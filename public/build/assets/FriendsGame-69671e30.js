import{R as m}from"./ReturnToBot-97343ef5.js";import{o as a,k as o,n as t,N as c,p as s,L as n,M as d,a8 as f,l as p,O as h}from"./index.es-c4852431.js";import"./_plugin-vue_export-helper-c27b6911.js";const _={class:"card card-style"},g={class:"content d-flex justify-content-center flex-wrap"},b={class:"img-avatar"},F=["innerHTML"],y={key:0,class:"content"},v={class:"text-center mb-2"},w={class:"text-center mb-2"},k={class:"mb-2 text-primary-emphasis"},N={class:"progress w-100",style:{height:"40px","border-radius":"25px"},role:"progressbar","aria-label":"Basic example","aria-valuenow":"25","aria-valuemin":"0","aria-valuemax":"100"},B=t("p",{class:"my-2"},"Когда полоска вашего прогресса достигнет 100% вы сможете получить свои бонусы!",-1),$={class:"content"},D={key:1},G={key:2},T=["disabled"],U={name:"App",data(){return{action:null,settings:{image:null,rules:null},friendsForm:{friends_invite:0,current_friends:0,needed_friends:0,friends_on_start:0,start_at:null,complete_at:null}}},computed:{currentBot(){return window.currentBot},progress(){let r=this.friendsForm.needed_friends||0,e=this.friendsForm.current_friends||0,i=this.friendsForm.friends_on_start||0;return(e-i)/(r-i)*100}},mounted(){this.prepareUserData()},methods:{start(){this.$store.dispatch("friendsGameStart").then(r=>{this.prepareUserData(),this.$botNotification.success("Отлично!","Игра началась! Поехали приглашать друзей")}).catch(()=>{this.$botNotification.warning("Упс...!","Игра почему-то не началась...")})},complete(){this.$store.dispatch("friendsGameFinish").then(r=>{this.prepareUserData(),this.$botNotification.success("Отлично!","Спасибо за участие в задании, скоро вы получите свои бонусы!")}).catch(()=>{this.$botNotification.warning("Упс...!","Мы не можем закончить это задание...")})},lose(){this.$botNotification.warning("Упс!","Вы израсходовали все попытки!")},prepareUserData(){return this.$store.dispatch("friendsGamePrepare").then(r=>{this.action=r.action,this.settings.rules=r.rules||null,this.settings.image=r.image||null,this.action.data&&(this.friendsForm.current_friends=this.action.data.current_friends||0,this.friendsForm.needed_friends=this.action.data.needed_friends||0,this.friendsForm.friends_invite=this.action.data.friends_invite||0,this.friendsForm.friends_on_start=this.action.data.friends_on_start||0,this.friendsForm.start_at=this.action.data.start_at||null,this.friendsForm.complete_at=this.action.data.complete_at||null)})}}},L=Object.assign(U,{setup(r){return(e,i)=>{const u=h("lazy");return a(),o("div",_,[t("div",g,[t("div",b,[c(t("img",null,null,512),[[u,"/images-by-bot-id/"+e.currentBot.id+"/"+e.currentBot.image]])]),t("p",null,[s(" Перед началом квеста нажмите кнопку «Начать». Затем перейдите в главное меню Бота и нажмите кнопку «Пригласить Друзей/Подруг». Там вы найдете свою реферальную ссылку, которую легко можно отправить тем, кого хотели бы пригласить в наш Бот. Для выполнения квеста нужно пригласить "),t("strong",null,n((e.friendsForm.needed_friends||0)-(e.friendsForm.friends_on_start||0)),1),s(" друзей/подруг , которые активируют нашего бота по вашей реферальной ссылке. ")]),e.settings.rules?(a(),o("p",{key:0,innerHTML:e.settings.rules},null,8,F)):d("",!0)]),e.friendsForm.start_at!=null?(a(),o("div",y,[t("p",v,[s("У вас сейчас "),t("strong",null,n(e.friendsForm.friends_invite||0),1),s(" / "),t("strong",null,n((e.friendsForm.needed_friends||0)-(e.friendsForm.friends_on_start||0)),1),s(" друзей")]),t("p",w,[s("По заданию приглашено "),t("strong",null,n(e.friendsForm.friends_invite||0),1),s(" друзей")]),t("p",k,[s("Текущий прогресс "),t("strong",null,n(e.progress)+"%",1)]),t("div",N,[t("div",{class:"progress-bar bg-success progress-bar-striped",style:f({width:e.progress+"%"})},n(e.progress.toFixed(2))+"% ",5)]),B])):d("",!0),t("div",$,[e.friendsForm.complete_at==null&&e.friendsForm.start_at==null?(a(),o("button",{key:0,type:"button",class:"btn btn-m btn-full my-3 rounded-xl text-uppercase font-900 shadow-s bg-green2-dark w-100",onClick:i[0]||(i[0]=(...l)=>e.start&&e.start(...l))},"Приступить к заданию")):d("",!0),e.friendsForm.start_at!=null?(a(),o("p",D,[s("Задание начато "),t("strong",null,n(e.friendsForm.start_at),1)])):d("",!0),e.friendsForm.complete_at!=null?(a(),o("p",G,[s("Задание завершено "),t("strong",null,n(e.friendsForm.complete_at),1)])):d("",!0),e.friendsForm.start_at!=null?(a(),o("button",{key:3,type:"button",onClick:i[1]||(i[1]=(...l)=>e.complete&&e.complete(...l)),disabled:e.progress<100||e.friendsForm.complete_at!=null||e.friendsForm.start_at==null,class:"btn btn-m btn-full my-3 rounded-xl text-uppercase font-900 shadow-s bg-green2-dark w-100"},"Получить награды",8,T)):d("",!0),p(m)])])}}});export{L as default};
