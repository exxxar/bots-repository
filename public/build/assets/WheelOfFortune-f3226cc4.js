import{W as p,_ as h}from"./ShopScriptEditor-721cbdb3.js";import{j as u,o,k as l,n as e,M as i,L as m,H as r,F as _,p as c}from"./index.es-c4852431.js";import"./ParametrizedTextArea-d4154d5d.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./v4-4a60fe23.js";import"./SlugForm-e32e52a8.js";import"./BotMediaList-9b4db56f.js";import"./Pagination-b758f7ed.js";/* empty css                                                   */import"./vue3-json-editor.esm.prod-a2876a2f.js";const f={key:0,class:"container py-3"},b={class:"row"},y={key:0,class:"col-12"},v=e("button",{type:"button","data-bs-toggle":"modal","data-bs-target":"#shop-wheel-form-modal",class:"btn btn-outline-light text-primary w-100 mb-2",style:{"font-size":"12px"}},[e("i",{class:"fa-regular fa-pen-to-square"}),c(" Редактор скрипта ")],-1),g=[v],k={key:1,class:"col-12"},w={class:"alert alert-light mb-2"},S={class:"col-12"},V={key:1,class:"container py-3"},D=e("div",{class:"row"},[e("div",{class:"col-12"},[e("div",{class:"alert alert-light d-flex flex-column align-items-center justify-content-center"},[c(" Подготавливаем данные... "),e("div",{class:"spinner-border text-primary my-3",role:"status"},[e("span",{class:"visually-hidden"},"Loading...")])])])],-1),M=[D],O={key:2,class:"modal fade",id:"shop-wheel-form-modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},W={class:"modal-dialog modal-fullscreen"},U={class:"modal-content"},$=e("div",{class:"modal-header"},[e("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"Редактор"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),j={class:"modal-body"},B={data(){return{loadScriptData:!1,script_data:null,action:null}},computed:{...u(["getSelf"]),canPlay(){return this.action?this.action.completed_at==null&&this.action.current_attempts<this.action.max_attempts:!1}},mounted(){this.loadScriptModuleData().then(()=>{this.prepareUserData()})},methods:{loadScriptModuleData(){return this.loadScriptData=!1,this.$store.dispatch("loadShopModuleData").then(a=>{this.script_data=[];const t=a.data;console.log("Resp data",t),this.$nextTick(()=>{t&&Object.keys(t).forEach(s=>{s&&(this.script_data[s]=t[s])}),this.loadScriptData=!0})})},winHandler(a){this.$store.dispatch("wheelOfFortuneV3Win",{winForm:(a==null?void 0:a.win)||null}).then(t=>{this.prepareUserData()}).catch(t=>{})},shuffle(a){let t=a.length,s;for(;t>0;)s=Math.floor(Math.random()*t),t--,[a[t],a[s]]=[a[s],a[t]];return a},prepareUserData(){return this.$store.dispatch("wheelOfFortuneV3Prepare").then(a=>{this.action=a.action})}}},z=Object.assign(B,{__name:"WheelOfFortune",setup(a){return(t,s)=>{var d;return o(),l(_,null,[t.loadScriptData&&t.action?(o(),l("div",f,[e("div",b,[(t.getSelf||{is_admin:!1}).is_admin?(o(),l("div",y,g)):i("",!0),(t.script_data.wheel_of_fortune||{rules:null}).rules?(o(),l("div",k,[e("div",w,m((t.script_data.wheel_of_fortune||{rules:null}).rules||"Правила игры"),1)])):i("",!0),e("div",S,[(((d=t.script_data.wheel_of_fortune)==null?void 0:d.items)||[]).length>=3?(o(),r(p,{key:0,"can-play":t.canPlay,"is-admin":!1,interval:t.script_data.interval||1,"action-data":t.action,onWin:t.winHandler,modelValue:t.script_data.wheel_of_fortune.items,"onUpdate:modelValue":s[0]||(s[0]=n=>t.script_data.wheel_of_fortune.items=n)},null,8,["can-play","interval","action-data","onWin","modelValue"])):i("",!0)])])])):(o(),l("div",V,M)),(t.getSelf||{is_admin:!1}).is_admin?(o(),l("div",O,[e("div",W,[e("div",U,[$,e("div",j,[t.script_data?(o(),r(h,{key:0,"default-type":1,modelValue:t.script_data,"onUpdate:modelValue":s[1]||(s[1]=n=>t.script_data=n)},null,8,["modelValue"])):i("",!0)])])])])):i("",!0)],64)}}});export{z as default};
