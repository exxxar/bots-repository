import{g as C,o as l,j as n,l as t,F as b,J as f,K as _,L as p,M as c,W as h,a0 as k,n as m,a2 as V,$ as U,a8 as F,N as w,G as y,k as S,w as P,s as O}from"./index.es-db843bab.js";import{_ as x}from"./_plugin-vue_export-helper-c27b6911.js";import{P as N}from"./Pagination-ccc8cfc8.js";/* empty css                                                   */const j={props:["bot","item"],data(){return{sectionForm:{section:null},categoryForm:{label:null},tab:0,types:[{title:"Готовый продукт",value:1},{title:"Товар на вес",value:2},{title:"Конструктор товара",value:3}],productCategories:[],sections:["Общие характеристики","Дополнительная информация"],photos:[],categories:[],removed_options:[],productForm:{article:null,vk_product_id:null,title:null,description:null,images:[],type:1,old_price:null,current_price:null,variants:[],in_stop_list_at:null,bot_id:null,options:[],reviews:[],categories:[]}}},computed:{...C(["getCategories"])},mounted(){this.loadProductCategories(),this.item&&this.$nextTick(()=>{this.productForm={id:this.item.id||null,article:this.item.article||null,vk_product_id:this.item.vk_product_id||null,title:this.item.title||null,description:this.item.description||null,images:this.item.images||null,type:this.item.type||1,old_price:this.item.old_price||null,current_price:this.item.current_price||null,variants:this.item.variants||null,in_stop_list_at:this.item.in_stop_list_at||null,bot_id:this.item.bot_id||null,options:this.item.options||null,reviews:this.item.reviews||null},this.options=[],this.item.categories.forEach(o=>{this.productCategories.push(o.id)})})},methods:{prepareCategoryName(o){let e=this.categories.find(r=>r.value===o);return e?e.label:o},removeProduct(){this.$store.dispatch("removeProductCategory",{category_id:id}).then(()=>{this.loadProductCategories(),this.$botNotification.notification("Конструктор ботов","Продукт успешно удален!")})},removeCategory(o){let e=this.categories.findIndex(r=>r.id===o)||null;e&&this.categories.splice(e,1),this.$store.dispatch("removeProductCategory",{category_id:o}).then(()=>{this.loadProductCategories(),this.$botNotification.notification("Конструктор ботов","Категория успешно удалена!")})},addCategory(){const o=this.categoryForm.label;this.categoryForm.label=null,this.$store.dispatch("addProductCategory",{category:o}).then(()=>{this.loadProductCategories()})},selectCategory(o){this.productCategories||(this.productCategories=[]);let e=this.productCategories.indexOf(o.id);e!==-1?this.productCategories.splice(e,1):this.productCategories.push(o.id)},submit(){let o=new FormData;if(Object.keys(this.productForm).forEach(e=>{const r=this.productForm[e]||"";typeof r=="object"?o.append(e,JSON.stringify(r)):o.append(e,r)}),this.bot&&o.append("bot_id",this.bot.id),this.photos.length>0)for(let e=0;e<this.photos.length;e++)o.append("photos[]",this.photos[e]);this.removed_options.length>0&&o.append("removed_options",JSON.stringify(this.removed_options)),this.productCategories.length>0&&o.append("categories",JSON.stringify(this.productCategories)),this.$store.dispatch("saveProduct",{productForm:o}).then(e=>{this.load=!0,this.$botNotification.notification("Конструктор ботов","Продукт успешно сохранен!"),this.clearForm(),this.$emit("refresh")}).catch(e=>{})},onChangePhotos(o){const e=o.target.files;for(let r=0;r<e.length;r++)this.photos.push(e[r])},loadProductCategories(){this.$store.dispatch("loadCategories").then(()=>{this.categories=this.getCategories})},getPhoto(o){return{imageUrl:URL.createObjectURL(o)}},removeSection(o){this.sections.splice(o,1)},addSection(){this.sections.push(this.sectionForm.section),this.sectionForm.section=null},addOption(){this.productForm.options||(this.productForm.options=[]),this.productForm.options.push({id:null,key:null,value:null,title:null,section:null})},addVariant(){this.productForm.variants||(this.productForm.variants=[]),this.productForm.variants.push({key:null,value:null})},removeProductCategory(o){},removeVariant(o){this.productForm.variants.splice(o,1)},removeOption(o){this.productForm.options[o].id&&this.removed_options.push(this.productForm.options[o].id),this.productForm.options.splice(o,1)},removeImage(o){this.productForm.images.splice(o,1)},removePhoto(o){this.photos.splice(o,1)},clearForm(){const o={article:null,vk_product_id:null,title:null,description:null,images:[],type:1,old_price:null,current_price:null,variants:[],in_stop_list_at:null,bot_id:null,options:[],reviews:[],categories:[]};this.photos=[],this.removed_options=[],this.productCategories=[],this.productForm=o}}},L={class:"card card-style"},D={class:"content"},T=t("h6",null,"Управление категориями",-1),q={key:0,class:"d-flex flex-wrap"},M={class:"px-3 font-10 rounded mr-1 mb-1 cursor-pointer"},$=["onClick"],z={class:"mb-2"},A=t("label",{for:"exampleDropdownFormEmail1",class:"form-label"},"Новая категория",-1),B={class:"card card-style bg-theme pb-0"},E={class:"content"},I={class:"d-flex justify-content-between flex-wrap"},R=t("i",{class:"fa-solid fa-plus mr-1"},null,-1),J={class:"form-check"},W=t("label",{class:"form-check-label",for:"in-stop-list"}," Товар находится в стоп-листе ",-1),G=t("div",{class:"divider divider-small my-3 bg-highlight"},null,-1),K=t("h6",null,"Выбор категории",-1),X={key:0,class:"d-flex flex-wrap"},H=["onClick"],Q=t("div",{class:"divider divider-small my-3 bg-highlight"},null,-1),Y={class:"mb-2"},Z=t("label",{for:"vk-product-id"},"Идентификатор товара VK",-1),tt={class:"mb-2"},et=t("label",{for:"article"},"Артикул товара",-1),ot={class:"mb-2"},st=t("label",{for:"title"},"Название товара",-1),it={class:"mb-2"},rt=t("label",{for:"type"},"Тип товара",-1),lt=["value"],nt={class:"mb-2"},dt=t("label",{for:"description"},"Описание товара",-1),at={class:"mb-2"},ct=t("label",{for:"current-price"},"Актуальная цена, руб",-1),ut={class:"mb-2"},pt=t("label",{for:"old-price"},"Старая цена, руб",-1),mt=t("div",{class:"divider divider-small my-3 bg-highlight"},null,-1),ht={key:0},bt={class:"mb-2"},_t={class:"mb-2"},ft=["for"],gt=["onUpdate:modelValue","id"],vt={class:"mb-2"},kt=["for"],yt=["onUpdate:modelValue","id"],Ft=["onClick"],Pt=t("i",{class:"fa-solid fa-trash-can"},null,-1),Ct=t("div",{class:"divider divider-small my-3 bg-highlight"},null,-1),wt=t("h6",null,"Характеристики товара",-1),xt={class:"mb-2"},Vt=t("button",{class:"btn btn-border btn-m btn-full mb-0 rounded-sm text-uppercase font-900 border-green2-dark color-green2-dark bg-theme w-100",type:"submit",id:"button-addon2"},"Добавить секцию ",-1),Ut={key:0,class:"d-flex flex-wrap"},St={class:"px-3 text-white rounded bg-info mr-1 mb-1 cursor-pointer font-12"},Ot=["onClick"],Nt=t("div",{class:"divider divider-small my-3 bg-highlight"},null,-1),jt={class:"mb-2"},Lt={class:"form-floating mb-2"},Dt=["for"],Tt=["onClick"],qt=t("i",{class:"fa-solid fa-trash-can mr-1"},null,-1),Mt=[qt],$t=["onUpdate:modelValue","id"],zt={class:"form-floating mb-2"},At=["for"],Bt=["onUpdate:modelValue","id"],Et={class:"form-floating mb-2"},It=["for"],Rt=["onUpdate:modelValue","id"],Jt=t("option",{value:null},"Без секции",-1),Wt=["value"],Gt=t("div",{class:"divider divider-small my-3 bg-highlight"},null,-1),Kt={class:"mb-2"},Xt=t("h6",null,"Фотографии товара",-1),Ht={class:"photo-preview d-flex justify-content-center flex-wrap w-100"},Qt={for:"location-photos",style:{"margin-right":"10px"},class:"photo-loader ml-2"},Yt=t("span",null,"+",-1),Zt={class:"mb-2 img-preview",style:{"margin-right":"10px"}},te={class:"remove"},ee=["onClick"],oe={class:"mb-2 img-preview",style:{"margin-right":"10px"}},se={class:"remove"},ie=["onClick"],re=t("button",{type:"submit",class:"btn btn-m btn-full mb-0 rounded-xs text-uppercase font-900 shadow-s bg-green2-dark w-100"}," Сохранить ",-1),le={key:0,class:"divider divider-small my-3 bg-highlight"};function ne(o,e,r,g,s,a){const v=w("lazy");return l(),n(b,null,[t("div",L,[t("div",D,[T,s.categories.length>0?(l(),n("div",q,[(l(!0),n(b,null,f(s.categories,(i,d)=>(l(),n("p",M,[t("span",null,_(i.title),1),t("i",{onClick:u=>a.removeCategory(i.id),class:"fa-solid fa-trash ml-2 color-red2-dark"},null,8,$)]))),256))])):p("",!0),t("div",z,[A,c(t("input",{type:"text",class:"form-control","onUpdate:modelValue":e[0]||(e[0]=i=>s.categoryForm.label=i),id:"exampleDropdownFormEmail1",placeholder:"Название категории"},null,512),[[h,s.categoryForm.label]])]),t("button",{class:"btn btn-border btn-m btn-full mb-0 rounded-sm text-uppercase font-900 border-green2-dark color-green2-dark bg-theme w-100",type:"button",onClick:e[1]||(e[1]=(...i)=>a.addCategory&&a.addCategory(...i))},"Добавить категорию ")])]),t("div",B,[t("div",E,[t("form",{onSubmit:e[16]||(e[16]=k((...i)=>a.submit&&a.submit(...i),["prevent"]))},[t("div",I,[t("a",{href:"javascript:void(0)",class:"btn btn-m btn-full mb-2 rounded-xs text-uppercase font-900 shadow-s bg-green2-light w-100",onClick:e[2]||(e[2]=(...i)=>a.clearForm&&a.clearForm(...i))},[R,m(" Новый товар ")]),t("div",J,[c(t("input",{class:"form-check-input","onUpdate:modelValue":e[3]||(e[3]=i=>s.productForm.in_stop_list_at=i),type:"checkbox",value:"false",id:"in-stop-list"},null,512),[[V,s.productForm.in_stop_list_at]]),W])]),G,K,s.categories.length>0?(l(),n("div",X,[(l(!0),n(b,null,f(s.categories,(i,d)=>(l(),n("p",{class:U(["px-3 font-10 rounded mr-1 mb-1 cursor-pointer",{"bg-info text-white":s.productCategories.indexOf(i.id)!=-1}])},[t("span",{onClick:u=>a.selectCategory(i)},_(i.title),9,H)],2))),256))])):p("",!0),Q,t("div",Y,[Z,c(t("input",{type:"text","onUpdate:modelValue":e[4]||(e[4]=i=>s.productForm.vk_product_id=i),disabled:!0,class:"form-control",id:"vk-product-id",placeholder:"Идентификатор"},null,512),[[h,s.productForm.vk_product_id]])]),t("div",tt,[et,c(t("input",{type:"text","onUpdate:modelValue":e[5]||(e[5]=i=>s.productForm.article=i),class:"form-control",id:"article",placeholder:"Название артикула"},null,512),[[h,s.productForm.article]])]),t("div",ot,[st,c(t("input",{type:"text","onUpdate:modelValue":e[6]||(e[6]=i=>s.productForm.title=i),class:"form-control",id:"title",placeholder:"Название"},null,512),[[h,s.productForm.title]])]),t("div",it,[rt,c(t("select",{class:"form-control font-12","onUpdate:modelValue":e[7]||(e[7]=i=>s.productForm.type=i),id:"type","aria-label":"Floating label select example"},[(l(!0),n(b,null,f(s.types,(i,d)=>(l(),n("option",{value:i.value},_(i.title),9,lt))),256))],512),[[F,s.productForm.type]])]),t("div",nt,[dt,c(t("textarea",{class:"form-control font-12","onUpdate:modelValue":e[8]||(e[8]=i=>s.productForm.description=i),placeholder:"Напишие полное описание товара",id:"description"},null,512),[[h,s.productForm.description]])]),t("div",at,[ct,c(t("input",{type:"number","onUpdate:modelValue":e[9]||(e[9]=i=>s.productForm.current_price=i),class:"form-control",id:"current-price",placeholder:"0 руб.",required:""},null,512),[[h,s.productForm.current_price]])]),t("div",ut,[pt,c(t("input",{type:"number","onUpdate:modelValue":e[10]||(e[10]=i=>s.productForm.old_price=i),class:"form-control",id:"old-price",placeholder:"0 руб"},null,512),[[h,s.productForm.old_price]])]),mt,t("h6",null,[m("Варианты товара "),s.productForm.variants?(l(),n("span",ht,"("+_(s.productForm.variants.length)+")",1)):p("",!0)]),t("button",{type:"button",class:"btn btn-border btn-m btn-full mb-0 rounded-sm text-uppercase font-900 border-green2-dark color-green2-dark bg-theme w-100",onClick:e[11]||(e[11]=(...i)=>a.addVariant&&a.addVariant(...i))},"Добавить вариант "),(l(!0),n(b,null,f(s.productForm.variants,(i,d)=>(l(),n("div",bt,[t("div",_t,[t("label",{for:"variant-key-"+d},"Ключ",8,ft),c(t("input",{type:"text","onUpdate:modelValue":u=>s.productForm.variants[d].key=u,class:"form-control",id:"variant-key-"+d,placeholder:"Название варианта",required:""},null,8,gt),[[h,s.productForm.variants[d].key]])]),t("div",vt,[t("label",{for:"variant-value-"+d},"Значение",8,kt),c(t("input",{type:"text","onUpdate:modelValue":u=>s.productForm.variants[d].value=u,class:"form-control",id:"variant-value-"+d,placeholder:"Величина\\значение варианта",required:""},null,8,yt),[[h,s.productForm.variants[d].value]])]),t("button",{type:"button",class:"btn btn-outline-danger w-100",onClick:u=>a.removeVariant(d)},[Pt,m(" Удалить вариант ")],8,Ft)]))),256)),Ct,wt,t("div",xt,[t("form",{onSubmit:e[13]||(e[13]=k((...i)=>a.addSection&&a.addSection(...i),["prevent"])),class:"mb-2"},[c(t("input",{type:"text","onUpdate:modelValue":e[12]||(e[12]=i=>s.sectionForm.section=i),class:"form-control mb-2",placeholder:"Название секции","aria-label":"Recipient's username","aria-describedby":"button-addon2",required:""},null,512),[[h,s.sectionForm.section]]),Vt],32),s.sections.length>0?(l(),n("div",Ut,[(l(!0),n(b,null,f(s.sections,(i,d)=>(l(),n("span",St,[m(_(i)+" ",1),t("i",{onClick:u=>a.removeSection(d),class:"fa-solid fa-trash ml-2 color-red2-dark"},null,8,Ot)]))),256))])):p("",!0),Nt]),(l(!0),n(b,null,f(s.productForm.options,(i,d)=>(l(),n("div",jt,[t("div",Lt,[t("label",{for:"option-title-"+d,class:"font-12 my-0 w-100 d-flex justify-content-between"},[m(" Название характеристики "),t("button",{type:"button",class:"btn btn-link color-red2-light font-12 p-0",onClick:u=>a.removeOption(d)},Mt,8,Tt)],8,Dt),c(t("input",{type:"text","onUpdate:modelValue":u=>s.productForm.options[d].title=u,class:"form-control",id:"option-title-"+d,placeholder:"Характеристика"},null,8,$t),[[h,s.productForm.options[d].title]])]),t("div",zt,[t("label",{for:"option-value-"+d,class:"font-12 my-0"},"Значение характеристики",8,At),c(t("input",{type:"text","onUpdate:modelValue":u=>s.productForm.options[d].value=u,class:"form-control",id:"option-value-"+d,placeholder:"Значение"},null,8,Bt),[[h,s.productForm.options[d].value]])]),t("div",Et,[t("label",{for:"option-section-"+d,class:"font-12 my-0"},"Секция товара",8,It),c(t("select",{class:"form-control font-12","onUpdate:modelValue":u=>s.productForm.options[d].section=u,id:"option-section-"+d,"aria-label":"Floating label select example"},[Jt,(l(!0),n(b,null,f(s.sections,u=>(l(),n("option",{value:u},_(u),9,Wt))),256))],8,Rt),[[F,s.productForm.options[d].section]])])]))),256)),t("button",{type:"button",class:"btn btn-border btn-m btn-full mb-0 rounded-sm text-uppercase font-900 border-green2-dark color-green2-dark bg-theme w-100",onClick:e[14]||(e[14]=(...i)=>a.addOption&&a.addOption(...i))},"Добавить характеристику "),Gt,t("div",Kt,[Xt,t("div",Ht,[t("label",Qt,[Yt,t("input",{type:"file",id:"location-photos",multiple:"",accept:"image/*",onChange:e[15]||(e[15]=(...i)=>a.onChangePhotos&&a.onChangePhotos(...i)),style:{display:"none"}},null,32)]),s.productForm.images?(l(!0),n(b,{key:0},f(s.productForm.images,(i,d)=>(l(),n("div",Zt,[c(t("img",null,null,512),[[v,i]]),t("div",te,[t("a",{href:"javascript:void(0)",onClick:u=>a.removeImage(d)},"Удалить",8,ee)])]))),256)):p("",!0),s.photos.length>0?(l(!0),n(b,{key:1},f(s.photos,(i,d)=>(l(),n("div",oe,[c(t("img",null,null,512),[[v,a.getPhoto(i).imageUrl]]),t("div",se,[t("a",{href:"javascript:void(0)",onClick:u=>a.removePhoto(d)},"Удалить",8,ie)])]))),256)):p("",!0)])]),re],32),s.productForm.id?(l(),n("div",le)):p("",!0),s.productForm.id?(l(),n("button",{key:1,onClick:e[17]||(e[17]=(...i)=>a.removeProduct&&a.removeProduct(...i)),type:"button",class:"btn btn-m btn-full mb-0 rounded-xs text-uppercase font-900 shadow-s bg-red2-dark w-100"},"Удалить товар ")):p("",!0)])])],64)}const de=x(j,[["render",ne]]),ae={props:["item"],data(){return{}},methods:{selectProduct(){this.$emit("select",this.item),window.scrollTo(50,400)},preparedImgUrl(o){if(o.toLocaleLowerCase().startsWith("https://")||o.toLocaleLowerCase().startsWith("http://"))return o},removeProduct(){this.$store.dispatch("removeProduct",this.item.id).then(o=>{this.$botNotification.success("Продукты","Продукт успешно удален!")}).catch(o=>{})},duplicateProduct(){this.$store.dispatch("duplicateProduct",this.item.id).then(o=>{this.$botNotification.success("Продукты","Продукт успешно продублирован!")}).catch(o=>{})}},mounted(){},computed:{}},ce={class:"d-flex pb-2"},ue={class:"mr-auto"},pe={class:"rounded-m shadow-xl",width:"110"},me={class:"ml-auto w-100 pl-3"},he={class:"font-14 font-600 opacity-80 pb-2"},be=t("div",{class:"clearfix"},null,-1),_e={class:"font-23 font-700 float-left pt-2"},fe={key:0,style:{"text-decoration":"line-through"},class:"font-15 opacity-50"},ge={class:"float-right"},ve={class:"input-style input-style-1 mt-1"},ke=t("i",{class:"fa-regular fa-pen-to-square"},null,-1),ye=[ke];function Fe(o,e,r,g,s,a){const v=w("lazy");return l(),n("div",ce,[t("div",ue,[c(t("img",pe,null,512),[[v,a.preparedImgUrl(r.item.images[0])]])]),t("div",me,[t("h5",he,"#"+_(r.item.id)+" "+_(r.item.title),1),be,t("h1",_e,[m(_(r.item.current_price)+"₽",1),r.item.old_price?(l(),n("sup",fe,_(r.item.old_price)+"₽",1)):p("",!0)]),t("div",ge,[t("div",ve,[t("button",{onClick:e[0]||(e[0]=(...i)=>a.selectProduct&&a.selectProduct(...i)),class:"btn btn-full btn-sm rounded-sm bg-highlight font-800 text-uppercase"},ye)])])])])}const Pe=x(ae,[["render",Fe]]),Ce={class:"card card-style"},we={class:"content"},xe=t("button",{class:"btn btn-m btn-full rounded-xs text-uppercase font-900 shadow-s bg-blue2-dark w-100 mb-0",type:"submit",id:"button-addon2"}," Найти ",-1),Ve={key:0},Ue={data(){return{search:null,products:[],paginate:null}},computed:{...C(["getProducts","getProductsPaginateObject"]),filteredProducts(){return this.products}},mounted(){this.loadProducts()},methods:{selectProduct(o){this.$emit("select",o)},nextProducts(o){this.loadProducts(o)},loadProducts(o=0){return this.$store.dispatch("loadProducts",{dataObject:{search:this.search},page:o}).then(()=>{this.products=this.getProducts,this.paginate=this.getProductsPaginateObject})}}},Se=Object.assign(Ue,{__name:"ProductList",setup(o){return(e,r)=>(l(),n("div",Ce,[t("div",we,[t("form",{onSubmit:r[1]||(r[1]=k(g=>e.loadProducts(0),["prevent"]))},[c(t("input",{type:"text",class:"form-control mb-2",placeholder:"Поиск товара","aria-label":"Поиск товара","onUpdate:modelValue":r[0]||(r[0]=g=>e.search=g),"aria-describedby":"button-addon2"},null,512),[[h,e.search]]),xe],32),t("p",null,[m("Всего товаров: "),e.paginate?(l(),n("span",Ve,_(e.paginate.meta.total||0),1)):p("",!0)]),(l(!0),n(b,null,f(e.filteredProducts,(g,s)=>(l(),y(Pe,{onSelect:a=>e.selectProduct(g),item:g},null,8,["onSelect","item"]))),256)),e.paginate?(l(),y(N,{key:0,simple:!0,onPagination_page:e.nextProducts,pagination:e.paginate},null,8,["onPagination_page","pagination"])):p("",!0)])]))}}),Oe={class:"card card-style"},Ne={class:"content mb-0"},je=t("h3",{class:"font-700"},"Управление магазином",-1),Le={class:"form-label d-flex justify-content-between mt-2",id:"bot-level-3"},De=t("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Te=t("div",null,"Ссылка на страницу ВК с товарами для вашего магазина в боте ",-1),qe=t("a",{href:"https://vk.com/groups?w=groups_create",target:"_blank"},"Создать",-1),Me=["disabled"],$e=t("i",{class:"fa-regular fa-floppy-disk mr-2"},null,-1),ze=t("div",{class:"divider divider-small my-3 bg-highlight"},null,-1),Ae={key:0,class:"btn btn-border btn-m btn-full mb-1 rounded-sm text-uppercase font-900 border-blue2-dark color-blue2-dark bg-theme w-100"},Be=t("i",{class:"fa-brands fa-vk mr-2"},null,-1),Ee=t("span",{class:"spinner-border color-blue2-dark font-12 ml-2",style:{"border-width":"2px",width:"1rem",height:"1rem"},role:"status"},null,-1),Ie=t("i",{class:"fa-brands fa-vk mr-2"},null,-1),Re=t("i",{class:"fa-solid fa-lock mr-2"},null,-1),Je=t("i",{class:"fa-solid fa-lock mr-2"},null,-1),We=t("i",{class:"fa-solid fa-lock mr-2"},null,-1),Ge=t("div",{class:"divider divider-small my-3 bg-highlight"},null,-1),Ke=["disabled"],Xe=t("i",{class:"fa-solid fa-trash mr-2"},null,-1),He=t("h6",null,null,-1),Qe={data(){return{load:!1,url:null,link:null,bot:null,selectedProduct:null,botForm:{vk_shop_link:null}}},computed:{tg(){return window.Telegram.WebApp}},mounted(){this.updateProducts(),this.botForm.vk_shop_link=window.currentBot.vk_shop_link||null},methods:{updateShopLink(){this.load=!0,this.$store.dispatch("updateShopLink",{botForm:this.botForm}).then(o=>{this.load=!1,this.updateProducts(),this.$botNotification.notification("Менеджер магазина","Ссылка на источник в ВК обновлена")}).catch(()=>{this.load=!1})},exportOrders(){this.$botNotification.notification("Менеджер магазина","Функция недоступна")},exportProducts(){this.$botNotification.notification("Менеджер магазина","Функция недоступна")},importProducts(){this.$botNotification.notification("Менеджер магазина","Функция недоступна")},refresh(){this.load=!0,this.selectedProduct=null,this.$nextTick(()=>{this.load=!1})},removeAllProducts(){this.load=!0,this.$store.dispatch("removeAllProducts").then(o=>{this.load=!1,this.$botNotification.notification("Менеджер магазина","Все продукты удалены")}).catch(()=>{this.load=!1})},selectProduct(o){this.load=!0,this.$nextTick(()=>{this.selectedProduct=o,this.load=!1})},updateProducts(){this.load=!0,this.$store.dispatch("updateProductsFromVk").then(o=>{this.link=o.data.url||null,this.load=!1,this.url=null}).catch(()=>{this.load=!1})},open(o){this.tg.openLink(o)}}},oo=Object.assign(Qe,{__name:"ShopManager",setup(o){return(e,r)=>{const g=O("Popper");return l(),n(b,null,[t("div",Oe,[t("div",Ne,[je,t("form",{onSubmit:r[1]||(r[1]=k((...s)=>e.updateShopLink&&e.updateShopLink(...s),["prevent"])),class:"mb-2"},[t("label",Le,[t("div",null,[S(g,null,{content:P(()=>[Te]),default:P(()=>[De]),_:1}),m(" ВК-группа ")]),qe]),c(t("input",{type:"url",class:"form-control",placeholder:"Ссылка на группу ВК","aria-label":"ссылка на группу ВК","onUpdate:modelValue":r[0]||(r[0]=s=>e.botForm.vk_shop_link=s),"aria-describedby":"vk_shop_link"},null,512),[[h,e.botForm.vk_shop_link]]),t("button",{disabled:e.load,class:"btn btn-m btn-full mb-3 mt-2 rounded-sm text-uppercase font-900 shadow-s bg-red2-dark w-100"},[$e,m(" Сохранить ")],8,Me)],32),ze,e.link?p("",!0):(l(),n("p",Ae,[Be,m(" Подготовка ссылки "),Ee])),e.link?(l(),n("a",{key:1,onClick:r[2]||(r[2]=s=>e.open(e.link)),href:"javascript:void(0)",type:"button",class:"btn btn-border btn-m btn-full mb-1 rounded-sm text-uppercase font-900 border-blue2-dark color-blue2-dark bg-theme w-100"},[Ie,m(" Обновить товар из ВК ")])):p("",!0),t("button",{onClick:r[3]||(r[3]=(...s)=>e.exportOrders&&e.exportOrders(...s)),class:"btn btn-border btn-m btn-full mb-1 rounded-sm text-uppercase font-900 border-green1-dark color-green1-dark bg-theme w-100"},[Re,m(" Экспортировать заказы ")]),t("button",{onClick:r[4]||(r[4]=(...s)=>e.importProducts&&e.importProducts(...s)),class:"btn btn-border btn-m btn-full mb-1 rounded-sm text-uppercase font-900 border-green1-dark color-green1-dark bg-theme w-100"},[Je,m(" Импорт из XLS ")]),t("button",{onClick:r[5]||(r[5]=(...s)=>e.exportProducts&&e.exportProducts(...s)),class:"btn btn-border btn-m btn-full mb-1 rounded-sm text-uppercase font-900 border-green1-dark color-green1-dark bg-theme w-100"},[We,m(" Экспорт в XLS ")]),Ge,t("button",{onClick:r[6]||(r[6]=(...s)=>e.removeAllProducts&&e.removeAllProducts(...s)),disabled:e.load,class:"btn btn-m btn-full mb-3 rounded-sm text-uppercase font-900 shadow-s bg-red2-dark w-100"},[Xe,m(" Удалить товары ")],8,Ke)])]),He,e.load?p("",!0):(l(),y(de,{key:0,item:e.selectedProduct,onRefresh:e.refresh},null,8,["item","onRefresh"])),e.load?p("",!0):(l(),y(Se,{key:1,onSelect:e.selectProduct},null,8,["onSelect"]))],64)}}});export{oo as default};
