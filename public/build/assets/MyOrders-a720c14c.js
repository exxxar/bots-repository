import{P as h}from"./Pagination-b758f7ed.js";import{_ as g}from"./ReviewCard-c6045fca.js";import{j as f,o as s,k as i,n as e,a0 as _,F as d,K as u,H as p,M as l,p as c,L as v,l as b}from"./index.es-c4852431.js";/* empty css                                                   */import"./_plugin-vue_export-helper-c27b6911.js";import"./Rating-5dca4717.js";import"./ProductCardSimple-2492c86f.js";const y={class:"container"},w={class:"row"},k=e("div",{class:"col-12"},[e("h5",{class:"my-3"},[e("i",{class:"fa-solid fa-list-check mr-1 text-primary"}),c(" Список заказов")]),e("div",{class:"alert alert-light mb-3 fw-bold",role:"alert"},[e("strong",{class:"text-primary"},"Внимание!"),c(" При повторном заказе автоматически формируется корзина из доступных к заказу товаров из вашего списка. Товары в стоп-листе заведения добавлены не будут. ")])],-1),j={class:"col-12"},O={class:"nav nav-tabs justify-content-center"},$={class:"nav-item"},P={class:"nav-item"},C={key:0,class:"col-12"},V={key:0,class:"list-group my-2"},B=["onClick"],R=e("i",{class:"fa-solid fa-stopwatch mr-2 text-primary"},null,-1),z=["onClick"],N=e("i",{class:"fa-solid fa-arrow-rotate-right mr-2"},null,-1),U={key:1,class:"d-flex flex-column justify-content-center align-items-center",style:{height:"100vh"}},x=e("div",{class:"d-flex justify-content-center flex-column align-items-center"},[e("i",{class:"fa-brands fa-shopify mb-3",style:{"font-size":"36px"}}),e("p",null,"Заказов еще нет:(")],-1),E=[x],I={key:1,class:"col-12"},S={key:0},T=e("hr",null,null,-1),A={key:1,class:"d-flex flex-column justify-content-center align-items-center",style:{height:"100vh"}},F=e("div",{class:"d-flex justify-content-center flex-column align-items-center"},[e("i",{class:"fa-brands fa-shopify mb-3",style:{"font-size":"36px"}}),e("p",null,"Отзывов о товарах еще нет:(")],-1),L=[F],M={props:["selected","active"],data(){return{tab:0,orders:null,orders_paginate_object:null,reviews:[],reviews_paginate_object:null}},computed:{...f(["getOrders","getOrdersPaginateObject","inCart","getReviews","getReviewsPaginateObject"]),tg(){return window.Telegram.WebApp}},mounted(){this.loadOrders(),this.tg.BackButton.show(),this.tg.BackButton.onClick(()=>{document.querySelectorAll('[data-bs-dismiss="modal"]').forEach(a=>a.click()),this.$router.back()})},methods:{loadProductInOrders(a=0){return this.tab=1,this.$store.dispatch("loadReviews",{page:a||0,size:20}).then(()=>{this.reviews=this.getReviews,this.reviews_paginate_object=this.getReviewsPaginateObject})},repeatOrder(a){let t=a.product_details[0].products.map(n=>n.title);this.$store.dispatch("repeatOrder",{products:t}).then(n=>{this.$store.dispatch("clearCart");let r=n.data;if(r.length===0){a.disabled=!0,this.$notify({title:"Корзина",text:"Нет доступных к заказу товаров:("});return}r.forEach(o=>{this.inCart(o)===0?this.$store.dispatch("addProductToCart",o):this.$store.dispatch("incQuantity",o.id)}),this.$router.push({name:"ShopCartV2"})}).catch(()=>{this.$notify({title:"Корзина",text:"Ошибка формирования заказа",type:"error"})})},nextOrders(a){this.loadOrders(a)},nextReviews(a){this.loadProductInOrders(a)},select(a){return this.$emit("select",a)},loadOrders(a=0){return this.$store.dispatch("loadOrders",{page:a,size:20}).then(()=>{this.orders=this.getOrders,this.orders_paginate_object=this.getOrdersPaginateObject})}}},J=Object.assign(M,{__name:"MyOrders",setup(a){return(t,n)=>(s(),i("div",y,[e("div",w,[k,e("div",j,[e("ul",O,[e("li",$,[e("a",{class:_(["nav-link",{active:t.tab===0}]),onClick:n[0]||(n[0]=r=>t.tab=0),"aria-current":"page",href:"javascript:void(0)"},"Заказы",2)]),e("li",P,[e("a",{class:_(["nav-link",{active:t.tab===1}]),onClick:n[1]||(n[1]=r=>t.loadProductInOrders(0)),href:"javascript:void(0)"},"Товары",2)])])]),t.tab===0?(s(),i("div",C,[(t.orders||[]).length>0?(s(),i("div",V,[(s(!0),i(d,null,u(t.orders,r=>(s(),i("a",{href:"javascript:void(0)",onClick:o=>t.select(r),style:{"font-weight":"bold"},class:"list-group-item d-flex justify-content-between p-3 align-items-start flex-column","aria-current":"true"},[e("p",null,[R,c(" Время заказа "+v(r.created_at),1)]),e("ul",null,[(s(!0),i(d,null,u(r.product_details[0].products,o=>(s(),i("li",null,v(o.title),1))),256))]),r.review?(s(),p(g,{key:0,modelValue:r.review,"onUpdate:modelValue":o=>r.review=o},null,8,["modelValue","onUpdate:modelValue"])):l("",!0),r.disabled?l("",!0):(s(),i("button",{key:1,type:"button",onClick:o=>t.repeatOrder(r),class:"btn btn-primary w-100 p-3"},[N,c(" Повторить заказ ")],8,z))],8,B))),256))])):(s(),i("div",U,E)),t.orders_paginate_object?(s(),p(h,{key:2,simple:!0,onPagination_page:t.nextOrders,pagination:t.orders_paginate_object},null,8,["onPagination_page","pagination"])):l("",!0)])):l("",!0),t.tab===1?(s(),i("div",I,[(t.reviews||[]).length>0?(s(),i("div",S,[(s(!0),i(d,null,u(t.reviews,(r,o)=>(s(),i(d,null,[b(g,{modelValue:t.reviews[o],"onUpdate:modelValue":m=>t.reviews[o]=m,"need-product":!0},null,8,["modelValue","onUpdate:modelValue"]),T],64))),256)),t.reviews_paginate_object?(s(),p(h,{key:0,simple:!0,onPagination_page:t.nextReviews,pagination:t.reviews_paginate_object},null,8,["onPagination_page","pagination"])):l("",!0)])):(s(),i("div",A,L))])):l("",!0)])]))}});export{J as default};
