import{g as v,s as j,o as i,j as o,l as s,n as m,K as d,L as r,$ as b,F as h,k as p,J as g,G as _,N as $,M as f,a7 as M,p as x,W as L,T as B,U as F,w as O,a6 as T}from"./index.es-db843bab.js";import{C as z,S as R,P as V,N as E}from"./carousel.es-8c11147c.js";import{_ as A}from"./ProductCard-0b6da098.js";import{R as q}from"./Rating-9f9eedad.js";import{_ as D}from"./ReviewCard-a85301e6.js";import{v as k}from"./v4-4a60fe23.js";import{P as S}from"./Pagination-ccc8cfc8.js";/* empty css                                                   */import"./ProductCardSimple-a61f6e6c.js";import{_ as N}from"./ProductCollectionView-4e0e7646.js";import{_ as J}from"./CollectionCardSimple-9feea761.js";import{P as w}from"./PreloaderV1-97f38083.js";import{_ as P}from"./_plugin-vue_export-helper-c27b6911.js";import{S as U}from"./StoryList-dd9fe137.js";import{B as Q}from"./BookingDropdown-766c0db1.js";z,R,V,E,{...v(["getCategories"])};const G={class:"list-group-item p-2 border-0 d-flex justify-content-between align-items-start"},H={class:"ms-2 w-100"},W=s("i",{class:"fa-solid fa-arrow-up-right-from-square"},null,-1),Y={key:0},K={class:"mb-2 fst-italic"},X={key:0,class:"d-flex justify-content-between align-items-center px-2"},Z={key:0},tt=s("i",{class:"fa-solid fa-check-double mr-2"},null,-1),et={key:1},st={key:0,class:"d-flex justify-content-between align-items-center my-2"},it=s("i",{class:"fa-solid fa-cart-plus"},null,-1),ot={key:0,class:"text-decoration-line-through",style:{"font-size":"10px"}},nt={key:1,class:"btn-group w-100 rounded-3"},lt=["disabled"],at={type:"button",class:"btn btn-sm btn-primary"},rt=["disabled"],dt={key:1,class:"px-2"},ct=s("span",{style:{"font-size":"12px"},class:"btn btn-outline-secondary rounded-3 py-2 btn-md w-100 d-flex justify-content-center align-items-center"},[s("i",{class:"fa-solid fa-lock mr-2"}),m(" нет в наличии")],-1),ut=[ct],ht={class:"d-flex flex-column"},mt={class:"badge text-bg-primary rounded-pill text-white fw-bold"},_t=s("i",{class:"fa-regular fa-star text-white"},null,-1),gt={key:0,class:"badge text-bg-primary rounded-pill text-white fw-bold mt-1"},pt=["id"],yt={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-fullscreen"},bt={class:"modal-content"},ft=s("div",{class:"modal-header"},[s("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"Детали"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),vt={class:"modal-body"},Ct={key:0,class:"card border-0 bg-primary"},wt={class:"card-body"},$t={class:"text-left text-white",style:{"font-weight":"700","line-height":"100%"}},kt={class:"d-flex justify-content-between align-items-center"},Pt={class:"text-left mb-0 text-white"},St={class:"text-white fw-bold"},It={key:0,class:"badge bg-primary fw-bold"},xt={class:"p-2"},jt=s("p",{class:"mb-0"},"Рейтинг товара",-1),Mt={class:"d-flex justify-content-between mb-3"},Lt={class:"nav nav-tabs justify-content-center"},Bt={class:"nav-item"},Ft={class:"nav-item"},Ot={key:1},Tt={class:"text-justify py-2 fst-italic"},zt={key:2},Rt={key:0},Vt={class:"list-group w-100 py-2 rounded-0"},Et={class:"list-group-item"},At={key:1,class:"alert alert-light my-2 d-flex justify-content-center align-items-center",role:"alert"},qt=s("div",{class:"d-flex justify-content-center align-items-center flex-column"},[s("div",{class:"spinner-grow text-primary my-3",role:"status"},[s("span",{class:"visually-hidden"},"Загружаем....")]),s("p",null,"Загружаем отзывы...")],-1),Dt=[qt],Nt={key:2,class:"alert alert-light my-2",role:"alert"},Jt={key:0,class:"modal-footer p-2 m-0"},Ut={class:"d-flex justify-content-between align-items-center w-100 p-0"},Qt={key:0,class:"text-decoration-line-through",style:{"font-size":"10px"}},Gt={key:1,class:"btn-group w-100"},Ht=["disabled"],Wt={type:"button",class:"btn btn-md btn-primary"},Yt=["disabled"],Kt={key:1,class:"modal-footer p-0 m-0"},Xt=s("p",{class:"p-3 border-secondary border rounded-2 w-100 text-secondary fw-bold text-center"},"Товар недоступен для заказа",-1),Zt=[Xt],te={props:["item","displayType","collectionMode","canSelect"],data(){return{tab:0,selected_image:null,loading_reviews:!1,showCart:!1,reviews:[],paginate:null}},computed:{...v(["inCart","getReviews","getReviewsPaginateObject"]),currentPrice(){return this.item.current_price/100},oldPrice(){return this.item.old_price/100},checkInCart(){return this.inCart(this.item.id)},discount(){return this.oldPrice>0?Math.round(this.currentPrice/this.oldPrice*100):0},uuid(){return k()}},mounted(){this.selected_image=(this.item.images||[]).length>0?this.item.images[0]:null},methods:{nextReviews(e){this.loadReviews(e)},loadReviews(e=0){return this.tab=1,this.loading_reviews=!0,this.$store.dispatch("loadReviewsByProductId",{dataObject:{product_id:this.item.id},page:e,size:30}).then(t=>{this.reviews=this.getReviews,this.paginate=this.getReviewsPaginateObject,this.loading_reviews=!1}).catch(()=>{this.loading_reviews=!1})},showProductDetails(){new bootstrap.Modal(document.getElementById("product-modal-info"+this.uuid),{}).show()},goToProduct(){this.$router.push({name:"ProductV2",params:{productId:this.item.id}})},incProductCart(){this.checkInCart===0?this.$store.dispatch("addProductToCart",this.item):this.$store.dispatch("incQuantity",this.item.id),this.$notify({title:"Добавление товара",text:"Товар успешно добавлен",type:"success"})},decProductCart(){this.checkInCart<=1?this.$store.dispatch("removeProduct",this.item.id):this.$store.dispatch("decQuantity",this.item.id),this.$notify({title:"Добавление товара",text:"Товар успешно удален",type:"success"})},selectInCollection(e){this.canSelect&&this.$emit("select-in-collection",e)}}},ee=Object.assign(te,{__name:"ProductListItem",setup(e){return(t,n)=>{const u=j("Pagination");return i(),o(h,null,[s("li",G,[s("div",H,[s("div",{onClick:n[0]||(n[0]=(...a)=>t.showProductDetails&&t.showProductDetails(...a)),class:"fw-bold mb-1",style:{"font-size":"12px"}},[W,m(" "+d(e.item.title.slice(0,50))+" ",1),e.item.title.length>50?(i(),o("span",Y,"...")):r("",!0)]),s("p",K,d(e.item.description||"нет описания"),1),e.collectionMode?(i(),o("div",X,[s("button",{type:"button",onClick:n[1]||(n[1]=a=>t.selectInCollection(e.item)),style:{"font-size":"12px"},class:b([{"btn-primary":e.item.is_checked,"btn-light":!e.item.is_checked},"btn btn-md w-100 rounded-2 mb-2"])},[e.item.is_checked?(i(),o("span",Z,[tt,m(" Выбрано")])):(i(),o("span",et,"Выбрать"))],2)])):(i(),o(h,{key:1},[e.item.in_stop_list_at?(i(),o("div",dt,ut)):(i(),o("div",st,[t.inCart(e.item.id)===0?(i(),o("button",{key:0,type:"button",onClick:n[2]||(n[2]=(...a)=>t.incProductCart&&t.incProductCart(...a)),class:"btn btn-sm btn-success fw-bold w-100 rounded-2 p-2"},[it,m(" В корзину "+d(e.item.current_price||0)+"₽ ",1),e.item.old_price>0?(i(),o("span",ot,d(e.item.old_price||0)+"₽",1)):r("",!0)])):r("",!0),t.inCart(e.item.id)>0?(i(),o("div",nt,[s("button",{type:"button",disabled:e.item.in_stop_list_at,style:{"border-radius":"6px 0px 0px 6px"},onClick:n[3]||(n[3]=(...a)=>t.decProductCart&&t.decProductCart(...a)),class:"btn btn-sm btn-primary p-2"},"- ",8,lt),s("button",at,d(t.checkInCart),1),s("button",{type:"button",disabled:e.item.in_stop_list_at,onClick:n[4]||(n[4]=(...a)=>t.incProductCart&&t.incProductCart(...a)),style:{"border-radius":"0px 6px 6px 0px"},class:"btn btn-sm btn-primary p-2"},"+ ",8,rt)])):r("",!0)]))],64))]),s("div",ht,[s("span",mt,[_t,m(" "+d(Math.round(e.item.rating||0)),1)]),e.item.old_price>0?(i(),o("span",gt,"% ")):r("",!0)])]),s("div",{class:"modal fade",id:"product-modal-info"+t.uuid,tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},[s("div",yt,[s("div",bt,[ft,s("div",vt,[e.item?(i(),o("div",Ct,[s("div",wt,[s("h6",$t,d(e.item.title||"Не указан"),1),s("div",kt,[s("p",Pt,[m("Цена "),s("strong",St,d(e.item.current_price||0)+"₽",1)]),t.discount>0?(i(),o("span",It,"-"+d(t.discount||0)+"%",1)):r("",!0)])])])):r("",!0),s("div",xt,[jt,s("h6",Mt,[p(q,{rating:e.item.rating},null,8,["rating"]),m(" "+d(Math.round(e.item.rating))+" из 5 ",1)])]),s("ul",Lt,[s("li",Bt,[s("a",{class:b(["nav-link",{active:t.tab===0}]),onClick:n[5]||(n[5]=a=>t.tab=0),"aria-current":"page",href:"javascript:void(0)"},"Описание",2)]),s("li",Ft,[s("a",{class:b(["nav-link",{active:t.tab===1}]),onClick:n[6]||(n[6]=a=>t.loadReviews(0)),href:"javascript:void(0)"},"Отзывы",2)])]),t.tab===0?(i(),o("div",Ot,[s("p",Tt,d(e.item.description||"-"),1)])):r("",!0),t.tab===1?(i(),o("div",zt,[t.reviews.length>0?(i(),o("div",Rt,[s("ul",Vt,[(i(!0),o(h,null,g(t.reviews,(a,l)=>(i(),o("li",Et,[p(D,{"need-product":!1,modelValue:t.reviews[l],"onUpdate:modelValue":c=>t.reviews[l]=c},null,8,["modelValue","onUpdate:modelValue"])]))),256))]),t.paginate?(i(),_(u,{key:0,simple:!0,onPagination_page:t.nextReviews,pagination:t.paginate},null,8,["onPagination_page","pagination"])):r("",!0)])):r("",!0),t.reviews.length===0&&t.loading_reviews?(i(),o("div",At,Dt)):r("",!0),t.reviews.length===0&&!t.loading_reviews?(i(),o("div",Nt," У данного товара еще нет отзывов! Для того чтобы оставить отзыв Вам необходимо заказать данный товар, после чего у вас появится возможность написать ваше впечатление от него;) ")):r("",!0)])):r("",!0)]),e.item.in_stop_list_at?(i(),o("div",Kt,Zt)):(i(),o("div",Jt,[s("div",Ut,[t.inCart(e.item.id)===0?(i(),o("button",{key:0,type:"button",onClick:n[7]||(n[7]=(...a)=>t.incProductCart&&t.incProductCart(...a)),class:"btn btn-md btn-primary w-100 rounded-3 p-2"},[m(d(e.item.current_price||0)+"₽ ",1),e.item.old_price>0?(i(),o("span",Qt,d(e.item.old_price||0)+"₽",1)):r("",!0)])):r("",!0),t.inCart(e.item.id)>0?(i(),o("div",Gt,[s("button",{type:"button",disabled:e.item.in_stop_list_at!=null,onClick:n[8]||(n[8]=(...a)=>t.decProductCart&&t.decProductCart(...a)),class:"btn btn-md btn-primary p-2"},"- ",8,Ht),s("button",Wt,d(t.checkInCart),1),s("button",{type:"button",disabled:e.item.in_stop_list_at!=null,onClick:n[9]||(n[9]=(...a)=>t.incProductCart&&t.incProductCart(...a)),class:"btn btn-md btn-primary p-2"},"+ ",8,Yt)])):r("",!0)])]))])])],8,pt)],64)}}});({...v(["getCategories","getCategoriesPaginateObject"])});const se={class:"card border-0 product-card"},ie={key:0,class:"rounded-3",alt:""},oe={class:"controls"},ne={class:"top d-flex justify-content-end w-100 align-items-center"},le={class:"product-count w-100 p-2"},ae={class:"text-white fw-bold"},re=s("i",{class:"fa-solid fa-layer-group mr-1"},null,-1),de={key:0,class:"badge bg-primary mr-2 fw-bold"},ce={class:"card-body px-0"},ue={class:"text-center mb-2",style:{"font-size":"12px"}},he={key:0},me={class:"d-flex justify-content-between align-items-center px-2"},_e=["disabled"],ge={style:{"text-decoration":"line-through"}},pe={class:"badge bg-primary"},ye=["id"],be={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable"},fe={class:"modal-content"},ve=s("div",{class:"modal-header"},[s("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"Варианты в корзине"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Ce={class:"modal-body"},we={key:0,class:"row"},$e={class:"col-12"},ke={key:1,class:"alert alert-light"},Pe=["id"],Se={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-fullscreen"},Ie={class:"modal-content"},xe=s("div",{class:"modal-header"},[s("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"Подборка"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),je={class:"modal-body mb-5 pb-5"},Me={props:["item"],data(){return{tab:0,selected_image:null,loading_reviews:!1,reviews:[],paginate:null,sending:!1,is_online:!0}},computed:{...v(["inCollectionCart","cartCollections"]),uuid(){return k()},discountPrice(){return Math.round(this.currentPrice*(1-(this.item.discount===0?1:this.item.discount)/100))},bot(){return window.currentBot},checkInCart(){return this.inCollectionCart(this.item.id,null)},currentPrice(){let e=0;return this.item.products.forEach(t=>{t.is_checked&&(e+=t.current_price||0)}),e},canProductAction(){return this.is_online&&!this.sending}},mounted(){this.selected_image=(this.item.images||[]).length>0?this.item.images[0]:null,window.addEventListener("online",()=>{this.is_online=!0}),window.addEventListener("offline",()=>{this.is_online=!1})},methods:{openVariantList(){new bootstrap.Modal(document.getElementById("collection-variant-modal-"+this.item.id),{}).show()},showCollectionDetails(){new bootstrap.Modal(document.getElementById("collection-modal-info"+this.item.id),{}).show()},incCollectionCart(){this.item.current_price=this.discountPrice,this.sending=!0,(this.checkInCart===0?this.$store.dispatch("addCollectionToCart",this.item):this.$store.dispatch("incQuantity",this.item.id)).then(()=>{this.sending=!1,this.$notify({title:"Добавление товара",text:"Товар успешно добавлен",type:"success"})}).catch(()=>{this.sending=!1,this.$notify({title:"Добавление товара",text:"Ошибка добавления товара!",type:"error"})})},decCollectionCart(){this.sending=!0,(this.checkInCart<=1?this.$store.dispatch("removeCollectionFromCart",this.item.id):this.$store.dispatch("decQuantity",this.item.id)).then(()=>{this.sending=!1,this.$notify({title:"Удаление товара",text:"Товар успешно удален",type:"success"})}).catch(()=>{this.sending=!1,this.$notify({title:"Удаление товара",text:"Ошибка удаления товара!",type:"error"})})}}},Le=Object.assign(Me,{__name:"CollectionCard",setup(e){return(t,n)=>{const u=$("lazy");return i(),o(h,null,[s("div",se,[s("div",{onClick:n[0]||(n[0]=(...a)=>t.showCollectionDetails&&t.showCollectionDetails(...a)),class:"img-container"},[e.item.image?f((i(),o("img",ie,null,512)),[[u,"/images-by-company-id/"+t.bot.company.id+"/"+e.item.image]]):r("",!0),s("div",oe,[s("div",ne,[s("div",le,[s("span",ae,[re,m(" "+d((e.item.products||[]).length),1)])]),e.item.discount>0?(i(),o("span",de,"%")):r("",!0)])])]),s("div",ce,[s("p",ue,[m(d(e.item.title.slice(0,50))+" ",1),e.item.title.length>50?(i(),o("span",he,"...")):r("",!0)]),s("div",me,[t.checkInCart===0?(i(),o("button",{key:0,type:"button",class:b([{"btn-secondary":!t.canProductAction},"btn btn-md btn-light w-100 rounded-3"]),disabled:e.item.in_stop_list_at!=null||!t.canProductAction,onClick:n[1]||(n[1]=(...a)=>t.incCollectionCart&&t.incCollectionCart(...a)),style:{"font-size":"12px"}},[e.item.discount>0?(i(),o(h,{key:0},[m(d(t.discountPrice)+"₽ ",1),s("span",ge,d(t.currentPrice)+"₽",1)],64)):(i(),o(h,{key:1},[m(d(t.currentPrice)+"₽ ",1)],64))],10,_e)):(i(),o("button",{key:1,type:"button",onClick:n[2]||(n[2]=(...a)=>t.openVariantList&&t.openVariantList(...a)),class:b([{"btn-secondary":!t.canProductAction},"btn btn-md btn-success w-100 rounded-3"]),style:{"font-size":"12px"}},[m(" Все варианты "),s("span",pe,d(t.cartCollections.length),1)],2))])])]),s("div",{class:"modal fade",id:"collection-variant-modal-"+e.item.id,tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},[s("div",be,[s("div",fe,[ve,s("div",Ce,[t.cartCollections.length>0?(i(),o("div",we,[(i(!0),o(h,null,g(t.cartCollections,(a,l)=>(i(),o("div",$e,[p(J,{params:a.params,item:a.collection},null,8,["params","item"])]))),256))])):(i(),o("p",ke," Ни одной коллекции не было добавлено в корзину! "))])])])],8,ye),s("div",{class:"modal fade",id:"collection-modal-info"+e.item.id,tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},[s("div",Se,[s("div",Ie,[xe,s("div",je,[e.item?(i(),_(N,{key:0,item:e.item},null,8,["item"])):r("",!0)])])])],8,Pe)],64)}}});const Be={data(){return{search:null,need_search:!1,category_modal:null}},props:{settings:Object,categories:Array,collections:Array},computed:{colorTheme(){return"background-color:"+(document.querySelector("[data-bs-theme]").getAttribute("data-bs-theme")==="light"?"white":"#212529")}},watch:{need_search:{handler:function(e){this.need_search||(this.search=null,this.findProducts())},deep:!0}},mounted(){this.category_modal=new bootstrap.Modal(document.getElementById("category-list-2-modal"),{backdrop:!1})},methods:{openCategoryModal(){this.category_modal.show()},findProducts(){this.$emit("search",this.search),this.category_modal.hide()},selectCategory(e){this.$emit("select",e),this.category_modal.hide();let t;e?e.id==="combo"?t="combo-menu":t=`category-${e.id}`:t="all-categories";const n=document.getElementById(t);n&&n.scrollIntoView({behavior:"auto",block:"start"})}}},C=e=>(B("data-v-daf0c2d9"),e=e(),F(),e),Fe={key:0,class:"container p-2"},Oe=C(()=>s("i",{class:"fa-solid fa-magnifying-glass"},null,-1)),Te=[Oe],ze={class:"d-flex overflow-auto category-slider gap-2 align-items-start"},Re={style:{"margin-left":"10px"},class:"badge bg-dark"},Ve=["onClick"],Ee={style:{"margin-left":"10px"},class:"badge bg-primary"},Ae={class:"modal fade",id:"category-list-2-modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},qe={class:"modal-dialog modal-fullscreen"},De={class:"modal-content"},Ne=C(()=>s("div",{class:"modal-header"},[s("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"Категории"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),Je={class:"modal-body"},Ue={class:"row mb-2"},Qe={class:"col"},Ge={class:"input-group"},He={class:"form-floating"},We=C(()=>s("label",{for:"searchInput"},"Поиск по товарам",-1)),Ye=C(()=>s("i",{class:"fa-solid fa-magnifying-glass"},null,-1)),Ke=[Ye],Xe={class:"row row-cols-1"},Ze=C(()=>s("div",{class:"col"},null,-1)),ts={class:"col mb-2"},es=["onClick"],ss={class:"badge bg-primary d-flex justify-content-center align-items-center"};function is(e,t,n,u,a,l){return i(),o(h,null,[n.settings?(i(),o("div",Fe,[n.categories.length>0||n.collections.length>0?(i(),o("div",{key:0,style:M(l.colorTheme),class:"container-slider-wrapper p-2 d-flex align-items-start"},[s("button",{style:{"margin-right":"10px"},type:"button",class:"btn btn-primary flex-shrink-0 mr-2",onClick:t[0]||(t[0]=(...c)=>l.openCategoryModal&&l.openCategoryModal(...c))},Te),s("div",ze,[n.collections.length>0?(i(),o("button",{key:0,type:"button",class:"btn btn-outline-warning flex-shrink-0 d-flex align-items-center",onClick:t[1]||(t[1]=c=>l.selectCategory({id:"combo"}))},[m(" Комбо-меню "),s("span",Re,d(n.collections.length),1)])):r("",!0),(i(!0),o(h,null,g(n.categories,c=>(i(),o("button",{type:"button",key:c.id,class:"btn btn-outline-secondary flex-shrink-0 d-flex align-items-center",onClick:y=>l.selectCategory(c)},[m(d(c.title||"Не указано")+" ",1),s("span",Ee,d(c.products_count||0),1)],8,Ve))),128))])],4)):r("",!0),x(e.$slots,"back-btn",{},void 0,!0)])):r("",!0),s("div",Ae,[s("div",qe,[s("div",De,[Ne,s("div",Je,[s("div",Ue,[s("div",Qe,[s("div",Ge,[s("div",He,[f(s("input",{type:"search","onUpdate:modelValue":t[2]||(t[2]=c=>a.search=c),class:"form-control",id:"searchInput",placeholder:"Поиск по товарам"},null,512),[[L,a.search]]),We]),s("button",{class:"btn btn-primary",type:"button",onClick:t[3]||(t[3]=(...c)=>l.findProducts&&l.findProducts(...c))},Ke)])])]),s("div",Xe,[Ze,(i(!0),o(h,null,g(n.categories,c=>(i(),o("div",ts,[(i(),o("button",{type:"button",key:c.id,class:"btn py-3 btn-outline-secondary flex-shrink-0 w-100 d-flex justify-content-between",onClick:y=>l.selectCategory(c)},[m(d(c.title||"Не указано")+" ",1),s("span",ss,d(c.products_count||0),1)],8,es))]))),256))])])])])])],64)}const os=P(Be,[["render",is],["__scopeId","data-v-daf0c2d9"]]);const ns={props:["partner"],data(){return{}},computed:{bot(){return window.currentBot||null}},mounted(){console.log(this.partner)}},ls={class:"row g-0"},as={class:"col-md-4"},rs={class:"img-fluid rounded-start img-partner-card",alt:"..."},ds={class:"col-md-8"},cs={class:"card-body"},us={class:"my-2 fw-bold"},hs={key:0,class:"fst-italic mb-2"},ms={key:1,class:"card-text",style:{"line-height":"100%"}},_s={class:"text-primary",style:{"font-size":"10px",margin:"3px"}};function gs(e,t,n,u,a,l){const c=$("lazy");return i(),o("div",{class:"card mb-2 border-light",onClick:t[0]||(t[0]=y=>e.$emit("select",n.partner))},[s("div",ls,[s("div",as,[f(s("img",rs,null,512),[[c,"/images-by-bot-id/"+l.bot.id+"/"+n.partner.image]])]),s("div",ds,[s("div",cs,[s("h5",us,d(n.partner.title),1),n.partner.description?(i(),o("p",hs,d(n.partner.description||""),1)):r("",!0),n.partner.categories?(i(),o("p",ms,[(i(!0),o(h,null,g(n.partner.categories,y=>(i(),o("span",_s,"#"+d(y.title)+", ",1))),256))])):r("",!0)])])])])}const I=P(ns,[["render",gs],["__scopeId","data-v-83acc772"]]);const ps={key:0,class:"row my-3 row-cols-1 g-1"},ys={key:0,class:"col"},bs={class:"col"},fs={key:1,class:"alert alert-light"},vs={name:"PartnerList",data(){return{}},computed:{bot(){return window.currentBot||null},settings(){return this.bot.settings},partnerList(){return this.bot.partners||[]}},mounted(){},methods:{selectPartner(e){this.$emit("select",e)}}},Cs=Object.assign(vs,{setup(e){return(t,n)=>{var u;return(t.partnerList||[]).length>0?(i(),o("div",ps,[(u=t.settings.partners)!=null&&u.display_self?(i(),o("div",ys,[(i(),_(I,{partner:t.settings.partners,onSelect:t.selectPartner,key:"partner-0"},null,8,["partner","onSelect"]))])):r("",!0),(i(!0),o(h,null,g(t.partnerList,(a,l)=>(i(),o("div",bs,[(i(),_(I,{partner:a,onSelect:t.selectPartner,key:"partner-"+l},null,8,["partner","onSelect"]))]))),256))])):(i(),o("p",fs," У вас нет добавленных партнеров "))}}}),ws=P(Cs,[["__scopeId","data-v-daaa62ee"]]),$s={class:"container"},ks={methods:{selectPartner(e){this.$emit("select",e)}}},Ps=Object.assign(ks,{__name:"PartnersMain",setup(e){return(t,n)=>(i(),o("div",$s,[p(ws,{onSelect:t.selectPartner},null,8,["onSelect"])]))}});const Ss={id:"category-slider",class:"d-block w-100 p-0 m-0 sticky-menu"},Is=s("i",{class:"fa-solid fa-arrow-left me-2"},null,-1),xs={class:"d-flex flex-column"},js={key:0,class:"p-2"},Ms={class:"alert alert-danger mb-0"},Ls=["innerHTML"],Bs={class:"album",style:{"min-height":"100vh"}},Fs={key:0,class:"container g-2"},Os={key:0,class:"list-group"},Ts={class:"badge text-bg-primary"},zs=["onClick"],Rs={class:"badge text-bg-primary"},Vs={key:1,style:{"min-height":"100vh"},class:"album"},Es={class:"container g-2"},As=s("h5",{class:"my-4 divider",id:"cat-combo"},"Комбо меню",-1),qs={class:"row row-cols-2 row-cols-sm-2 row-cols-md-3 g-2"},Ds={class:"col"},Ns={key:0,class:"row row-cols-1 row-cols-sm-2 row-cols-md-3 g-3"},Js={class:"col"},Us=s("h5",{class:"my-4 divider",id:"cat-combo"},"Наши новинки",-1),Qs=["id"],Gs={key:0,class:"row row-cols-2 row-cols-sm-2 row-cols-md-3 g-2"},Hs={class:"col"},Ws={key:0,class:"col-12"},Ys=["onClick"],Ks={key:0},Xs={key:1,class:"d-inline-flex align-items-center"},Zs=s("span",{class:"spinner-border",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1),ti={class:"list-group list-group-numbered"},ei=["onClick"],si={key:0},ii={key:1,class:"d-inline-flex align-items-center"},oi=s("span",{class:"spinner-border",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1),ni={class:"container"},li={class:"row row-cols-1 row-cols-sm-2 row-cols-md-3 g-3"},ai={class:"col"},ri={data(){return{selected_partner:null,extra_charge:0,shop:0,stories:[],tab:1,load_content:!1,load_collection:!1,product_type_display:1,spent_time_counter:0,is_requested:!1,isCollapsed:!0,search:null,products:[],collections:[],collections_paginate:[],products_with_categories:[],paginate:null,categories:[],sending:!1,min_price:null,max_price:null,moneyVariants:[500,1e3,2e3,5e3],deliveryForm:{name:null,phone:null,address:null,city:null,street:null,building:null,flat_number:null,entrance_number:null,floor_number:null,info:null,need_pickup:!1,has_disability:!1,use_cashback:!1,disabilities:[],money:null,cash:!0,persons:1,time:null,when_ready:!0}}},computed:{...v(["inCart","inCollectionCart","getStories","getCollections","getCollectionsPaginateObject","getProducts","getCategories","getProductsPaginateObject","cartProducts","cartTotalCount","cartTotalPrice","getSelf"]),uuid(){return k()},settings(){return this.bot.settings},partners(){var e;return(e=this.bot.settings)==null?void 0:e.partners},bot(){return window.currentBot},colorTheme(){return"background-color:"+(document.querySelector("[data-bs-theme]").getAttribute("data-bs-theme")==="light"?"white":"#212529")},getCurrentBot(){return window.currentBot},cashbackLimit(){let e=this.getSelf.cashBack?this.getSelf.cashBack.amount:0,t=this.cartTotalPrice||0,n=this.getCurrentBot.max_cashback_use_percent||0,u=t*(n/100);return Math.min(u,e)},filteredCategories(){if(!this.products||this.products.length===0)return[];const e=this.search instanceof Event||!this.search?"":this.search.toLowerCase();return this.products.map(t=>{const n=t.products.filter(u=>{var a;return((a=u.title)==null?void 0:a.toLowerCase().includes(e))&&(this.settings.need_hide_disabled_products?u.in_stop_list_at==null:!0)});return{...t,products:n}}).filter(t=>t.products.length>0)},filteredProducts(){return this.categories.length===0?this.products:this.products.filter(e=>e.categories.findIndex(t=>this.categories.indexOf(t.id)!==-1)!==-1)},tg(){return window.Telegram.WebApp},activeCategories(){let e=[];return this.filteredProducts.forEach(t=>{e.push(t.categories.map(n=>n.id))}),[...new Set(e.map(t=>t[0])),...new Set(e.map(t=>t[1]))]}},mounted(){var n;this.shop=(n=this.partners)!=null&&n.is_active?0:1;const e=document.getElementById("category-slider"),t=()=>{e&&(window.scrollY>50?(e.style.position="fixed",e.style.top="0",e.style.left="0",e.style.right="0",e.style.zIndex="1000"):(e.style.position="relative",e.style.top="",e.style.left="",e.style.right="",e.style.zIndex="",e.style.backgroundColor="",e.style.boxShadow=""))};window.addEventListener("scroll",t),this.loadStories(),this.loadProducts(),this.loadCollections(),this.tg.BackButton.show(),this.tg.BackButton.onClick(()=>{document.querySelectorAll('[data-bs-dismiss="modal"]').forEach(u=>u.click()),this.$router.push({name:"MenuV2"})})},methods:{selectPartner(e){this.selected_partner=null,this.extra_charge=0,this.products=[],this.collections=[],this.categories=[],this.$nextTick(()=>{this.selected_partner=e,this.extra_charge=e.extra_charge||0,this.loadProducts(0),this.loadCollections(0),this.shop=1}),this.$preloader.show()},doSwipeLeft(){this.$router.push({name:"MenuV2"})},doSwipeRight(){this.$router.push({name:"ShopCartV2"})},loadStories(){this.$store.dispatch("loadStories").then(e=>{this.stories=this.getStories||[]})},findProducts(e){this.search=e},scroll(e){var t=document.getElementById(e),n=70,u=(t==null?void 0:t.getBoundingClientRect().top)||70,a=u+window.pageYOffset-n;window.scroll({top:a,behavior:"smooth"})},openTab(e){this.tab=e,window.scroll(0,80)},closeModalOnSwipe(){return document.querySelectorAll(".modal.show").length>0?(document.querySelectorAll('[data-bs-dismiss="modal"]').forEach(t=>t.click()),!0):!1},decPersons(){this.deliveryForm.persons=this.deliveryForm.persons>1?this.deliveryForm.persons-1:this.deliveryForm.persons},incPersons(){this.deliveryForm.persons=this.deliveryForm.persons<100?this.deliveryForm.persons+1:this.deliveryForm.persons},startTimer(e){this.spent_time_counter=e!=null?Math.min(e,10):10;let t=setInterval(()=>{this.spent_time_counter>0?this.spent_time_counter--:(clearInterval(t),this.is_requested=!1,this.spent_time_counter=null),localStorage.setItem("cashman_self_product_delivery_counter",this.spent_time_counter)},1e3)},clearCart(){this.tab=1,this.$store.dispatch("clearCart").then(()=>{this.$notify({title:"Корзина",text:"Корзина успешно очищена!",type:"success"})})},selectCategory(e){this.tab=1,this.$nextTick(()=>{e?this.scroll("cat-"+e.id):window.scroll(0,80)})},nextProducts(e){this.loadProducts(e)},nextCollections(e){this.loadCollections(e)},loadCollections(e=0){var t;return this.load_content=!0,this.load_collection=!0,this.$store.dispatch("loadGlobalCollections",{partner_id:((t=this.selected_partner)==null?void 0:t.bot_partner_id)||null,page:e}).then(n=>{this.collections=this.getCollections,this.collections_paginate=this.getCollectionsPaginateObject,this.load_content=!1,this.load_collection=!1,window.scroll(0,80)}).catch(()=>{this.load_content=!1,this.load_collection=!1,this.$store.dispatch("clearCart").then(()=>{this.loadCollections()})})},loadMore(e,t){var n;return this.load_content=!0,this.$store.dispatch("loadMoreProductsByCategory",{partner_id:((n=this.selected_partner)==null?void 0:n.bot_partner_id)||null,category_id:e,offset:t}).then(u=>{let a=u.length||0;if(this.load_content=!1,a===0){this.products.find(l=>l.id===e).products_count=t;return}this.products.find(l=>l.id===e).products.push(...u)}).catch(()=>{this.load_content=!1})},loadProducts(e=0){var n;this.tab=1;let t=localStorage.getItem("cashman_preloaded_products_by_categories_"+this.getCurrentBot.bot_domain)!==null;return t&&(this.products=JSON.parse(localStorage.getItem("cashman_preloaded_products_by_categories_"+this.getCurrentBot.bot_domain))),this.load_content=!1,this.$store.dispatch("loadProductsByCategory",{partner_id:((n=this.selected_partner)==null?void 0:n.bot_partner_id)||null}).then(u=>{this.load_content=!0,this.$nextTick(()=>{this.products=u.data,localStorage.setItem("cashman_preloaded_products_by_categories_"+this.getCurrentBot.bot_domain,JSON.stringify(this.products)),this.load_content=!1,t||window.scroll(0,80)})}).catch(()=>{this.load_content=!1,this.$store.dispatch("clearCart").then(()=>{this.loadProducts()})})},startCheckout(){if(this.is_requested){this.$notify({title:"Упс!",text:"Сделать повторный заказ можно через ${this.spent_time_counter} сек.",type:"error"});return}localStorage.setItem("cashman_self_product_delivery_form_name",this.deliveryForm.name||""),localStorage.setItem("cashman_self_product_delivery_form_phone",this.deliveryForm.phone||""),localStorage.setItem("cashman_self_product_delivery_form_address",this.deliveryForm.address||""),localStorage.setItem("cashman_self_product_delivery_form_city",this.deliveryForm.city||""),localStorage.setItem("cashman_self_product_delivery_form_street",this.deliveryForm.street||""),localStorage.setItem("cashman_self_product_delivery_form_building",this.deliveryForm.building||""),localStorage.setItem("cashman_self_product_delivery_form_flat_number",this.deliveryForm.flat_number||""),localStorage.setItem("cashman_self_product_delivery_form_entrance_number",this.deliveryForm.entrance_number||""),localStorage.setItem("cashman_self_product_delivery_form_entrance_disabilities",JSON.stringify(this.deliveryForm.disabilities||[]));let e=new FormData;this.sending=!0,Object.keys(this.deliveryForm).forEach(t=>{const n=this.deliveryForm[t]||"";typeof n=="object"?e.append(t,JSON.stringify(n)):e.append(t,n)}),this.type&&e.append("type",this.type),this.$store.dispatch("startCheckout",{deliveryForm:e}).then(t=>{this.deliveryForm={message:null,name:null,phone:null},this.$notify({title:"Доставка",text:"Дальнейшая инструкция отправлена вам в бот!",type:"success"}),this.tab=1,this.$store.dispatch("clearCart"),this.tg.close(),this.sending=!1}).catch(t=>{this.sending=!1}),this.startTimer(),this.is_requested=!0},removeCategory(e){this.categories.splice(e,1)},addToCart(e){this.$cart.add(e.product)}}},ki=Object.assign(ri,{__name:"ShopProductCatalog",setup(e){return(t,n)=>{var a;const u=$("touch");return i(),o(h,null,[t.shop==0?(i(),_(Ps,{key:0,onSelect:t.selectPartner},null,8,["onSelect"])):r("",!0),t.shop==1?(i(),o(h,{key:1},[s("menu",Ss,[p(os,{settings:t.settings,categories:t.filteredCategories,collections:t.collections,onSelect:t.selectCategory,onSearch:t.findProducts},{"back-btn":O(()=>{var l;return[(l=t.partners)!=null&&l.is_active?(i(),o("button",{key:0,onClick:n[0]||(n[0]=c=>t.shop=0),class:"btn btn-primary p-2 mt-2"},[Is,m(" К магазинам ")])):r("",!0)]}),_:1},8,["settings","categories","collections","onSelect","onSearch"])]),s("div",xs,[t.settings?(i(),o(h,{key:0},[t.settings.is_disabled?(i(),o("div",js,[s("div",Ms,[s("p",{class:"mb-0",innerHTML:t.settings.disabled_text},null,8,Ls)])])):r("",!0)],64)):r("",!0),p(Q),f(s("div",Bs,[t.settings?(i(),o("div",Fs,[t.filteredCategories.length>0?(i(),o("div",Os,[s("a",{href:"javascript:void(0)",onClick:n[1]||(n[1]=l=>t.selectCategory(null)),style:{"font-weight":"bold"},class:"list-group-item list-group-item-action d-flex justify-content-between p-3","aria-current":"true"}," Все категории товаров "),t.collections.length>0?(i(),o("a",{key:0,href:"javascript:void(0)",onClick:n[2]||(n[2]=l=>t.selectCategory({id:"combo"})),style:{"font-weight":"bold"},class:"list-group-item list-group-item-action d-flex justify-content-between p-3","aria-current":"true"},[m(" Комбо-меню"),s("span",Ts,d(t.collections.length||0),1)])):r("",!0),(i(!0),o(h,null,g(t.filteredCategories,l=>(i(),o("a",{href:"javascript:void(0)",onClick:c=>t.selectCategory(l),style:{"font-weight":"bold"},class:"list-group-item list-group-item-action d-flex justify-content-between p-3 align-items-center","aria-current":"true"},[m(d(l.title||"Не указано"),1),s("span",Rs,d(l.count||0),1)],8,zs))),256))])):r("",!0)])):(i(),_(w,{key:1}))],512),[[T,t.tab===0]]),t.tab===1?(i(),o("div",Vs,[t.settings?(i(),o(h,{key:0},[s("div",Es,[t.collections.length>0?(i(),o(h,{key:0},[As,s("div",qs,[(i(!0),o(h,null,g(t.collections,(l,c)=>(i(),o("div",Ds,[p(Le,{item:l},null,8,["item"])]))),256))]),((a=t.collections_paginate)==null?void 0:a.meta.last_page)>1?(i(),o("div",Ns,[s("div",Js,[t.collections_paginate?(i(),_(S,{key:0,simple:!0,onPagination_page:t.nextCollections,pagination:t.collections_paginate},null,8,["onPagination_page","pagination"])):r("",!0)])])):r("",!0)],64)):r("",!0),(t.stories||[]).length>0?(i(),o(h,{key:1},[Us,p(U,{stories:t.stories||[]},null,8,["stories"])],64)):r("",!0),t.filteredCategories.length>0?(i(!0),o(h,{key:2},g(t.filteredCategories,l=>(i(),o(h,null,[s("h5",{class:"my-4 divider",id:"cat-"+l.id},d(l.title||"-"),9,Qs),t.settings.is_product_list?(i(),o(h,{key:1},[s("ol",ti,[(i(!0),o(h,null,g(l.products,(c,y)=>(i(),_(ee,{item:c},null,8,["item"]))),256))]),l.products_count>l.products.length?(i(),o("button",{key:0,onClick:c=>t.loadMore(l.id,l.products.length),class:"btn btn-outline-light text-primary p-3 w-100 my-3",type:"button"},[t.load_content?(i(),o("span",ii,[m(" Загружаем.... "),oi])):(i(),o("span",si,"Загрузить еще ("+d(l.products_count-l.products.length)+")",1))],8,ei)):r("",!0)],64)):f((i(),o("div",Gs,[(i(!0),o(h,null,g(l.products,(c,y)=>(i(),o("div",Hs,[p(A,{item:c},null,8,["item"])]))),256)),l.products_count>l.products.length?(i(),o("div",Ws,[s("button",{onClick:c=>t.loadMore(l.id,l.products.length),class:"btn btn-outline-light text-primary p-3 my-3 w-100",type:"button"},[t.load_content?(i(),o("span",Xs,[m(" Загружаем.... "),Zs])):(i(),o("span",Ks,"Загрузить еще ("+d(l.products_count-l.products.length)+")",1))],8,Ys)])):r("",!0)])),[[u,t.doSwipeLeft,"swipe",{left:!0}],[u,t.doSwipeRight,"swipe",{right:!0}]])],64))),256)):(i(),_(w,{key:3}))]),s("div",ni,[s("div",li,[s("div",ai,[t.paginate?(i(),_(S,{key:0,simple:!0,onPagination_page:t.nextProducts,pagination:t.paginate},null,8,["onPagination_page","pagination"])):r("",!0)])])])],64)):(i(),_(w,{key:1}))])):r("",!0)]),x(t.$slots,"navigation")],64)):r("",!0)],64)}}});export{ki as _};
