import{G as w,R as $,L as F,q as i,t as l,B as p,O as C,u as B,a6 as M,v as t,K as f,A as r,D as d,y as c,P as k,H as m,J as h,F as b,C as _,N as T,x as E}from"./index.es-560b785d.js";import{M as L}from"./ManagerProfile-8334a3fc.js";/* empty css                                                 */import{b as x,_ as q}from"./BotForm-45b3b639.js";import{P as A}from"./PromoCodeActivateForm-d4d42431.js";import{_ as P}from"./BotSection-a2fbbf13.js";import"./CompanyList-8faea17f.js";import{C as D,S as I,P as j,N as V}from"./carousel.es-c0740b66.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./TelegramChannelHelper.vue_vue_type_style_index_0_lang-6ebd6e3a.js";import"./MailingTable-059fa0eb.js";import"./TelegramChannelHelper-83ac9b65.js";import"./v4-4a60fe23.js";import"./main-7389a3e5.js";import"./SlugForm-12ddcbad.js";import"./GlobalSlugList-68307534.js";import"./base64-1857b31a.js";const O=t("title",null,"Кабинет администратора",-1),N=t("meta",{name:"description",content:"Кабинет администратора<"},null,-1),U={class:"navbar navbar-expand-lg sticky-top bg-primary"},z={class:"container"},H=t("i",{class:"fas fa-money-bill"},null,-1),J=t("span",{class:"fw-bold text-white"},"0",-1),R={class:"fw-bold text-white"},G={class:"d-flex"},K={key:0,class:"btn text-white p-2 px-3 border-light mr-2",style:{"font-size":"12px"},type:"button","data-bs-toggle":"offcanvas","data-bs-target":"#bot-section-menu","aria-controls":"staticBackdrop"},X=t("i",{class:"fa-solid fa-screwdriver-wrench text-white"},null,-1),Q=[X],W={class:"dropdown"},Y={style:{"font-size":"12px"},class:"btn btn-outline-light text-white dropdown-toggle p-2",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},Z=t("i",{class:"fa-solid fa-user"},null,-1),tt=t("ul",{class:"dropdown-menu"},[t("li",null,[t("a",{class:"dropdown-item","data-bs-toggle":"offcanvas",role:"button",href:"#profile-sidebar"},"Профиль")]),t("li",null,[t("a",{href:"javascript:void(0)","data-bs-toggle":"modal","data-bs-target":"#open-payment-modal",class:"dropdown-item"},"Пополнить баланс")]),t("li",null,[t("a",{href:"javascript:void(0)","data-bs-toggle":"modal","data-bs-target":"#activate-promo-code",class:"dropdown-item"},"Ввести промокод")]),t("li",null,[t("hr",{class:"dropdown-divider"})]),t("li",null,[t("a",{class:"dropdown-item"},"Вопросы и ответы")]),t("li",null,[t("a",{"data-bs-toggle":"modal","data-bs-target":"#feedbackModal",class:"dropdown-item",href:"javascript:void(0)"},"Тех. поддержка")]),t("li",null,[t("hr",{class:"dropdown-divider"})]),t("li",null,[t("a",{class:"dropdown-item",href:"/logout"},"Выход")])],-1),et={class:"modal fade",id:"open-payment-modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},st={class:"modal-dialog modal-xs"},ot={class:"modal-content"},at=t("div",{class:"modal-header"},[t("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"Оплата произвольной суммы"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),it={class:"modal-body"},lt={class:"alert alert-light"},nt={class:"form-floating mb-3"},rt=t("label",{for:"floatingPassword"},"Сумма для внесения, руб",-1),dt=t("button",{class:"btn btn-primary w-100 p-3",type:"submit"},"Пополнить ",-1),ct={class:"modal fade",id:"payment-modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},mt={class:"modal-dialog modal-xl"},ht={class:"modal-content"},bt=t("div",{class:"modal-header"},[t("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"Выбор тарифа"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),ut={class:"modal-body"},pt=t("div",{class:"alert alert-light mb-3"}," После осуществления оплаты обновите страницу для отображения зачисленных средств! ",-1),ft={key:0,class:"row"},_t={class:"col-md-4"},gt={class:"card payment-card h-100 d-flex justify-content-between flex-column"},vt={class:"price"},yt={key:0,class:"list-group list-group-flush"},kt={class:"list-group-item"},wt=["onClick"],Ct={key:1,class:"alert alert-light"},St={class:"container-fluid"},$t={class:"row"},Ft={class:"col-md-12 ms-sm-auto col-lg-12 px-md-4 px-0"},Bt={class:"pt-md-3 pt-0 pb-md-2 pb-0 mb-3"},Mt={class:"theme-switcher d-none d-md-flex flex-column"},Tt=t("button",{id:"switch-theme","data-bs-toggle":"modal","data-bs-target":"#theme-switch-modal",class:"btn btn-primary"},[t("i",{class:"fa-solid fa-palette"})],-1),Et=t("i",{class:"fa-solid fa-moon"},null,-1),Lt=[Et],xt={class:"modal",id:"theme-switch-modal",tabindex:"-1"},qt={class:"modal-dialog"},At={class:"modal-content"},Pt=t("div",{class:"modal-header"},[t("h5",{class:"modal-title"},"Выбор темы оформления"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Dt={class:"modal-body"},It={class:"list-group"},jt=["onClick"],Vt=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),Ot={class:"modal fade",id:"activate-promo-code",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},Nt={class:"modal-dialog"},Ut={class:"modal-content"},zt={key:0,class:"modal-body"},Ht=t("h6",{class:"text-center"},"Активируйте ваш ключ и получите дополнительные слоты",-1),Jt={key:1,class:"modal-body"},Rt=t("div",{class:"alert alert-primary"},"Вы не являетесь менеджером!",-1),Gt=[Rt],Kt=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),Xt={class:"modal fade",id:"feedbackModal",tabindex:"-1","aria-labelledby":"feedbackModalLabel","aria-hidden":"true"},Qt={class:"modal-dialog modal-dialog-centered"},Wt={class:"modal-content"},Yt=t("div",{class:"modal-header bg-primary p-4"},[t("h5",{class:"modal-title font-alt text-white",id:"feedbackModalLabel"},"Заказать обратную связь"),t("button",{class:"btn-close btn-close-white",type:"button","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Zt={class:"modal-body border-0 p-4"},te={class:"form-floating mb-3"},ee=t("label",{for:"name"},"Ваше Ф.И.О.",-1),se=t("div",{class:"invalid-feedback","data-sb-feedback":"name:required"},"Является обязательным ",-1),oe={class:"form-floating mb-3"},ae=t("label",{for:"email"},"Ваша почта",-1),ie=t("div",{class:"invalid-feedback","data-sb-feedback":"email:required"},"An email is required. ",-1),le=t("div",{class:"invalid-feedback","data-sb-feedback":"email:email"},"Email is not valid. ",-1),ne={class:"form-floating mb-3"},re=t("label",{for:"phone"},"Номер телефона",-1),de=t("div",{class:"invalid-feedback","data-sb-feedback":"phone:required"},"A phone number is required. ",-1),ce={class:"form-floating mb-3"},me=t("label",{for:"phone"},"Когда вам удобно?",-1),he=t("div",{class:"invalid-feedback","data-sb-feedback":"phone:required"},"A phone number is required. ",-1),be={class:"form-floating mb-3"},ue=t("label",{for:"message"},"Сообщение менеджеру",-1),pe=t("div",{class:"invalid-feedback","data-sb-feedback":"message:required"},"A message is required. ",-1),fe={key:0,class:"alert alert-success text-center my-3 rounded-3",id:"submitSuccessMessage"},_e=t("span",{class:"fw-bolder"},"Спасибо! Вы успешно отправили заявку!",-1),ge=t("br",null,null,-1),ve={key:1,class:"alert alert-danger my-3 text-center rounded-2",id:"submitErrorMessage"},ye=t("div",{class:"d-grid"},[t("button",{class:"btn btn-success text-white rounded-2 btn-lg",id:"submitButton",type:"submit"},"Отправить заявку ")],-1),ke={class:"offcanvas offcanvas-start",tabindex:"-1",id:"profile-sidebar","aria-labelledby":"offcanvasExampleLabel"},we=t("div",{class:"offcanvas-header"},[t("h5",{class:"offcanvas-title",id:"offcanvasExampleLabel"},"Ваш профиль"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"offcanvas","aria-label":"Закрыть"})],-1),Ce={class:"offcanvas-body"},Se={data(){let s=new Date,e=s.getHours()+":"+s.getMinutes();return{payment_modal:null,paymentForm:{amount:0},success:!1,error:!1,feedbackForm:{name:null,email:null,phone:null,time:e,message:"Добрый день! Возникли технические сложности, свяжитесь со мной!"},bot:null,load:!1,is_chat_open:!1,currentTheme:"",company:null,tariffs:[],themes:[{title:"Тема 1",href:"/theme1.bootstrap.min.css"},{title:"Тема 2",href:"/theme2.bootstrap.min.css"},{title:"Тема 3",href:"/theme3.bootstrap.min.css"},{title:"Тема 4",href:"/theme4.bootstrap.min.css"},{title:"Тема 5",href:"/theme5.bootstrap.min.css"},{title:"Тема 6",href:"/theme6.bootstrap.min.css"},{title:"Тема 7",href:"/theme7.bootstrap.min.css"},{title:"Тема 8",href:"/theme8.bootstrap.min.css"},{title:"Тема 9",href:"/theme9.bootstrap.min.css"},{title:"Тема 10",href:"/theme10.bootstrap.min.css"},{title:"Тема 11",href:"/theme11.bootstrap.min.css"},{title:"Тема 12",href:"/theme12.bootstrap.min.css"},{title:"Тема 13",href:"/theme13.bootstrap.min.css"},{title:"Тема 14",href:"/theme14.bootstrap.min.css"},{title:"Тема 15",href:"/theme15.bootstrap.min.css"},{title:"Тема 16",href:"/theme16.bootstrap.min.css"}]}},computed:{...w(["getErrors","getCurrentBot","getCurrentCompany"]),profile(){return window.profile||null},slotsCount(){var s,e;return((e=(s=this.profile)==null?void 0:s.manager)==null?void 0:e.max_bot_slot_count)||0}},watch:{getErrors:function(s,e){Object.keys(s).forEach(o=>{this.$notify({title:"Конструктор ботов",text:s[o],type:"warn"})})}},mounted(){this.payment_modal=new bootstrap.Modal(document.getElementById("payment-modal"),{}),this.loadCurrentCompany(),this.loadCurrentBot();let s=localStorage.getItem("cashman_global_admin_theme")||null,e=localStorage.getItem("cashman_global_admin_light")||null;s&&this.$nextTick(()=>{this.currentTheme=s}),e&&this.changeLight(e),window.addEventListener("store_current_bot-change-event",o=>{this.bot=this.getCurrentBot}),window.addEventListener("store_current_company-change-event",o=>{this.company=this.getCurrentCompany})},methods:{openTariffsModal(){this.loadActualTariffs(),this.payment_modal.show()},submitPayment(s=0){s>0&&(this.paymentForm.amount=s);let e=new FormData;Object.keys(this.paymentForm).forEach(o=>{const n=this.paymentForm[o]||"";typeof n=="object"?e.append(o,JSON.stringify(n)):e.append(o,n)}),this.$store.dispatch("sendInvoice",{paymentForm:e}).then(o=>{this.$notify({title:"Оплата услуг сервиса",text:"Платежная ссылка успешно сформирована!",type:"success"});const n=o.url;window.open(n,"_blank").focus()}).catch(()=>{this.$notify({title:"Оплата услуг сервиса",text:"Ошибка формирования платежной ссылки",type:"error"})})},submitMail(){this.success=!1,this.error=!1;let s=new FormData;Object.keys(this.feedbackForm).forEach(e=>{const o=this.feedbackForm[e]||"";typeof o=="object"?s.append(e,JSON.stringify(o)):s.append(e,o)}),this.$store.dispatch("sendFeedback",{mailForm:s}).then(e=>{this.load=!0,this.success=!0;let o=new Date,n=o.getHours()+":"+o.getMinutes();this.feedbackForm={name:null,email:null,phone:null,time:n,message:"Добрый день! Заинтересовала данная система, хочу запросить перезвон менеджера для обсуждения деталей!"},this.$notify({title:"CashMan",text:"Сообщение отправлено!",type:"success"})}).catch(e=>{this.error=!0,this.$notify({title:"CashMan",text:"Упс... ошибочка!",type:"error"})})},botSectionCallback(){window.dispatchEvent(new CustomEvent("change-current_bot-from-navbar-event"))},changeLight(s=null){let e=document.querySelector("html");if(s!=null&&(s==="light"||s==="dark")){e.setAttribute("data-bs-theme",s),localStorage.setItem("cashman_global_admin_light",s);return}if(e.hasAttribute("data-bs-theme")){let o=e.getAttribute("data-bs-theme");e.setAttribute("data-bs-theme",o==="dark"?"light":"dark")}else e.setAttribute("data-bs-theme","dark");localStorage.setItem("cashman_global_admin_light",e.getAttribute("data-bs-theme")||"light")},hasRole(s){return window.hasRole(s)||!1},switchTheme(s){let e=document.querySelector("#theme");e.href=this.themes[s].href,localStorage.setItem("cashman_global_admin_theme",e.href),this.$nextTick(()=>{this.currentTheme=e.href})},loadActualTariffs(){this.tariffs.length>0||this.$store.dispatch("getActualTariffs").then(s=>{this.tariffs=s||[]})},loadCurrentCompany(s=null){this.$store.dispatch("updateCurrentCompany",{company:s}).then(()=>{this.company=this.getCurrentCompany})},loadCurrentBot(s=null){return this.$store.dispatch("updateCurrentBot",{bot:s}).then(()=>{this.bot=this.getCurrentBot})},resetCompany(){this.$store.dispatch("resetCurrentCompany").then(()=>{this.company=null,window.dispatchEvent(new CustomEvent("store_current_company-change-event"))})},resetBot(){this.$store.dispatch("resetCurrentBot").then(()=>{this.bot=null,window.dispatchEvent(new CustomEvent("store_current_bot-change-event"))})},stopAllDialogs(){this.$store.dispatch("stopDialogs").then(s=>{this.$notify({title:"Конструктор ботов",text:"Все диалоги остановлены",type:"success"})}).catch(s=>{})}}},$e=Object.assign(Se,{__name:"ManagerLayout",setup(s){return(e,o)=>{var g,v,y;const n=$("notifications"),S=F("mask");return i(),l(b,null,[p(B(M),null,{default:C(()=>[O,N]),_:1}),p(n,{position:"top right"}),t("nav",U,[t("div",z,[e.load?r("",!0):(i(),f(x,{key:0,id:"global-bot-search","custom-class":"dropdown-toggle my-2 text-white",onSelectBot:e.botSectionCallback,bot:e.bot},null,8,["onSelectBot","bot"])),t("button",{class:"btn text-white p-2 btn-outline-light",style:{"font-size":"12px"},onClick:o[0]||(o[0]=(...a)=>e.openTariffsModal&&e.openTariffsModal(...a)),"aria-controls":"staticBackdrop"},[H,d(" У вас "),J,d(" руб, "),t("span",R,c(e.slotsCount),1),d(" свободных слотов ")]),t("div",G,[e.bot?(i(),l("button",K,Q)):r("",!0),t("div",W,[t("button",Y,[Z,d(" "+c(((g=e.profile)==null?void 0:g.name)||((v=e.profile)==null?void 0:v.username)||((y=e.profile)==null?void 0:y.telegram_chat_id)||"-"),1)]),tt])])])]),t("div",et,[t("div",st,[t("div",ot,[at,t("div",it,[t("div",lt,[d(" Через данное окно вы можете внести абсолютно любую сумму. Рекомендуем вносить оплату согласно "),t("a",{href:"#tariff",onClick:o[1]||(o[1]=(...a)=>e.openTariffsModal&&e.openTariffsModal(...a))},"тарифным планам"),d(", так вы получаете помимо средств еще и дополнительные возможности в виде слотов или скидки (и другие преимущества тарифного плана). ")]),t("form",{onSubmit:o[3]||(o[3]=k((...a)=>e.submitPayment&&e.submitPayment(...a),["prevent"]))},[t("div",nt,[m(t("input",{type:"number",min:"0","onUpdate:modelValue":o[2]||(o[2]=a=>e.paymentForm.amount=a),class:"form-control",id:"floatingPassword",placeholder:"Password"},null,512),[[h,e.paymentForm.amount]]),rt]),dt],32)])])])]),t("div",ct,[t("div",mt,[t("div",ht,[bt,t("div",ut,[pt,e.tariffs.length>0?(i(),l("div",ft,[(i(!0),l(b,null,_(e.tariffs,a=>(i(),l("div",_t,[t("div",gt,[t("h3",null,c(a.name||"не указано"),1),t("div",vt,c(a.price||"0")+"₽",1),(a.services||[]).length>0?(i(),l("ul",yt,[(i(!0),l(b,null,_(a.services,u=>(i(),l("li",kt,c(u),1))),256))])):r("",!0),t("button",{type:"button",onClick:u=>e.submitPayment(a.price),class:"btn btn-primary p-3"},"Выбрать ",8,wt)])]))),256))])):(i(),l("p",Ct," Подождите, мы загружаем тарифы! "))])])])]),t("div",St,[t("div",$t,[t("main",Ft,[t("div",Bt,[T(e.$slots,"default")])])])]),t("div",Mt,[Tt,t("button",{onClick:o[4]||(o[4]=(...a)=>e.changeLight&&e.changeLight(...a)),class:"btn btn-primary mt-2"},Lt)]),t("div",xt,[t("div",qt,[t("div",At,[Pt,t("div",Dt,[t("div",It,[(i(!0),l(b,null,_(e.themes,(a,u)=>(i(),l("button",{type:"button",onClick:Me=>e.switchTheme(u),class:E([{active:e.currentTheme.indexOf(a.href)!=-1},"list-group-item list-group-item-action"]),"aria-current":"true"},c(a.title||"-"),11,jt))),256))])]),Vt])])]),t("div",Ot,[t("div",Nt,[t("div",Ut,[e.profile?(i(),l(b,{key:0},[e.profile.manager?(i(),l("div",zt,[Ht,p(A,{bot:e.bot},null,8,["bot"])])):(i(),l("div",Jt,Gt)),Kt],64)):r("",!0)])])]),t("div",Xt,[t("div",Qt,[t("div",Wt,[Yt,t("div",Zt,[t("form",{id:"contactForm",onSubmit:o[10]||(o[10]=k((...a)=>e.submitMail&&e.submitMail(...a),["prevent"]))},[t("div",te,[m(t("input",{class:"form-control","onUpdate:modelValue":o[5]||(o[5]=a=>e.feedbackForm.name=a),id:"name",type:"text",placeholder:"Введите ваше имя...","data-sb-validations":"required",required:""},null,512),[[h,e.feedbackForm.name]]),ee,se]),t("div",oe,[m(t("input",{class:"form-control","onUpdate:modelValue":o[6]||(o[6]=a=>e.feedbackForm.email=a),id:"email",type:"email",placeholder:"name@example.com"},null,512),[[h,e.feedbackForm.email]]),ae,ie,le]),t("div",ne,[m(t("input",{class:"form-control","onUpdate:modelValue":o[7]||(o[7]=a=>e.feedbackForm.phone=a),id:"phone",type:"text",placeholder:"+7(123)456-78-90","data-sb-validations":"required",required:""},null,512),[[S,"+7(###)###-##-##"],[h,e.feedbackForm.phone]]),re,de]),t("div",ce,[m(t("input",{class:"form-control",id:"time","onUpdate:modelValue":o[8]||(o[8]=a=>e.feedbackForm.time=a),type:"time",placeholder:"12:00"},null,512),[[h,e.feedbackForm.time]]),me,he]),t("div",be,[m(t("textarea",{"onUpdate:modelValue":o[9]||(o[9]=a=>e.feedbackForm.message=a),class:"form-control",id:"message",type:"text",placeholder:"Текст вашего сообщения",style:{height:"10rem"},"data-sb-validations":"required",required:""},null,512),[[h,e.feedbackForm.message]]),ue,pe]),e.success?(i(),l("div",fe,[_e,ge,d(" Наш менеджер свяжется с вами! ")])):r("",!0),e.error?(i(),l("div",ve," Ошибка отправки заявки ")):r("",!0),ye],32)])])])]),t("div",ke,[we,t("div",Ce,[t("div",null,[p(L)])])])],64)}}}),Fe={class:"container"},Be={components:{Carousel:D,Slide:I,Pagination:j,Navigation:V},data(){return{templates:[],load:!1,step:0,bot:null}},computed:{...w(["getCurrentBot","getCurrentCompany"]),profile(){return window.profile},isManagerVerified(){return!(!this.profile||!this.profile.manager)}},mounted(){this.loadCurrentBot(),this.setStep(localStorage.getItem("cashman_set_botpage_step_index")||0),window.addEventListener("change-current_bot-from-navbar-event",s=>{this.bot=this.getCurrentBot,localStorage.setItem("cashman_set_botform_step_index",4),localStorage.setItem("cashman_set_botpage_step_index",2),this.botSectionCallback()}),window.addEventListener("reset-current_bot-from-navbar-event",s=>{this.bot=null,this.botSectionCallback()})},methods:{openForEdit(){},duplicateAndEdit(s,e){this.templates[s].in_use=!0,this.$store.dispatch("duplicateBot",{dataObject:{bot_id:e,company_id:this.getCurrentCompany?this.getCurrentCompany.id:null}}).then(o=>{this.bot=o.data,this.load=!0,this.templates[s].in_use=!1,this.loadCurrentBot(this.bot),localStorage.setItem("cashman_set_botform_step_index",0),this.inBotFav(this.bot.id)||this.$store.dispatch("addBotToFavorites",this.bot.id),this.setStep(2),this.$nextTick(()=>{this.load=!1}),this.$notify("Указанный бот успешно продублирован")})},loadTemplates(){this.$store.dispatch("loadTemplates").then(s=>{this.templates=s.data})},setStep(s){this.step=parseInt(s),localStorage.setItem("cashman_set_botpage_step_index",s)},loadCurrentBot(s=null){this.$store.dispatch("updateCurrentBot",{bot:s}).then(()=>{this.bot=this.getCurrentBot})},botSectionCallback(){this.load=!0,this.$nextTick(()=>{this.load=!1})},botListCallback(s){this.load=!0,this.setStep(2),this.loadCurrentBot(s),this.$nextTick(()=>{this.load=!1})}}},Re=Object.assign(Be,{__name:"DevPage",props:{botUser:{type:String}},setup(s){const e=s;return window.profile=e.botUser,(o,n)=>(i(),f($e,null,{default:C(()=>[t("div",Fe,[o.bot&&!o.load?(i(),f(P,{key:0,onCallback:o.botSectionCallback,bot:o.bot},null,8,["onCallback","bot"])):r("",!0),!o.load&&o.bot===null?(i(),f(q,{key:1,bot:o.bot,onCallback:o.loadCurrentBot},null,8,["bot","onCallback"])):r("",!0)])]),_:1}))}});export{Re as default};
