import{_ as p}from"./_plugin-vue_export-helper-c27b6911.js";import{o as a,j as d,l as e,K as s,F as r,J as u,L as h,n as b}from"./index.es-db843bab.js";const k={data(){return{selectedTable:null,my_bookings:[]}},mounted(){this.myUpcomingBookings()},methods:{selectATable(n){this.selectedTable=null,this.$nextTick(()=>{this.selectedTable=n,localStorage.setItem("cashman_current_active_table",JSON.stringify(n)),this.$emit("select",this.selectedTable)})},myUpcomingBookings(){return this.$store.dispatch("myUpcomingBookings").then(n=>{this.my_bookings=n.data||[];let t=localStorage.getItem("cashman_current_active_table")||null;t&&(t=JSON.parse(t)),this.selectedTable=this.my_bookings.find(c=>c.id===(t==null?void 0:t.id))||null})},openRemoveModal(n){this.selectedTable=null,this.$nextTick(()=>{this.selectedTable=n;const t=document.getElementById("remove-booking-modal");new bootstrap.Modal(t).show()})},cancelBookingTable(){if(this.selectedTable)return this.$store.dispatch("cancelBookingTable",{bookingId:this.selectedTable.id}).then(n=>{this.$notify({title:"Бронирование",text:"Бронь столика успешно убрана!",type:"success"}),localStorage.removeItem("cashman_current_active_table"),this.myUpcomingBookings();const t=document.getElementById("remove-booking-modal");bootstrap.Modal.getInstance(t).hide().hide()})}}},y={key:0,class:"p-3"},f={class:"dropdown my-2"},v={class:"btn btn-success dropdown-toggle w-100 p-3",type:"button",id:"bookingsDropdown","data-bs-toggle":"dropdown","aria-expanded":"false"},T={key:0},w={key:1},x={class:"dropdown-menu w-100","aria-labelledby":"bookingsDropdown"},B=e("li",null,[e("hr",{class:"dropdown-divider"})],-1),M=["onClick"],C={class:"fw-bold"},I={class:"text-muted"},S={class:"fst-italic mb-1"},E={class:"d-flex justify-content-between align-items-center"},N=["onClick"],D={class:"badge bg-primary rounded-pill"},L={class:"modal fade",id:"remove-booking-modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},U={class:"modal-dialog modal-dialog-centered"},j={class:"modal-content"},A=e("div",{class:"modal-header"},[e("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"Удаление брони"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),J={class:"modal-body"},V={class:"mb-2"},F={class:"fw-bold text-primary"},O={class:"fw-bold text-primary"},R={class:"w-100 d-flex justify-content-center"},K=e("button",{"data-bs-dismiss":"modal",class:"btn btn-secondary",type:"button"},"Нет, отменить ",-1);function q(n,t,c,z,l,i){return a(),d(r,null,[l.my_bookings.length>0?(a(),d("div",y,[e("div",f,[e("button",v,[l.selectedTable?(a(),d("span",T,"Выбран столик #"+s(l.selectedTable.number),1)):(a(),d("span",w,"Мои брони ("+s(l.my_bookings.length)+")",1))]),e("ul",x,[e("li",{onClick:t[0]||(t[0]=o=>i.selectATable(null)),class:"dropdown-item"}," Не выбран "),B,(a(!0),d(r,null,u(l.my_bookings,o=>{var _,m;return a(),d("li",{onClick:g=>i.selectATable(o),key:o.id,class:"dropdown-item"},[e("div",C," Бронь столика №"+s(o.number),1),e("small",I," Дата "+s(o.booked_date_at)+" в "+s(o.booked_time_at),1),e("p",S,s(((_=o.booked_info)==null?void 0:_.description)||"-"),1),e("div",E,[e("button",{onClick:g=>i.openRemoveModal(o),type:"button",class:"btn btn-sm btn-danger"}," Отменить ",8,N),e("span",D,s(((m=o.booked_info)==null?void 0:m.persons)||1)+" чел. ",1)])],8,M)}),128))])])])):h("",!0),e("div",L,[e("div",U,[e("div",j,[A,e("div",J,[l.selectedTable?(a(),d(r,{key:0},[e("p",V,[b("Вы точно хотите удалить бронь на "),e("strong",F,s(l.selectedTable.booked_date_at||"-"),1),b(" для столика "),e("strong",O,s(l.selectedTable.number||"-"),1),b("?")]),e("div",R,[e("button",{onClick:t[1]||(t[1]=(...o)=>i.cancelBookingTable&&i.cancelBookingTable(...o)),style:{"margin-right":"10px"},class:"btn btn-danger",type:"button"},"Да, удалить "),K])],64)):h("",!0)])])])])],64)}const P=p(k,[["render",q]]);export{P as B};
