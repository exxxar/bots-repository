import"./ProductCardSimple-fd2f756b.js";import{j as m,O as f,o as n,k as o,n as i,N as y,p as r,L as l,M as a,a0 as u,F as b}from"./index.es-c4852431.js";const p={class:"card border-0 product-card"},g={class:"img-container"},v={class:"rounded-3"},w={class:"controls"},k={class:"top d-flex justify-content-between w-100 align-items-center"},P={class:"rating p-2"},C={class:"text-white fw-bold"},_=i("i",{class:"fa-regular fa-star text-primary mr-1"},null,-1),x={key:0,class:"terms p-2"},$=i("span",{class:"text-white fw-bold"},[i("i",{class:"fa-solid fa-clock text-primary"})],-1),z=[$],F={key:0,class:"fa-solid fa-heart",style:{"font-size":"14px"}},I={key:1,class:"fa-regular fa-heart",style:{"font-size":"14px"}},A={class:"card-body px-0"},D={key:0,style:{"margin-right":"10px"},class:"text-primary text-center"},j={key:0},T={key:1,class:"d-flex justify-content-between align-items-center px-2"},R={key:0},B=i("i",{class:"fa-solid fa-check-double mr-2"},null,-1),M={key:1},N={key:0,class:"d-flex justify-content-between align-items-center px-2"},O=["disabled"],S={key:0,class:"text-decoration-line-through",style:{"font-size":"10px"}},V={key:1,class:"btn-group w-100 rounded-3"},E=["disabled"],L={key:0},Q=["disabled"],G={key:1,class:"px-2"},q=i("span",{style:{"font-size":"12px"},class:"btn btn-outline-secondary rounded-3 py-2 btn-md w-100 d-flex justify-content-center align-items-center"},[i("i",{class:"fa-solid fa-lock mr-2"}),r(" нет в наличии")],-1),H=[q],J={props:["item","displayType","collectionMode","canSelect"],data(){return{sending:!1,is_online:!0}},computed:{...m(["inCart","getReviews","getReviewsPaginateObject","getSelf","getFavoriteProducts"]),currentPrice(){return this.item.current_price/100},checkInCart(){return this.inCart(this.item.id)},favorites(){return this.getFavoriteProducts},canProductAction(){return this.is_online&&!this.sending},currentBot(){return window.currentBot},inFav(){return this.favorites.length===0?!1:this.favorites.indexOf(this.item.id)!==-1}},mounted(){window.addEventListener("online",()=>{this.is_online=!0}),window.addEventListener("offline",()=>{this.is_online=!1})},methods:{showProductDetails(){this.$productInfo.show(this.item)},goToProduct(){this.$router.push({name:"ProductV2",params:{productId:this.item.id}})},addToFavorite(){var s;this.$store.dispatch("toggleProductInFavorites",{form:{id:this.item.id}}).then(c=>{this.$notify({title:"Избранное",text:this.inFav?"Товар успешно добавлен в избранное!":"Товар убран из избранного!",type:"success"}),window.self.config.favorites=c.data.favorites}).catch(()=>{});const t=((s=window.self.config)==null?void 0:s.favorites)||[];let e=t.findIndex(c=>c===this.item.id);e!==-1?t.splice(e,1):t.push(this.item.id),window.self.config==null?window.self.config={favorites:t}:window.self.config.favorites=t},incProductCart(){this.sending=!0,(this.checkInCart===0?this.$store.dispatch("addProductToCart",this.item):this.$store.dispatch("incQuantity",this.item.id)).then(()=>{this.sending=!1,this.$notify({title:"Добавление товара",text:'Товар "'+this.item.title+'" успешно добавлен',type:"success"})}).catch(()=>{this.sending=!1,this.$notify({title:"Добавление товара",text:"Ошибка добавления товара!",type:"error"})})},decProductCart(){this.sending=!0,(this.checkInCart<=1?this.$store.dispatch("removeProduct",this.item.id):this.$store.dispatch("decQuantity",this.item.id)).then(()=>{this.sending=!1,this.$notify({title:"Удаление товара",text:'Товар "'+this.item.title+'" успешно убран из корзины',type:"success"})}).catch(()=>{this.sending=!1,this.$notify({title:"Удаление товара",text:"Ошибка удаления товара!",type:"error"})})},selectInCollection(t){this.canSelect&&this.$emit("select-in-collection",t)}}},W=Object.assign(J,{__name:"ProductCard",setup(t){return(e,s)=>{var h;const c=f("lazy");return n(),o("div",p,[i("div",g,[y(i("img",v,null,512),[[c,t.item.images[0]]]),i("div",w,[i("div",k,[i("div",P,[i("span",C,[_,r(" "+l(Math.round(t.item.rating||0)),1)])]),t.item.delivery_terms?(n(),o("div",x,z)):a("",!0),i("span",{onClick:s[0]||(s[0]=(...d)=>e.addToFavorite&&e.addToFavorite(...d)),style:{"margin-right":"10px"},class:"badge bg-primary fw-bold"},[e.inFav?(n(),o("i",F)):(n(),o("i",I))])])]),i("div",{onClick:s[1]||(s[1]=(...d)=>e.showProductDetails&&e.showProductDetails(...d)),class:"click-zone"})]),i("div",A,[t.item.old_price>0?(n(),o("p",D,"Акция")):a("",!0),i("p",{onClick:s[2]||(s[2]=(...d)=>e.showProductDetails&&e.showProductDetails(...d)),class:"text-center mb-2",style:{"font-size":"10px"}},[r(l(t.item.title.slice(0,50))+" ",1),t.item.title.length>50?(n(),o("span",j,"...")):a("",!0)]),t.collectionMode?(n(),o("div",T,[i("button",{type:"button",onClick:s[3]||(s[3]=d=>e.selectInCollection(t.item)),style:{"font-size":"12px"},class:u([{"btn-primary":t.item.is_checked,"btn-light":!t.item.is_checked},"btn btn-md w-100 rounded-2 mb-2"])},[t.item.is_checked?(n(),o("span",R,[B,r(" Выбрано")])):(n(),o("span",M,"Выбрать"))],2)])):(n(),o(b,{key:2},[t.item.in_stop_list_at?(n(),o("div",G,H)):(n(),o("div",N,[e.inCart(t.item.id)===0?(n(),o("button",{key:0,type:"button",onClick:s[4]||(s[4]=(...d)=>e.incProductCart&&e.incProductCart(...d)),style:{"font-size":"12px"},class:u([{"btn-secondary":!e.canProductAction},"btn btn-sm btn-light w-100 rounded-3"]),disabled:t.item.in_stop_list_at!=null||!e.canProductAction},[r(l(t.item.current_price||0)+"₽ ",1),t.item.old_price>0?(n(),o("span",S,l(t.item.old_price||0)+"₽",1)):a("",!0)],10,O)):a("",!0),e.inCart(t.item.id)>0?(n(),o("div",V,[i("button",{type:"button",disabled:t.item.in_stop_list_at!=null||!e.canProductAction,style:{"border-radius":"6px 0px 0px 6px"},class:u([{"btn-secondary":!e.canProductAction},"btn btn-sm btn-primary"]),onClick:s[5]||(s[5]=(...d)=>e.decProductCart&&e.decProductCart(...d))},"- ",10,E),i("button",{type:"button",class:u([{"btn-secondary":!e.canProductAction},"btn btn-sm btn-primary"])},[r(l(e.checkInCart)+" ",1),(h=t.item)!=null&&h.is_weight_product?(n(),o("span",L,"г.")):a("",!0)],2),i("button",{type:"button",class:u([{"btn-secondary":!e.canProductAction},"btn btn-sm btn-primary"]),disabled:t.item.in_stop_list_at!=null||!e.canProductAction,onClick:s[6]||(s[6]=(...d)=>e.incProductCart&&e.incProductCart(...d)),style:{"border-radius":"0px 6px 6px 0px"}},"+ ",10,Q)])):a("",!0)]))],64))])])}}});export{W as _};
