import{_ as P}from"./ProductCardSimple-862098ff.js";import{_ as $}from"./CollectionCardSimple-d56ca33a.js";import{j as D,o as i,k as a,n as t,q as b,F as d,K as y,H as m,w as r,L as l,M as c,l as _,u as p,a0 as z,N as g,Z as N,p as v,s as T,O as x}from"./index.es-c4852431.js";import{C as k,S as u,P as w,N as C}from"./carousel.es-39a2ec14.js";const M={class:"container py-3"},S={class:"row"},B={class:"col-12"},j={class:"row"},F={key:0,class:"mb-0"},L={class:"fst-italic",style:{"font-size":"10px"}},V={key:1,class:"mb-0"},A={class:"fst-italic",style:{"font-size":"10px"}},O={key:0,class:"mb-0"},U={class:"fst-italic",style:{"font-size":"10px"}},E=t("h6",{class:"opacity-75 mb-2 mt-2"},"Выбор приза Колеса фортуны",-1),W={class:"card-img-top object-fit-cover w-100",alt:"..."},q=t("div",{class:"card-body"},[t("p",{class:"card-text text-primary",style:{"font-size":"12px"}},"Приз не выбран")],-1),G=["onClick"],H={class:"card-img-top object-fit-cover w-100",alt:"..."},I={class:"card-body"},K={class:"card-text text-primary",style:{"font-size":"10px"}},Z={class:"card mb-3"},J={class:"card-body"},Q={class:"mb-2"},R={class:"fw-bold"},X={class:"mb-0"},Y={class:"fw-bold"},tt={key:0,class:"text-success fw-bold"},et=t("i",{class:"fa-solid fa-trash-can mr-2"},null,-1),st=t("span",{class:"color-white"},"Очистить корзину",-1),ot=[et,st],it=t("i",{class:"fa-solid fa-money-bill mr-2"},null,-1),at=t("span",{class:"color-white"},"Перейти к оформлению",-1),nt=[it,at],lt={class:"modal fade",id:"take-prize-modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},rt={class:"modal-dialog"},ct={class:"modal-content"},dt=T('<div class="modal-header"><h1 class="modal-title fs-5" id="exampleModalLabel">Использование приза</h1><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div><div class="modal-body"> Вы точно хотите использовать этот приз сейчас? <p class="alert alert-info my-"> Внимание! Призы со скидкой будут применены к текущей корзине, если товара по скидке нет, то он будет добавлен в корзину и применена скидка к нему. </p></div>',2),pt={class:"modal-footer d-flex justify-content-center"},mt=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Отмена",-1),ht={props:["formData","simpleMode"],components:{Carousel:k,Slide:u,Pagination:w,Navigation:C},computed:{...D(["cartProducts","cartTotalCount","cartTotalPrice"]),filteredActionData(){return this.action?this.action.data?this.action.data.filter(o=>!o.taked_at):[]:[]},bot(){return window.currentBot},settings(){return this.bot.settings}},data(){return{selected_prize:null,prize_modal:null,config:{itemsToShow:2.5},display_promo_code:!1,action:null}},mounted(){this.prize_modal=new bootstrap.Modal(document.getElementById("take-prize-modal"),{}),this.loadClientNotUsedPrizes()},methods:{openPrizeModal(o){this.selected_prize=null,this.$nextTick(()=>{this.selected_prize=o,this.selected_prize!=null&&this.prize_modal.show()})},selectPrize(){const o=this.selected_prize;if(o==null){this.prize_modal.hide();return}this.$store.dispatch("useWheelOfFortunePrize",{form:{action_prize:o,action_id:this.action.id}}).then(s=>{this.action=s.action,this.$notify({title:"Выбор приза",text:"Приз успешно выбран!",type:"success"}),this.$emit("select-prize",{prize:o,action_id:this.action.id}),this.selected_prize=null,this.prize_modal.hide(),window.location.reload()}).catch(()=>{this.prize_modal.hide()})},loadClientNotUsedPrizes(){this.settings.selected_script_id&&this.$store.dispatch("getClientNotUsedPrizesFromWheelOfFortune",{slug_id:this.settings.selected_script_id}).then(o=>{this.action=o.action})},clearCart(){this.$emit("change-tab",1),this.$store.dispatch("clearCart").then(()=>{this.$notify({title:"Корзина",text:"Корзина успешно очищена",type:"success"})})}}},zt=Object.assign(ht,{__name:"CartProductList",setup(o){return(s,n)=>{const f=x("lazy");return i(),a(d,null,[t("div",M,[t("div",S,[t("div",B,[b(s.$slots,"upper-text")])]),t("div",j,[(i(!0),a(d,null,y(s.cartProducts,(e,h)=>(i(),a("div",{key:e.id,class:"col-12"},[(e.product||null)!=null?(i(),m(P,{comment:e.comment,config:e.params,key:"product-"+e.product.id,item:e.product},{partner:r(()=>[e.partner?(i(),a("p",F,[t("span",L,l(e.partner.title||"-"),1)])):(i(),a("p",V,[t("span",A,l(s.bot.title||"-"),1)]))]),_:2},1032,["comment","config","item"])):(e.collection||null)!=null?(i(),m($,{comment:e.comment,params:e.params,key:"collection-"+e.collection.id,item:e.collection},{partner:r(()=>[e.partner?(i(),a("p",O,[t("span",U,l(e.partner.title||"-"),1)])):c("",!0)]),_:2},1032,["comment","params","item"])):c("",!0)]))),128))]),s.settings.need_prizes_from_wheel_of_fortune&&(s.filteredActionData||[]).length>0?(i(),a(d,{key:0},[E,_(p(k),N({itemsToShow:2.5,wrapAround:!1},s.config),{addons:r(()=>[_(p(C)),_(p(w))]),default:r(()=>[(i(),m(p(u),{key:"empty-prize"},{default:r(()=>[t("div",{onClick:n[0]||(n[0]=e=>s.openPrizeModal(null)),class:z([{"border-primary":o.formData.action_prize==null},"card mx-1 p-3 align-items-center"]),style:{height:"190px","border-color":"#e9ecef"}},[g(t("img",W,null,512),[[f,"/images/chest.png"]]),q],2)]),_:1})),(i(!0),a(d,null,y(s.filteredActionData,e=>(i(),m(p(u),{key:e},{default:r(()=>{var h;return[t("div",{onClick:_t=>s.openPrizeModal(e),class:z([{"border-primary":(((h=o.formData.action_prize)==null?void 0:h.prize)||{description:null}).description==e.description},"card mx-1 p-3 align-items-center"]),style:{height:"190px","border-color":"#e9ecef"}},[g(t("img",H,null,512),[[f,"/images/wheel.png"]]),t("div",I,[t("p",K,l(e.description||"-"),1)])],10,G)]}),_:2},1024))),128))]),_:1},16,["itemsToShow"])],64)):c("",!0),o.simpleMode?c("",!0):(i(),a(d,{key:1},[t("div",Z,[t("div",J,[t("h6",Q,[v("Товаров в корзине "),t("strong",R,l(s.cartTotalCount)+" ед.",1)]),t("h6",X,[v("Общая цена товаров "),t("strong",Y,l(s.cartTotalPrice-o.formData.discount)+"₽",1),(o.formData.discount||0)>0?(i(),a("strong",tt," (-"+l(o.formData.discount)+" ₽ )",1)):c("",!0)])])]),b(s.$slots,"recommendation-list"),s.cartTotalCount>0?(i(),a("button",{key:0,onClick:n[1]||(n[1]=(...e)=>s.clearCart&&s.clearCart(...e)),class:"btn btn-outline-primary p-3 w-100 mb-2"},ot)):c("",!0),t("button",{onClick:n[2]||(n[2]=e=>s.$emit("change-tab",1)),class:"btn btn-primary p-3 w-100"},nt)],64))]),t("div",lt,[t("div",rt,[t("div",ct,[dt,t("div",pt,[mt,t("button",{type:"button",onClick:n[3]||(n[3]=(...e)=>s.selectPrize&&s.selectPrize(...e)),class:"btn btn-primary"},"Использовать ")])])])])],64)}}});export{zt as _};
