import{L as m,q as n,t as a,x as v,v as e,A as d,H as h,G as f,J as b,F as u,C as p,y as r,K as y,B as g}from"./index.es-b188fb53.js";import{P as w}from"./Pagination-0b2e35d4.js";import{_ as k}from"./_plugin-vue_export-helper-c27b6911.js";const C={props:["type","content"],data(){return{url:null}},mounted(){this.url="https://media.your-cashman.com/"}},M={class:"d-flex justify-content-center"},j=["src"],O=["src"],B={key:2,class:"w-100",alt:""},P={key:3,class:"w-100",alt:""},x=["src"],V=["src"];function D(s,o,t,i,l,c){const _=m("lazy");return n(),a("div",M,[(t.type=="video"||t.type=="video_note")&&t.content.indexOf("http")==-1?(n(),a("video",{key:0,class:v(["w-100",{"video-circle":t.type=="video_note"}]),controls:"",poster:"/images/load.gif"},[e("source",{src:l.url+t.content,type:"video/mp4"},null,8,j)],2)):d("",!0),t.content.indexOf("http")!=-1?(n(),a("iframe",{key:1,class:"w-100",style:{"min-height":"300px"},src:t.content,frameborder:"0",allowfullscreen:""},`

        `,8,O)):d("",!0),t.type=="photo"&&t.content.indexOf("http")==-1?h((n(),a("img",B,null,512)),[[_,l.url+t.content]]):d("",!0),t.type=="photo"&&t.content.indexOf("http")!=-1?h((n(),a("img",P,null,512)),[[_,t.content]]):d("",!0),t.type=="audio"&&t.content.indexOf("http")!=-1?(n(),a("audio",{key:4,controls:"",autoplay:"",src:t.content},null,8,x)):d("",!0),t.type=="audio"&&t.content.indexOf("http")==-1?(n(),a("audio",{key:5,controls:"",autoplay:"",src:l.url+t.content},null,8,V)):d("",!0)])}const N=k(C,[["render",D]]),I={class:"row"},A={class:"input-group mb-3"},S={key:0,class:"row"},T={class:"col-12 col-md-12 mb-3"},$={class:"row"},z=["onClick"],L={class:"card-header d-flex justify-content-between align-items-center"},F={class:"badge bg-primary rounded-pill mb-0"},G={class:"badge bg-info rounded-pill"},q={class:"card-body"},E={class:"fw-bold"},H={class:"w-100"},J={class:"card-footer d-flex justify-content-between"},K=["onClick"],U=e("i",{class:"fa-solid fa-eye"},null,-1),Q=[U],R=["onClick"],W=e("i",{class:"fa-brands fa-telegram"},null,-1),X=[W],Y=["onClick"],Z=e("i",{class:"fa-solid fa-trash"},null,-1),ee=[Z],te={class:"col-12"},oe={key:1,class:"row"},se=e("div",{class:"col-12"},[e("div",{class:"alert alert-warning",role:"alert"}," У выбранного бота нет медиа-файлов ")],-1),ne=[se],ie={class:"modal fade",id:"preview-modal",tabindex:"-1","aria-labelledby":"preview-modal-label","aria-hidden":"true"},ae={class:"modal-dialog"},de={class:"modal-content"},le={class:"modal-body"},ce={key:0,class:"d-flex justify-content-center align-items-center"},re=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),he={props:["selected","needVideo","needVideoNote","needPhoto","needAudio","needDocument","needSticker"],data(){return{bot:null,previewContent:null,loading:!0,media:[],search:null,media_paginate_object:null}},computed:{...f(["getMedia","getMediaPaginateObject","getCurrentBot"])},mounted(){this.loadCurrentBot().then(()=>{this.loadMedia()})},methods:{selectMedia(s){this.$emit("select",s)},loadCurrentBot(s=null){return this.$store.dispatch("updateCurrentBot",{bot:s}).then(()=>{this.bot=this.getCurrentBot})},nextMedia(s){this.loadMedia(s)},remove(s){this.$store.dispatch("removeMedia",{dataObject:{mediaId:s}}).then(o=>{this.loadMedia(),this.$notify({title:"Удаление медиа-контента",text:"Медиа контент удален"})}).catch(()=>{})},showPreview(s){this.previewContent=null,this.$nextTick(()=>{this.previewContent=s,new bootstrap.Modal("#preview-modal",{}).show()})},showPreviewInTg(s){this.$store.dispatch("showMediaPreview",{dataObject:{mediaId:s}}).then(o=>{this.$notify({title:"Превью медиа-контента",text:"Отправлено в бота"})}).catch(()=>{this.$notify({title:"Превью медиа-контента",text:"Ошибка отправки в канал!"})})},loadMedia(s=0){this.loading=!0,this.$store.dispatch("loadMedia",{dataObject:{botId:this.bot.id||null,search:this.search,needVideo:this.needVideo||!1,needVideoNote:this.needVideoNote||!1,needPhoto:this.needPhoto||!1,needAudio:this.needAudio||!1,needDocument:this.needDocument||!1,needSticker:this.needSticker||!1},page:s}).then(o=>{this.loading=!1,this.media=this.getMedia,this.media_paginate_object=this.getMediaPaginateObject}).catch(()=>{this.loading=!1})}}},me=Object.assign(he,{__name:"BotMediaList",setup(s){return(o,t)=>(n(),a(u,null,[e("div",I,[e("div",A,[h(e("input",{type:"search",class:"form-control",placeholder:"Поиск файла","aria-label":"Поиск файла","onUpdate:modelValue":t[0]||(t[0]=i=>o.search=i)},null,512),[[b,o.search]]),e("button",{class:"btn btn-outline-secondary",onClick:t[1]||(t[1]=i=>o.loadMedia(0)),type:"button",id:"button-addon2"},"Найти ")])]),o.media.length>0?(n(),a("div",S,[e("div",T,[e("div",$,[(n(!0),a(u,null,p(o.media,(i,l)=>(n(),a("div",{onClick:c=>o.selectMedia(i),class:"col-lg-6 col-12"},[e("div",{class:v(["card mb-2",{"border-info":(s.selected||[]).indexOf(i.file_id)!=-1}])},[e("div",L,[e("p",F,"#"+r(i.id),1),e("span",G,r(i.type),1)]),e("div",q,[e("div",E,r(i.caption??"Без подписи"),1),e("small",H,r(i.file_id),1)]),e("div",J,[e("div",null,[e("a",{href:"javascript:void(0)",class:"btn btn-info mr-2",onClick:c=>o.showPreview(i)},Q,8,K),e("a",{href:"javascript:void(0)",class:"btn btn-info",onClick:c=>o.showPreviewInTg(i.id)},X,8,R)]),e("a",{href:"javascript:void(0)",class:"btn btn-outline-danger text-danger",onClick:c=>o.remove(i.id)},ee,8,Y)])],2)],8,z))),256))])]),e("div",te,[o.media_paginate_object?(n(),y(w,{key:0,onPagination_page:o.nextMedia,pagination:o.media_paginate_object},null,8,["onPagination_page","pagination"])):d("",!0)])])):(n(),a("div",oe,ne)),e("div",ie,[e("div",ae,[e("div",de,[e("div",le,[o.previewContent!=null?(n(),a("div",ce,[g(N,{type:o.previewContent.type,content:o.previewContent.file_id},null,8,["type","content"])])):d("",!0)]),re])])])],64))}});export{N as B,me as _};
