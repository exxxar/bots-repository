import{o as d,k as l,n as t,N as n,a9 as y,Y as u,H as i,M as r,a1 as c,p as h,L as b,F as m,K as p}from"./index.es-c4852431.js";import{K as k}from"./KeyboardConstructor-8a23a78e.js";import{_ as f}from"./KeyboardCard-9a26d223.js";import{v as _}from"./v4-4a60fe23.js";const g={key:0},v=t("h6",null,"Форма создания шаблона клавиатуры",-1),F={class:"mb-3"},K=t("label",{class:"form-label",id:"bot-domain"},"Тип",-1),B=t("option",{value:"reply"},"Нижняя клавиатура",-1),M=t("option",{value:"inline"},"Встроенная клавиатура",-1),S=[B,M],w={class:"mb-3"},T={class:"form-label d-flex justify-content-between",id:"bot-domain"},C=t("span",null,"Мнемоническое имя",-1),$=t("i",{class:"fa-solid fa-arrows-rotate"},null,-1),j=[$],N={class:"col-12"},V=t("button",{class:"btn btn-m btn-full mb-0 rounded-xs text-uppercase font-900 shadow-s bg-green1-dark w-100"}," Добавить новый шаблон клавиатуры ",-1),D=t("div",{class:"divider divider-small my-3 bg-highlight"},null,-1),L={key:1,class:"mb-1"},O={class:"badge bg-warning"},A={class:"mb-3"},E={key:1,class:"card"},R={class:"card-body"},U={key:3,class:"mb-3"},q=t("div",{class:"alert alert-warning",role:"alert"},[t("p",null,"Список шаблонов клавиатур пуст!")],-1),H=[q],I={props:["selectMode","type"],data(){return{keyboards:[],load:!1,editedKeyboard:null,selectMenuIndex:null,keyboardForm:{type:"reply",slug:null,menu:[]}}},computed:{filteredKeyboard(){return this.type?this.keyboards.filter(o=>o.type==this.type):this.keyboards}},mounted(){this.loadMenusByBotTemplate(),this.generateSlug()},methods:{selectCard(o){this.$emit("select",o)},keyboardCallbackAction(o){let e=this.keyboards.find(s=>s.id===o);e.deleted_at=new Date,this.loadMenusByBotTemplate()},loadMenusByBotTemplate(){this.$store.dispatch("loadBotKeyboards").then(o=>{this.$nextTick(()=>{this.keyboards=o.data})})},submitKeyboard(){let o=new FormData;Object.keys(this.keyboardForm).forEach(e=>{const s=this.keyboardForm[e]||"";typeof s=="object"?o.append(e,JSON.stringify(s)):o.append(e,s)}),this.$store.dispatch("createKeyboardTemplate",{keyboardForm:o}).then(e=>{this.keyboardForm={type:"reply",slug:null,menu:[]},this.load=!0,this.$nextTick(()=>{this.load=!1}),this.loadMenusByBotTemplate()})},generateSlug(){this.keyboardForm.slug=_()},changeKeyboardFormMenu(o){this.keyboardForm.menu=o}}},Q=Object.assign(I,{__name:"KeyboardList",setup(o){return(e,s)=>(d(),l(m,null,[o.selectMode?r("",!0):(d(),l("div",g,[v,t("form",{onSubmit:s[3]||(s[3]=c((...a)=>e.submitKeyboard&&e.submitKeyboard(...a),["prevent"]))},[t("div",F,[K,n(t("select",{"onUpdate:modelValue":s[0]||(s[0]=a=>e.keyboardForm.type=a),class:"form-control"},S,512),[[y,e.keyboardForm.type]])]),t("div",w,[t("label",T,[C,t("a",{onClick:s[1]||(s[1]=(...a)=>e.generateSlug&&e.generateSlug(...a)),href:"javascript:void(0)"},j)]),n(t("input",{type:"text",class:"form-control",placeholder:"Мнемоническое имя","aria-label":"Мнемоническое имя","onUpdate:modelValue":s[2]||(s[2]=a=>e.keyboardForm.slug=a),maxlength:"255","aria-describedby":"bot-domain",required:""},null,512),[[u,e.keyboardForm.slug]])]),t("div",N,[e.load?r("",!0):(d(),i(k,{key:0,onSave:e.changeKeyboardFormMenu,"edited-keyboard":e.keyboardForm},null,8,["onSave","edited-keyboard"]))]),V],32),D])),e.keyboards?(d(),l("p",L,[h("В списке клавиатур "),t("span",O,b(e.filteredKeyboard.length)+" ед.",1)])):r("",!0),e.keyboards?(d(!0),l(m,{key:2},p(e.filteredKeyboard,(a,J)=>(d(),l("div",A,[a.deleted_at?(d(),l("div",E,[t("div",R,[t("p",null,"Удаленная клавиатура #"+b(a.id),1)])])):(d(),i(f,{key:0,"select-mode":o.selectMode,onSelect:e.selectCard,onReload:e.loadMenusByBotTemplate,onCallback:e.keyboardCallbackAction,keyboard:a},null,8,["select-mode","onSelect","onReload","onCallback","keyboard"]))]))),256)):r("",!0),e.filteredKeyboard.length===0?(d(),l("div",U,H)):r("",!0)],64))}});export{Q as _};
