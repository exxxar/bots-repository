import{j as _,o as i,k as c,n as e,F as d,K as h,N as u,a3 as f,M as b,Y as k,a1 as v,p as m,L as p}from"./index.es-c4852431.js";import{_ as F}from"./_plugin-vue_export-helper-c27b6911.js";const x={data(){return{file:null,sending:!1,need_video:!1,need_document:!1,callbackForm:{message:null,images:[],videos:[],documents:[]}}},watch:{need_video:{handler:function(s){this.need_video||(this.callbackForm.videos=[])},deep:!0},need_document:{handler:function(s){this.need_video||(this.callbackForm.documents=[])},deep:!0}},computed:{..._(["getSelf"]),self(){return this.getSelf},canSend(){return!this.sending&&((this.callbackForm.images||[]).length>0||(this.callbackForm.videos||[]).length>0||(this.callbackForm.documents||[]).length>0)},tg(){return window.Telegram.WebApp}},mounted(){},methods:{onChangePhotos(s){const t=s.target.files||[];for(let l=0;l<t.length;l++)this.callbackForm.images.push(t[l])},onChangeVideos(s){const t=s.target.files||[];for(let l=0;l<t.length;l++)this.callbackForm.videos.push(t[l])},onChangeDocuments(s){const t=s.target.files||[];for(let l=0;l<t.length;l++)this.callbackForm.documents.push(t[l])},getPhoto(s){return{imageUrl:URL.createObjectURL(s)}},removePhoto(s){this.callbackForm.images.splice(s,1)},removeVideo(s){this.callbackForm.videos.splice(s,1)},removeDocument(s){this.callbackForm.documents.splice(s,1)},onAdvancedUpload(s){},submitCallback(){let s=new FormData;this.sending=!0,Object.keys(this.callbackForm).forEach(t=>{const l=this.callbackForm[t]||"";typeof l=="object"?s.append(t,JSON.stringify(l)):s.append(t,l)}),this.callbackForm.images.length>0&&(this.callbackForm.images.forEach(t=>{s.append("photos[]",t)}),s.delete("images")),this.callbackForm.documents.length>0&&(this.callbackForm.documents.forEach(t=>{s.append("documents[]",t)}),s.delete("documents")),this.callbackForm.videos.length>0&&(this.callbackForm.videos.forEach(t=>{s.append("videos[]",t)}),s.delete("videos")),this.$store.dispatch("uploadFileForm",{callbackForm:s}).then(t=>{this.callbackForm={message:null,videos:[],documents:[],images:[]},this.$notify({title:"Загрузка файлов",text:"Спасибо, файлы загружены"}),this.sending=!1,this.tg.close()}).catch(t=>{this.sending=!1})}}},y={key:0,class:"container py-3"},C=e("h3",null,"Загрузка файлов",-1),w=e("p",{class:"alert alert-light"},[m(" Внимание! Вы можете загрузить до "),e("strong",{class:"fw-bold text-primary"},"10"),m(" фотографий, "),e("strong",{class:"fw-bold text-primary"},"1"),m(" видео-ролик и "),e("strong",{class:"fw-bold text-primary"},"1"),m(" документ. ")],-1),V=e("h6",{class:"my-2 text-center fw-bold"},"Прикрепить фотографию ",-1),D={class:"form-floating mb-2"},U=["disabled"],j=e("label",{for:"menu-photos-upload"},"Фотографии",-1),S={class:"list-group list-group-numbered mb-2"},P={class:"list-group-item d-flex justify-content-between align-items-start"},E={class:"ms-2 me-auto",style:{"word-break":"break-all"}},L=["onClick"],N={class:"form-check mb-2"},M=e("label",{class:"form-check-label",for:"need_attach_video"}," Нужно прикрепить видео ",-1),B=e("h6",{class:"mb-2 text-center fw-bold"},"Прикрепить видео",-1),O={class:"form-floating mb-2"},T=["disabled"],A=e("label",{for:"menu-video"},"Видео",-1),R={class:"list-group list-group-numbered mb-2"},G={class:"list-group-item d-flex justify-content-between align-items-start"},J={class:"ms-2 me-auto",style:{"word-break":"break-all"}},K=["onClick"],W={class:"form-check mb-2"},Y=e("label",{class:"form-check-label",for:"need_attach_file"}," Нужно прикрепить файл ",-1),q=e("h6",{class:"mb-2 text-center fw-bold"},"Прикрепить файл",-1),z={class:"form-floating mb-2"},H=["disabled"],I=e("label",{for:"menu-document"},"Документ",-1),Q={class:"list-group list-group-numbered mb-2"},X={class:"list-group-item d-flex justify-content-between align-items-start"},Z={class:"ms-2 me-auto",style:{"word-break":"break-all"}},$=["onClick"],ee={class:"form-floating"},te=e("label",{for:"callbackForm-message"},"Пояснение",-1),se={class:"navbar navbar-expand-sm fixed-bottom p-3 bg-transparent border-0",style:{"border-radius":"10px 10px 0px 0px"}},oe=["disabled"];function le(s,t,l,ae,a,n){return n.self?(i(),c("div",y,[C,w,e("form",{onSubmit:t[6]||(t[6]=v((...o)=>n.submitCallback&&n.submitCallback(...o),["prevent"]))},[V,e("div",D,[e("input",{type:"file",id:"menu-photos-upload",accept:"image/*",onChange:t[0]||(t[0]=(...o)=>n.onChangePhotos&&n.onChangePhotos(...o)),class:"form-control",disabled:(a.callbackForm.images||[]).length===10,placeholder:"name@example.com",multiple:!0},null,40,U),j]),e("ol",S,[(i(!0),c(d,null,h(a.callbackForm.images,(o,r)=>(i(),c("li",P,[e("div",E,p(o.name||"не указан"),1),e("span",{onClick:g=>n.removePhoto(r),class:"badge text-bg-primary rounded-pill cursor-pointer"}," удалить ",8,L)]))),256))]),e("div",N,[u(e("input",{class:"form-check-input","onUpdate:modelValue":t[1]||(t[1]=o=>a.need_video=o),type:"checkbox",value:"",id:"need_attach_video"},null,512),[[f,a.need_video]]),M]),a.need_video?(i(),c(d,{key:0},[B,e("div",O,[e("input",{type:"file",id:"menu-video",accept:"video/*",disabled:(a.callbackForm.videos||[]).length===1,onChange:t[2]||(t[2]=(...o)=>n.onChangeVideos&&n.onChangeVideos(...o)),class:"form-control",placeholder:"name@example.com"},null,40,T),A]),e("ol",R,[(i(!0),c(d,null,h(a.callbackForm.videos,(o,r)=>(i(),c("li",G,[e("div",J,p(o.name||"не указан"),1),e("span",{onClick:g=>n.removeVideo(r),class:"badge text-bg-primary rounded-pill cursor-pointer"}," удалить ",8,K)]))),256))])],64)):b("",!0),e("div",W,[u(e("input",{class:"form-check-input","onUpdate:modelValue":t[3]||(t[3]=o=>a.need_document=o),type:"checkbox",value:"",id:"need_attach_file"},null,512),[[f,a.need_document]]),Y]),a.need_document?(i(),c(d,{key:1},[q,e("div",z,[e("input",{type:"file",id:"menu-document",accept:"application/pdf",disabled:(a.callbackForm.documents||[]).length===1,onChange:t[4]||(t[4]=(...o)=>n.onChangeDocuments&&n.onChangeDocuments(...o)),class:"form-control",placeholder:"name@example.com"},null,40,H),I]),e("ol",Q,[(i(!0),c(d,null,h(a.callbackForm.documents,(o,r)=>(i(),c("li",X,[e("div",Z,p(o.name||"не указан"),1),e("span",{onClick:g=>n.removeDocument(r),class:"badge text-bg-primary rounded-pill cursor-pointer"}," удалить ",8,$)]))),256))])],64)):b("",!0),e("div",ee,[u(e("textarea",{class:"form-control",style:{height:"200px","line-height":"150%"},"onUpdate:modelValue":t[5]||(t[5]=o=>a.callbackForm.message=o),placeholder:"Leave a comment here",id:"callbackForm-message"},null,512),[[k,a.callbackForm.message]]),te]),e("nav",se,[e("button",{type:"submit",disabled:!n.canSend,class:"btn btn-primary mt-2 p-3 w-100"}," Отправить сообщение ",8,oe)])],32)])):b("",!0)}const ce=F(x,[["render",le]]);export{ce as default};
