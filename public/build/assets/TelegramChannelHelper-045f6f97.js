import{y as v,o,g as i,n as m,j as e,l,w as u,u as b,v as f,F as _,q as g,t as h,x as y,p as k,C as w}from"./index.es-818101fe.js";import{P as C}from"./TelegramChannelHelper.vue_vue_type_style_index_0_lang-ec2683f6.js";import{_ as p}from"./_plugin-vue_export-helper-c27b6911.js";const M={props:["type","content"],data(){return{url:null}},mounted(){this.url="https://media.your-cashman.com/"}},x={class:"d-flex justify-content-center"},j=["src"],O=["src"],$={key:2,class:"w-100",alt:""},P={key:3,class:"w-100",alt:""},B=["src"],L=["src"];function V(s,t,n,a,r,d){const c=v("lazy");return o(),i("div",x,[(n.type=="video"||n.type=="video_note")&&n.content.indexOf("http")==-1?(o(),i("video",{key:0,class:m(["w-100",{"video-circle":n.type=="video_note"}]),controls:"",poster:"/images/load.gif"},[e("source",{src:r.url+n.content,type:"video/mp4"},null,8,j)],2)):l("",!0),n.content.indexOf("http")!=-1?(o(),i("iframe",{key:1,class:"w-100",style:{"min-height":"300px"},src:n.content,frameborder:"0",allowfullscreen:""},`

        `,8,O)):l("",!0),n.type=="photo"&&n.content.indexOf("http")==-1?u((o(),i("img",$,null,512)),[[c,r.url+n.content]]):l("",!0),n.type=="photo"&&n.content.indexOf("http")!=-1?u((o(),i("img",P,null,512)),[[c,n.content]]):l("",!0),n.type=="audio"&&n.content.indexOf("http")!=-1?(o(),i("audio",{key:4,controls:"",autoplay:"",src:n.content},null,8,B)):l("",!0),n.type=="audio"&&n.content.indexOf("http")==-1?(o(),i("audio",{key:5,controls:"",autoplay:"",src:r.url+n.content},null,8,L)):l("",!0)])}const T=p(M,[["render",V]]),I={class:"row"},q={class:"input-group mb-3"},D={key:0,class:"row"},N={class:"col-12 col-md-12 mb-3"},S={class:"row"},z=["onClick"],A={class:"card-header d-flex justify-content-between align-items-center"},F={class:"badge bg-primary rounded-pill mb-0"},U={class:"badge bg-info rounded-pill"},E={class:"card-body"},G={class:"fw-bold"},H={class:"w-100"},J={class:"card-footer d-flex justify-content-between"},K=["onClick"],Q=e("i",{class:"fa-solid fa-eye"},null,-1),R=[Q],W=["onClick"],X=e("i",{class:"fa-brands fa-telegram"},null,-1),Y=[X],Z=["onClick"],ee=e("i",{class:"fa-solid fa-trash"},null,-1),te=[ee],ne={class:"col-12"},se={key:1,class:"row"},oe=e("div",{class:"col-12"},[e("div",{class:"alert alert-warning",role:"alert"}," У выбранного бота нет медиа-файлов ")],-1),ie=[oe],ae={class:"modal fade",id:"preview-modal",tabindex:"-1","aria-labelledby":"preview-modal-label","aria-hidden":"true"},de={class:"modal-dialog"},le={class:"modal-content"},ce={class:"modal-body"},re={key:0,class:"d-flex justify-content-center align-items-center"},he=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),ue={props:["selected","needVideo","needVideoNote","needPhoto","needAudio","needDocument","needSticker"],data(){return{bot:null,previewContent:null,loading:!0,media:[],search:null,media_paginate_object:null}},computed:{...b(["getMedia","getMediaPaginateObject","getCurrentBot"])},mounted(){this.loadCurrentBot().then(()=>{this.loadMedia()})},methods:{selectMedia(s){this.$emit("select",s)},loadCurrentBot(s=null){return this.$store.dispatch("updateCurrentBot",{bot:s}).then(()=>{this.bot=this.getCurrentBot})},nextMedia(s){this.loadMedia(s)},remove(s){this.$store.dispatch("removeMedia",{dataObject:{mediaId:s}}).then(t=>{this.loadMedia(),this.$notify({title:"Удаление медиа-контента",text:"Медиа контент удален"})}).catch(()=>{})},showPreview(s){this.previewContent=null,this.$nextTick(()=>{this.previewContent=s,new bootstrap.Modal("#preview-modal",{}).show()})},showPreviewInTg(s){this.$store.dispatch("showMediaPreview",{dataObject:{mediaId:s}}).then(t=>{this.$notify({title:"Превью медиа-контента",text:"Отправлено в бота"})}).catch(()=>{this.$notify({title:"Превью медиа-контента",text:"Ошибка отправки в канал!"})})},loadMedia(s=0){this.loading=!0,this.$store.dispatch("loadMedia",{dataObject:{botId:this.bot.id||null,search:this.search,needVideo:this.needVideo||!1,needVideoNote:this.needVideoNote||!1,needPhoto:this.needPhoto||!1,needAudio:this.needAudio||!1,needDocument:this.needDocument||!1,needSticker:this.needSticker||!1},page:s}).then(t=>{this.loading=!1,this.media=this.getMedia,this.media_paginate_object=this.getMediaPaginateObject}).catch(()=>{this.loading=!1})}}},$e=Object.assign(ue,{__name:"BotMediaList",setup(s){return(t,n)=>(o(),i(_,null,[e("div",I,[e("div",q,[u(e("input",{type:"search",class:"form-control",placeholder:"Поиск файла","aria-label":"Поиск файла","onUpdate:modelValue":n[0]||(n[0]=a=>t.search=a)},null,512),[[f,t.search]]),e("button",{class:"btn btn-outline-secondary",onClick:n[1]||(n[1]=a=>t.loadMedia(0)),type:"button",id:"button-addon2"},"Найти ")])]),t.media.length>0?(o(),i("div",D,[e("div",N,[e("div",S,[(o(!0),i(_,null,g(t.media,(a,r)=>(o(),i("div",{onClick:d=>t.selectMedia(a),class:"col-lg-6 col-12"},[e("div",{class:m(["card mb-2",{"border-info":(s.selected||[]).indexOf(a.file_id)!=-1}])},[e("div",A,[e("p",F,"#"+h(a.id),1),e("span",U,h(a.type),1)]),e("div",E,[e("div",G,h(a.caption??"Без подписи"),1),e("small",H,h(a.file_id),1)]),e("div",J,[e("div",null,[e("a",{href:"javascript:void(0)",class:"btn btn-info mr-2",onClick:d=>t.showPreview(a)},R,8,K),e("a",{href:"javascript:void(0)",class:"btn btn-info",onClick:d=>t.showPreviewInTg(a.id)},Y,8,W)]),e("a",{href:"javascript:void(0)",class:"btn btn-outline-danger text-danger",onClick:d=>t.remove(a.id)},te,8,Z)])],2)],8,z))),256))])]),e("div",ne,[t.media_paginate_object?(o(),y(C,{key:0,onPagination_page:t.nextMedia,pagination:t.media_paginate_object},null,8,["onPagination_page","pagination"])):l("",!0)])])):(o(),i("div",se,ie)),e("div",ae,[e("div",de,[e("div",le,[e("div",ce,[t.previewContent!=null?(o(),i("div",re,[k(T,{type:t.previewContent.type,content:t.previewContent.file_id},null,8,["type","content"])])):l("",!0)]),he])])])],64))}}),_e={props:["token","param"],data(){return{channelLink:null}},mounted(){},methods:{checkLink(){this.channelLink.indexOf("https://t.me/")!==-1&&(this.channelLink="@"+(this.channelLink.split("https://t.me/")[1]||this.channelLink))},requestTelegramChannelId(){this.$store.dispatch("requestTelegramChannelId",{dataObject:{token:this.token,channel:this.channelLink}}).then(s=>{s.ok&&this.$emit("callback",{param:this.param||null,text:s.result.chat.id}),s.ok||(this.$notify({title:"Конструктор ботов",text:s.description,type:"error"}),this.$emit("callback",{param:this.param||null,text:null}))}).catch(()=>{})}}},me={class:"dropdown"},fe=e("button",{class:"btn btn-link dropdown-toggle",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-brands fa-telegram"})],-1),pe={style:{"min-width":"300px"},class:"dropdown-menu cursor-pointer text-muted p-2"},ve={class:"input-group"},be={class:"form-floating"},ge=e("label",{for:""},"Ссылка на канал",-1),ye=["disabled"],ke=e("i",{class:"fa-solid fa-magnifying-glass"},null,-1),we=[ke],Ce={key:0,class:"alert alert-danger mb-2",role:"alert"};function Me(s,t,n,a,r,d){return o(),i("div",me,[fe,e("div",pe,[e("form",{onSubmit:t[2]||(t[2]=w((...c)=>d.requestTelegramChannelId&&d.requestTelegramChannelId(...c),["prevent"]))},[e("div",ve,[e("div",be,[u(e("input",{type:"text",class:"form-control",id:"search-description-text","onUpdate:modelValue":t[0]||(t[0]=c=>r.channelLink=c),onChange:t[1]||(t[1]=(...c)=>d.checkLink&&d.checkLink(...c)),placeholder:"@telegram_channel",required:""},null,544),[[f,r.channelLink]]),ge]),e("button",{disabled:!n.token,class:"btn btn-outline-primary"},we,8,ye)]),n.token?l("",!0):(o(),i("div",Ce," Вам необходимо указать тоукен бота! "))],32)])])}const Pe=p(_e,[["render",Me]]);export{T as B,Pe as T,$e as _};
