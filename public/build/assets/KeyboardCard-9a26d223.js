import{K as y}from"./KeyboardConstructor-8a23a78e.js";/* empty css                                                     */import{v as m}from"./v4-4a60fe23.js";import{o as d,k as i,n as o,a0 as b,M as n,L as l,p as u,F as r,K as c,H as p}from"./index.es-c4852431.js";const k={key:0,class:"mb-2 px-1"},f=["disabled"],_=o("i",{class:"fa-solid fa-arrow-left"},null,-1),g=[_],v=["data-bs-target","disabled"],K=o("i",{class:"fa-regular fa-pen-to-square"},null,-1),F=[K],$=["disabled"],C=o("i",{class:"fa-regular fa-floppy-disk"},null,-1),M=[C],w={key:1,class:"d-flex justify-content-between"},N={class:"mr-2"},T=["disabled"],j={key:0,class:"fa-solid fa-check"},O={key:1,class:"fa-regular fa-pen-to-square"},S=["disabled"],B=o("i",{class:"fa-regular fa-clone"},null,-1),D=[B],E=["disabled"],I=o("i",{class:"fa-regular fa-floppy-disk"},null,-1),V=[I],q=["disabled"],J=o("i",{class:"fa-solid fa-trash-can"},null,-1),L=[J],z={key:2},H={class:"mb-0"},A={key:0},G={key:1},P={class:"mb-0"},Q={class:"mb-1 d-flex justify-content-between"},R={class:"mb-1 px-1 w-100"},U={type:"button",class:"btn btn-outline-primary w-100 font-10 p-2"},W=o("div",{class:"divider divider-small my-3 bg-highlight"},null,-1),X={props:["keyboard","selectMode"],data:()=>({is_edited:!1,editMode:!1,load:!1,keyboardForm:null}),computed:{uuid(){return m()}},watch:{keyboardForm:{handler(t){this.is_edited=!0},deep:!0}},mounted(){const t=this.keyboard;this.keyboardForm=t,this.$nextTick(()=>{this.is_edited=!1})},methods:{removeKeyboard(){this.$store.dispatch("removeKeyboardTemplate",{templateId:this.keyboardForm.id}).then(t=>{this.load=!0,this.$nextTick(()=>{this.load=!1}),this.$botNotification.success("Конструктор клавитатуры","Клавиатура успешно удалена!"),this.$emit("callback",this.keyboardForm.id)}).catch(()=>{this.$emit("callback",this.keyboardForm.id),this.$botNotification.warning("Конструктор клавитатуры","Ошибка удаления клавиатуры")})},saveKeyboard(t){this.keyboardForm.menu=t,this.$botNotification.notification("Конструктор клавитатуры","Клавиатура успешно выбрана!")},selectCard(){this.$emit("select",this.keyboardForm)},duplicateKeyboard(){let t=new FormData;Object.keys(this.keyboardForm).forEach(e=>{const s=this.keyboardForm[e]||"";typeof s=="object"?t.append(e,JSON.stringify(s)):t.append(e,s)}),this.$store.dispatch("createKeyboardTemplate",{keyboardForm:t}).then(e=>{this.$botNotification.success("Конструктор ботов","Меню успешно продублировано!"),this.load=!0,this.$nextTick(()=>{this.load=!1}),this.$emit("reload")})},updateKeyboard(){let t=new FormData;Object.keys(this.keyboardForm).forEach(e=>{const s=this.keyboardForm[e]||"";typeof s=="object"?t.append(e,JSON.stringify(s)):t.append(e,s)}),this.$store.dispatch("editKeyboardTemplate",{keyboardForm:t}).then(e=>{this.load=!0,this.$nextTick(()=>{this.load=!1,this.is_edited=!1}),this.$botNotification.success("Конструктор клавитатуры","Клавиатура успешно сохранена!"),this.$emit("callback")}).catch(()=>{this.is_edited=!0})}}},oe=Object.assign(X,{__name:"KeyboardCard",setup(t){return(e,s)=>(d(),i(r,null,[t.selectMode?(d(),i("div",k,[o("button",{onClick:s[0]||(s[0]=(...a)=>e.selectCard&&e.selectCard(...a)),disabled:e.load,type:"button",class:"btn btn-outline-success mr-2"},g,8,f),o("button",{"data-bs-toggle":"modal","data-bs-target":"#open-construct-"+e.uuid,disabled:e.load,type:"button",title:"Редактировать клавиатуру",class:"btn btn-outline-success mr-2"},F,8,v),o("button",{onClick:s[1]||(s[1]=(...a)=>e.updateKeyboard&&e.updateKeyboard(...a)),type:"button",title:"Обновить клавиатуру",disabled:e.load||!e.is_edited,class:b(["btn mr-2",{"btn-outline-primary have-change":e.is_edited,"btn-outline-secondary":!e.is_edited}])},M,10,$)])):n("",!0),t.selectMode?n("",!0):(d(),i("div",w,[o("div",null,[o("strong",N,"#"+l(t.keyboard.id),1),o("button",{"data-bs-toggle":"modal",onClick:s[2]||(s[2]=a=>e.editMode=!e.editMode),disabled:e.load,type:"button",title:"Редактировать клавиатуру",class:"btn btn-outline-success mr-2"},[e.editMode?(d(),i("i",j)):(d(),i("i",O))],8,T),o("button",{onClick:s[3]||(s[3]=(...a)=>e.duplicateKeyboard&&e.duplicateKeyboard(...a)),type:"button",title:"Дублировать клавиатуру",disabled:e.load,class:"btn btn-outline-primary mr-2"},D,8,S),o("button",{onClick:s[4]||(s[4]=(...a)=>e.updateKeyboard&&e.updateKeyboard(...a)),type:"button",title:"Обновить клавиатуру",disabled:e.load||!e.is_edited,class:b(["btn mr-2",{"btn-outline-primary have-change":e.is_edited,"btn-outline-secondary":!e.is_edited}])},V,10,E)]),o("button",{onClick:s[5]||(s[5]=(...a)=>e.removeKeyboard&&e.removeKeyboard(...a)),type:"button",disabled:e.load,title:"Удалить клавиатуру",class:"btn btn-outline-danger mr-2"},L,8,q)])),t.selectMode?n("",!0):(d(),i("div",z,[o("p",H,[u("Тип клавиатуры: "),t.keyboard.type==="reply"?(d(),i("strong",A,"Нижняя клавиатура")):n("",!0),t.keyboard.type==="inline"?(d(),i("strong",G,"Встроенная клавиатура")):n("",!0)]),o("p",P,[u("Мнемоническое имя: "),o("strong",null,l(t.keyboard.slug),1)])])),e.editMode?n("",!0):(d(!0),i(r,{key:3},c(t.keyboard.menu,(a,Y)=>(d(),i("div",Q,[(d(!0),i(r,null,c(a,(h,Z)=>(d(),i("div",R,[o("button",U,l(h.text),1)]))),256))]))),256)),e.keyboardForm&&e.editMode?(d(),p(y,{key:4,onSave:e.saveKeyboard,"edited-keyboard":e.keyboardForm},null,8,["onSave","edited-keyboard"])):n("",!0),W],64))}});export{oe as _};
