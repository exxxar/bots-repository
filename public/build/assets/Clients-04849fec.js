import{j as k,o as i,k as a,n as t,N as u,Y as f,a3 as v,a1 as g,F as p,p as d,L as c,K as w,a0 as b,H as U,M as h,s as C,O as B,l as y,a9 as F,a7 as S}from"./index.es-c4852431.js";import{P as V}from"./Pagination-b758f7ed.js";import{_ as j,a as q}from"./OrderList-019c2884.js";import{_ as $}from"./_plugin-vue_export-helper-c27b6911.js";/* empty css                                                   */import{_ as O}from"./BotMediaList-9b4db56f.js";import{_ as M}from"./CashBackList-2f8bde7e.js";import"./ReviewCard-2760000f.js";import"./Rating-5dca4717.js";import"./ProductCardSimple-fd2f756b.js";const I=t("p",{class:"my-3"},"Введите номер телефона (или фрагмент) пользователя или его Ф.И.О.",-1),L={class:"form-floating mb-3"},T=t("label",{for:"floatingInput"},"Кого ищем?",-1),D={class:"d-flex w-100",style:{"overflow-x":"scroll"}},P={class:"scroll d-flex px-2",style:{"min-width":"1300px"}},R={class:"form-check form-switch mx-2"},E=t("label",{class:"form-check-label",for:"need-admins-checkbox"},"Только администраторы",-1),H={class:"form-check form-switch mx-2"},X=t("label",{class:"form-check-label",for:"need-with-phone-checkbox"},"Только с телефоном",-1),N={class:"form-check form-switch mx-2"},A=t("label",{class:"form-check-label",for:"need-deliveryman"},"Только доставщики",-1),z={class:"form-check form-switch mx-2"},J=t("label",{class:"form-check-label",for:"need-without-phone-checkbox"},"Только без телефоном",-1),G={class:"form-check form-switch mx-2"},K=t("label",{class:"form-check-label",for:"need-vip-checkbox"},"Только VIP",-1),W={class:"form-check form-switch mx-2"},Y=t("label",{class:"form-check-label",for:"need-not-vip-checkbox"},"Только не VIP",-1),Q=t("button",{type:"submit",class:"btn btn-primary w-100 p-3 my-3"},[t("i",{class:"fa-solid fa-magnifying-glass mr-2"}),d("Искать ")],-1),Z={class:"w-100 text-center mb-2 small"},tt={class:"text-primary fw-bold"},et={class:"list-group"},st=["onClick"],ot={key:0,class:"fa-solid fa-a text-danger mr-2"},lt={key:1,class:"fa-solid fa-u text-success mr-2"},it={key:2,style:{"font-size":"12px"}},at={key:3,style:{"font-size":"12px"}},nt={style:{"font-size":"12px"}},rt=C('<div class="card card-info mb-3"><div class="card-body"><p class="mb-2"><i class="fa-solid fa-a text-danger mr-2"></i> - администратор системы</p><p class="mb-0"><i class="fa-solid fa-u text-success mr-2"></i> - пользователь</p></div></div>',1),dt=t("i",{class:"fa-regular fa-file-excel mr-2"},null,-1),ct=t("i",{class:"fa-regular fa-file-excel mr-2"},null,-1),ut={props:["selectedBotUser"],data(){return{loading:!0,users:null,search:null,need_admins:!1,need_vip:!1,need_not_vip:!1,need_with_phone:!1,need_without_phone:!1,need_deliveryman:!1,users_paginate_object:null}},computed:{...k(["getUsers","getUsersPaginateObject"])},mounted(){this.loadUsers(0)},methods:{downloadBotUsers(){this.$notify({title:"Внимание!",text:"Начался формироваться документ статистики!"}),this.$store.dispatch("downloadBotUsers").then(n=>{this.$notify({title:"Отлично!",text:"Документ успешно сформирован!",type:"success"})}).catch(()=>{this.$notify({title:"Упс...!",text:"Что-то пошло не так...!",type:"error"})})},downloadCashBackHistory(){this.$notify({title:"Внимание!",text:"Начался формироваться документ статистики!"}),this.$store.dispatch("downloadCashBackHistory").then(n=>{this.$notify({title:"Отлично!",text:"Документ успешно сформирован!",type:"success"})}).catch(()=>{this.$notify({title:"Упс...!",text:"Что-то пошло не так...!",type:"error"})})},nextUsers(n){this.loadUsers(n)},selectUser(n){this.$emit("select",n)},loadUsers(n=0){this.loading=!0,this.$store.dispatch("loadUsers",{dataObject:{search:this.search,need_admins:this.need_admins,need_vip:this.need_vip,need_not_vip:this.need_not_vip,need_deliveryman:this.need_deliveryman,need_with_phone:this.need_with_phone,need_without_phone:this.need_without_phone},page:n}).then(e=>{this.loading=!1,this.users=this.getUsers,this.users_paginate_object=this.getUsersPaginateObject,this.$emit("cancel")}).catch(()=>{this.loading=!1})}}},mt=Object.assign(ut,{__name:"Users",setup(n){return(e,s)=>(i(),a(p,null,[I,t("form",{onSubmit:s[7]||(s[7]=g(l=>e.loadUsers(0),["prevent"]))},[t("div",L,[u(t("input",{type:"text","onUpdate:modelValue":s[0]||(s[0]=l=>e.search=l),class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,512),[[f,e.search]]),T]),t("div",D,[t("div",P,[t("div",R,[u(t("input",{class:"form-check-input","onUpdate:modelValue":s[1]||(s[1]=l=>e.need_admins=l),value:"false",type:"checkbox",role:"switch",id:"need-admins-checkbox"},null,512),[[v,e.need_admins]]),E]),t("div",H,[u(t("input",{class:"form-check-input","onUpdate:modelValue":s[2]||(s[2]=l=>e.need_with_phone=l),value:"false",type:"checkbox",role:"switch",id:"need-with-phone-checkbox"},null,512),[[v,e.need_with_phone]]),X]),t("div",N,[u(t("input",{class:"form-check-input","onUpdate:modelValue":s[3]||(s[3]=l=>e.need_deliveryman=l),value:"false",type:"checkbox",role:"switch",id:"need-deliveryman"},null,512),[[v,e.need_deliveryman]]),A]),t("div",z,[u(t("input",{class:"form-check-input","onUpdate:modelValue":s[4]||(s[4]=l=>e.need_without_phone=l),value:"false",type:"checkbox",role:"switch",id:"need-without-phone-checkbox"},null,512),[[v,e.need_without_phone]]),J]),t("div",G,[u(t("input",{class:"form-check-input","onUpdate:modelValue":s[5]||(s[5]=l=>e.need_vip=l),value:"false",type:"checkbox",role:"switch",id:"need-vip-checkbox"},null,512),[[v,e.need_vip]]),K]),t("div",W,[u(t("input",{class:"form-check-input","onUpdate:modelValue":s[6]||(s[6]=l=>e.need_not_vip=l),value:"false",type:"checkbox",role:"switch",id:"need-not-vip-checkbox"},null,512),[[v,e.need_not_vip]]),Y])])]),Q],32),e.users&&!e.loading?(i(),a(p,{key:0},[t("p",Z,[d("Найдено пользователей "),t("span",tt,c(e.users_paginate_object.meta.total),1)]),t("ul",et,[(i(!0),a(p,null,w(e.users,(l,o)=>(i(),a("li",{onClick:_=>e.selectUser(l),class:b([{"bg-primary text-white":l.id==(n.selectedBotUser||{id:null}).id},"list-group-item d-flex justify-content-between"])},[t("div",null,[l.is_admin?(i(),a("i",ot)):(i(),a("i",lt)),(l.name||l.fio_from_telegram||"Не указано").length>26?(i(),a("span",it,c((l.name||l.fio_from_telegram||"Не указано").substring(0,26))+"...",1)):(i(),a("span",at,c(l.name||l.fio_from_telegram||"Не указано"),1))]),t("strong",nt,c(l.phone||"Телефон не указан"),1)],10,st))),256))]),e.users_paginate_object?(i(),U(V,{key:0,simple:!0,class:"mt-4",onPagination_page:e.nextUsers,pagination:e.users_paginate_object},null,8,["onPagination_page","pagination"])):h("",!0)],64)):h("",!0),rt,t("a",{href:"javascript:void(0)",onClick:s[8]||(s[8]=(...l)=>e.downloadBotUsers&&e.downloadBotUsers(...l)),class:"btn btn-outline-info w-100 p-3 mb-2"},[dt,d(" Скачать список пользователей ")]),t("a",{href:"javascript:void(0)",onClick:s[9]||(s[9]=(...l)=>e.downloadCashBackHistory&&e.downloadCashBackHistory(...l)),class:"btn btn-outline-info w-100 p-3 mb-2"},[ct,d(" Скачать историю начисления ")])],64))}}),bt={props:["botUser"],data(){return{isEdit:!1,messages:[],botUserForm:{id:null,is_vip:!1,is_admin:!1,is_work:!1,is_manager:!1,is_deliveryman:!1,user_in_location:!1,name:null,phone:null,email:null,birthday:null,age:null,city:null,country:null,address:null,sex:null,is_blocked:null,blocked_message:null}}},watch:{isEdit:function(){this.botUserForm.id=this.botUser.id,this.botUserForm.is_vip=this.botUser.is_vip,this.botUserForm.is_admin=this.botUser.is_admin,this.botUserForm.is_work=this.botUser.is_work,this.botUserForm.is_manager=this.botUser.is_manager,this.botUserForm.is_deliveryman=this.botUser.is_deliveryman,this.botUserForm.user_in_location=this.botUser.user_in_location,this.botUserForm.name=this.botUser.name||this.botUser.username||this.botUser.id,this.botUserForm.phone=this.botUser.phone,this.botUserForm.email=this.botUser.email,this.botUserForm.birthday=this.botUser.birthday||null,this.botUserForm.city=this.botUser.city||null,this.botUserForm.country=this.botUser.country||null,this.botUserForm.address=this.botUser.address||null,this.botUserForm.sex=this.botUser.sex||!1,this.botUserForm.is_blocked=this.botUser.blocked_at!=null,this.botUserForm.blocked_message=this.botUser.blocked_message||null}},methods:{alert(n){this.messages.push(n)},removeMessage(n){this.messages.splice(n,1)},submit(){this.$store.dispatch("updateBotUser",{botUserForm:this.botUserForm}).then(()=>{this.isEdit=!1,this.messages=[],this.botUserForm={id:null,is_vip:!1,is_admin:!1,is_work:!1,is_manager:!1,is_deliveryman:!1,user_in_location:!1,name:null,phone:null,email:null,birthday:null,age:null,city:null,country:null,address:null,sex:null,is_blocked:!1},this.$emit("update"),this.$notify({title:"Редактирование данных",text:"Данные успешно обновлены!",type:"success"})}).catch(()=>{this.$notify({title:"Редактирование данных",text:"Ошибка обновления данных",type:"error"})})}}},ht={key:0},_t=t("i",{class:"fa-solid fa-user-pen mr-2"},null,-1),ft={key:1},pt=t("i",{class:"fa-solid fa-chevron-up mr-2"},null,-1),gt={key:0},yt=t("h6",null,"Основные данные пользователя",-1),vt={class:"table"},kt=t("thead",null,[t("tr",{class:"bg-gray1-dark"},[t("th",{scope:"col",class:"color-theme"},"Ключ"),t("th",{scope:"col",class:"color-theme"},"Значение")])],-1),Ut=t("th",{scope:"row"},"ID в системе",-1),wt={class:"font-weight-bold"},$t=t("th",{scope:"row"},"Дата регистрации",-1),Ft={class:"font-weight-bold"},xt=t("th",{scope:"row"},"Телеграм ID",-1),Ct={class:"font-weight-bold"},Bt=t("th",{scope:"row"},"Имя",-1),St={class:"font-weight-bold"},Vt=t("th",{scope:"row"},"Имя из телеграмма",-1),jt={class:"font-weight-bold"},qt=t("th",{scope:"row"},"Домен пользователя",-1),Ot={class:"font-weight-bold"},Mt=t("th",{scope:"row"},"Номер телефона",-1),It={class:"font-weight-bold"},Lt=t("th",{scope:"row"},"Возраст",-1),Tt={class:"font-weight-bold"},Dt=t("th",{scope:"row"},"Пол",-1),Pt={class:"font-weight-bold"},Rt=t("th",{scope:"row"},"Страна",-1),Et={class:"font-weight-bold"},Ht=t("th",{scope:"row"},"Город",-1),Xt={class:"font-weight-bold"},Nt=t("th",{scope:"row"},"Адрес",-1),At={class:"font-weight-bold"},zt=t("h6",null,"Статусы пользователя",-1),Jt={class:"table"},Gt=t("thead",null,[t("tr",{class:"bg-gray1-dark"},[t("th",{scope:"col",class:"color-theme"},"Ключ"),t("th",{scope:"col",class:"color-theme"},"Значение")])],-1),Kt=t("th",{scope:"row"},"VIP",-1),Wt={class:"font-weight-bold"},Yt=t("th",{scope:"row"},"Администратор",-1),Qt={class:"font-weight-bold"},Zt=t("th",{scope:"row"},"Доставщик",-1),te={class:"font-weight-bold"},ee=t("th",{scope:"row"},"На работе",-1),se={class:"font-weight-bold"},oe=t("th",{scope:"row"},"В заведении",-1),le={class:"font-weight-bold"},ie={key:0},ae=t("th",{scope:"row"},"Пользователь заблокирован",-1),ne={class:"font-weight-bold"},re={class:"mb-0"},de={class:"mb-0"},ce={class:"form-floating mb-2"},ue=t("label",{for:""},"Ф.И.О пользователя",-1),me={class:"form-floating mb-2"},be=t("label",{for:""},"Телефон",-1),he={class:"form-floating mb-2"},_e=t("label",{for:""},"Почта",-1),fe={class:"form-floating mb-2"},pe=t("label",{for:""},"Адрес",-1),ge={class:"form-floating mb-2"},ye=t("label",{for:""},"Дата рождения",-1),ve={class:"form-floating mb-2"},ke=t("label",{for:""},"Страна",-1),Ue={class:"form-floating mb-2"},we=t("label",{for:""},"Город",-1),$e={class:"row mb-0"},Fe=t("p",{class:"col-12 my-2"},"Администратор",-1),xe={class:"col-6"},Ce=t("i",{class:"fa-solid fa-check mr-1"},null,-1),Be={class:"col-6"},Se=t("i",{class:"fa-solid fa-xmark mr-1"},null,-1),Ve={class:"row mb-0"},je=t("p",{class:"col-12 my-2"},"VIP",-1),qe={class:"col-6"},Oe=t("i",{class:"fa-solid fa-check mr-1"},null,-1),Me={class:"col-6"},Ie=t("i",{class:"fa-solid fa-xmark mr-1"},null,-1),Le={class:"row mb-0"},Te=t("p",{class:"col-12 my-2"},"Доставщик",-1),De={class:"col-6"},Pe=t("i",{class:"fa-solid fa-check mr-1"},null,-1),Re={class:"col-6"},Ee=t("i",{class:"fa-solid fa-xmark mr-1"},null,-1),He={class:"row mb-0"},Xe=t("p",{class:"col-12 my-2"},"Менеджер",-1),Ne={class:"col-6"},Ae=t("i",{class:"fa-solid fa-check mr-1"},null,-1),ze={class:"col-6"},Je=t("i",{class:"fa-solid fa-xmark mr-1"},null,-1),Ge={class:"row mb-0"},Ke=t("p",{class:"col-12 my-2"},"Работает",-1),We={class:"col-6"},Ye=t("i",{class:"fa-solid fa-check mr-1"},null,-1),Qe={class:"col-6"},Ze=t("i",{class:"fa-solid fa-xmark mr-1"},null,-1),ts={class:"row mb-0"},es=t("p",{class:"col-12 my-2"},"В заведении",-1),ss={class:"col-6"},os=t("i",{class:"fa-solid fa-check mr-1"},null,-1),ls={class:"col-6"},is=t("i",{class:"fa-solid fa-xmark mr-1"},null,-1),as={class:"row mb-0"},ns=t("p",{class:"col-12 my-2"},"Блокировка пользователя",-1),rs={class:"col-6"},ds=t("i",{class:"fa-solid fa-check mr-1"},null,-1),cs={class:"col-6"},us=t("i",{class:"fa-solid fa-xmark mr-1"},null,-1),ms={key:0,class:"col-12"},bs={class:"form-floating my-2"},hs=t("label",{for:""},"Сообщение блокировки",-1),_s={class:"row mb-0"},fs=t("p",{class:"col-12 my-2"},"Пол",-1),ps={class:"col-6"},gs=t("i",{class:"fa-solid fa-mars mr-1"},null,-1),ys={class:"col-6"},vs=t("i",{class:"fa-solid fa-venus mr-1"},null,-1),ks={class:"alert alert-small rounded-s shadow-xl bg-red2-dark w-100",role:"alert"},Us={class:"custom-alert-text"},ws=["onClick"],$s=t("nav",{class:"navbar navbar-expand-sm fixed-bottom p-3 bg-transparent border-0",style:{"border-radius":"10px 10px 0px 0px"}},[t("button",{type:"submit",class:"btn btn-primary p-3 my-3 w-100"}," Сохранить ")],-1);function Fs(n,e,s,l,o,_){const r=B("mask");return i(),a(p,null,[t("a",{href:"javascript:void(0)",onClick:e[0]||(e[0]=m=>o.isEdit=!o.isEdit),class:"btn btn-outline-light text-primary w-100 p-3 mb-2"},[o.isEdit?(i(),a("span",ft,[pt,d(" Завершить редактирование")])):(i(),a("span",ht,[_t,d(" Редактировать пользователя")]))]),o.isEdit?h("",!0):(i(),a("div",gt,[yt,t("table",vt,[kt,t("tbody",null,[t("tr",null,[Ut,t("td",wt,c(s.botUser.id||"Не указано"),1)]),t("tr",null,[$t,t("td",Ft,c(n.$filters.current(s.botUser.created_at)),1)]),t("tr",null,[xt,t("td",Ct,c(s.botUser.telegram_chat_id||"Не указано"),1)]),t("tr",{class:b({"bg-red1-light":s.botUser.name==null})},[Bt,t("td",St,c(s.botUser.name||"Не указано"),1)],2),t("tr",null,[Vt,t("td",jt,c(s.botUser.fio_from_telegram||"Не указано"),1)]),t("tr",null,[qt,t("td",Ot,c(s.botUser.username||"Не указано"),1)]),t("tr",{class:b({"bg-red1-light":s.botUser.phone==null})},[Mt,t("td",It,c(s.botUser.phone||"Не указано"),1)],2),t("tr",{class:b({"bg-red1-light":s.botUser.age==null})},[Lt,t("td",Tt,c(s.botUser.age||"Не указано"),1)],2),t("tr",null,[Dt,t("td",Pt,c(s.botUser.sex?"Мужчина":"Женщина"),1)]),t("tr",{class:b({"bg-red1-light":s.botUser.country==null})},[Rt,t("td",Et,c(s.botUser.country||"Не указано"),1)],2),t("tr",{class:b({"bg-red1-light":s.botUser.city==null})},[Ht,t("td",Xt,c(s.botUser.city||"Не указано"),1)],2),t("tr",{class:b({"bg-red1-light":s.botUser.address==null})},[Nt,t("td",At,c(s.botUser.address||"Не указано"),1)],2)])]),zt,t("table",Jt,[Gt,t("tbody",null,[t("tr",null,[Kt,t("td",Wt,c(s.botUser.is_vip?"Да":"Нет"),1)]),t("tr",null,[Yt,t("td",Qt,c(s.botUser.is_admin?"Да":"Нет"),1)]),t("tr",null,[Zt,t("td",te,c(s.botUser.is_deliveryman?"Да":"Нет"),1)]),t("tr",null,[ee,t("td",se,c(s.botUser.is_work?"Да":"Нет"),1)]),t("tr",null,[oe,t("td",le,c(s.botUser.user_in_location?"Да":"Нет"),1)]),s.botUser.blocked_at?(i(),a("tr",ie,[ae,t("td",ne,[t("p",re,c(n.$filters.current(s.botUser.blocked_at)),1),t("p",de,[t("em",null,c(s.botUser.blocked_message??"Без сообщения"),1)])])])):h("",!0)])])])),o.isEdit?(i(),a("form",{key:1,onSubmit:e[27]||(e[27]=g((...m)=>_.submit&&_.submit(...m),["prevent"]))},[t("div",ce,[u(t("input",{type:"text",class:"form-control","onUpdate:modelValue":e[1]||(e[1]=m=>o.botUserForm.name=m),onInvalid:e[2]||(e[2]=m=>_.alert("Вы не указали имя!")),placeholder:"Иванов Иван Иванович",required:""},null,544),[[f,o.botUserForm.name]]),ue]),t("div",me,[u(t("input",{type:"text",class:"form-control","onUpdate:modelValue":e[3]||(e[3]=m=>o.botUserForm.phone=m),onInvalid:e[4]||(e[4]=m=>_.alert("Вы не указали телефон!")),placeholder:"+7(XXX) XXX-XX-XX",required:""},null,544),[[f,o.botUserForm.phone],[r,"+7(###)###-##-##"]]),be]),t("div",he,[u(t("input",{type:"text",class:"form-control","onUpdate:modelValue":e[5]||(e[5]=m=>o.botUserForm.email=m),placeholder:"example@gmail.com"},null,512),[[f,o.botUserForm.email]]),_e]),t("div",fe,[u(t("input",{type:"text",class:"form-control","onUpdate:modelValue":e[6]||(e[6]=m=>o.botUserForm.address=m),placeholder:"ул. Петрова, 123, кв 45"},null,512),[[f,o.botUserForm.address]]),pe]),t("div",ge,[u(t("input",{type:"date",class:"form-control","onUpdate:modelValue":e[7]||(e[7]=m=>o.botUserForm.birthday=m),placeholder:"12/01/2023"},null,512),[[f,o.botUserForm.birthday]]),ye]),t("div",ve,[u(t("input",{type:"text",class:"form-control","onUpdate:modelValue":e[8]||(e[8]=m=>o.botUserForm.country=m),placeholder:"Россия"},null,512),[[f,o.botUserForm.country]]),ke]),t("div",Ue,[u(t("input",{type:"text",class:"form-control","onUpdate:modelValue":e[9]||(e[9]=m=>o.botUserForm.city=m),placeholder:"Краснодар"},null,512),[[f,o.botUserForm.city]]),we]),t("div",$e,[Fe,t("div",xe,[t("button",{type:"button",onClick:e[10]||(e[10]=m=>o.botUserForm.is_admin=!0),class:b([{"btn-info":o.botUserForm.is_admin,"btn-outline-secondary":!o.botUserForm.is_admin},"w-100 btn"])},[Ce,d(" Да ")],2)]),t("div",Be,[t("button",{type:"button",onClick:e[11]||(e[11]=m=>o.botUserForm.is_admin=!1),class:b([{"btn-info":!o.botUserForm.is_admin,"btn-outline-secondary":o.botUserForm.is_admin},"w-100 btn"])},[Se,d(" Нет ")],2)])]),t("div",Ve,[je,t("div",qe,[t("button",{type:"button",onClick:e[12]||(e[12]=m=>o.botUserForm.is_vip=!0),class:b([{"btn-info":o.botUserForm.is_vip,"btn-outline-secondary":!o.botUserForm.is_vip},"w-100 btn"])},[Oe,d(" Да ")],2)]),t("div",Me,[t("button",{type:"button",onClick:e[13]||(e[13]=m=>o.botUserForm.is_vip=!1),class:b([{"btn-info":!o.botUserForm.is_vip,"btn-outline-secondary":o.botUserForm.is_vip},"w-100 btn"])},[Ie,d(" Нет ")],2)])]),t("div",Le,[Te,t("div",De,[t("button",{type:"button",onClick:e[14]||(e[14]=m=>o.botUserForm.is_deliveryman=!0),class:b([{"btn-info":o.botUserForm.is_deliveryman,"btn-outline-secondary":!o.botUserForm.is_deliveryman},"w-100 btn"])},[Pe,d(" Да ")],2)]),t("div",Re,[t("button",{type:"button",onClick:e[15]||(e[15]=m=>o.botUserForm.is_deliveryman=!1),class:b([{"btn-info":!o.botUserForm.is_deliveryman,"btn-outline-secondary":o.botUserForm.is_deliveryman},"w-100 btn"])},[Ee,d(" Нет ")],2)])]),t("div",He,[Xe,t("div",Ne,[t("button",{type:"button",onClick:e[16]||(e[16]=m=>o.botUserForm.is_manager=!0),class:b([{"btn-info":o.botUserForm.is_manager,"btn-outline-secondary":!o.botUserForm.is_manager},"w-100 btn"])},[Ae,d(" Да ")],2)]),t("div",ze,[t("button",{type:"button",onClick:e[17]||(e[17]=m=>o.botUserForm.is_manager=!1),class:b([{"btn-info":!o.botUserForm.is_manager,"btn-outline-secondary":o.botUserForm.is_manager},"w-100 btn"])},[Je,d(" Нет ")],2)])]),t("div",Ge,[Ke,t("div",We,[t("button",{type:"button",onClick:e[18]||(e[18]=m=>o.botUserForm.is_work=!0),class:b([{"btn-info":o.botUserForm.is_work,"btn-outline-secondary":!o.botUserForm.is_work},"w-100 btn"])},[Ye,d(" Да ")],2)]),t("div",Qe,[t("button",{type:"button",onClick:e[19]||(e[19]=m=>o.botUserForm.is_work=!1),class:b([{"btn-info":!o.botUserForm.is_work,"btn-outline-secondary":o.botUserForm.is_work},"w-100 btn"])},[Ze,d(" Нет ")],2)])]),t("div",ts,[es,t("div",ss,[t("button",{type:"button",onClick:e[20]||(e[20]=m=>o.botUserForm.user_in_location=!0),class:b([{"btn-info":o.botUserForm.user_in_location,"btn-outline-secondary":!o.botUserForm.user_in_location},"w-100 btn"])},[os,d(" Да ")],2)]),t("div",ls,[t("button",{type:"button",onClick:e[21]||(e[21]=m=>o.botUserForm.user_in_location=!1),class:b([{"btn-info":!o.botUserForm.user_in_location,"btn-outline-secondary":o.botUserForm.user_in_location},"w-100 btn"])},[is,d(" Нет ")],2)])]),t("div",as,[ns,t("div",rs,[t("button",{type:"button",onClick:e[22]||(e[22]=m=>o.botUserForm.is_blocked=!0),class:b([{"btn-info":o.botUserForm.is_blocked,"btn-outline-secondary":!o.botUserForm.is_blocked},"w-100 btn"])},[ds,d(" Да ")],2)]),t("div",cs,[t("button",{type:"button",onClick:e[23]||(e[23]=m=>o.botUserForm.is_blocked=!1),class:b([{"btn-info":!o.botUserForm.is_blocked,"btn-outline-secondary":o.botUserForm.is_blocked},"w-100 btn"])},[us,d(" Нет ")],2)]),o.botUserForm.is_blocked?(i(),a("div",ms,[t("div",bs,[u(t("textarea",{type:"text",class:"form-control","onUpdate:modelValue":e[24]||(e[24]=m=>o.botUserForm.blocked_message=m),style:{"min-height":"150px"},placeholder:"Увы и ах.. "},`
                     `,512),[[f,o.botUserForm.blocked_message]]),hs])])):h("",!0)]),t("div",_s,[fs,t("div",ps,[t("button",{type:"button",onClick:e[25]||(e[25]=m=>o.botUserForm.sex=!0),class:b([{"btn-info text-white":o.botUserForm.sex,"btn-outline-secondary":!o.botUserForm.sex},"w-100 btn"])},[gs,d(" Муж ")],2)]),t("div",ys,[t("button",{type:"button",onClick:e[26]||(e[26]=m=>o.botUserForm.sex=!1),class:b([{"btn-info text-white":!o.botUserForm.sex,"btn-outline-secondary":o.botUserForm.sex},"w-100 btn"])},[vs,d(" Жен ")],2)])]),o.messages.length>0?(i(!0),a(p,{key:0},w(o.messages,(m,x)=>(i(),a("div",ks,[t("p",Us,c(m||"Ошибка"),1),t("button",{type:"button",onClick:ja=>_.removeMessage(x),class:"close color-white opacity-60 font-16"},"× ",8,ws)]))),256)):h("",!0),$s],32)):h("",!0)],64)}const xs=$(bt,[["render",Fs]]),Cs=t("button",{type:"button","data-bs-toggle":"modal","data-bs-target":"#message-to-user",class:"btn btn-outline-light text-primary w-100 p-3"},"Написать пользователю сообщение",-1),Bs={class:"modal fade",id:"message-to-user",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},Ss={class:"modal-dialog modal-fullscreen"},Vs=t("div",{class:"modal-header"},[t("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"Админ. панель"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),js={class:"modal-body"},qs={class:"mb-3"},Os={class:"form-floating mb-3"},Ms=t("label",{for:"bill-info",class:"form-label"},"Написать сообщение",-1),Is={class:"form-check form-switch"},Ls=t("label",{for:"toggle-need-media"},"Нужен медиа контент",-1),Ts={key:0,class:"mb-3"},Ds={class:"modal-footer"},Ps=["disabled"],Rs={props:["botUser"],data(){return{loading:!1,locationForm:{info:null,content:null,content_type:null,need_media_content:!1}}},methods:{acceptUserInLocation(){this.loading=!0,this.$store.dispatch("userMessage",{dataObject:{user_telegram_chat_id:this.botUser.telegram_chat_id,...this.locationForm}}).then(n=>{this.loading=!1,this.locationForm.info=null,this.locationForm.content=null,this.locationForm.content_type=null,this.locationForm.need_media_content=!1,this.$notify({title:"Отлично!",text:"Вы отметили пользователя в заведении и отправили ему сообщение",type:"success"})}).catch(()=>{this.loading=!1,this.$notify({title:"Упс...!",text:"Ошибочка...",type:"error"})})},goToUserChatHistory(){this.$router.push({name:"AdminChatLog",params:{botUserId:this.botUser.id}})},selectMediaForMessage(n){this.locationForm.content=n.file_id||null,this.locationForm.content_type=n.type||null}}},Es=Object.assign(Rs,{__name:"MessageToUser",setup(n){return(e,s)=>(i(),a("div",null,[Cs,t("div",Bs,[t("div",Ss,[t("form",{onSubmit:s[3]||(s[3]=g((...l)=>e.acceptUserInLocation&&e.acceptUserInLocation(...l),["prevent"])),class:"modal-content"},[Vs,t("div",js,[t("div",qs,[t("a",{href:"javascript:void(0)",class:"btn btn-link w-100",onClick:s[0]||(s[0]=(...l)=>e.goToUserChatHistory&&e.goToUserChatHistory(...l))},"Глянуть историю переписки с пользователем")]),t("div",Os,[u(t("textarea",{class:"form-control",placeholder:"Текст сообщения","onUpdate:modelValue":s[1]||(s[1]=l=>e.locationForm.info=l),id:"bill-info",style:{"min-height":"200px"},required:""},null,512),[[f,e.locationForm.info]]),Ms]),t("div",Is,[u(t("input",{class:"form-check-input","onUpdate:modelValue":s[2]||(s[2]=l=>e.locationForm.need_media_content=l),type:"checkbox",role:"switch",id:"toggle-need-media"},null,512),[[v,e.locationForm.need_media_content]]),Ls]),e.locationForm.need_media_content?(i(),a("div",Ts,[y(O,{"need-audio":!0,"need-video-note":!0,"need-video":!0,"need-photo":!0,onSelect:e.selectMediaForMessage,selected:[e.locationForm.content]},null,8,["onSelect","selected"])])):h("",!0)]),t("div",Ds,[t("button",{disabled:e.loading,type:"submit",class:"btn btn-primary w-100 p-3"}," Отправить ",8,Ps)])],32)])])]))}}),Hs={props:["botUser"],data(){return{loading:!1,cashbackForm:{percent:null,need_custom_percents:!1,category:null,amount:null,info:null}}},computed:{...k(["getSelf","getCashBack","getCashBackPaginateObject"]),currentBot(){return window.currentBot}},methods:{removeCashBack(){if(!this.botUser.telegram_chat_id){this.$notify({title:"Упс!",text:"Вы должны выбрать пользователя!",type:"error"});return}this.loading=!0,this.$store.dispatch("removeCashBack",{dataObject:{user_telegram_chat_id:this.botUser.telegram_chat_id,...this.cashbackForm}}).then(n=>{this.loading=!1,this.cashbackForm.amount=0,this.cashbackForm.info=null,this.$notify({title:"Отлично!",text:"Вы успешно списали кэшбэк",type:"success"}),this.$emit("callback")}).catch(()=>{this.loading=!1,this.$notify({title:"Упс...!",text:"Ошибочка...",type:"error"})})}}},Xs=t("button",{type:"button","data-bs-toggle":"modal","data-bs-target":"#remove-cashback-from-user",class:"btn btn-outline-light text-primary w-100 p-3"},"Списать CashBack",-1),Ns={class:"modal fade",id:"remove-cashback-from-user",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},As={class:"modal-dialog modal-fullscreen"},zs=t("div",{class:"modal-header"},[t("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"Админ. панель"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Js={class:"modal-body"},Gs={class:"mb-2"},Ks={key:1},Ws=t("h6",null,"В боте поддерживается списание CashBack по категориям",-1),Ys={class:"form-floating mb-3"},Qs=t("option",{selected:"",value:null},"Общий CashBack",-1),Zs=["value"],to=t("label",{for:"floatingSelect"},"Категория CashBack-а",-1),eo={class:"form-floating mb-3"},so=t("label",{for:"bill-amount",class:"form-label"},"Сумма списания CashBack, руб",-1),oo={class:"form-floating mb-3"},lo=t("label",{for:"bill-info",class:"form-label"},"Причина списания",-1),io={class:"modal-footer"},ao=["disabled"];function no(n,e,s,l,o,_){return i(),a("div",null,[Xs,t("div",Ns,[t("div",As,[t("form",{onSubmit:e[3]||(e[3]=g((...r)=>_.removeCashBack&&_.removeCashBack(...r),["prevent"])),class:"modal-content"},[zs,t("div",Js,[t("p",null,[d("У пользователя "),t("strong",null,c(s.botUser.cashBack.amount||0)+" руб",1),d(" CashBack")]),s.botUser.cashBack.subs?(i(!0),a(p,{key:0},w(s.botUser.cashBack.subs,r=>(i(),a("p",Gs,c(r.title||"Без названия")+" - "+c(r.amount||0)+" руб. ",1))),256)):h("",!0),_.currentBot.cashback_config?(i(),a("div",Ks,[Ws,t("div",Ys,[u(t("select",{class:"form-select",id:"floatingSelect","onUpdate:modelValue":e[0]||(e[0]=r=>o.cashbackForm.category=r),required:""},[Qs,(i(!0),a(p,null,w(_.currentBot.cashback_config,r=>(i(),a("option",{value:r.title},c(r.title||"Без названия"),9,Zs))),256))],512),[[F,o.cashbackForm.category]]),to])])):h("",!0),t("div",eo,[u(t("input",{type:"number",min:"0",class:"form-control",id:"bill-amount","onUpdate:modelValue":e[1]||(e[1]=r=>o.cashbackForm.amount=r),placeholder:"Сумма",required:""},null,512),[[f,o.cashbackForm.amount]]),so]),t("div",oo,[u(t("textarea",{class:"form-control",placeholder:"Информация","onUpdate:modelValue":e[2]||(e[2]=r=>o.cashbackForm.info=r),style:{"min-height":"200px"},id:"bill-info",rows:"3",required:""},null,512),[[f,o.cashbackForm.info]]),lo])]),t("div",io,[t("button",{disabled:o.loading,type:"submit",class:"btn btn-primary w-100 p-3"}," Отправить ",8,ao)])],32)])])])}const ro=$(Hs,[["render",no]]),co={props:["botUser"],data(){return{loading:!1,cashbackForm:{percent:null,need_custom_percents:!1,need_user_review:!1,category:null,amount:null,message:null,info:null}}},computed:{...k(["getSelf","getCashBack","getCashBackPaginateObject"]),currentBot(){return window.currentBot},"cashbackForm.need_custom_percents":function(){this.cashbackForm.need_custom_percents||(this.cashbackForm.percent=null,this.cashbackForm.amount=null)}},methods:{addCashBack(){if(!this.botUser.telegram_chat_id){this.$notify({title:"Упс",text:"Вы должны выбрать пользователя!",type:"error"});return}this.loading=!0,this.$store.dispatch("addCashBack",{dataObject:{user_telegram_chat_id:this.botUser.telegram_chat_id,...this.cashbackForm}}).then(n=>{this.loading=!1,this.cashbackForm.amount=0,this.cashbackForm.info=null,this.cashbackForm.message=null,this.$emit("callback"),this.$notify({title:"Отлично!",text:"Вы успешно начислили кэшбэк",type:"success"})}).catch(()=>{this.loading=!1,this.$notify({title:"Упс...!",text:"Ошибочка...",type:"error"})})}}},uo=t("button",{type:"button","data-bs-toggle":"modal","data-bs-target":"#add-cashback-to-user",class:"btn btn-outline-light text-primary w-100 p-3"},"Начислить Баллы",-1),mo={class:"modal fade",id:"add-cashback-to-user",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},bo={class:"modal-dialog modal-fullscreen"},ho=t("div",{class:"modal-header"},[t("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"Админ. панель"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),_o={class:"modal-body"},fo={class:"mb-2"},po={class:"mb-2"},go={key:1},yo=t("h6",null,"В боте поддерживается начисление CashBack по категориям",-1),vo={class:"form-floating"},ko=t("option",{selected:"",value:null},"Общий CashBack",-1),Uo=["value"],wo=t("label",{for:"floatingSelect"},"Категории CashBack",-1),$o=t("em",null,"Начисления по реферальной системе происходя только для общего CashBack-а. CashBack-по категориям не суммируется с общим и отображается пользователю отдельно.",-1),Fo={class:"form-check my-3"},xo=t("label",{class:"form-check-label",for:"need_user_review"}," Нужен отзыв от пользователя ",-1),Co={class:"form-check my-3"},Bo=t("label",{class:"form-check-label",for:"need_custom_cashback_amount"}," Нужен нестандартный % CashBack ",-1),So={key:2,class:"form-floating mb-3"},Vo=t("label",{for:"bill-percent",class:"form-label"},"% CashBack-а",-1),jo={class:"form-floating mb-3"},qo=t("label",{for:"bill-amount",class:"form-label"},"Сумма в чеке, руб",-1),Oo={class:"form-floating mb-3"},Mo=t("label",{for:"bill-info",class:"form-label"},"Информация о чеке, номер",-1),Io={class:"form-floating mb-3"},Lo=t("label",{for:"message",class:"form-label"},"Комментарий для пользователя",-1),To={class:"modal-footer"},Do=["disabled"];function Po(n,e,s,l,o,_){return i(),a("div",null,[uo,t("div",mo,[t("div",bo,[t("form",{onSubmit:e[7]||(e[7]=g((...r)=>_.addCashBack&&_.addCashBack(...r),["prevent"])),class:"modal-content"},[ho,t("div",_o,[t("p",fo,[d("У пользователя "),t("strong",null,c(s.botUser.cashBack.amount||0)+" руб",1),d(" CashBack")]),s.botUser.cashBack.subs?(i(!0),a(p,{key:0},w(s.botUser.cashBack.subs,r=>(i(),a("p",po,c(r.title||"Без названия")+" - "+c(r.amount||0)+" руб. ",1))),256)):h("",!0),_.currentBot.cashback_config?(i(),a("div",go,[yo,t("div",vo,[u(t("select",{class:"form-control mb-2","onUpdate:modelValue":e[0]||(e[0]=r=>o.cashbackForm.category=r),required:""},[ko,(i(!0),a(p,null,w(_.currentBot.cashback_config,r=>(i(),a("option",{value:r.title},c(r.title||"Без названия"),9,Uo))),256))],512),[[F,o.cashbackForm.category]]),wo]),$o])):h("",!0),t("div",Fo,[u(t("input",{class:"form-check-input","onUpdate:modelValue":e[1]||(e[1]=r=>o.cashbackForm.need_user_review=r),type:"checkbox",value:"",id:"need_user_review"},null,512),[[v,o.cashbackForm.need_user_review]]),xo]),t("div",Co,[u(t("input",{class:"form-check-input","onUpdate:modelValue":e[2]||(e[2]=r=>o.cashbackForm.need_custom_percents=r),type:"checkbox",value:"",id:"need_custom_cashback_amount"},null,512),[[v,o.cashbackForm.need_custom_percents]]),Bo]),o.cashbackForm.need_custom_percents?(i(),a("div",So,[u(t("input",{type:"number",min:"0",class:"form-control",id:"bill-percent","onUpdate:modelValue":e[3]||(e[3]=r=>o.cashbackForm.percent=r),placeholder:"Значите %",required:""},null,512),[[f,o.cashbackForm.percent]]),Vo])):h("",!0),t("div",jo,[u(t("input",{type:"number",min:"0",class:"form-control",id:"bill-amount","onUpdate:modelValue":e[4]||(e[4]=r=>o.cashbackForm.amount=r),placeholder:"Сумма",required:""},null,512),[[f,o.cashbackForm.amount]]),qo]),t("div",Oo,[u(t("textarea",{class:"form-control",placeholder:"Информация","onUpdate:modelValue":e[5]||(e[5]=r=>o.cashbackForm.info=r),id:"bill-info",rows:"3",required:""},null,512),[[f,o.cashbackForm.info]]),Mo]),t("div",Io,[u(t("textarea",{class:"form-control",placeholder:"Комментарий","onUpdate:modelValue":e[6]||(e[6]=r=>o.cashbackForm.message=r),id:"message",style:{"min-height":"150px"}},null,512),[[f,o.cashbackForm.message]]),Lo])]),t("div",To,[t("button",{disabled:o.loading,type:"submit",class:"btn btn-primary w-100 p-3"}," Отправить ",8,Do)])],32)])])])}const Ro=$(co,[["render",Po]]),Eo={props:["botUser"],data(){return{silent_mode:!1,loading:!1,adminForm:{info:null}}},computed:{...k(["getSelf","getCashBack","getCashBackPaginateObject"]),currentBot(){return window.currentBot}},methods:{changeStatus(){this.loading=!0,this.$store.dispatch(this.botUser.is_admin?"removeAdmin":"addAdmin",{dataObject:{silent_mode:this.silent_mode,user_telegram_chat_id:this.botUser.telegram_chat_id,...this.adminForm}}).then(n=>{this.loading=!1,this.adminForm.info=null,this.$emit("callback"),this.$notify({title:"Отлично!",text:this.botUser.is_admin?"Вы успешно разжаловали администратора до уровня пользователя":"Вы успешно назначили пользователя администратором",type:"success"})}).catch(()=>{this.loading=!1,this.$notify({title:"Упс...!",text:"Ошибочка...",type:"error"})})}}},Ho=t("button",{type:"button","data-bs-toggle":"modal","data-bs-target":"#change-admin-status",class:"btn btn-outline-light text-primary w-100 p-3"},"Изменить статус администратора ",-1),Xo={class:"modal fade",id:"change-admin-status",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},No={class:"modal-dialog modal-fullscreen"},Ao=t("div",{class:"modal-header"},[t("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"Админ. панель"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),zo={class:"modal-body"},Jo={class:"form-check form-switch my-2"},Go=t("label",{class:"form-check-label",for:"switchCheckDefault"}," Тихий режим (не оповещать пользователя о смене статуса) ",-1),Ko={key:0},Wo={key:1},Yo={class:"text-primary fw-bold"},Qo={class:"form-floating mb-3"},Zo={for:"bill-info",class:"form-label"},tl={key:0},el={key:1},sl={class:"modal-footer"},ol=["disabled"];function ll(n,e,s,l,o,_){return i(),a("div",null,[Ho,t("div",Xo,[t("div",No,[t("form",{onSubmit:e[2]||(e[2]=g((...r)=>_.changeStatus&&_.changeStatus(...r),["prevent"])),class:"modal-content"},[Ao,t("div",zo,[t("div",Jo,[u(t("input",{class:"form-check-input","onUpdate:modelValue":e[0]||(e[0]=r=>o.silent_mode=r),type:"checkbox",role:"switch",id:"switchCheckDefault"},null,512),[[v,o.silent_mode]]),Go]),t("p",null,[d(" Вы хотите "),s.botUser.is_admin?(i(),a("span",Ko,"удалить из администраторов")):(i(),a("span",Wo,"назначить администратором")),d(" пользователя "),t("strong",Yo,c(s.botUser.fio_from_telegram||s.botUser.telegram_chat_id||"-"),1)]),t("div",Qo,[u(t("textarea",{class:"form-control",placeholder:"Информация","onUpdate:modelValue":e[1]||(e[1]=r=>o.adminForm.info=r),style:{"min-height":"300px"},id:"bill-info",required:""},null,512),[[f,o.adminForm.info]]),t("label",Zo,[s.botUser.is_admin?(i(),a("span",tl,"Причина удаления администратора")):(i(),a("span",el,"Причина добавления администратора"))])])]),t("div",sl,[t("button",{disabled:o.loading,type:"submit",class:"btn btn-primary w-100 p-3"}," Подтвердить ",8,ol)])],32)])])])}const il=$(Eo,[["render",ll]]),al={props:["botUser"],data(){return{loading:!1,userDataForm:{info:null}}},computed:{...k(["getSelf","getCashBack","getCashBackPaginateObject"]),currentBot(){return window.currentBot}},methods:{requestUserMenu(){this.loading=!0,this.$store.dispatch("requestRefreshMenu",{dataObject:{user_telegram_chat_id:this.botUser.telegram_chat_id,...this.userDataForm}}).then(n=>{this.loading=!1,this.userDataForm.info=null,this.$notify({title:"Отлично!",text:"Вы успешно отправили запрос на обновление меню!",type:"error"})}).catch(()=>{this.loading=!1,this.$notify({title:"Упс...!",text:"Ошибочка...",type:"error"})})}}},nl=t("button",{type:"button","data-bs-toggle":"modal","data-bs-target":"#refresh-user-menu",class:"btn btn-outline-light text-primary w-100 p-3"},"Обновить меню пользователю",-1),rl={class:"modal fade",id:"refresh-user-menu",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},dl={class:"modal-dialog modal-fullscreen"},cl=t("div",{class:"modal-header"},[t("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"Админ. панель"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),ul={class:"modal-body"},ml={class:"form-floating mb-3"},bl=t("label",{for:"bill-info",class:"form-label"},"Комментарий",-1),hl={class:"modal-footer"},_l=["disabled"];function fl(n,e,s,l,o,_){return i(),a("div",null,[nl,t("div",rl,[t("div",dl,[t("form",{onSubmit:e[1]||(e[1]=g((...r)=>_.requestUserMenu&&_.requestUserMenu(...r),["prevent"])),class:"modal-content"},[cl,t("div",ul,[t("div",ml,[u(t("textarea",{class:"form-control",placeholder:"Комментарий к запросу","onUpdate:modelValue":e[0]||(e[0]=r=>o.userDataForm.info=r),id:"bill-info",style:{"min-height":"200px"},required:""},null,512),[[f,o.userDataForm.info]]),bl])]),t("div",hl,[t("button",{disabled:o.loading,type:"submit",class:"btn btn-primary w-100 p-3"}," Отправить ",8,_l)])],32)])])])}const pl=$(al,[["render",fl]]),gl={props:["botUser"],data(){return{loading:!1,userDataForm:{info:null}}},computed:{...k(["getSelf","getCashBack","getCashBackPaginateObject"]),currentBot(){return window.currentBot}},methods:{requestUserData(){this.loading=!0,this.$store.dispatch("requestUserData",{dataObject:{user_telegram_chat_id:this.botUser.telegram_chat_id,...this.userDataForm}}).then(n=>{this.loading=!1,this.userDataForm.info=null,this.$notify({title:"Отлично!",text:"Вы отправили запрос на заполнение пользовательских данных",type:"success"})}).catch(()=>{this.loading=!1,this.$notify({title:"Упс...!",text:"Ошибочка...",type:"error"})})}}},yl=t("button",{type:"button","data-bs-toggle":"modal","data-bs-target":"#request-user-profile",class:"btn btn-outline-light text-primary w-100 p-3"},"Запросить заполнение анкеты",-1),vl={class:"modal fade",id:"request-user-profile",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},kl={class:"modal-dialog modal-fullscreen"},Ul=t("div",{class:"modal-header"},[t("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"Админ. панель"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),wl={class:"modal-body"},$l={class:"form-floating mb-3"},Fl=t("label",{for:"bill-info",class:"form-label"},"Комментарий",-1),xl={class:"modal-footer"},Cl=["disabled"];function Bl(n,e,s,l,o,_){return i(),a("div",null,[yl,t("div",vl,[t("div",kl,[t("form",{onSubmit:e[1]||(e[1]=g((...r)=>_.requestUserData&&_.requestUserData(...r),["prevent"])),class:"modal-content"},[Ul,t("div",wl,[t("div",$l,[u(t("textarea",{class:"form-control",placeholder:"Комментарий к запросу","onUpdate:modelValue":e[0]||(e[0]=r=>o.userDataForm.info=r),style:{"min-height":"150px"},id:"bill-info",rows:"3",required:""},null,512),[[f,o.userDataForm.info]]),Fl])]),t("div",xl,[t("button",{disabled:o.loading,type:"submit",class:"btn btn-primary w-100 p-3"}," Отправить ",8,Cl)])],32)])])])}const Sl=$(gl,[["render",Bl]]),Vl={props:["botUser"],data(){return{loading:!1,invoiceForm:{amount:100,info:null}}},computed:{...k(["getSelf","getCashBack","getCashBackPaginateObject"]),currentBot(){return window.currentBot}},methods:{sendInvoice(){this.loading=!0,this.$store.dispatch("sendInvoice",{dataObject:{user_telegram_chat_id:this.botUser.telegram_chat_id,...this.invoiceForm}}).then(n=>{this.loading=!1,this.invoiceForm.info=null,this.$emit("callback"),this.$notify({title:"Отлично!",text:"Вы успешно отправили пользователю запрос на оплату",type:"success"})}).catch(()=>{this.loading=!1,this.$notify({title:"Упс...!",text:"Ошибочка...",type:"error"})})}}},jl=t("button",{type:"button","data-bs-toggle":"modal","data-bs-target":"#request-invoice",class:"btn btn-outline-light text-primary w-100 p-3"},"Запрос на оплату",-1),ql={class:"modal fade",id:"request-invoice",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},Ol={class:"modal-dialog modal-fullscreen"},Ml=t("div",{class:"modal-header"},[t("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"Админ. панель"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Il={class:"modal-body"},Ll={class:"form-floating mb-3"},Tl=t("label",{for:"bill-amount",class:"form-label"},"Значение на оплату, руб",-1),Dl={class:"form-floating mb-3"},Pl=t("label",{for:"bill-info",class:"form-label"},"Введите сообщение для пользователя",-1),Rl={class:"modal-footer"},El=["disabled"];function Hl(n,e,s,l,o,_){return i(),a("div",null,[jl,t("div",ql,[t("div",Ol,[t("form",{onSubmit:e[2]||(e[2]=g((...r)=>_.sendInvoice&&_.sendInvoice(...r),["prevent"])),class:"modal-content"},[Ml,t("div",Il,[t("div",Ll,[u(t("input",{class:"form-control",type:"number",min:"100",step:"50",placeholder:"100","onUpdate:modelValue":e[0]||(e[0]=r=>o.invoiceForm.amount=r),id:"bill-amount",required:""},null,512),[[f,o.invoiceForm.amount]]),Tl]),t("div",Dl,[u(t("textarea",{class:"form-control",placeholder:"Текст запроса","onUpdate:modelValue":e[1]||(e[1]=r=>o.invoiceForm.info=r),id:"bill-info",style:{"min-height":"200px"},required:""},null,512),[[f,o.invoiceForm.info]]),Pl])]),t("div",Rl,[t("button",{disabled:o.loading,type:"submit",class:"btn btn-primary w-100 p-3"}," Отправить запрос ",8,El)])],32)])])])}const Xl=$(Vl,[["render",Hl]]),Nl=t("button",{type:"button","data-bs-toggle":"modal","data-bs-target":"#request-user-review",class:"btn btn-outline-light text-primary w-100 p-3"},"Запросить оценку",-1),Al={class:"modal fade",id:"request-user-review",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},zl={class:"modal-dialog modal-fullscreen"},Jl=t("div",{class:"modal-header"},[t("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"Админ. панель"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Gl={class:"modal-body"},Kl={class:"form-floating mb-3"},Wl=t("label",{for:"bill-info",class:"form-label"},"Сообщение для пользователя",-1),Yl={class:"modal-footer"},Ql=["disabled"],Zl={props:["botUser"],data(){return{loading:!1,reviewForm:{message:null}}},methods:{requestReview(){this.loading=!0,this.$store.dispatch("userReviewRequest",{dataObject:{telegram_chat_id:this.botUser.telegram_chat_id,...this.reviewForm}}).then(n=>{this.loading=!1,this.reviewForm.message=null,this.$notify({title:"Отлично!",text:"Вы запросили у пользователя оставить отзыв!",type:"success"})}).catch(()=>{this.loading=!1,this.$notify({title:"Упс...!",text:"Ошибочка...",type:"error"})})}}},ti=Object.assign(Zl,{__name:"RequestReview",setup(n){return(e,s)=>(i(),a("div",null,[Nl,t("div",Al,[t("div",zl,[t("form",{onSubmit:s[1]||(s[1]=g((...l)=>e.requestReview&&e.requestReview(...l),["prevent"])),class:"modal-content"},[Jl,t("div",Gl,[t("div",Kl,[u(t("textarea",{class:"form-control",placeholder:"Текст сообщения","onUpdate:modelValue":s[0]||(s[0]=l=>e.reviewForm.message=l),id:"bill-info",style:{"min-height":"200px"}},null,512),[[f,e.reviewForm.message]]),Wl])]),t("div",Yl,[t("button",{disabled:e.loading,type:"submit",class:"btn btn-primary w-100 p-3"}," Отправить ",8,Ql)])],32)])])]))}});const ei=t("div",{class:"divider mb-3"},"Управление заказом",-1),si={class:"text-center my-3 fw-bold text-primary d-flex justify-content-between"},oi=t("a",{"data-bs-toggle":"modal","data-bs-target":"#order-details",href:"javascript:void(0)"},[t("i",{class:"fa-solid fa-circle-info"}),d(" Детали заказа")],-1),li={key:0,class:"alert alert-danger"},ii=t("strong",{class:"fw-bold"},"Внимание!",-1),ai={class:"btn-group mb-2 w-100",role:"group"},ni=t("button",{type:"button","data-bs-toggle":"modal","data-bs-target":"#message-settings",class:"btn btn-outline-primary w-auto d-flex justify-content-center align-items-center",style:{"max-width":"60px"},"aria-expanded":"false"},[t("i",{class:"fa-solid fa-cogs"})],-1),ri={class:"btn-group mb-2 w-100",role:"group"},di=t("button",{type:"button","data-bs-toggle":"modal","data-bs-target":"#message-settings",class:"btn btn-outline-primary w-auto d-flex justify-content-center align-items-center",style:{"max-width":"60px"},"aria-expanded":"false"},[t("i",{class:"fa-solid fa-cogs"})],-1),ci={class:"btn-group mb-2 w-100",role:"group"},ui=t("button",{type:"button","data-bs-toggle":"modal","data-bs-target":"#message-settings",class:"btn btn-outline-primary w-auto d-flex justify-content-center align-items-center",style:{"max-width":"60px"},"aria-expanded":"false"},[t("i",{class:"fa-solid fa-cogs"})],-1),mi={class:"btn-group mb-2 w-100",role:"group"},bi=t("button",{type:"button","data-bs-toggle":"modal","data-bs-target":"#message-settings",class:"btn btn-outline-primary w-auto d-flex justify-content-center align-items-center",style:{"max-width":"60px"},"aria-expanded":"false"},[t("i",{class:"fa-solid fa-cogs"})],-1),hi=["disabled"],_i={key:0,class:"color-white"},fi={key:1,class:"color-white"},pi=t("button",{type:"button","data-bs-toggle":"modal","data-bs-target":"#message-settings",class:"btn btn-outline-primary w-auto d-flex justify-content-center align-items-center",style:{"max-width":"60px"},"aria-expanded":"false"},[t("i",{class:"fa-solid fa-cogs"})],-1),gi=t("div",{class:"divider my-3"},"Самовывоз",-1),yi=t("button",{type:"button","data-bs-toggle":"modal","data-bs-target":"#order-self-delivery",class:"btn btn-outline-success p-3 w-100"},[t("i",{class:"fa fa-shopping-bag mr-2","aria-hidden":"true"}),d("Готово (самовывоз) ")],-1),vi=t("div",{class:"divider my-3"},"Отмена заказа",-1),ki={class:"btn-group mb-2 w-100",role:"group"},Ui=t("i",{class:"fa-solid fa-triangle-exclamation mr-2"},null,-1),wi=t("button",{type:"button","data-bs-toggle":"modal","data-bs-target":"#message-settings",class:"btn btn-outline-primary w-auto d-flex justify-content-center align-items-center",style:{"max-width":"60px"},"aria-expanded":"false"},[t("i",{class:"fa-solid fa-cogs"})],-1),$i=t("i",{class:"fa-solid fa-triangle-exclamation mr-2"},null,-1),Fi={key:1,class:"alert alert-light d-flex flex-column align-items-center justify-content-center"},xi=t("div",{class:"spinner-border text-primary mt-3",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),Ci={class:"mb-0"},Bi=t("i",{class:"fa-solid fa-triangle-exclamation text-danger"},null,-1),Si={class:"modal fade",id:"order-self-delivery","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"staticBackdropLabel","aria-hidden":"true"},Vi={class:"modal-dialog modal-fullscreen"},ji={class:"modal-content"},qi=t("div",{class:"modal-header"},[t("h1",{class:"modal-title fs-5",id:"staticBackdropLabel"},"Самовывоз"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Oi={class:"modal-body"},Mi={class:"form-floating mb-3"},Ii=t("label",{for:"pickup-form-info",class:"form-label"},"Написать сообщение",-1),Li=t("button",{"data-bs-dismiss":"modal","aria-label":"Close",type:"submit",class:"btn btn-primary w-100 p-3"}," Отправить ",-1),Ti={class:"modal fade",id:"order-details","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"staticBackdropLabel","aria-hidden":"true"},Di={class:"modal-dialog modal-fullscreen"},Pi={class:"modal-content"},Ri=t("div",{class:"modal-header"},[t("h1",{class:"modal-title fs-5",id:"staticBackdropLabel"},"Детали заказа"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Ei={class:"modal-body"},Hi={class:"modal fade",id:"message-settings",tabindex:"-1","aria-labelledby":"message-settings","aria-hidden":"true"},Xi={class:"modal-dialog modal-fullscreen"},Ni=t("div",{class:"modal-header"},[t("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"Настройка сообщений"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Ai={class:"modal-body"},zi={class:"form-floating mb-2"},Ji={for:"floatingTextarea2"},Gi={key:0},Ki={class:"form-floating mb-2"},Wi={for:"floatingTextarea2"},Yi={key:0},Qi={class:"form-floating mb-2"},Zi={for:"floatingTextarea2"},ta={key:0},ea={class:"form-floating mb-2"},sa={for:"floatingTextarea2"},oa={key:0},la={class:"form-floating mb-2"},ia={for:"floatingTextarea2"},aa={key:0},na=t("div",{class:"modal-footer"},[t("button",{type:"submit",class:"btn btn-primary w-100 p-3","data-bs-dismiss":"modal"},[t("i",{class:"fa fa-floppy-o mr-2","aria-hidden":"true"}),d(" Сохранить настройки ")])],-1),ra={props:["orderId","botUser"],data(){return{loaded:!0,order:{status:0},errors:[],spent_time_counter:0,settings:{order_status_0:"Статус вашего заказа установлен как 'Принят в работу'",order_status_1:"Статус вашего заказа изменен на 'Доставляется'",order_status_2:"Статус вашего заказа изменен на 'Завершен'",order_status_3:"Статус вашего заказа изменен на 'Отменен'",order_status_4:"Статус вашего заказа изменен на 'Готов к доставке'",order_status_5:"Статус вашего заказа изменен на 'Передан на кухню'"},pickupForm:{info:null}}},computed:{currentBot(){return window.currentBot}},mounted(){this.orderId&&this.loadOrderById(),this.currentBot.settings&&(this.settings.order_status_0=this.currentBot.settings.order_status_0||"Статус вашего заказа установлен как 'Принят в работу'",this.settings.order_status_1=this.currentBot.settings.order_status_1||"Статус вашего заказа изменен на 'Доставляется'",this.settings.order_status_2=this.currentBot.settings.order_status_2||"Статус вашего заказа изменен на 'Завершен'",this.settings.order_status_3=this.currentBot.settings.order_status_3||"Статус вашего заказа изменен на 'Отменен'",this.settings.order_status_4=this.currentBot.settings.order_status_4||"Статус вашего заказа изменен на 'Готов к доставке'",this.settings.order_status_5=this.currentBot.settings.order_status_5||"Статус вашего заказа изменен на 'Передан на кухню'"),localStorage.getItem("cashman_order_cashback_add_counter")!=null&&this.startTimer(localStorage.getItem("cashman_order_cashback_add_counter")||0)},methods:{sendPickupMessage(){this.$store.dispatch("userMessage",{dataObject:{user_telegram_chat_id:this.botUser.telegram_chat_id,...this.pickupForm}}).then(n=>{this.pickupForm.info=null,this.$notify({title:"Отлично!",text:"Вы отправили пользователю сообщение",type:"success"})}).catch(()=>{this.$notify({title:"Упс...!",text:"Ошибочка...",type:"error"})})},loadOrderById(){this.errors=[],this.loaded=!1,this.$store.dispatch("loadOrderById",{dataObject:{order_id:this.orderId}}).then(n=>{this.order=n.data,this.loaded=!0}).catch(()=>{this.$notify({title:"Упс...!",text:"Ошибка загрузки заказа",type:"error"}),this.errors.push(`Заказ #${this.orderId} не найден в системе!`)})},startTimer(n){this.spent_time_counter=n!=null?Math.min(n,10):10;let e=setInterval(()=>{this.spent_time_counter>0?this.spent_time_counter--:(clearInterval(e),this.is_requested=!1,this.spent_time_counter=null),localStorage.setItem("cashman_order_cashback_add_counter",this.spent_time_counter)},1e3)},autoCashback(){this.startTimer(),this.$store.dispatch("addCashBackToOrder",{order_id:this.orderId}).then(()=>{this.order.is_cashback_crediting=!0,this.$notify({title:"Отзывы",text:"Вы успешно начислили баллы пользователю",type:"success"})}).catch(()=>{this.order.is_cashback_crediting=!1,this.$notify({title:"Отзывы",text:"Ошибка начисления баллов",type:"error"})})},storeTextConfig(){this.$store.dispatch("storeMessageSettings",{dataObject:{settings:this.settings}}).then(n=>{this.$notify({title:"Отлично!",text:"Данные успешно сохранены",type:"success"})}).catch(()=>{this.$notify({title:"Упс...!",text:"Ошибка сохранения данных",type:"error"})})},declineOrder(){this.$store.dispatch("declineOrder",{dataObject:{order_id:this.orderId}}).then(n=>{this.$notify({title:"Отлично!",text:"Вы отклонили заказ и изменили его статус!",type:"success"})}).catch(()=>{this.$notify({title:"Упс...!",text:"Ошибка смены статуса заказа!",type:"error"})})},changeStatus(n){this.order.status=n,this.$store.dispatch("changeOrderStatus",{dataObject:{order_id:this.orderId,user_telegram_chat_id:this.botUser.telegram_chat_id||null,status:n}}).then(e=>{this.$notify({title:"Отлично!",text:"Вы изменили статус заказа",type:"success"})}).catch(()=>{this.$notify({title:"Упс...!",text:"Ошибка смены статуса заказа!",type:"error"})})}}},da=Object.assign(ra,{__name:"LastOrderHandler",setup(n){return(e,s)=>(i(),a(p,null,[ei,e.loaded&&e.errors.length===0?(i(),a(p,{key:0},[t("p",si,[t("span",null,"Заказ №"+c(n.orderId),1),oi]),e.order.status===0?(i(),a("div",li,[ii,d(" Заказ еще не взят в работу! Выберите актуальный статус из предложенных ниже! ")])):h("",!0),t("div",ai,[t("button",{type:"button",class:b([{"current-step-success text-primary fw-bold":e.order.status===5},"btn btn-outline-primary p-3"]),onClick:s[0]||(s[0]=l=>e.changeStatus(5))},"Принять в работу ",2),ni]),t("div",ri,[t("button",{type:"button",class:b([{"current-step text-primary fw-bold":e.order.status===4},"btn btn-outline-primary p-3"]),onClick:s[1]||(s[1]=l=>e.changeStatus(4))},"Передать на доставку ",2),di]),t("div",ci,[t("button",{type:"button",class:b([{"current-step text-primary fw-bold":e.order.status===1},"btn btn-outline-primary p-3"]),onClick:s[2]||(s[2]=l=>e.changeStatus(1))},"Доставляется ",2),ui]),t("div",mi,[t("button",{type:"button",class:b([{"current-step text-primary fw-bold":e.order.status===2},"btn btn-outline-primary p-3"]),onClick:s[3]||(s[3]=l=>e.changeStatus(2))},"Прибыло к заказчику ",2),bi]),t("div",{class:"btn-group mb-2 w-100",onClick:s[4]||(s[4]=(...l)=>e.autoCashback&&e.autoCashback(...l)),role:"group"},[t("button",{type:"button",disabled:e.order.is_cashback_crediting||e.spent_time_counter>0,class:b([{"current-step-success text-primary fw-bold":e.order.is_cashback_crediting},"btn btn-outline-primary p-3"])},[e.spent_time_counter<=0?(i(),a("span",_i,"Начислить баллы")):(i(),a("span",fi,"Осталось ждать "+c(e.spent_time_counter||0)+" сек.",1))],10,hi),pi]),gi,yi,vi,t("div",ki,[t("button",{type:"button",class:b([{"current-step-danger text-danger fw-bold":e.order.status===3},"btn btn-outline-danger p-3"]),onClick:s[5]||(s[5]=l=>e.changeStatus(3))},[Ui,d(" Отклонить заказ ")],2),wi]),t("button",{type:"button",onClick:s[6]||(s[6]=(...l)=>e.declineOrder&&e.declineOrder(...l)),class:"btn btn-outline-danger p-3 w-100 mb-3"},[$i,d(" Закрыть заказ без оповещения ")])],64)):(i(),a("div",Fi,[e.errors.length===0?(i(),a(p,{key:0},[d(" Данные о заказе еще не загружены! "),xi],64)):(i(!0),a(p,{key:1},w(e.errors,l=>(i(),a("p",Ci,[Bi,d(" "+c(l),1)]))),256))])),t("div",Si,[t("div",Vi,[t("div",ji,[qi,t("div",Oi,[t("form",{onSubmit:s[8]||(s[8]=g((...l)=>e.sendPickupMessage&&e.sendPickupMessage(...l),["prevent"]))},[t("div",Mi,[u(t("textarea",{class:"form-control",placeholder:"Текст сообщения","onUpdate:modelValue":s[7]||(s[7]=l=>e.pickupForm.info=l),id:"pickup-form-info",style:{"min-height":"200px"},required:""},null,512),[[f,e.pickupForm.info]]),Ii]),Li],32)])])])]),t("div",Ti,[t("div",Di,[t("div",Pi,[Ri,t("div",Ei,[e.loaded?(i(),U(j,{key:0,item:e.order},null,8,["item"])):h("",!0)])])])]),t("div",Hi,[t("div",Xi,[t("form",{class:"modal-content",onSubmit:s[14]||(s[14]=g((...l)=>e.storeTextConfig&&e.storeTextConfig(...l),["prevent"]))},[Ni,t("div",Ai,[t("div",zi,[u(t("textarea",{class:"form-control","onUpdate:modelValue":s[9]||(s[9]=l=>e.settings.order_status_5=l),maxlength:"512",placeholder:"Leave a comment here",id:"floatingTextarea2",style:{height:"100px"}},null,512),[[f,e.settings.order_status_5]]),t("label",Ji,[d("Заказ принят в работу "),(e.settings.order_status_5||"").length>0?(i(),a("span",Gi,c(e.settings.order_status_5.length)+"/512",1)):h("",!0)])]),t("div",Ki,[u(t("textarea",{class:"form-control","onUpdate:modelValue":s[10]||(s[10]=l=>e.settings.order_status_1=l),maxlength:"512",placeholder:"Leave a comment here",id:"floatingTextarea2",style:{height:"100px"}},null,512),[[f,e.settings.order_status_1]]),t("label",Wi,[d("Заказ передан на доставку "),(e.settings.order_status_1||"").length>0?(i(),a("span",Yi,c(e.settings.order_status_1.length)+"/512",1)):h("",!0)])]),t("div",Qi,[u(t("textarea",{class:"form-control","onUpdate:modelValue":s[11]||(s[11]=l=>e.settings.order_status_4=l),maxlength:"512",placeholder:"Leave a comment here",id:"floatingTextarea2",style:{height:"100px"}},null,512),[[f,e.settings.order_status_4]]),t("label",Zi,[d("Заказ доставляется "),(e.settings.order_status_4||"").length>0?(i(),a("span",ta,c(e.settings.order_status_4.length)+"/512",1)):h("",!0)])]),t("div",ea,[u(t("textarea",{class:"form-control","onUpdate:modelValue":s[12]||(s[12]=l=>e.settings.order_status_2=l),maxlength:"512",placeholder:"Leave a comment here",id:"floatingTextarea2",style:{height:"100px"}},null,512),[[f,e.settings.order_status_2]]),t("label",sa,[d("Заказ был доставлен "),(e.settings.order_status_2||"").length>0?(i(),a("span",oa,c(e.settings.order_status_2.length)+"/512",1)):h("",!0)])]),t("div",la,[u(t("textarea",{class:"form-control","onUpdate:modelValue":s[13]||(s[13]=l=>e.settings.order_status_3=l),maxlength:"512",placeholder:"Leave a comment here",id:"floatingTextarea2",style:{height:"100px"}},null,512),[[f,e.settings.order_status_3]]),t("label",ia,[d("Заказ отклонен "),(e.settings.order_status_3||"").length>0?(i(),a("span",aa,c(e.settings.order_status_3.length)+"/512",1)):h("",!0)])])]),na],32)])])],64))}}),ca={class:"btn-group w-100 my-3 px-3",style:{"overflow-x":"auto"},role:"group","aria-label":"Basic example"},ua={key:0},ma={key:1},ba={key:2},ha={key:3},_a=t("div",{class:"divider"},"Сервисы",-1),fa={props:["modelValue"],data(){return{work_with_orders:!1,loading:!1,reloadUsers:!1,order_id:null,tab:0,botUser:null,request_telegram_chat_id:null}},computed:{...k(["getSelf"]),currentBot(){return window.currentBot}},mounted(){const n=new URLSearchParams(window.location.search);this.order_id=JSON.parse(n.get("order_id")),this.order_id&&(this.work_with_orders=!0),this.modelValue&&this.$nextTick(()=>{this.botUser=this.modelValue,this.work_with_orders&&(this.tab=2)})},methods:{updateUserInfo(){this.reloadUsers=!0,this.botUser=null,this.request_telegram_chat_id=null,this.$nextTick(()=>{this.reloadUsers=!1})}}},pa=Object.assign(fa,{__name:"UserProfileCard",setup(n){return(e,s)=>(i(),a(p,null,[t("div",ca,[t("button",{type:"button",class:b([{"btn-primary":e.tab===0,"btn-outline-primary":e.tab!==0},"btn"]),onClick:s[0]||(s[0]=l=>e.tab=0)},"Информация ",2),t("button",{type:"button",onClick:s[1]||(s[1]=l=>e.tab=2),class:b([{"btn-primary":e.tab===2,"btn-outline-primary":e.tab!==2},"btn"])},"Управление ",2),t("button",{type:"button",onClick:s[2]||(s[2]=l=>e.tab=1),class:b([{"btn-primary":e.tab===1,"btn-outline-primary":e.tab!==1},"btn"])},"CashBack ",2),t("button",{type:"button",onClick:s[3]||(s[3]=l=>e.tab=3),class:b([{"btn-primary":e.tab===3,"btn-outline-primary":e.tab!==3},"btn"])},"Заказы ",2)]),e.tab===0?(i(),a("div",ua,[e.botUser&&!e.reloadUsers?(i(),U(xs,{key:0,onUpdate:e.updateUserInfo,"bot-user":e.botUser},null,8,["onUpdate","bot-user"])):h("",!0)])):h("",!0),e.tab===1?(i(),a("div",ma,[e.botUser?(i(),U(M,{key:0,"bot-user":e.botUser},null,8,["bot-user"])):h("",!0)])):h("",!0),e.tab===3?(i(),a("div",ba,[e.botUser?(i(),U(q,{key:0,"bot-user":e.botUser},null,8,["bot-user"])):h("",!0)])):h("",!0),e.botUser&&e.tab===2?(i(),a("div",ha,[e.work_with_orders?(i(),U(da,{key:0,class:"mb-2","order-id":e.order_id,"bot-user":e.botUser},null,8,["order-id","bot-user"])):h("",!0),_a,y(Es,{class:"mb-2","bot-user":e.botUser},null,8,["bot-user"]),y(ti,{class:"mb-2","bot-user":e.botUser},null,8,["bot-user"]),y(ro,{class:"mb-2","bot-user":e.botUser},null,8,["bot-user"]),y(Ro,{class:"mb-2","bot-user":e.botUser},null,8,["bot-user"]),y(il,{class:"mb-2","bot-user":e.botUser},null,8,["bot-user"]),y(pl,{class:"mb-2","bot-user":e.botUser},null,8,["bot-user"]),y(Sl,{class:"mb-2","bot-user":e.botUser},null,8,["bot-user"]),y(Xl,{class:"mb-2","bot-user":e.botUser},null,8,["bot-user"])])):h("",!0)],64))}}),ga={class:"container py-3"},ya={class:"row"},va={class:"col-12"},ka={class:"nav nav-tabs justify-content-center catalog-tabs"},Ua={class:"nav-item"},wa=t("i",{class:"fa-solid fa-users mr-2"},null,-1),$a={class:"nav-item"},Fa=["disabled"],xa=t("i",{class:"fa-solid fa-user-secret mr-2"},null,-1),Ca={class:"col-12"},Ba={key:0,class:"col-12"},Sa={key:1,class:"alert alert-light mt-2"},Va={data(){return{loadedUser:!1,tab:0,request_telegram_chat_id:null,selected_bot_user:null}},computed:{...k(["getSelf"]),currentBot(){return window.currentBot},tg(){return window.Telegram.WebApp}},mounted(){this.getSelf&&(this.selected_bot_user=this.getSelf);const n=new URLSearchParams(window.location.search);let e=JSON.parse(n.get("user")),s=n.has("hide_menu")||!1;e&&(this.request_telegram_chat_id=e,this.loadReceiverUserData()),this.tg.BackButton.show(),this.tg.BackButton.onClick(()=>{document.querySelectorAll('[data-bs-dismiss="modal"]').forEach(l=>l.click()),s?this.tg.close():this.$router.back()})},methods:{updateUserInfo(){this.selected_bot_user=null,this.request_telegram_chat_id=null},cancelUserSelected(){this.request_telegram_chat_id=null,this.selected_bot_user=null,window.scroll(0,0)},selectUser(n){this.request_telegram_chat_id=n.telegram_chat_id,this.loadReceiverUserData()},loadReceiverUserData(){this.loadedUser=!1,this.selected_bot_user=null,this.$store.dispatch("loadReceiverUserData",{dataObject:{user_telegram_chat_id:this.request_telegram_chat_id}}).then(n=>{this.selected_bot_user=n.data,this.request_telegram_chat_id=this.selected_bot_user.telegram_chat_id,this.$nextTick(()=>{this.loadedUser=!0,this.tab=1,window.scroll(0,0)})}).catch(()=>{this.loadedUser=!1})}}},Ha=Object.assign(Va,{__name:"Clients",setup(n){return(e,s)=>(i(),a("div",ga,[t("div",ya,[t("div",va,[t("ul",ka,[t("li",Ua,[t("button",{type:"button",class:b(["nav-link",{active:e.tab===0}]),onClick:s[0]||(s[0]=l=>e.tab=0),style:{"font-weight":"bold"},"aria-current":"page"},[wa,d("Клиенты ")],2)]),t("li",$a,[t("button",{type:"button",class:b(["nav-link",{active:e.tab===1}]),onClick:s[1]||(s[1]=l=>e.tab=1),disabled:!e.selected_bot_user,style:{"font-weight":"bold"}},[xa,d("Результат ")],10,Fa)])])]),u(t("div",Ca,[y(mt,{"selected-bot-user":e.selected_bot_user,onCancel:e.cancelUserSelected,onSelect:e.selectUser},null,8,["selected-bot-user","onCancel","onSelect"])],512),[[S,e.tab===0]]),e.tab===1?(i(),a("div",Ba,[e.loadedUser?(i(),U(pa,{key:0,modelValue:e.selected_bot_user,"onUpdate:modelValue":s[2]||(s[2]=l=>e.selected_bot_user=l)},null,8,["modelValue"])):(i(),a("div",Sa," Пользователь еще не выбран! "))])):h("",!0)])]))}});export{Ha as default};
