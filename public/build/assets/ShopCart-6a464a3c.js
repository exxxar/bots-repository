import{_ as z}from"./CartProductList-25795ff9.js";import{o,k as i,n as t,u as k,L as m,M as n,N as u,Y as f,F as p,p as a,j as $,K as T,a0 as v,l as b,O as P,a3 as F,bB as U,a1 as q,w as C,H as V,aZ as E,aL as M,U as R,W as A}from"./index.es-c4852431.js";import{g as N,c as I,s as j,a as w,b as H}from"./commonMethods-8bc36d87.js";import{_ as S}from"./_plugin-vue_export-helper-c27b6911.js";import{S as x}from"./SelectOffice-2d6fe3c6.js";/* empty css                                                    */import{_ as J}from"./ProductCard-580d9e29.js";import{S as W,C as G}from"./carousel.es-39a2ec14.js";import"./ProductCardSimple-2492c86f.js";import"./CollectionCardSimple-d6c4fe49.js";import"./v4-4a60fe23.js";const K={class:"opacity-75 mb-2 mt-2 d-flex justify-content-between","data-bs-container":"body","data-bs-toggle":"popover","data-bs-placement":"top","data-bs-content":"Введи промокод и нажми на кнопку рядом чтоб узнать % скидки!"},Y=t("span",null,[a("Промокод на скидку "),t("i",{class:"fa-regular fa-circle-question"})],-1),Z={key:0},Q={key:1,class:"spinner-border spinner-border-sm text-primary",role:"status"},X=t("span",{class:"visually-hidden"},"Loading...",-1),ee=[X],te=t("div",{class:"alert-light border-primary alert mb-2"},[t("span",{class:"text-primary fw-bold"},"Внимание!"),a(" После активации промокода его нельзя использовать повторно! ")],-1),se={class:"form-floating mb-2"},oe=["disabled"],ie=t("label",{for:"floatingInput"},"Ваш промокод",-1),re=["disabled"],le=t("i",{class:"fa-solid fa-tags"},null,-1),ne={key:0},ae={key:1},de={name:"App",data(){return{spent_time:0,is_requested:!1,discount:0,discount_in_percent:!1,activate_price:0,promocodeForm:{code:null}}},watch:{"promocodeForm.code":{handler:function(l){this.discount=0},deep:!0}},mounted(){[...document.querySelectorAll('[data-bs-toggle="popover"]')].map(e=>new bootstrap.Popover(e)),this.is_requested=I(),window.addEventListener("trigger-spent-timer",e=>{this.spent_time=e.detail})},methods:{submit(){this.promocodeForm.code!=null&&(j(10),this.is_requested=!0,this.$store.dispatch("activateShopDiscountPromocode",{promocodeForm:this.promocodeForm}).then(l=>{this.is_requested=!1,this.discount=l.discount||0,this.discount_in_percent=l.discount_in_percent||!1,this.activate_price=l.activate_price||0,this.$notify({title:"Промокод",text:"Промокод успешно активирован!",type:"success"}),this.$emit("callback",{code:this.promocodeForm.code||null,discount:this.discount||0,discount_in_percent:this.discount_in_percent||!1,activate_price:this.activate_price||0})}).catch(()=>{this.is_requested=!1,this.discount=0,this.activate_price=0,this.$emit("callback",{code:this.promocodeForm.code||null,discount:0,discount_in_percent:!1,activate_price:0}),this.$notify({title:"Промокод",text:"Ошибка активации промокода!",type:"error"})}))}}},ce=Object.assign(de,{setup(l){return(e,r)=>(o(),i(p,null,[t("h6",K,[Y,k(N)()>0?(o(),i("span",Z,m(e.spent_time)+" сек.",1)):n("",!0),e.is_requested?(o(),i("div",Q,ee)):n("",!0)]),te,t("div",se,[u(t("input",{type:"text",disabled:e.spent_time>0,"onUpdate:modelValue":r[0]||(r[0]=c=>e.promocodeForm.code=c),class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,8,oe),[[f,e.promocodeForm.code]]),ie]),e.discount===0?(o(),i("button",{key:0,type:"button",onClick:r[1]||(r[1]=(...c)=>e.submit&&e.submit(...c)),disabled:e.spent_time>0,class:"btn btn-primary p-3 w-100 mb-2"},[le,e.spent_time>0?(o(),i("span",ne," Осталось ждать "+m(e.spent_time)+" сек.",1)):(o(),i("span",ae," Активировать"))],8,re)):n("",!0)],64))}}),me={class:"card my-3"},ue={class:"card-body p-2"},_e={class:"list-group list-group-flush"},pe={class:"list-group-item"},ye={class:"mb-0 d-flex justify-content-between"},he={class:"list-group-item"},fe={class:"mb-0 d-flex justify-content-between"},ve=t("sup",null,".00",-1),be={key:0,class:"list-group-item"},ge={class:"mb-0 d-flex justify-content-between"},Fe={key:0},ke={key:1},we={key:1,class:"list-group-item"},$e={"data-bs-toggle":"modal","data-bs-target":"#promocode-modal",class:"mb-0 d-flex justify-content-between"},Ve={key:0,class:"fw-bold"},Ce={key:1,class:"text-primary"},Te=t("i",{class:"fa-solid fa-percent px-2"},null,-1),Pe=t("span",{class:"text-decoration-underline"},"Ввести промокод",-1),Se=[Te,Pe],je={key:0,class:"list-group-item"},qe={"data-bs-toggle":"modal","data-bs-target":"#person-modal",class:"mb-0 d-flex justify-content-between"},Ie={class:"fw-bold text-primary"},Ue=t("i",{class:"fa-solid fa-people-group mr-2"},null,-1),Le={key:1,class:"list-group-item"},De={class:"mb-2 d-flex justify-content-between"},Be=["data-bs-toggle","data-bs-target"],Oe={key:1,class:"d-flex justify-content-end text-decoration-underline"},ze=t("i",{class:"fa-solid fa-money-bill-wave"},null,-1),Ee={key:2},Me=t("p",{class:"my-3 text-center"},"Мы можем подготовить для вас сдачу с:",-1),Re={class:"row row-cols-2 mb-0"},Ae={class:"col"},Ne=["onClick"],He=t("p",{class:"mb-2"},[t("em",null,"или введите другую сумму...")],-1),xe={class:"form-floating"},Je=t("label",{for:"data-money"},"С какой суммы нужна сдача",-1),We={class:"list-group-item"},Ge={class:"mb-0 d-flex justify-content-between"},Ke={class:"fw-bold"},Ye={key:0,class:"list-group-item"},Ze={class:"mb-0 d-flex justify-content-between"},Qe={class:"fw-bold text-primary"},Xe={class:"fw-bold text-primary"},et={key:1,class:"list-group-item"},tt={class:"mb-0 d-flex justify-content-between"},st={class:"fw-bold"},ot={key:4,class:"list-group-item"},it={class:"mb-0 d-flex justify-content-between"},rt={class:"fw-bold"},lt={class:"list-group-item"},nt={class:"mb-0 d-flex justify-content-between"},at={class:"fw-bold"},dt=["innerHTML"],ct={key:1},mt={class:"fw-bold"},ut={class:"modal fade",id:"promocode-modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},_t={class:"modal-dialog modal-dialog-centered"},pt={class:"modal-content"},yt={class:"modal-body"},ht={key:0,class:"text-center py-3 border-primary border rounded-2"},ft={class:"fw-bold"},vt={class:"modal fade",id:"person-modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},bt={class:"modal-dialog modal-dialog-centered"},gt={class:"modal-content"},Ft={class:"modal-body"},kt=t("h6",{class:"opacity-75 mb-3"},"Укажите на сколько человек добавить приборы?",-1),wt={class:"row text-center"},$t={class:"col-4"},Vt=t("i",{class:"fa-solid fa-minus font-22"},null,-1),Ct=[Vt],Tt={class:"col-4 d-flex justify-content-center align-items-center"},Pt={class:"fw-bold",style:{"font-size":"16px"}},St={class:"col-4"},jt=t("i",{class:"fa-solid fa-plus font-22"},null,-1),qt=[jt],It={props:["modelValue"],data(){return{deliveryForm:null,moneyVariants:[500,1e3,2e3,5e3]}},watch:{deliveryForm:{handler:function(l){this.$emit("update:modelValue",this.deliveryForm)},deep:!0},modelValue:{handler:function(l){this.deliveryForm=l},deep:!0},cartTotalPrice:{handler:function(l){this.settings.free_shipping_starts_from<=this.cartTotalPrice&&(this.deliveryForm.delivery_price=0)},deep:!0}},computed:{...$(["cartProducts","cartProducts","cartTotalCount","cartTotalPrice","getSelf"]),bot(){return window.currentBot},settings(){return this.bot.settings},finallyPrice(){var r,c;let l=(r=this.deliveryForm)!=null&&r.use_cashback?this.cartTotalPrice-w():this.cartTotalPrice,e=this.settings.need_automatic_delivery_request?(((c=this.deliveryForm.cdek.tariff)==null?void 0:c.delivery_sum)||0)+(this.deliveryForm.delivery_price||0):0;return l+e}},mounted(){this.deliveryForm=this.modelValue},methods:{goToProductCart(){document.dispatchEvent(new Event("switch-to-cart"))},recalcDeliveryPrice(){this.$emit("calc-delivery-price")},activateDiscount(l){this.deliveryForm.discount=l.discount||0},decPersons(){this.deliveryForm.persons=this.deliveryForm.persons>1?this.deliveryForm.persons-1:this.deliveryForm.persons},incPersons(){this.deliveryForm.persons=this.deliveryForm.persons<100?this.deliveryForm.persons+1:this.deliveryForm.persons}}},L=Object.assign(It,{__name:"Summary",setup(l){return(e,r)=>{var c,s,_,h,d;return e.deliveryForm!=null?(o(),i(p,{key:0},[t("div",me,[t("div",ue,[t("ul",_e,[t("li",pe,[t("p",ye,[a("Суммарно, ед. "),t("strong",{class:"text-decoration-underline text-primary",onClick:r[0]||(r[0]=(...y)=>e.goToProductCart&&e.goToProductCart(...y))},m(e.cartTotalCount)+" шт.",1)])]),t("li",he,[t("p",fe,[a("Цена "),t("strong",null,[a(m(e.cartTotalPrice)+" ",1),ve,a("₽")])])]),(c=e.deliveryForm)!=null&&c.use_cashback?(o(),i("li",be,[t("p",ge,[a("Оплата бонусами "),(s=e.deliveryForm)!=null&&s.use_cashback?(o(),i("strong",Fe,m(k(w)())+" ₽",1)):(o(),i("strong",ke,"-"))])])):n("",!0),e.settings.need_promo_code?(o(),i("li",we,[t("p",$e,[a(" Промокод "),((_=e.deliveryForm)==null?void 0:_.discount)>0?(o(),i("strong",Ve,m(e.deliveryForm.discount)+" ₽ ",1)):(o(),i("strong",Ce,Se))])])):n("",!0),e.settings.shop_display_type==0?(o(),i(p,{key:2},[e.settings.need_person_counter&&e.settings.shop_display_type==0?(o(),i("li",je,[t("p",qe,[a("Число гостей "),t("strong",Ie,[Ue,a(m(e.deliveryForm.persons)+" чел.",1)])])])):n("",!0),e.deliveryForm.need_pickup?n("",!0):(o(),i("li",Le,[t("p",De,[a(" Цена доставки "),e.settings.need_automatic_delivery_request?(o(),i("span",{key:0,class:"d-flex justify-content-end text-decoration-underline","data-bs-toggle":e.deliveryForm.delivery_price>0?"modal":null,"data-bs-target":e.deliveryForm.delivery_price>0?"#delivery-price-modal":null},[e.deliveryForm.delivery_price>0?(o(),i(p,{key:0},[a(m(e.deliveryForm.delivery_price)+"₽ ",1)],64)):(o(),i(p,{key:1},[a(" не рассчитана ")],64))],8,Be)):(o(),i("span",Oe,[a(" Рассчитывается курьером "),t("span",{class:"text-primary underline fw-bold cursor-pointer",onClick:r[1]||(r[1]=(...y)=>e.recalcDeliveryPrice&&e.recalcDeliveryPrice(...y))}," (повторить расчет) ")]))]),e.deliveryForm.delivery_price===0?(o(),i("button",{key:0,type:"button",class:"w-100 p-3 btn btn-primary",onClick:r[2]||(r[2]=(...y)=>e.recalcDeliveryPrice&&e.recalcDeliveryPrice(...y))},[ze,a(" Рассчитать цену доставки ")])):n("",!0)])),e.deliveryForm.payment_type===3&&e.settings.can_use_cash?(o(),i("div",Ee,[Me,t("div",Re,[(o(!0),i(p,null,T(e.moneyVariants,y=>(o(),i("div",Ae,[t("button",{class:v(["btn btn-outline-primary w-100 mb-2 rounded-5",{"btn-primary text-white":e.deliveryForm.money===y}]),type:"button",onClick:g=>e.deliveryForm.money=y},m(y)+"₽ ",11,Ne)]))),256))]),He,t("div",xe,[u(t("input",{type:"number",min:"0","onUpdate:modelValue":r[3]||(r[3]=y=>e.deliveryForm.money=y),class:"form-control",id:"data-money",placeholder:"С какой суммы нужна сдача"},null,512),[[f,e.deliveryForm.money]]),Je])])):n("",!0)],64)):n("",!0),e.settings.shop_display_type==1&&e.deliveryForm.cdek.tariff&&e.settings.need_automatic_delivery_request?(o(),i(p,{key:3},[t("li",We,[t("p",Ge,[a("Тариф "),t("strong",Ke,m(e.deliveryForm.cdek.tariff.tariff_name),1)])]),e.settings.need_hide_delivery_period?n("",!0):(o(),i("li",Ye,[t("p",Ze,[a("Время доставки займет от "),t("strong",Qe,m(e.deliveryForm.cdek.tariff.calendar_min),1),a(" до "),t("strong",Xe,m(e.deliveryForm.cdek.tariff.calendar_max),1),a(" дней ")])])),e.settings.need_automatic_delivery_request?(o(),i("li",et,[t("p",tt,[a("Стоимость доставки "),t("strong",st,m(e.deliveryForm.cdek.tariff.delivery_sum)+" ₽",1)])])):n("",!0)],64)):n("",!0),(h=e.deliveryForm)!=null&&h.discount?(o(),i("li",ot,[t("p",it,[a("Величина скидки "),t("strong",rt,m((d=e.deliveryForm)==null?void 0:d.discount)+" ₽",1)])])):n("",!0),t("li",lt,[t("p",nt,[a("Итого, цена "),t("strong",at,m(e.finallyPrice)+" ₽",1)])])])])]),e.settings.delivery_price_text?(o(),i("p",{key:0,innerHTML:e.settings.delivery_price_text},null,8,dt)):n("",!0),(e.settings.min_price||0)>e.cartTotalPrice?(o(),i("p",ct,[a("Минимальная цена заказа "),t("strong",mt,m(e.settings.min_price||0)+" руб",1)])):n("",!0),t("div",ut,[t("div",_t,[t("div",pt,[t("div",yt,[b(ce,{onCallback:e.activateDiscount},null,8,["onCallback"]),e.deliveryForm.discount>0?(o(),i("h6",ht,[a("Скидка за промокод "),t("strong",ft,m(e.deliveryForm.discount)+" ₽",1)])):n("",!0)])])])]),t("div",vt,[t("div",bt,[t("div",gt,[t("div",Ft,[kt,t("div",wt,[t("div",$t,[t("button",{onClick:r[4]||(r[4]=(...y)=>e.decPersons&&e.decPersons(...y)),type:"button",class:"btn p-2 w-100 btn-primary"},Ct)]),t("div",Tt,[t("strong",Pt,m(e.deliveryForm.persons),1)]),t("div",St,[t("button",{type:"button",onClick:r[5]||(r[5]=(...y)=>e.incPersons&&e.incPersons(...y)),class:"btn p-2 w-100 btn-primary"},qt)])])])])])])],64)):n("",!0)}}}),Ut={key:0,class:"list-group my-3"},Lt=t("i",{class:"fa-solid fa-file-invoice mr-2"},null,-1),Dt={class:"d-inline-flex justify-content-between w-100 px-2"},Bt={style:{width:"45px"},alt:""},Ot=t("i",{class:"fa-solid fa-earth-americas mr-2"},null,-1),zt=t("span",{class:"px-2"},"Онлайн через бота",-1),Et=[Ot,zt],Mt=t("i",{class:"fa-regular fa-credit-card mr-2"},null,-1),Rt=t("span",{class:"px-2"},"Картой",-1),At=[Mt,Rt],Nt=t("i",{class:"fa-solid fa-file-invoice mr-2"},null,-1),Ht=t("span",{class:"px-2"},"Переводом",-1),xt=[Nt,Ht],Jt=t("i",{class:"fa-regular fa-money-bill-1 mr-2"},null,-1),Wt=t("span",{class:"px-2"},"Наличными",-1),Gt=[Jt,Wt],Kt=t("h6",{class:"opacity-75"},[a("Бонусы "),t("small",null,"(нажми для использования)")],-1),Yt={class:"card-body"},Zt={class:"d-flex justify-content-between mb-0"},Qt=t("span",null," Списать баллы",-1),Xt={props:["modelValue"],data(){return{deliveryForm:null}},watch:{deliveryForm:{handler:function(l){this.$emit("update:modelValue",this.deliveryForm)},deep:!0},modelValue:{handler:function(l){this.deliveryForm=l},deep:!0}},mounted(){this.deliveryForm=this.modelValue,this.settings.can_use_sbp&&(this.deliveryForm.payment_type=4)},computed:{...$(["cartProducts","cartProducts","cartTotalCount","cartTotalPrice","getSelf"]),settings(){return this.bot.settings},bot(){return window.currentBot}}},D=Object.assign(Xt,{__name:"PaymentTypes",setup(l){return(e,r)=>{var s;const c=P("lazy");return o(),i(p,null,[e.deliveryForm?(o(),i("div",Ut,[e.settings.can_use_sbp?(o(),i("a",{key:0,href:"javascript:void(0)",class:v([{active:e.deliveryForm.payment_type===4},"list-group-item list-group-item-action p-3 d-flex align-items-center"]),onClick:r[0]||(r[0]=_=>e.deliveryForm.payment_type=4)},[Lt,t("span",Dt,[a(" Оплата по СБП "),u(t("img",Bt,null,512),[[c,"/images/СБП_логотип.svg"]])])],2)):n("",!0),e.settings.can_use_card&&e.settings.payment_token!=null?(o(),i("a",{key:1,href:"javascript:void(0)",onClick:r[1]||(r[1]=_=>e.deliveryForm.payment_type=0),class:v([{active:e.deliveryForm.payment_type===0},"list-group-item list-group-item-action p-3"]),"aria-current":"true"},Et,2)):n("",!0),e.deliveryForm.pick_up_type==0&&e.settings.can_use_cash?(o(),i("a",{key:2,href:"javascript:void(0)",class:v([{active:e.deliveryForm.payment_type===1},"list-group-item list-group-item-action p-3"]),onClick:r[2]||(r[2]=_=>e.deliveryForm.payment_type=1)},At,2)):n("",!0),e.settings.can_use_cash?(o(),i("a",{key:3,href:"javascript:void(0)",class:v([{active:e.deliveryForm.payment_type===2},"list-group-item list-group-item-action p-3"]),onClick:r[3]||(r[3]=_=>e.deliveryForm.payment_type=2)},xt,2)):n("",!0),e.settings.can_use_cash?(o(),i("a",{key:4,href:"javascript:void(0)",class:v([{active:e.deliveryForm.payment_type===3},"list-group-item list-group-item-action p-3"]),onClick:r[4]||(r[4]=_=>e.deliveryForm.payment_type=3)},Gt,2)):n("",!0)])):n("",!0),e.settings.need_bonuses_section&&k(w)()>0?(o(),i(p,{key:1},[Kt,t("div",{class:v(["card my-3",{"text-bg-primary":(s=e.deliveryForm)==null?void 0:s.use_cashback}]),onClick:r[5]||(r[5]=_=>{var h;return e.deliveryForm.use_cashback=!((h=e.deliveryForm)!=null&&h.use_cashback)})},[t("div",Yt,[t("p",Zt,[Qt,t("strong",null,m(k(w)())+"₽",1)])])],2)],64)):n("",!0)],64)}}}),es={props:["modelValue"],data(){return{offer_agreement:!1}},watch:{modelValue:{handler:function(l){this.offer_agreement=l},deep:!0},offer_agreement:{handler:function(l){this.$emit("update:modelValue",this.offer_agreement)},deep:!0}},mounted(){this.offer_agreement=this.modelValue||!1},computed:{bot(){return window.currentBot},settings(){return this.bot.settings}}},ts={key:0,class:"alert alert-light my-2 border-primary"},ss={class:"mb-2"},os=["href"],is=t("a",{href:"https://www.consultant.ru/document/cons_doc_LAW_61801/",target:"_blank"}," Федеральному закону №152-ФЗ ",-1),rs={class:"form-check form-switch"},ls=t("label",{class:"form-check-label fw-bold",for:"offerSwitch"},"Я соглашаюсь",-1),ns={key:1,class:"alert alert-light my-2 border-primary"},as=t("p",{class:"mb-2"}," Нажимая кнопку, вы соглашаетесь с условиями договора оферты данной компании. ",-1),ds={class:"form-check form-switch"},cs=t("label",{class:"form-check-label fw-bold",for:"offerSwitch"},"Я соглашаюсь",-1);function ms(l,e,r,c,s,_){var h,d;return(h=_.bot.company.law_params)!=null&&h.offer_link?(o(),i("div",ts,[t("p",ss,[a(" Нажимая кнопку, вы соглашаетесь с условиями "),t("a",{href:(d=_.bot.company.law_params)==null?void 0:d.offer_link,class:"fw-bold",target:"_blank"},"договора оферты",8,os),a(", а также вы даете согласие на обработку персональных данных согласно "),is]),t("div",rs,[u(t("input",{"onUpdate:modelValue":e[0]||(e[0]=y=>s.offer_agreement=y),class:"form-check-input",type:"checkbox",role:"switch",id:"offerSwitch",checked:""},null,512),[[F,s.offer_agreement]]),ls])])):(o(),i("div",ns,[as,t("div",ds,[u(t("input",{"onUpdate:modelValue":e[1]||(e[1]=y=>s.offer_agreement=y),class:"form-check-input",type:"checkbox",role:"switch",id:"offerSwitch",checked:""},null,512),[[F,s.offer_agreement]]),cs])]))}const B=S(es,[["render",ms]]),us={props:["modelValue","mode"],data(){return{deliveryForm:null,need_select_table_by_number:!1}},watch:{deliveryForm:{handler:function(l){localStorage.setItem("cashman_self_product_delivery_form_address",this.deliveryForm.address||""),localStorage.setItem("cashman_self_product_delivery_form_city",this.deliveryForm.city||""),localStorage.setItem("cashman_self_product_delivery_form_street",this.deliveryForm.street||""),localStorage.setItem("cashman_self_product_delivery_form_building",this.deliveryForm.building||""),localStorage.setItem("cashman_self_product_delivery_form_flat_number",this.deliveryForm.flat_number||""),localStorage.setItem("cashman_self_product_delivery_form_entrance_number",this.deliveryForm.entrance_number||""),(this.deliveryForm.disabilities||[]).length>0?localStorage.setItem("cashman_self_product_delivery_form_entrance_disabilities",JSON.stringify(this.deliveryForm.disabilities||[])):localStorage.removeItem("cashman_self_product_delivery_form_entrance_disabilities"),this.$emit("update:modelValue",this.deliveryForm)},deep:!0},modelValue:{handler:function(l){this.deliveryForm=l},deep:!0}},mounted(){this.deliveryForm=this.modelValue,this.deliveryForm.name=localStorage.getItem("cashman_self_product_delivery_form_name")!=null?localStorage.getItem("cashman_self_product_delivery_form_name"):null,this.deliveryForm.phone=localStorage.getItem("cashman_self_product_delivery_form_phone")!=null?localStorage.getItem("cashman_self_product_delivery_form_phone"):null,this.deliveryForm.address=localStorage.getItem("cashman_self_product_delivery_form_address")!=null?localStorage.getItem("cashman_self_product_delivery_form_address"):null,this.deliveryForm.city=localStorage.getItem("cashman_self_product_delivery_form_city")!=null?localStorage.getItem("cashman_self_product_delivery_form_city"):null,this.deliveryForm.street=localStorage.getItem("cashman_self_product_delivery_form_street")!=null?localStorage.getItem("cashman_self_product_delivery_form_street"):null,this.deliveryForm.building=localStorage.getItem("cashman_self_product_delivery_form_building")!=null?localStorage.getItem("cashman_self_product_delivery_form_building"):null,this.deliveryForm.flat_number=localStorage.getItem("cashman_self_product_delivery_form_flat_number")!=null?localStorage.getItem("cashman_self_product_delivery_form_flat_number"):null,this.deliveryForm.entrance_number=localStorage.getItem("cashman_self_product_delivery_form_entrance_number")!=null?localStorage.getItem("cashman_self_product_delivery_form_entrance_number"):null,this.deliveryForm.disabilities=localStorage.getItem("cashman_self_product_delivery_form_entrance_disabilities")!=null?JSON.parse(localStorage.getItem("cashman_self_product_delivery_form_entrance_disabilities")):[],this.deliveryForm.disabilities.length>0&&(this.deliveryForm.has_disability=!0)},computed:{bot(){return window.currentBot},settings(){return this.bot.settings}}},_s={class:"form-floating mb-2"},ps=t("label",{for:"deliveryForm-name"},[a("Ф.И.О. "),t("span",{class:"fw-bold text-danger"},"*")],-1),ys={class:"form-floating mb-2"},hs=t("label",{for:"deliveryForm-phone"},[a("Номер телефона "),t("span",{class:"fw-bold text-danger"},"*")],-1),fs={class:"form-floating"},vs=t("label",{for:"deliveryForm-info"},"Информация для сотрудника",-1),bs={class:"form-floating mb-2"},gs=t("label",{for:"deliveryForm-name"},[a("Ф.И.О. "),t("span",{class:"fw-bold text-danger"},"*")],-1),Fs={class:"form-floating mb-2"},ks=t("label",{for:"deliveryForm-phone"},[a("Номер телефона "),t("span",{class:"fw-bold text-danger"},"*")],-1),ws={class:"form-floating mb-2"},$s=t("label",{for:"deliveryForm-city"},[a("Ваш город "),t("span",{class:"fw-bold text-danger"},"*")],-1),Vs={class:"form-floating mb-2"},Cs=t("label",{for:"deliveryForm-street"},[a("Улица "),t("span",{class:"fw-bold text-danger"},"*")],-1),Ts={class:"form-floating mb-2"},Ps=t("label",{for:"deliveryForm-building"},[a("Номер дома "),t("span",{class:"fw-bold text-danger"},"*")],-1),Ss={class:"form-floating mb-2"},js=t("label",{for:"deliveryForm-flat-number"},"Номер квартиры ",-1),qs={class:"form-floating mb-2"},Is=t("label",{for:"deliveryForm-entrance-number"},"Номер подъезда",-1),Us={class:"form-floating mb-2"},Ls=t("label",{for:"deliveryForm-floor-number"},"Номер этажа",-1),Ds={class:"form-check form-switch mb-2"},Bs=t("label",{class:"form-check-label",for:"select-table-number-from-list"},"Выбрать номер столика из списка",-1),Os={key:0,class:"row row-cols-5"},zs={class:"col"},Es=["onClick"],Ms={key:1,class:"form-floating mb-2"},Rs=t("label",{for:"deliveryForm-table-number"},"Номер столика",-1),As={class:"form-floating"},Ns={key:0,for:"deliveryForm-info"},Hs={key:1,for:"deliveryForm-info"},xs=t("h6",{class:"opacity-75 mt-3"},"К какому времени приготовить?",-1),Js={class:"list-group my-3"},Ws=t("i",{class:"fa-solid fa-stopwatch-20 mr-2"},null,-1),Gs=t("span",{class:"px-2"},"По готовности",-1),Ks=[Ws,Gs],Ys=t("i",{class:"fa-regular fa-clock mr-2"},null,-1),Zs=t("span",{class:"px-2"},"К указанному времени",-1),Qs=[Ys,Zs],Xs={key:0,class:"form-floating"},eo=t("label",{for:"deliveryForm-time"},"Время доставки",-1),to={key:0,class:"opacity-75 mt-3"},so={key:1,class:"list-group my-3"},oo=t("i",{class:"fa-regular fa-heart mr-2"},null,-1),io=t("span",{class:"px-2"},"Нет ограничений по здоровью",-1),ro=[oo,io],lo=t("i",{class:"fa-solid fa-house-medical-flag mr-2"},null,-1),no=t("span",{class:"px-2"},"Есть ограничения по здоровью",-1),ao=[lo,no],co={key:2,class:"list-group my-3"},mo={href:"javascript:void(0)",class:"list-group-item list-group-item-action p-3 d-flex justify-content-between","aria-current":"true"},uo=t("label",{for:"switch-1"},[t("i",{class:"fa-solid fa-head-side-mask mr-2"}),a(" Болею")],-1),_o={href:"javascript:void(0)",class:"list-group-item list-group-item-action p-3 d-flex justify-content-between","aria-current":"true"},po=t("label",{for:"switch-5"},[t("i",{class:"fa-solid fa-ear-deaf mr-2"}),a(" Плохо слышит \\ говорит")],-1),yo={href:"javascript:void(0)",class:"list-group-item list-group-item-action p-3 d-flex justify-content-between","aria-current":"true"},ho=t("label",{for:"switch-3"},[t("i",{class:"fa-solid fa-glasses mr-2"}),a(" Слабовидящий")],-1),fo={href:"javascript:void(0)",class:"list-group-item list-group-item-action p-3 d-flex justify-content-between","aria-current":"true"},vo=t("label",{for:"switch-4"},[t("i",{class:"fa-solid fa-wheelchair mr-2"}),a(" Ограничения мобильности")],-1),bo={href:"javascript:void(0)",class:"list-group-item list-group-item-action p-3 d-flex justify-content-between","aria-current":"true"},go=t("label",{for:"switch-5"},[t("i",{class:"fa-solid fa-person-dots-from-line mr-2"}),a(" Пищевая аллергия")],-1),Fo={key:3,class:"form-floating mb-2"},ko=t("label",{for:"floatingInput"},[a("Укажите на что аллергия "),t("span",{class:"fw-bold text-danger"},"*")],-1);function wo(l,e,r,c,s,_){const h=P("mask");return o(),i(p,null,[r.mode===1&&s.deliveryForm?(o(),i(p,{key:0},[t("div",_s,[u(t("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=d=>s.deliveryForm.name=d),class:"form-control",id:"deliveryForm-name",placeholder:"Иванов Иван Иванович",required:""},null,512),[[f,s.deliveryForm.name]]),ps]),t("div",ys,[u(t("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=d=>s.deliveryForm.phone=d),class:"form-control",id:"deliveryForm-phone",placeholder:"+7(000)000-00-00",required:""},null,512),[[h,"+7(###)###-##-##"],[f,s.deliveryForm.phone]]),hs]),t("div",fs,[u(t("textarea",{class:"form-control","onUpdate:modelValue":e[2]||(e[2]=d=>s.deliveryForm.info=d),style:{height:"200px","line-height":"150%"},placeholder:"Информация",id:"deliveryForm-info"},null,512),[[f,s.deliveryForm.info]]),vs])],64)):n("",!0),r.mode===0&&s.deliveryForm?(o(),i(p,{key:1},[t("div",bs,[u(t("input",{type:"text","onUpdate:modelValue":e[3]||(e[3]=d=>s.deliveryForm.name=d),class:"form-control",id:"deliveryForm-name",placeholder:"Иванов Иван Иванович",required:""},null,512),[[f,s.deliveryForm.name]]),gs]),t("div",Fs,[u(t("input",{type:"text","onUpdate:modelValue":e[4]||(e[4]=d=>s.deliveryForm.phone=d),class:"form-control",id:"deliveryForm-phone",placeholder:"+7(000)000-00-00",required:""},null,512),[[h,"+7(###)###-##-##"],[f,s.deliveryForm.phone]]),ks]),s.deliveryForm.need_pickup?(o(),i(p,{key:1},[_.settings.need_table_list?(o(),i(p,{key:0},[t("div",Ds,[u(t("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":e[11]||(e[11]=d=>s.need_select_table_by_number=d),role:"switch",id:"select-table-number-from-list"},null,512),[[F,s.need_select_table_by_number]]),Bs]),s.need_select_table_by_number?(o(),i("div",Os,[(o(!0),i(p,null,T(parseInt(_.settings.max_tables),d=>(o(),i("div",zs,[t("a",{href:"javascript:void(0)",onClick:y=>s.deliveryForm.table_number=d,class:v([{"btn-primary":s.deliveryForm.table_number==d,"btn-outline-primary":s.deliveryForm.table_number!=d},"btn w-100 mb-2"])},m(d),11,Es)]))),256))])):n("",!0)],64)):n("",!0),s.deliveryForm.pick_up_type=="0"?(o(),i("div",Ms,[u(t("input",{type:"number",min:"1",max:"200","onUpdate:modelValue":e[12]||(e[12]=d=>s.deliveryForm.table_number=d),class:"form-control",id:"deliveryForm-table-number",placeholder:"Номер столика"},null,512),[[f,s.deliveryForm.table_number]]),Rs])):n("",!0)],64)):(o(),i(p,{key:0},[t("div",ws,[u(t("input",{type:"text","onUpdate:modelValue":e[5]||(e[5]=d=>s.deliveryForm.city=d),class:"form-control",id:"deliveryForm-city",placeholder:"Ваш город",required:""},null,512),[[f,s.deliveryForm.city]]),$s]),t("div",Vs,[u(t("input",{type:"text","onUpdate:modelValue":e[6]||(e[6]=d=>s.deliveryForm.street=d),class:"form-control",id:"deliveryForm-street",placeholder:"Улица",required:""},null,512),[[f,s.deliveryForm.street]]),Cs]),t("div",Ts,[u(t("input",{type:"text","onUpdate:modelValue":e[7]||(e[7]=d=>s.deliveryForm.building=d),class:"form-control",id:"deliveryForm-building",placeholder:"Номер дома",required:""},null,512),[[f,s.deliveryForm.building]]),Ps]),t("div",Ss,[u(t("input",{type:"text","onUpdate:modelValue":e[8]||(e[8]=d=>s.deliveryForm.flat_number=d),class:"form-control",id:"deliveryForm-flat-number",placeholder:"Номер квартиры"},null,512),[[f,s.deliveryForm.flat_number]]),js]),t("div",qs,[u(t("input",{type:"text","onUpdate:modelValue":e[9]||(e[9]=d=>s.deliveryForm.entrance_number=d),class:"form-control",id:"deliveryForm-entrance-number",placeholder:"Номер подъезда"},null,512),[[f,s.deliveryForm.entrance_number]]),Is]),t("div",Us,[u(t("input",{type:"text","onUpdate:modelValue":e[10]||(e[10]=d=>s.deliveryForm.floor_number=d),class:"form-control",id:"deliveryForm-floor-number",placeholder:"Номер этажа"},null,512),[[f,s.deliveryForm.floor_number]]),Ls])],64)),t("div",As,[u(t("textarea",{class:"form-control","onUpdate:modelValue":e[13]||(e[13]=d=>s.deliveryForm.info=d),style:{height:"200px","line-height":"150%"},placeholder:"Информация",id:"deliveryForm-info"},null,512),[[f,s.deliveryForm.info]]),s.deliveryForm.need_pickup?(o(),i("label",Hs,"Информация для сотрудника")):(o(),i("label",Ns,"Информация для доставщика"))]),s.deliveryForm.need_pickup?n("",!0):(o(),i(p,{key:2},[xs,t("div",Js,[t("a",{href:"javascript:void(0)",class:v([{active:s.deliveryForm.when_ready},"list-group-item list-group-item-action p-3"]),onClick:e[14]||(e[14]=d=>s.deliveryForm.when_ready=!0),"aria-current":"true"},Ks,2),t("a",{href:"javascript:void(0)",onClick:e[15]||(e[15]=d=>s.deliveryForm.when_ready=!1),class:v([{active:!s.deliveryForm.when_ready},"list-group-item list-group-item-action p-3"])},Qs,2)]),s.deliveryForm.when_ready?n("",!0):(o(),i("div",Xs,[u(t("input",{type:"datetime-local","onUpdate:modelValue":e[16]||(e[16]=d=>s.deliveryForm.time=d),class:"form-control",id:"deliveryForm-time",placeholder:"Время доставки",required:""},null,512),[[f,s.deliveryForm.time]]),eo]))],64)),_.settings.need_health_restrictions?(o(),i(p,{key:3},[s.deliveryForm.need_pickup?n("",!0):(o(),i("h6",to,"Ограничения по здоровью")),s.deliveryForm.need_pickup?n("",!0):(o(),i("div",so,[t("a",{href:"javascript:void(0)",onClick:e[17]||(e[17]=d=>s.deliveryForm.has_disability=!1),class:v([{active:!s.deliveryForm.has_disability},"list-group-item list-group-item-action p-3"])},ro,2),t("a",{href:"javascript:void(0)",class:v([{active:s.deliveryForm.has_disability},"list-group-item list-group-item-action p-3"]),onClick:e[18]||(e[18]=d=>s.deliveryForm.has_disability=!0),"aria-current":"true"},ao,2)])),s.deliveryForm.has_disability&&!s.deliveryForm.need_pickup?(o(),i("div",co,[t("a",mo,[uo,u(t("input",{type:"checkbox",value:"болею",class:"form-check-input","onUpdate:modelValue":e[19]||(e[19]=d=>s.deliveryForm.disabilities=d),id:"switch-1"},null,512),[[F,s.deliveryForm.disabilities]])]),t("a",_o,[po,u(t("input",{type:"checkbox",value:"плохо слышит или говорит",class:"form-check-input","onUpdate:modelValue":e[20]||(e[20]=d=>s.deliveryForm.disabilities=d),id:"switch-5"},null,512),[[F,s.deliveryForm.disabilities]])]),t("a",yo,[ho,u(t("input",{type:"checkbox",value:"слабовидящий",class:"form-check-input","onUpdate:modelValue":e[21]||(e[21]=d=>s.deliveryForm.disabilities=d),id:"switch-3"},null,512),[[F,s.deliveryForm.disabilities]])]),t("a",fo,[vo,u(t("input",{type:"checkbox",class:"form-check-input",value:"ограничения мобильности","onUpdate:modelValue":e[22]||(e[22]=d=>s.deliveryForm.disabilities=d),id:"switch-4"},null,512),[[F,s.deliveryForm.disabilities]])]),t("a",bo,[go,u(t("input",{type:"checkbox",class:"form-check-input",value:"пищевая аллергия","onUpdate:modelValue":e[23]||(e[23]=d=>s.deliveryForm.disabilities=d),id:"switch-5"},null,512),[[F,s.deliveryForm.disabilities]])])])):n("",!0),s.deliveryForm.disabilities.indexOf("пищевая аллергия")!==-1?(o(),i("div",Fo,[u(t("input",{type:"text",class:"form-control","onUpdate:modelValue":e[24]||(e[24]=d=>s.deliveryForm.allergy=d),id:"floatingInput",placeholder:"name@example.com",required:""},null,512),[[f,s.deliveryForm.allergy]]),ko])):n("",!0)],64)):n("",!0)],64)):n("",!0)],64)}const O=S(us,[["render",wo]]),$o={props:["modelValue"],data(){return{deliveryForm:null}},watch:{deliveryForm:{handler:function(l){this.$emit("update:modelValue",this.deliveryForm)},deep:!0},modelValue:{handler:function(l){this.deliveryForm=l},deep:!0}},mounted(){this.deliveryForm=this.modelValue},computed:{bot(){return window.currentBot},settings(){return this.bot.settings}}},Vo={key:0,class:"list-group my-3"},Co=t("i",{class:"fa-solid fa-truck mr-2"},null,-1),To=t("span",{class:"px-2"},"Доставка",-1),Po=[Co,To],So=t("i",{class:"fa-brands fa-shopify mr-2"},null,-1),jo=t("span",{class:"px-2"},"Самовывоз",-1),qo=[So,jo],Io={key:0,href:"javascript:void(0)",class:"list-group-item list-group-item-action p-3 d-flex justify-content-between"},Uo=t("label",{class:"form-check-label",for:"in-restaurant"},[t("i",{class:"fa-solid fa-utensils mr-2"}),t("span",{class:"px-2"},"В заведении")],-1),Lo={key:1,href:"javascript:void(0)",class:"list-group-item list-group-item-action p-3 d-flex justify-content-between"},Do=t("label",{class:"form-check-label",for:"pick-up-in-package"},[t("i",{class:"fa-solid fa-person-walking-luggage mr-2"}),t("span",{class:"px-2"},"Забрать с собой")],-1);function Bo(l,e,r,c,s,_){return s.deliveryForm?(o(),i("div",Vo,[t("a",{href:"javascript:void(0)",class:v([{active:!s.deliveryForm.need_pickup},"list-group-item list-group-item-action p-3"]),onClick:e[0]||(e[0]=h=>s.deliveryForm.need_pickup=!1),"aria-current":"true"},Po,2),t("a",{href:"javascript:void(0)",onClick:e[1]||(e[1]=h=>s.deliveryForm.need_pickup=!0),class:v([{active:s.deliveryForm.need_pickup},"list-group-item list-group-item-action p-3"])},qo,2),s.deliveryForm.need_pickup?(o(),i("a",Io,[Uo,u(t("input",{class:"form-check-input",name:"pickup-format","onUpdate:modelValue":e[2]||(e[2]=h=>s.deliveryForm.pick_up_type=h),type:"radio",value:"0",id:"in-restaurant"},null,512),[[U,s.deliveryForm.pick_up_type]])])):n("",!0),s.deliveryForm.need_pickup?(o(),i("a",Lo,[Do,u(t("input",{class:"form-check-input",type:"radio",value:"1","onUpdate:modelValue":e[3]||(e[3]=h=>s.deliveryForm.pick_up_type=h),name:"pickup-format",id:"pick-up-in-package"},null,512),[[U,s.deliveryForm.pick_up_type]])])):n("",!0)])):n("",!0)}const Oo=S($o,[["render",Bo]]),zo=t("h6",{class:"opacity-75"},"Способы получения заказа",-1),Eo=t("h6",{class:"opacity-75 mb-3"},"Информация",-1),Mo=t("h6",{class:"opacity-75"},"Способы оплаты",-1),Ro={key:0,class:"alert alert-danger fw-bold mb-2"},Ao=t("i",{class:"fa-solid fa-cart-shopping"},null,-1),No={key:1,class:"navbar navbar-expand-sm fixed-bottom p-3 bg-transparent border-0",style:{"border-radius":"10px 10px 0px 0px"}},Ho=["disabled"],xo=t("i",{class:"fa-solid fa-map-location-dot mr-2"},null,-1),Jo=t("span",{class:"px-2"},"Рассчитать цену доставки",-1),Wo={key:0,class:"spinner-border ml-2 spinner-border-sm",role:"status"},Go=t("span",{class:"visually-hidden"},"Loading...",-1),Ko=[Go],Yo=["disabled"],Zo={key:0,class:"fa-solid fa-file-invoice mr-2"},Qo={key:1,class:"fa-solid fa-hourglass mr-2"},Xo=["disabled"],ei={style:{width:"80px","object-fit":"cover","margin-left":"10px"},alt:""},ti=["disabled"],si=t("i",{class:"fa-solid fa-receipt mr-2"},null,-1),oi={key:1,type:"button",class:"btn btn-primary p-3 w-100 d-flex align-items-center justify-content-center"},ii={key:0,class:"spinner-border ml-2 spinner-border-sm",role:"status"},ri=t("span",{class:"visually-hidden"},"Loading...",-1),li=[ri],ni={class:"modal fade",id:"delivery-price-modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},ai={class:"modal-dialog modal-dialog-centered"},di={class:"modal-content"},ci=t("div",{class:"modal-header"},[t("h5",{class:"modal-title"},"Детали расчета цены доставки"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),mi={class:"modal-body"},ui=t("div",{class:"d-flex justify-content-center align-items-center",style:{height:"100px"}},[t("div",{class:"spinner-border text-primary",role:"status"},[t("span",{class:"visually-hidden"},"Загрузка...")])],-1),_i=t("p",{class:"text-primary text-center fw-bold"},"Рассчитываем стоимость доставки",-1),pi={key:1,class:"container"},yi={class:"fw-bold mb-2"},hi={key:0},fi={key:1},vi={class:"list-group mb-2 list-group-flush"},bi={class:"list-group-item"},gi={class:"d-flex justify-content-between w-100"},Fi={class:"fw-bold"},ki={class:"badge bg-primary mx-2"},wi={class:"badge bg-primary"},$i={class:"fw-bold d-flex justify-content-between"},Vi={class:"badge bg-primary"},Ci={class:"fw-bold d-flex justify-content-between"},Ti={class:"badge bg-primary"},Pi={key:1,class:"alert alert-light"},Si=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary p-3 w-100","data-bs-dismiss":"modal"},"Закрыть ")],-1),ji={props:["modelValue"],data(){return{spent_time:0,deliveryForm:null,offer_agreement:!0,delivery_price_request_step:0,loading_delivery:!1,delivery_message:"",need_select_table_by_number:!1,need_request_delivery_price:!0,error_delivery_price_message:null,moneyVariants:[500,1e3,2e3,5e3]}},watch:{deliveryForm:{handler:function(l){this.$emit("update:modelValue",this.deliveryForm)},deep:!0},"deliveryForm.need_pickup":{handler:function(l){this.delivery_price_request_step=(this.deliveryForm.need_pickup===!0?1:0)||(this.settings.need_automatic_delivery_request?0:1)},deep:!0},modelValue:{handler:function(l){this.deliveryForm=l},deep:!0},cartTotalPrice:{handler:function(l){this.settings.free_shipping_starts_from<=this.cartTotalPrice&&(this.deliveryForm.delivery_price=0,this.delivery_price_request_step=1)},deep:!0}},computed:{...$(["cartProducts","cartProducts","cartTotalCount","cartTotalPrice","getSelf"]),bot(){return window.currentBot},settings(){return this.bot.settings},canRequestDeliverPrice(){return this.need_request_delivery_price&&this.deliveryForm.city!=null&&this.deliveryForm.street!=null&&this.deliveryForm.building!=null},canSubmitForm(){var e;return((e=this.deliveryForm)!=null&&e.use_cashback?this.cartTotalPrice-w()>(this.settings.min_price||0):this.cartTotalPrice>=(this.settings.min_price||0))&&!(this.spent_time>0)}},mounted(){this.deliveryForm=this.modelValue,I(),window.addEventListener("trigger-spent-timer",l=>{this.spent_time=l.detail}),this.delivery_price_request_step=(this.deliveryForm.need_pickup===!0?1:0)||(this.settings.need_automatic_delivery_request?0:1)},methods:{goToProductCart(){document.dispatchEvent(new Event("switch-to-cart"))},requestDeliveryPrice(){this.need_request_delivery_price=!1,this.error_delivery_price_message=null,this.loading_delivery=!0,this.$notify({title:"Корзина",text:"Мы начали процесс расчета цены доставки"});const l=bootstrap.Modal.getOrCreateInstance(document.getElementById("delivery-price-modal"));l&&l.show(),this.$store.dispatch("requestDeliveryPrice",{city:this.deliveryForm.city,street:this.deliveryForm.street,building:this.deliveryForm.building}).then(e=>{this.deliveryForm.delivery_price=e.price||0,this.deliveryForm.distance=e.distance||0,this.deliveryForm.delivery_details=e.config||[],this.need_request_delivery_price=!0,this.delivery_price_request_step=1,this.$notify({title:"Корзина",text:"Цена доставки успешно просчитана",type:"success"}),this.loading_delivery=!1}).catch(()=>{this.deliveryForm.delivery_price=0,this.deliveryForm.distance=0,this.need_request_delivery_price=!0,this.delivery_price_request_step=1,this.error_delivery_price_message="Цена будет рассчитана курьером в момент доставки!",this.$notify({title:"Корзина",text:"Ошибка расчёта цены доставки",type:"error"}),this.loading_delivery=!1})},startCheckout(){this.spent_time>0||(console.log("startCheckout"),this.$emit("start-checkout"),j(10))},nextStep(){if(this.spent_time>0)return;const e=document.getElementById("basket").querySelectorAll("[required]");let r=!0;if(Array.from(e).reverse().forEach(_=>{_.value.trim()||(_.focus(),r=!1)}),!r){this.$notify({title:"Корзина",text:"Пожалуйста, заполните все обязательные поля.",type:"error"});return}this.$emit("change-tab",3),j(10)}}},qi=Object.assign(ji,{__name:"CheckoutProductForm",setup(l){return(e,r)=>{const c=P("lazy");return o(),i(p,null,[e.deliveryForm?(o(),i("form",{key:0,id:"basket",class:"container py-3",onSubmit:r[8]||(r[8]=q((...s)=>e.startCheckout&&e.startCheckout(...s),["prevent"]))},[zo,b(Oo,{modelValue:e.deliveryForm,"onUpdate:modelValue":r[0]||(r[0]=s=>e.deliveryForm=s)},null,8,["modelValue"]),Eo,b(O,{modelValue:e.deliveryForm,"onUpdate:modelValue":r[1]||(r[1]=s=>e.deliveryForm=s),mode:0},null,8,["modelValue"]),b(B,{modelValue:e.offer_agreement,"onUpdate:modelValue":r[2]||(r[2]=s=>e.offer_agreement=s)},null,8,["modelValue"]),Mo,b(D,{modelValue:e.deliveryForm,"onUpdate:modelValue":r[3]||(r[3]=s=>e.deliveryForm=s)},null,8,["modelValue"]),b(L,{onCalcDeliveryPrice:e.requestDeliveryPrice,modelValue:e.deliveryForm,"onUpdate:modelValue":r[4]||(r[4]=s=>e.deliveryForm=s)},null,8,["onCalcDeliveryPrice","modelValue"]),e.error_delivery_price_message?(o(),i("p",Ro,m(e.error_delivery_price_message),1)):n("",!0),t("button",{type:"button",onClick:r[5]||(r[5]=(...s)=>e.goToProductCart&&e.goToProductCart(...s)),class:"btn btn-primary w-100 p-3"},[Ao,a(" Корзина с товаром ")]),e.offer_agreement?(o(),i("nav",No,[e.spent_time<=0?(o(),i(p,{key:0},[e.settings.need_automatic_delivery_request?(o(),i(p,{key:0},[e.delivery_price_request_step===0?(o(),i("button",{key:0,onClick:r[6]||(r[6]=(...s)=>e.requestDeliveryPrice&&e.requestDeliveryPrice(...s)),class:"btn btn-primary text-white p-3 w-100 d-flex align-items-center justify-content-center",disabled:!e.canRequestDeliverPrice},[xo,Jo,e.need_request_delivery_price?n("",!0):(o(),i("div",Wo,Ko))],8,Ho)):n("",!0)],64)):n("",!0),e.delivery_price_request_step===1?(o(),i(p,{key:1},[e.settings.need_pay_after_call||e.deliveryForm.payment_type===3?(o(),i("button",{key:0,disabled:!e.canSubmitForm,class:"btn btn-primary p-3 w-100"},[e.spent_time<=0?(o(),i("i",Zo)):(o(),i("i",Qo)),a(" Оформить ")],8,Yo)):n("",!0),e.deliveryForm.payment_type===4&&!e.settings.need_pay_after_call?(o(),i("button",{key:1,disabled:!e.canSubmitForm,class:"btn btn-primary p-3 w-100 d-flex justify-content-center align-items-center"},[a(" Оплатить через "),u(t("img",ei,null,512),[[c,"/images/Т-Банк.png"]])],8,Xo)):n("",!0),e.deliveryForm.payment_type===2&&!e.settings.need_pay_after_call?(o(),i("button",{key:2,type:"button",onClick:r[7]||(r[7]=(...s)=>e.nextStep&&e.nextStep(...s)),disabled:!e.canSubmitForm,class:"btn btn-primary p-3 w-100"},[si,a(" Оплатить переводом ")],8,ti)):n("",!0)],64)):n("",!0)],64)):(o(),i("button",oi,[a(" Осталось ждать "+m(e.spent_time||0)+" сек. ",1),e.canSubmitForm?n("",!0):(o(),i("div",ii,li))]))])):n("",!0)],32)):n("",!0),t("div",ni,[t("div",ai,[t("div",di,[ci,t("div",mi,[!e.deliveryForm||e.loading_delivery?(o(),i(p,{key:0},[ui,_i],64)):n("",!0),e.deliveryForm&&!e.loading_delivery?(o(),i("div",pi,[t("h6",yi,[(e.deliveryForm.delivery_details||[]).length>1?(o(),i("span",hi,"Цена доставки формируется из")):(o(),i("span",fi,"Цена доставки"))]),t("ul",vi,[(e.deliveryForm.delivery_details||[]).length>0?(o(!0),i(p,{key:0},T(Object.keys(e.deliveryForm.delivery_details),s=>(o(),i("li",bi,[t("div",gi,[t("span",Fi,m(e.deliveryForm.delivery_details[s].title),1),t("span",null,[t("span",ki,m(e.deliveryForm.delivery_details[s].distance)+" км",1),t("span",wi,m(e.deliveryForm.delivery_details[s].price)+" руб.",1)])])]))),256)):n("",!0)]),e.deliveryForm.distance>0&&e.deliveryForm.delivery_price>0?(o(),i(p,{key:0},[t("h6",$i,[a(" Общее расстояние "),t("span",Vi,m(e.deliveryForm.distance)+" км",1)]),t("h6",Ci,[a(" Общая сумма за доставку "),t("span",Ti,m(e.deliveryForm.delivery_price)+" руб.",1)])],64)):(o(),i("p",Pi,"Цена доставки будет рассчитана курьером! Проверьте корректность введенного вами адреса и попробуйте расчитать доставку еще раз!"))])):n("",!0)]),Si])])])],64)}}}),Ii=t("h6",null,"Офис получения",-1),Ui={key:0,class:"alert alert-light my-2"},Li={class:"mb-0"},Di={class:"fw-bold text-primary"},Bi={class:"fw-bold text-primary"},Oi={class:"mb-0"},zi={class:"fw-bold text-primary"},Ei={props:["needDeliveryPrice"],data(){return{calcTariffForm:{tariff:null,to:{region:null,city:null,office:null}}}},watch:{"calcTariffForm.to":{handler:function(l){this.calcTariffForm.tariff=null,this.calcTariffForm.to.region!=null&&this.calcTariffForm.to.city!=null&&this.calcTariffForm.to.office!=null&&this.loadTariffForCdek()},deep:!0}},computed:{canCalcTariff(){return this.calcTariffForm.packages.length>0&&this.calcTariffForm.to.region!=null&&this.calcTariffForm.to.city!=null}},mounted(){this.loadTariffForCdek()},methods:{selectOffice(l){this.calcTariffForm.to.region=l.region,this.calcTariffForm.to.city=l.city,this.calcTariffForm.to.office=l.office,this.calcTariffForm.tariff=null},loadTariffForCdek(){this.$store.dispatch("calcCdekTariffFromCart",this.calcTariffForm).then(l=>{this.calcTariffForm.tariff=l.tariff,this.$emit("calc",this.calcTariffForm)})}}},Mi=Object.assign(Ei,{__name:"CdekCalcForm",setup(l){return(e,r)=>(o(),i(p,null,[Ii,b(x,{onCallback:e.selectOffice},null,8,["onCallback"]),e.calcTariffForm.tariff&&l.needDeliveryPrice?(o(),i("div",Ui,[t("p",Li,[a("Доставка от "),t("span",Di,m(e.calcTariffForm.tariff.period_min||0),1),a(" до "),t("span",Bi,m(e.calcTariffForm.tariff.period_max||0),1),a(" рабочих дней")]),t("p",Oi,[a("Стоимость доставки "),t("span",zi,m(e.calcTariffForm.tariff.delivery_sum||0),1),a(" руб.")])])):n("",!0)],64))}}),Ri=t("h6",{class:"opacity-75"},"Способы оплаты",-1),Ai={key:0,class:"opacity-75 my-3"},Ni=t("h6",{class:"opacity-75 my-3"},"Общая информация",-1),Hi=t("h6",{class:"opacity-75 my-3"},"Сводка",-1),xi=t("i",{class:"fa-solid fa-cart-shopping"},null,-1),Ji={key:1,class:"navbar navbar-expand-sm fixed-bottom p-3 bg-transparent border-0",style:{"border-radius":"10px 10px 0px 0px"}},Wi=["disabled"],Gi={key:0,class:"fa-solid fa-file-invoice mr-2"},Ki={key:1,class:"fa-solid fa-hourglass mr-2"},Yi=["disabled"],Zi=t("i",{class:"fa-solid fa-receipt mr-2"},null,-1),Qi=["disabled"],Xi=t("i",{class:"fa-solid fa-receipt mr-2"},null,-1),er={key:1,class:"alert alert-info"},tr={key:1,type:"button",class:"btn btn-primary p-3 w-100 d-flex align-items-center justify-content-center"},sr={key:0,class:"spinner-border ml-2 spinner-border-sm",role:"status"},or=t("span",{class:"visually-hidden"},"Loading...",-1),ir=[or],rr={props:["modelValue"],data(){return{spent_time:0,deliveryForm:null,can_start_payment:!1,offer_agreement:!0,need_request_delivery_price:!0,moneyVariants:[500,1e3,2e3,5e3]}},watch:{modelValue:{handler:function(l){this.deliveryForm=l},deep:!0},deliveryForm:{handler:function(l){this.$emit("update:modelValue",this.deliveryForm)},deep:!0},cartTotalPrice:{handler:function(l){this.settings.free_shipping_starts_from<=this.cartTotalPrice&&(this.deliveryForm.delivery_price=0)},deep:!0}},computed:{...$(["cartProducts","cartProducts","cartTotalCount","cartTotalPrice","getSelf"]),bot(){return window.currentBot},settings(){return this.bot.settings},canRequestDeliverPrice(){return this.need_request_delivery_price?this.can_start_payment:!0},canSubmitForm(){var e;let l=(e=this.deliveryForm)!=null&&e.use_cashback?this.cartTotalPrice-w()>(this.settings.min_price||0):this.cartTotalPrice>=(this.settings.min_price||0);return this.can_start_payment&&l&&!(this.spent_time>0)}},mounted(){this.deliveryForm=this.modelValue,this.is_requested=I(),window.addEventListener("trigger-spent-timer",l=>{this.spent_time=l.detail})},methods:{goToProductCart(){document.dispatchEvent(new Event("switch-to-cart"))},calcTariff(l){var e,r,c,s;if(this.deliveryForm.cdek.tariff=l.tariff||null,this.deliveryForm.cdek.to.region=((e=l.to)==null?void 0:e.region)||null,this.deliveryForm.cdek.to.city=((r=l.to)==null?void 0:r.city)||null,this.deliveryForm.cdek.to.office=((c=l.to)==null?void 0:c.office)||null,(s=this.deliveryForm.cdek.tariff)!=null&&s.errors){this.can_start_payment=!1;return}this.deliveryForm.cdek.tariff&&(this.can_start_payment=!0)},startCheckout(){this.$emit("start-checkout")},nextStep(){this.$emit("change-tab",3)}}},lr=Object.assign(rr,{__name:"CheckoutNonFoodGoodsForm",setup(l){return(e,r)=>e.deliveryForm?(o(),i("form",{key:0,id:"basket",class:"container py-3",onSubmit:r[8]||(r[8]=q((...c)=>e.startCheckout&&e.startCheckout(...c),["prevent"]))},[Ri,b(D,{modelValue:e.deliveryForm,"onUpdate:modelValue":r[0]||(r[0]=c=>e.deliveryForm=c)},null,8,["modelValue"]),e.settings.need_automatic_delivery_request?(o(),i("h6",Ai,"Расчёт цены доставки CDEK")):n("",!0),b(Mi,{"need-delivery-price":e.settings.need_automatic_delivery_request,onCalc:e.calcTariff},null,8,["need-delivery-price","onCalc"]),Ni,b(O,{modelValue:e.deliveryForm,"onUpdate:modelValue":r[1]||(r[1]=c=>e.deliveryForm=c),mode:1},null,8,["modelValue"]),b(B,{modelValue:e.offer_agreement,"onUpdate:modelValue":r[2]||(r[2]=c=>e.offer_agreement=c)},null,8,["modelValue"]),Hi,b(L,{modelValue:e.deliveryForm,"onUpdate:modelValue":r[3]||(r[3]=c=>e.deliveryForm=c)},null,8,["modelValue"]),t("button",{type:"button",onClick:r[4]||(r[4]=(...c)=>e.goToProductCart&&e.goToProductCart(...c)),class:"btn btn-primary w-100 p-3"},[xi,a(" Корзина с товаром ")]),e.offer_agreement?(o(),i("nav",Ji,[e.spent_time<=0?(o(),i(p,{key:0},[e.deliveryForm.cdek.tariff!=null||!e.settings.need_automatic_delivery_request?(o(),i(p,{key:0},[e.settings.need_pay_after_call||e.deliveryForm.payment_type===3?(o(),i("button",{key:0,type:"button",onClick:r[5]||(r[5]=(...c)=>e.startCheckout&&e.startCheckout(...c)),disabled:!e.canSubmitForm,class:"btn btn-primary p-3 w-100 mb-2"},[e.spent_time<=0?(o(),i("i",Gi)):(o(),i("i",Ki)),a(" Оформить ")],8,Wi)):n("",!0),e.deliveryForm.payment_type===4&&!e.settings.need_pay_after_call?(o(),i("button",{key:1,type:"button",onClick:r[6]||(r[6]=(...c)=>e.startCheckout&&e.startCheckout(...c)),disabled:!e.canSubmitForm,class:"btn btn-primary p-3 w-100"},[Zi,a(" Оформить и оплатить через СБП ")],8,Yi)):n("",!0),e.deliveryForm.payment_type===2&&!e.settings.need_pay_after_call?(o(),i("button",{key:2,type:"button",onClick:r[7]||(r[7]=(...c)=>e.nextStep&&e.nextStep(...c)),disabled:!e.canSubmitForm,class:"btn btn-primary p-3 w-100"},[Xi,a(" Оплатить переводом ")],8,Qi)):n("",!0)],64)):(o(),i("div",er," Для оформления выберите офис доставки СДЭК "))],64)):(o(),i("button",tr,[a(" Осталось ждать "+m(e.spent_time||0)+" сек. ",1),e.canSubmitForm?n("",!0):(o(),i("div",sr,ir))]))])):n("",!0)],32)):n("",!0)}}),nr={props:["modelValue"],data(){return{spent_time_counter:0}},computed:{...$(["cartProducts","cartProducts","cartTotalCount","cartTotalPrice","getSelf"]),cashbackLimit(){let l=this.getSelf.cashBack?this.getSelf.cashBack.amount:0,e=this.cartTotalPrice||0,r=this.bot.max_cashback_use_percent||0,c=e*(r/100);return Math.min(c,l)},settings(){return window.currentBot.settings||null},finallyPrice(){var r,c,s;let l=((r=this.modelValue.promo)==null?void 0:r.activate_price)||0,e=((c=this.modelValue.promo)==null?void 0:c.discount)||0;return(s=this.modelValue)!=null&&s.use_cashback?Math.max(1,this.cartTotalPrice-this.cashbackLimit-(this.cartTotalPrice>=l?e:0))+this.modelValue.delivery_price:Math.max(1,this.cartTotalPrice-(this.cartTotalPrice>=l?e:0))+this.modelValue.delivery_price}},watch:{modelValue:{handler:function(l){this.$emit("update:modelValue",this.modelValue)},deep:!0}},mounted(){},methods:{startCheckout(){this.spent_time_counter>0||(this.startTimer(10),this.$emit("startCheckout"))},onChangePhotos(l){const e=l.target.files[0];e&&(this.modelValue.image=e)},getPhoto(l){return{imageUrl:URL.createObjectURL(l)}},removePhoto(){this.modelValue.image=null},canSubmitForm(){return this.modelValue.image!=null},startTimer(l){this.spent_time_counter=l!=null?Math.min(l,10):10;let e=setInterval(()=>{this.spent_time_counter>0?this.spent_time_counter--:(clearInterval(e),this.spent_time_counter=null),localStorage.setItem("cashman_self_product_delivery_counter",this.spent_time_counter)},1e3)}}},ar=t("h5",{class:"my-3 text-left"},[t("i",{class:"fa-regular fa-image mr-2"}),a("Фотография чека")],-1),dr=["innerHTML"],cr=t("h6",{class:"opacity-75 mt-3"},"Сводка",-1),mr={class:"card my-3"},ur={class:"card-body p-2"},_r={class:"list-group list-group-flush"},pr={class:"list-group-item"},yr={class:"mb-0 d-flex justify-content-between"},hr={class:"list-group-item"},fr={class:"mb-0 d-flex justify-content-between"},vr={class:"list-group-item"},br={class:"mb-0 d-flex justify-content-between"},gr={key:0},Fr={key:1},kr={key:0,class:"list-group-item"},wr=t("p",{class:"mb-2 text-justify"},[t("strong",{class:"fw-bold"},"Внимание!"),a(" Не распространяется на цену доставки! ")],-1),$r={class:"mb-0 d-flex justify-content-between"},Vr={key:1,class:"list-group-item"},Cr={class:"mb-0 d-flex justify-content-between"},Tr={key:0},Pr={key:1},Sr={class:"list-group-item"},jr={class:"mb-0 d-flex justify-content-between"},qr={key:0},Ir=t("p",{class:"my-3 text-center"},"Мы можем подготовить для вас сдачу с:",-1),Ur={class:"row row-cols-2 mb-0"},Lr={class:"col"},Dr=["onClick"],Br=t("p",{class:"mb-2"},[t("em",null,"или введите другую сумму...")],-1),Or={class:"form-floating"},zr=t("label",{for:"modelValue-money"},"С какой суммы нужна сдача",-1),Er={class:"d-flex justify-content-center flex-wrap w-100"},Mr={key:0,for:"menu-photos",class:"photo-loader-bill d-flex flex-column justify-content-center align-items-center mb-2"},Rr=t("i",{class:"fa-regular fa-image my-2 text-primary",style:{"font-size":"20px"}},null,-1),Ar=t("span",{class:"text-primary fw-bold text-center"},"Выбрать фотографию чека в формате: jpg, png, bmp",-1),Nr={key:1,class:"mb-2 img-preview-bill"},Hr={class:"remove"},xr=t("i",{class:"fa-solid fa-trash-can mr-2 text-primary"},null,-1),Jr={class:"form-floating mb-2"},Wr=t("label",{for:"modelValue-image_info"},[a("Текст к оплате "),t("small",null,"(не обязательно)")],-1),Gr=["disabled"],Kr={key:0,class:"fa-solid fa-file-invoice mr-2"},Yr={key:1,class:"fa-solid fa-hourglass mr-2"},Zr={key:2,class:"color-white"},Qr={key:3,class:"color-white"};function Xr(l,e,r,c,s,_){var d,y;const h=P("lazy");return o(),i("form",{class:"container py-3",onSubmit:e[4]||(e[4]=q((...g)=>_.startCheckout&&_.startCheckout(...g),["prevent"]))},[ar,(d=_.settings)!=null&&d.payment_info?(o(),i("div",{key:0,class:"alert alert-light mb-2 fw-bold",role:"alert",innerHTML:_.settings.payment_info},null,8,dr)):n("",!0),cr,t("div",mr,[t("div",ur,[t("ul",_r,[t("li",pr,[t("p",yr,[a("Суммарно, ед. "),t("strong",null,m(l.cartTotalCount)+" шт.",1)])]),t("li",hr,[t("p",fr,[a("Цена "),t("strong",null,m(l.cartTotalPrice)+" ₽",1)])]),t("li",vr,[t("p",br,[a("Оплата бонусами "),(y=r.modelValue)!=null&&y.use_cashback?(o(),i("strong",gr,m(_.cashbackLimit)+" ₽",1)):(o(),i("strong",Fr,"-"))])]),r.modelValue.discount>0?(o(),i("li",kr,[wr,t("p",$r,[a("Промокод "),t("strong",null,m(r.modelValue.discount)+" ₽",1)])])):n("",!0),r.modelValue.need_pickup?n("",!0):(o(),i("li",Vr,[t("p",Cr,[a("Цена доставки "),r.modelValue.delivery_price>0?(o(),i("strong",Tr,m(r.modelValue.delivery_price)+"₽",1)):(o(),i("strong",Pr,"от курьера"))])])),t("li",Sr,[t("p",jr,[a("Итого, цена "),t("strong",null,m(_.finallyPrice)+" ₽",1)])])]),r.modelValue.payment_type===3&&_.settings.can_use_cash?(o(),i("div",qr,[Ir,t("div",Ur,[(o(!0),i(p,null,T(l.moneyVariants,g=>(o(),i("div",Lr,[t("button",{class:v(["btn btn-outline-primary w-100 mb-2 rounded-5",{"btn-primary text-white":r.modelValue.money===g}]),type:"button",onClick:Ul=>r.modelValue.money=g},m(g)+"₽ ",11,Dr)]))),256))]),Br,t("div",Or,[u(t("input",{type:"number",min:"0","onUpdate:modelValue":e[0]||(e[0]=g=>r.modelValue.money=g),class:"form-control",id:"modelValue-money",placeholder:"С какой суммы нужна сдача"},null,512),[[f,r.modelValue.money]]),zr])])):n("",!0)])]),t("div",Er,[r.modelValue.image==null?(o(),i("label",Mr,[Rr,Ar,t("input",{type:"file",required:"",id:"menu-photos",accept:"image/*",onChange:e[1]||(e[1]=(...g)=>_.onChangePhotos&&_.onChangePhotos(...g)),style:{display:"none"}},null,32)])):n("",!0),r.modelValue.image!=null?(o(),i("div",Nr,[u(t("img",null,null,512),[[h,_.getPhoto(r.modelValue.image).imageUrl]]),t("div",Hr,[t("a",{onClick:e[2]||(e[2]=g=>_.removePhoto())},[xr,a("Удалить")])])])):n("",!0)]),t("div",Jr,[u(t("textarea",{class:"form-control","onUpdate:modelValue":e[3]||(e[3]=g=>r.modelValue.image_info=g),style:{height:"100px","line-height":"150%"},placeholder:"Информация",id:"modelValue-image_info"},null,512),[[f,r.modelValue.image_info]]),Wr]),t("button",{type:"submit",disabled:!_.canSubmitForm,class:"btn btn-primary p-3 w-100"},[s.spent_time_counter<=0?(o(),i("i",Kr)):(o(),i("i",Yr)),s.spent_time_counter<=0?(o(),i("span",Zr,"Оформить")):(o(),i("span",Qr,"Осталось ждать "+m(s.spent_time_counter)+" сек.",1))],8,Gr)],32)}const el=S(nr,[["render",Xr]]);const tl=l=>(R("data-v-11b2d633"),l=l(),A(),l),sl={key:0,class:"row my-3"},ol=tl(()=>t("div",{class:"col-12"},[t("h6",{class:"fw-bold"},"Также рекомендуем")],-1)),il={class:"col-12"},rl={class:"carousel__item"},ll={name:"ProductRecommendationList",data(){return{products:[]}},mounted(){this.loadRecommendedProducts()},methods:{loadRecommendedProducts(){return this.$store.dispatch("loadRecommendedProducts").then(l=>{this.products=l.data||[]})}}},nl=Object.assign(ll,{setup(l){const e={itemsToShow:2.1,wrapAround:!0};return(r,c)=>(r.products||[]).length>0?(o(),i("div",sl,[ol,t("div",il,[b(k(G),E(M(e)),{addons:C(()=>[]),default:C(()=>[(o(!0),i(p,null,T(r.products,s=>(o(),V(k(W),{key:s.id},{default:C(()=>[t("div",rl,[b(J,{item:s},null,8,["item"])])]),_:2},1024))),128))]),_:1},16)])])):n("",!0)}}),al=S(nl,[["__scopeId","data-v-11b2d633"]]);const dl={key:0},cl=t("h4",null,"Итого",-1),ml=t("p",null," Ниже приведена итоговая цена заказа без учета стоимости доставки. Цена доставки рассчитывается отдельно и зависит от расстояния. ",-1),ul={key:1},_l={key:1,class:"d-flex flex-column justify-content-center align-items-center",style:{height:"100vh"}},pl={class:"d-flex justify-content-center flex-column align-items-center"},yl=t("i",{class:"fa-brands fa-shopify mb-3",style:{"font-size":"36px"}},null,-1),hl=t("p",null,"Корзина пустая:(",-1),fl=t("i",{class:"fa-solid fa-arrows-rotate"},null,-1),vl={key:2,class:"navbar navbar-expand-sm fixed-bottom p-2 bg-transparent border-0",style:{"border-radius":"10px 10px 0px 0px"}},bl={key:0,class:"w-100"},gl={key:0,class:"ios-nav-group w-100"},Fl=t("button",{type:"button","data-bs-toggle":"offcanvas","data-bs-target":"#sidebar-menu","aria-controls":"sidebar-menu",class:"btn btn-primary ios-btn"},[t("i",{class:"fa-solid fa-bars"}),t("span",{class:"ios-label"},"Меню")],-1),kl=t("i",{class:"fa-solid fa-shop"},null,-1),wl=t("span",{class:"ios-label"},"Магазин",-1),$l=[kl,wl],Vl=t("i",{class:"fa-solid fa-money-bill"},null,-1),Cl=t("span",{class:"ios-label"},"Оформить заказ",-1),Tl=[Vl,Cl],Pl={key:1,class:"w-100"},Sl={key:3,class:"navbar navbar-expand-sm fixed-bottom p-2 bg-transparent border-0",style:{"border-radius":"10px 10px 0px 0px"}},jl=t("p",{style:{"box-shadow":"1px 1px 6px 0px #0000004a"},class:"btn btn-secondary w-100 p-3 rounded-3 shadow-lg d-flex justify-content-between"}," В данный момент покупки недоступны ",-1),ql=[jl],Il={props:["type"],data(){return{tab:0,deliveryForm:{name:null,phone:null,address:null,discount:0,cdek:{tariff:null,to:{region:null,city:null,office:null,address:null}},city:null,street:null,building:null,flat_number:null,entrance_number:null,floor_number:null,table_number:null,info:null,need_pickup:!1,pick_up_type:1,has_disability:!1,use_cashback:!1,disabilities:[],money:null,cash:!0,payment_type:2,persons:1,time:null,when_ready:!0,image:null,image_info:null,delivery_price:0,distance:0,delivery_details:[],allergy:null,action_prize:null}}},watch:{tab:{handler:function(l){window.scroll(0,80)},deep:!0},"deliveryForm.need_pickup":{handler:function(l){this.deliveryForm.need_pickup&&(this.deliveryForm.delivery_price=0,this.deliveryForm.distance=0)},deep:!0},"deliveryForm.cash":{handler:function(l){this.deliveryForm.cash||(this.deliveryForm.money=null)},deep:!0},"deliveryForm.has_disability":{handler:function(l){this.deliveryForm.disabilities=[],this.deliveryForm.allergy=null},deep:!0}},computed:{...$(["cartTotalCount","cartTotalPrice","getSelf"]),settings(){return this.bot.settings},bot(){return window.currentBot},tg(){return window.Telegram.WebApp}},mounted(){this.loadBasketData(),this.tg.BackButton.show(),this.tg.BackButton.onClick(()=>{document.querySelectorAll('[data-bs-dismiss="modal"]').forEach(l=>l.click()),this.$router.back()}),window.addEventListener("scroll-to-basket",l=>{this.tab=2,document.querySelector("#basket").scrollIntoView({behavior:"smooth"})}),document.addEventListener("switch-to-cart",()=>{this.changeTab(0),document.querySelector("#basket").scrollIntoView({behavior:"smooth"})})},methods:{doSwipeLeft(){this.$router.push({name:"CatalogV2"})},doSwipeRight(){this.$router.push({name:"MenuV2"})},changeTab(l){this.tab=l},goToCatalog(){this.$router.push({name:"CatalogV2"})},selectPrize(l){this.deliveryForm.action_prize=l},loadBasketData(){return this.$store.dispatch("loadProductsInBasket",{dataObject:{search:"",categories:""},page:0,size:12})},startCheckout(){let l=new FormData;if(l.append("display_type",this.settings.shop_display_type),Object.keys(this.deliveryForm).forEach(e=>{const r=this.deliveryForm[e]||"";typeof r=="object"?l.append(e,JSON.stringify(r)):l.append(e,r)}),this.type&&l.append("type",this.type),l.append("need_automatic_delivery_request",this.settings.need_automatic_delivery_request),this.deliveryForm.payment_type===0&&this.settings.can_use_card){this.$store.dispatch("createCheckoutLink",{deliveryForm:l}).then(e=>{this.tg.openInvoice(e.result)});return}typeof this.deliveryForm.image!="string"&&(l.append("photo",this.deliveryForm.image),l.delete("image")),this.sending=!0,this.$store.dispatch("startCheckout",{deliveryForm:l}).then(e=>{this.$notify({title:"Доставка",text:"Дальнейшая инструкция отправлена вам в бот!",type:"success"}),this.tab=1,this.$store.dispatch("clearCart"),e.url&&(window.location.href=e.url),this.sending=!1}).catch(e=>{this.sending=!1,this.$notify({title:"Доставка",text:"Ошибка! Обратитесь к администратору",type:"error"})}),j(10)}}},xl=Object.assign(Il,{__name:"ShopCart",setup(l){return(e,r)=>{const c=P("touch");return o(),i(p,null,[e.cartTotalCount>0?(o(),i("div",dl,[e.tab===0?(o(),V(z,{key:0,onSelectPrize:e.selectPrize,onChangeTab:e.changeTab,"form-data":e.deliveryForm},{"upper-text":C(()=>[cl,ml]),"recommendation-list":C(()=>[b(al)]),_:1},8,["onSelectPrize","onChangeTab","form-data"])):n("",!0),e.tab===1?u((o(),i("div",ul,[e.settings.shop_display_type===0?(o(),V(qi,{key:0,onStartCheckout:e.startCheckout,onChangeTab:e.changeTab,modelValue:e.deliveryForm,"onUpdate:modelValue":r[0]||(r[0]=s=>e.deliveryForm=s)},null,8,["onStartCheckout","onChangeTab","modelValue"])):(o(),V(lr,{key:1,onStartCheckout:e.startCheckout,onChangeTab:e.changeTab,modelValue:e.deliveryForm,"onUpdate:modelValue":r[1]||(r[1]=s=>e.deliveryForm=s)},null,8,["onStartCheckout","onChangeTab","modelValue"]))])),[[c,e.doSwipeLeft,"swipe",{left:!0}],[c,e.doSwipeRight,"swipe",{right:!0}]]):n("",!0),e.tab===3?(o(),V(el,{key:2,onStartCheckout:e.startCheckout,modelValue:e.deliveryForm,"onUpdate:modelValue":r[2]||(r[2]=s=>e.deliveryForm=s)},null,8,["onStartCheckout","modelValue"])):n("",!0)])):u((o(),i("div",_l,[t("div",pl,[yl,hl,t("a",{class:"btn btn-primary",onClick:r[3]||(r[3]=s=>e.loadBasketData()),href:"javascript:void(0)"},[fl,a(" Обновить корзину ")])])])),[[c,e.doSwipeLeft,"swipe",{left:!0}],[c,e.doSwipeRight,"swipe",{right:!0}]]),k(H)?(o(),i("nav",vl,[e.cartTotalCount>0?(o(),i("div",bl,[e.tab===0?(o(),i("div",gl,[Fl,t("button",{onClick:r[4]||(r[4]=(...s)=>e.goToCatalog&&e.goToCatalog(...s)),type:"button",class:"btn btn-primary ios-btn"},$l),e.tab===0?(o(),i("button",{key:0,type:"button",onClick:r[5]||(r[5]=s=>e.tab=1),style:{flex:"3"},class:"btn btn-primary ios-btn p-2"},Tl)):n("",!0)])):n("",!0)])):(o(),i("div",Pl,[t("button",{type:"button",onClick:r[6]||(r[6]=(...s)=>e.goToCatalog&&e.goToCatalog(...s)),style:{"box-shadow":"1px 1px 6px 0px #0000004a"},class:"btn btn-primary w-100 p-3 rounded-3 shadow-lg d-flex justify-content-center"}," Вернуться в магазин ")]))])):(o(),i("nav",Sl,ql))],64)}}});export{xl as default};
