import{g as p,o as t,j as n,l as s,M as u,W as y,Z as b,a2 as v,L as l,F as _,J as m,K as d,G as k,k as $,u as w,n as h,$ as C}from"./index.es-db843bab.js";import{P as g}from"./Pagination-4f4ca1a4.js";import{K as f}from"./vue-datepicker-496dde0e.js";/* empty css             */const S={class:"row mt-2"},j={class:"input-group mb-3"},A={class:"form-check form-switch my-2"},U=s("label",{class:"form-check-label",for:"switchCheckDefault"}," Тихий режим (не оповещать пользователя о смене статуса) ",-1),B={key:0,class:"row"},O={class:"col-12 col-md-12 mb-3"},P={class:"table"},V=s("th",{scope:"col"},"#",-1),D=s("th",{scope:"col"},"Ф.И.О. из телеграмма",-1),K=s("th",{scope:"col"},"Имя пользователя",-1),T=s("th",{scope:"col"},"Домен",-1),I=s("th",{scope:"col"},"Телефон",-1),L=s("th",{scope:"col"},"TG id",-1),N={key:0,scope:"col"},z={key:1,scope:"col"},G={key:2,scope:"col"},M={key:3,scope:"col"},F={key:4,scope:"col"},E=["onClick"],J={scope:"row"},W=["href"],Z={key:1},q={key:0},H=["onClick"],Q=s("i",{class:"fa-solid fa-check text-success"},null,-1),R=[Q],X=["onClick"],Y=s("i",{class:"fa-solid fa-xmark text-danger"},null,-1),x=[Y],ss={key:1},es=["onClick"],ts=s("i",{class:"fa-solid fa-check text-success"},null,-1),os=[ts],ns=["onClick"],is=s("i",{class:"fa-solid fa-xmark text-danger"},null,-1),as=[is],ls={key:2},ds=["onClick"],cs=s("i",{class:"fa-solid fa-check text-success"},null,-1),rs=[cs],hs=["onClick"],_s=s("i",{class:"fa-solid fa-xmark text-danger"},null,-1),us=[_s],ps={key:3},ms=["onClick"],ks=s("i",{class:"fa-solid fa-check text-success"},null,-1),gs=[ks],fs=["onClick"],ys=s("i",{class:"fa-solid fa-xmark text-danger"},null,-1),bs=[ys],vs={key:4},$s=["onClick"],ws=s("i",{class:"fa-solid fa-check text-success"},null,-1),Cs=[ws],Ss=["onClick"],js=s("i",{class:"fa-solid fa-xmark text-danger"},null,-1),As=[js],Us={class:"col-12"},Bs={key:1,class:"row"},Os=s("div",{class:"col-12"},[s("div",{class:"alert alert-warning",role:"alert"}," У выбранного бота нет пользователей ")],-1),Ps=[Os],Vs={props:["simple"],data(){return{silent_mode:!1,bot:null,loading:!0,bot_users:[],search:null,bot_users_paginate_object:null}},computed:{...p(["getBotUsers","getBotUsersPaginateObject","getCurrentBot"])},mounted(){this.loadCurrentBot().then(()=>{this.loadUsers()})},methods:{selectUser(i){this.$emit("select",i)},loadCurrentBot(i=null){return this.$store.dispatch("updateCurrentBot",{bot:i}).then(()=>{this.bot=this.getCurrentBot})},changeUserStatus(i,e,a="is_admin"){this.bot_users[i][a]=e===1,this.$store.dispatch("changeUserStatus",{dataObject:{bot_user_id:this.bot_users[i].id,status:e,type:a,silent_mode:this.silent_mode}}).then(()=>{this.$notify({title:"Конструктор ботов",text:"Статус пользователя успешно изменен! Пользователь оповещен об изменении статуса!",type:"success"})}).catch(()=>{this.$notify({title:"Конструктор ботов",text:"Ошибка изменения статуса",type:"error"})})},nextUsers(i){this.loadUsers(i)},loadUsers(i=0){this.loading=!0,this.$store.dispatch("loadBotUsers",{dataObject:{botId:this.bot.id||null,search:this.search},size:100,page:i}).then(e=>{this.loading=!1,this.bot_users=this.getBotUsers,this.bot_users_paginate_object=this.getBotUsersPaginateObject}).catch(()=>{this.loading=!1})}}},he=Object.assign(Vs,{__name:"BotUserList",setup(i){return(e,a)=>(t(),n(_,null,[s("div",S,[s("div",j,[u(s("input",{type:"search",class:"form-control",placeholder:"Поиск пользователя","aria-label":"Поиск пользователя",onKeydown:a[0]||(a[0]=b(o=>e.loadUsers(0),["enter"])),"onUpdate:modelValue":a[1]||(a[1]=o=>e.search=o)},null,544),[[y,e.search]]),s("button",{class:"btn btn-outline-secondary",onClick:a[2]||(a[2]=o=>e.loadUsers(0)),type:"button",id:"button-addon2"},"Найти ")])]),s("div",A,[u(s("input",{class:"form-check-input","onUpdate:modelValue":a[3]||(a[3]=o=>e.silent_mode=o),type:"checkbox",role:"switch",id:"switchCheckDefault"},null,512),[[v,e.silent_mode]]),U]),e.bot_users.length>0?(t(),n("div",B,[s("div",O,[s("table",P,[s("thead",null,[s("tr",null,[V,D,K,T,I,L,i.simple?l("",!0):(t(),n("th",N,"Админ")),i.simple?l("",!0):(t(),n("th",z,"VIP")),i.simple?l("",!0):(t(),n("th",G,"Доставщик")),i.simple?l("",!0):(t(),n("th",M,"Менеджер")),i.simple?l("",!0):(t(),n("th",F,"За работой"))])]),s("tbody",null,[(t(!0),n(_,null,m(e.bot_users,(o,c)=>(t(),n("tr",{onClick:r=>e.selectUser(o)},[s("th",J,d(o.id),1),s("td",null,d(o.fio_from_telegram||"Не указано"),1),s("td",null,d(o.name||"Не указано"),1),s("td",null,[o.username?(t(),n("a",{key:0,href:"https://t.me/"+o.username,target:"_blank"},"@"+d(o.username),9,W)):(t(),n("span",Z,"Не указано"))]),s("td",null,d(o.phone||"Не указано"),1),s("td",null,d(o.telegram_chat_id||"Не указано"),1),i.simple?l("",!0):(t(),n("td",q,[o.is_admin?(t(),n("span",{key:0,onClick:r=>e.changeUserStatus(c,0,"is_admin")},R,8,H)):(t(),n("span",{key:1,onClick:r=>e.changeUserStatus(c,1,"is_admin")},x,8,X))])),i.simple?l("",!0):(t(),n("td",ss,[o.is_vip?(t(),n("span",{key:0,onClick:r=>e.changeUserStatus(c,0,"is_vip")},os,8,es)):(t(),n("span",{key:1,onClick:r=>e.changeUserStatus(c,1,"is_vip")},as,8,ns))])),i.simple?l("",!0):(t(),n("td",ls,[o.is_deliveryman?(t(),n("span",{key:0,onClick:r=>e.changeUserStatus(c,0,"is_deliveryman")},rs,8,ds)):(t(),n("span",{key:1,onClick:r=>e.changeUserStatus(c,1,"is_deliveryman")},us,8,hs))])),i.simple?l("",!0):(t(),n("td",ps,[o.is_manager?(t(),n("span",{key:0,onClick:r=>e.changeUserStatus(c,0,"is_manager")},gs,8,ms)):(t(),n("span",{key:1,onClick:r=>e.changeUserStatus(c,1,"is_manager")},bs,8,fs))])),i.simple?l("",!0):(t(),n("td",vs,[o.is_work?(t(),n("span",{key:0,onClick:r=>e.changeUserStatus(c,0,"is_work")},Cs,8,$s)):(t(),n("span",{key:1,onClick:r=>e.changeUserStatus(c,1,"is_work")},As,8,Ss))]))],8,E))),256))])])]),s("div",Us,[e.bot_users_paginate_object?(t(),k(g,{key:0,onPagination_page:e.nextUsers,pagination:e.bot_users_paginate_object},null,8,["onPagination_page","pagination"])):l("",!0)])])):(t(),n("div",Bs,Ps))],64))}}),Ds={class:"row"},Ks={class:"col-md-4"},Ts={class:"col-12"},Is={key:0,class:"fa-solid fa-arrow-down-short-wide"},Ls={key:1,class:"fa-solid fa-arrow-up-wide-short"},Ns={key:0,class:"fa-solid fa-arrow-down-short-wide"},zs={key:1,class:"fa-solid fa-arrow-up-wide-short"},Gs={key:0,class:"fa-solid fa-arrow-down-short-wide"},Ms={key:1,class:"fa-solid fa-arrow-up-wide-short"},Fs={class:"col-md-4 mb-2"},Es=["onClick"],Js={class:"card-body text-center"},Ws={class:"row"},Zs={class:"col-md-6"},qs={class:"mb-0"},Hs=s("p",{class:"mb-0"},"Начало сеанса",-1),Qs={class:"mb-0"},Rs=s("p",{class:"mb-0"},"Окончание сеанса",-1),Xs={class:"mb-0"},Ys={class:"col-md-6"},xs={class:"mb-0"},se={class:"mb-0"},ee={class:"mb-0"},te=s("p",{class:"mb-0"},[s("strong",null,"Период")],-1),oe={class:"mb-0"},ne={class:"row"},ie={class:"col-12"},ae={props:["bot","eventId"],components:{VueDatePicker:f},data(){return{date:null,loading:!0,schedule:[],order:null,direction:null,months:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","октябрь","Ноябрь","Декабрь"],days:["Понедельник","Вторник","Среда","Четверг","Пятница","Суббота","Воскресенье"],paginate_object:null}},watch:{date:{handler:function(i){this.loadAppointmentSchedules()},deep:!0}},computed:{...p(["getAppointmentSchedules","getAppointmentSchedulesPaginateObject"])},mounted(){this.date=new Date,this.loadAppointmentSchedules()},methods:{selectTime(i){this.$emit("select",i)},loadAndOrder(i){this.order=i,this.direction=this.direction==="desc"?"asc":"desc",this.loadAppointmentSchedules(0)},nextAppointmentSchedule(i){this.loadAppointmentSchedules(i)},loadAppointmentSchedules(i=0){this.loading=!0,this.$store.dispatch("loadAppointmentSchedules",{dataObject:{date:this.date||null,event_id:this.eventId,bot_id:this.bot.id||null,order:this.order,direction:this.direction},page:i,size:20}).then(e=>{this.loading=!1,this.schedule=this.getAppointmentSchedules,this.paginate_object=this.getAppointmentSchedulesPaginateObject}).catch(()=>{this.loading=!1})}}},_e=Object.assign(ae,{__name:"AppointmentScheduleList",setup(i){return(e,a)=>(t(),n(_,null,[s("div",Ds,[s("div",Ks,[$(w(f),{modelValue:e.date,"onUpdate:modelValue":a[0]||(a[0]=o=>e.date=o)},null,8,["modelValue"])]),s("div",Ts,[s("p",null,[h(" Тип сортировки: "),s("a",{class:"mx-2",onClick:a[1]||(a[1]=o=>e.loadAndOrder("day")),href:"javascript:void(0)"},[h("По дню недели "),e.order==="day"&&e.direction==="asc"?(t(),n("i",Is)):l("",!0),e.order==="day"&&e.direction==="desc"?(t(),n("i",Ls)):l("",!0)]),s("a",{class:"mx-2",onClick:a[2]||(a[2]=o=>e.loadAndOrder("start_time")),href:"javascript:void(0)"},[h("По времени начала "),e.order==="start_time"&&e.direction==="asc"?(t(),n("i",Ns)):l("",!0),e.order==="start_time"&&e.direction==="desc"?(t(),n("i",zs)):l("",!0)]),s("a",{class:"mx-2",onClick:a[3]||(a[3]=o=>e.loadAndOrder("end_time")),href:"javascript:void(0)"},[h("По времени окончания "),e.order==="end_time"&&e.direction==="asc"?(t(),n("i",Gs)):l("",!0),e.order==="end_time"&&e.direction==="desc"?(t(),n("i",Ms)):l("",!0)])])]),(t(!0),n(_,null,m(e.schedule,o=>(t(),n("div",Fs,[s("div",{class:C(["card btn",{"btn-outline-secondary bg-secondary":o.appointment!=null,"btn-outline-success":o.appointment==null}]),onClick:c=>e.selectTime(o)},[s("div",Js,[s("div",Ws,[s("div",Zs,[s("p",qs,[s("strong",null,d(e.days[o.day-1]),1)]),Hs,s("p",Qs,[s("strong",null,d(o.start_time||"-"),1)]),Rs,s("p",Xs,[s("strong",null,d(o.end_time||"-"),1)])]),s("div",Ys,[s("p",xs,[s("strong",null,d(o.year||"-"),1)]),s("p",se,[s("strong",null,d(e.months[o.month||0]),1)]),s("p",ee,[s("strong",null,d(o.day_number),1)]),te,s("p",oe,[s("strong",null,"c "+d(o.week_start||"-"),1),h(" по "),s("strong",null,d(o.week_end||"-"),1)])])])])],10,Es)]))),256))]),s("div",ne,[s("div",ie,[e.paginate_object?(t(),k(g,{key:0,onPagination_page:e.nextAppointmentSchedule,pagination:e.paginate_object},null,8,["onPagination_page","pagination"])):l("",!0)])])],64))}});export{he as _,_e as a};
