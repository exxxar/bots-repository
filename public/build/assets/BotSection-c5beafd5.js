import{_ as K,a as A,b as ee,c as R,d as $e,e as ke,f as Fe}from"./MailingTable-cb829bc7.js";import{j as S,O as Q,o as l,k as i,n as e,N as c,Y as _,F as f,K as $,L as u,p as m,a0 as g,M as r,a3 as k,a8 as de,l as b,u as j,a1 as C,a9 as T,H as y,s as B,a7 as V,t as z,w as v,v as we,C as W,y as Ce,aa as Se,z as je,A as Ve,J as te}from"./index.es-c4852431.js";import"./SlugForm-bfc274b3.js";/* empty css                                                              */import{_ as P,B as Z}from"./BotMediaList-30a5f8d8.js";import{c as qe,_ as ze}from"./BotForm-a4bdbbd7.js";import{V as re}from"./vue3-json-editor.esm.prod-a2876a2f.js";import{_ as x}from"./GlobalSlugList-1bba8449.js";import{P as q}from"./Pagination-02b5940a.js";import{_ as J,a as ce}from"./AppointmentScheduleList-fd2d6334.js";import{T as ue}from"./TelegramChannelHelper-ff1b321d.js";import{_ as U}from"./_plugin-vue_export-helper-c27b6911.js";/* empty css                                                               */import{g as Pe}from"./base64-ae67ffac.js";import{K as H}from"./vue-datepicker-ff2ff697.js";/* empty css             */import{v as Ue}from"./v4-4a60fe23.js";import{s as E,a as L,b as M,c as D,d as me,e as he,f as Oe}from"./vue3-charts.esm-31920dfb.js";const Ae={class:"form-floating mb-3"},Ie=e("label",{for:"floatingInput"},"Команда",-1),Qe={class:"form-floating mb-3"},Te=e("label",{for:"floatingInput"},"Мнемоническое имя",-1),Me={class:"form-floating mb-3"},De=e("label",{for:"floatingInput"},"Описание скрипта",-1),Re=e("h6",null," Параметры скрипта ",-1),Be=e("div",{class:"alert alert-info",role:"alert"}," Данные параметры используются для настройки скриптов на стороне сервера ",-1),Ee={class:"dropdown"},Le=e("button",{class:"btn btn-outline-info w-100 dropdown-toggle mb-2",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"}," Добавить ",-1),Ke={class:"dropdown-menu w-100"},Ne=["onClick"],Je={class:"row"},He={class:"col-12"},Ye=["onClick"],Ge=e("p",null,"Вы можете подгрузить отсутствующие параметры конфигурации",-1),We=e("i",{class:"fa-solid fa-rotate mr-2"},null,-1),Xe={key:0,class:"row"},Ze={class:"col-12"},xe={class:"table"},et=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"Ключ"),e("th",{scope:"col"},"Значение")])],-1),tt={colspan:"2"},st={class:"w-100 d-flex align-items-center justify-content-between"},ot={class:"dropdown mr-2"},lt=e("button",{class:"btn btn-outline-primary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-bars"})],-1),it={class:"dropdown-menu"},nt=["onClick"],at=e("i",{class:"fa-solid fa-trash-can"},null,-1),dt=["onClick"],rt=e("i",{class:"fa-solid fa-caret-left"},null,-1),ct=["onClick"],ut=e("i",{class:"fa-solid fa-caret-right"},null,-1),mt=["innerHTML"],ht={key:1,class:"mb-0 font-bold"},_t={class:"dropdown"},pt={class:"btn btn-outline-primary dropdown-toggle w-100 d-flex justify-content-between align-items-center",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},bt={class:"dropdown-menu"},ft=["onClick"],gt={style:{width:"300px"}},vt={class:"form-floating"},yt=["onUpdate:modelValue","id"],$t=["for"],kt={key:0,class:"form-floating"},Ft=["id","onUpdate:modelValue"],wt=["for"],Ct={key:1,class:"form-check"},St=["onUpdate:modelValue","id"],jt=["for"],Vt={key:2,class:"form-floating"},qt=["onUpdate:modelValue","id"],zt=["for"],Pt=["onClick"],Ut={key:0,class:"fa-solid fa-eye mr-2"},Ot={key:1,class:"fa-solid fa-eye-slash mr-2"},At={key:2},It={key:3},Qt=["onClick"],Tt={key:0,class:"fa-solid fa-eye mr-2"},Mt={key:1,class:"fa-solid fa-eye-slash mr-2"},Dt={key:2},Rt={key:3},Bt={key:5,class:"form-floating"},Et=["onUpdate:modelValue","id"],Lt=["for"],Kt=["onClick"],Nt={key:0,class:"fa-solid fa-eye mr-2"},Jt={key:1,class:"fa-solid fa-eye-slash mr-2"},Ht={key:2},Yt={key:3},Gt={key:7,class:"form-check"},Wt=["onUpdate:modelValue","id"],Xt=["for"],Zt={key:8,class:"form-floating"},xt=["id","onUpdate:modelValue"],es=["for"],ts=["onClick"],ss={key:0,class:"fa-solid fa-eye mr-2"},os={key:1,class:"fa-solid fa-eye-slash mr-2"},ls={key:2},is={key:3},ns={colspan:"2"},as={key:0,class:"form-floating mb-3"},ds=["id","onUpdate:modelValue"],rs=["for"],cs={key:1,class:"form-floating"},us=e("label",{class:"form-label",id:"bot-domain"},"JSON-код",-1),ms={key:2,class:"form-floating"},hs=["onUpdate:modelValue","id"],_s=["for"],ps={key:3,class:"form-floating"},bs=["onUpdate:modelValue","id"],fs=["for"],gs={key:1,class:"row"},vs=e("div",{class:"col-12"},[e("p",null,"Параметры скрипта еще не добавлены")],-1),ys=[vs],$s={class:"btn btn-primary text-white w-100 mt-2 p-3"},ks={key:0},Fs={key:1},ws={props:["item"],components:{Vue3JsonEditor:re},data(){return{filters:[],simple:!0,configTypes:[{title:"Текстовый или числовой параметр",type:"text"},{title:"Большое текстовое поле",type:"large-text"},{title:"Канал обратной связи",type:"channel"},{title:"Логический оператор",type:"boolean"},{title:"Ссылка на изображение",type:"image"},{title:"Цвет",type:"color"},{title:"Geo",type:"geo"},{title:"Номер телефона",type:"phone"},{title:"ID скрипта",type:"script"},{title:"ID страницы",type:"page"},{title:"JSON",type:"json"}],bot:null,photos:[],slugForm:{bot_id:null,id:null,command:null,comment:null,slug:null,parent_id:null,config:[],is_global:!0}}},computed:{...S(["getCurrentBot"]),filteredConfigs(){return this.filters.length==0?this.slugForm.config:this.slugForm.config.filter(o=>this.filters.indexOf(o.type)>=0)}},mounted(){this.loadCurrentBot(),this.item&&(this.slugForm.id=this.item.id||null,this.slugForm.command=this.item.command,this.slugForm.comment=this.item.comment,this.slugForm.bot_id=this.item.bot_id,this.slugForm.slug=this.item.slug,this.slugForm.parent_id=this.item.parent_id||null,this.slugForm.config=this.item.config||[],this.slugForm.is_global=this.item.is_global||!1)},methods:{loadSlugParentParams(){this.$store.dispatch("loadSlugParams",{parentSlugId:this.slugForm.parent_id?this.slugForm.parent_id:this.slugForm.id}).then(o=>{let t=o.config,s=0;t.forEach(d=>{this.slugForm.config.findIndex(a=>a.key===d.key)===-1&&(s++,this.slugForm.config.unshift(d))}),this.$notify({title:"Конструктор команд",text:`Параметры успешно подгружены: Обновлено ${s} параметров`,type:"success"})})},toggleFilter(o){let t=this.filters.indexOf(o);t>=0?this.filters.splice(t,1):this.filters.push(o)},addTextTo(o,t={text:null}){this.slugForm.config[o].value=t.text},loadCurrentBot(o=null){return this.$store.dispatch("updateCurrentBot",{bot:o}).then(()=>{this.bot=this.getCurrentBot})},submit(){let o=new FormData;Object.keys(this.slugForm).forEach(t=>{const s=this.slugForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),this.$store.dispatch(this.slugForm.id===null?"createSlug":"updateSlug",{slugForm:o}).then(t=>{this.$notify({title:"Конструктор команд",text:"Команда успешно обновлена",type:"success"}),this.slugForm.id===null&&(this.slugForm.id=null,this.slugForm.command=null,this.slugForm.comment=null,this.slugForm.bot_id=null,this.slugForm.slug=null,this.slugForm.config=[],this.slugForm.is_global=!0),this.$emit("callback")}).catch(t=>{})},onJsonChange(o,t){this.filteredConfigs[t].value=o},addConfig(o){this.slugForm.config.splice(0,0,{key:null,value:null,type:o||"text"})},move(o,t=0){let s=this.slugForm.config[o],d=this.slugForm.config.length||0,n=t===0?o-1>=0?o-1:d-1:o<d-1?o+1:0;this.slugForm.config[o]=this.slugForm.config[n],this.slugForm.config[n]=s},removeConfigItem(o){try{this.slugForm.config.splice(o,1)}catch{this.slugForm.config=[]}},selectSlug(o,t){this.filteredConfigs[t].value=o.id},selectPhoto(o,t){this.filteredConfigs[t].value=o.file_id}}},_e=Object.assign(ws,{__name:"SlugTableForm",setup(o){return(t,s)=>{const d=Q("mask");return l(),i("form",{onSubmit:s[4]||(s[4]=C((...n)=>t.submit&&t.submit(...n),["prevent"]))},[e("div",Ae,[c(e("input",{type:"text","onUpdate:modelValue":s[0]||(s[0]=n=>t.slugForm.command=n),class:"form-control",id:"floatingInput",placeholder:"name@example.com",required:""},null,512),[[_,t.slugForm.command]]),Ie]),e("div",Qe,[c(e("input",{type:"text","onUpdate:modelValue":s[1]||(s[1]=n=>t.slugForm.slug=n),class:"form-control",id:"floatingInput",placeholder:"name@example.com",required:""},null,512),[[_,t.slugForm.slug]]),Te]),e("div",Me,[c(e("input",{type:"text","onUpdate:modelValue":s[2]||(s[2]=n=>t.slugForm.comment=n),class:"form-control",id:"floatingInput",placeholder:"name@example.com",required:""},null,512),[[_,t.slugForm.comment]]),De]),Re,Be,e("div",Ee,[Le,e("ul",Ke,[(l(!0),i(f,null,$(t.configTypes,(n,a)=>(l(),i("li",null,[e("a",{class:"dropdown-item",onClick:h=>t.addConfig(n.type)},u(n.title||"Не установлен"),9,Ne)]))),256))])]),e("div",Je,[e("div",He,[e("p",null,[m("Фильтры: "),(l(!0),i(f,null,$(t.configTypes,(n,a)=>(l(),i("span",{class:g(["badge mb-1 bg-gray-100 cursor-pointer mr-1",{"bg-info":t.filters.indexOf(n.type)>=0}]),onClick:h=>t.toggleFilter(n.type)},u(n.type),11,Ye))),256))]),Ge,e("button",{type:"button",onClick:s[3]||(s[3]=(...n)=>t.loadSlugParentParams&&t.loadSlugParentParams(...n)),class:"btn btn-outline-info"},[We,m("Загрузить ")])])]),t.filteredConfigs.length>0?(l(),i("div",Xe,[e("div",Ze,[e("table",xe,[et,e("tbody",null,[(l(!0),i(f,null,$(t.filteredConfigs,(n,a)=>(l(),i(f,null,[e("tr",{class:g({"table-light":a%2===0})},[e("td",tt,[e("div",st,[e("div",ot,[lt,e("ul",it,[e("li",null,[e("a",{class:"dropdown-item",onClick:h=>t.removeConfigItem(a),href:"javascript:void(0)"},[at,m(" Удалить")],8,nt)]),e("li",null,[e("a",{class:"dropdown-item",onClick:h=>t.move(a,0),href:"javascript:void(0)"},[rt,m(" Вверх")],8,dt)]),e("li",null,[e("a",{class:"dropdown-item",onClick:h=>t.move(a,1),href:"javascript:void(0)"},[ut,m(" Вниз")],8,ct)])])]),t.filteredConfigs[a].description?(l(),i("p",{key:0,class:"mb-0 font-italic font-bold",innerHTML:t.filteredConfigs[a].description},null,8,mt)):(l(),i("p",ht,"без описания")),e("div",_t,[e("button",pt,u(t.filteredConfigs[a].type),1),e("ul",bt,[(l(!0),i(f,null,$(t.configTypes,h=>(l(),i("li",null,[e("a",{class:"dropdown-item",onClick:p=>t.filteredConfigs[a].type=h.type},u(h.title||n.type),9,ft)]))),256))])])])])],2),e("tr",{class:g({"table-light":a%2===0})},[e("td",gt,[e("div",vt,[c(e("input",{type:"text",class:"form-control","onUpdate:modelValue":h=>t.filteredConfigs[a].key=h,id:"field-input-key-"+a,placeholder:"name@example.com"},null,8,yt),[[_,t.filteredConfigs[a].key]]),e("label",{for:"field-input-key-"+a},"Ключ",8,$t)])]),e("td",null,[t.filteredConfigs[a].type==="text"||t.filteredConfigs[a].type==="channel"?(l(),i("div",kt,[c(e("input",{type:"text",class:"form-control",id:"field-input-"+a,"onUpdate:modelValue":h=>t.filteredConfigs[a].value=h,placeholder:"name@example.com"},null,8,Ft),[[_,t.filteredConfigs[a].value]]),e("label",{for:"field-input-"+a},"Значение",8,wt)])):r("",!0),t.filteredConfigs[a].type==="boolean"?(l(),i("div",Ct,[c(e("input",{class:"form-check-input","onUpdate:modelValue":h=>t.filteredConfigs[a].value=h,type:"checkbox",value:"false",id:"filtered-config-"+a+"-checkbox"},null,8,St),[[k,t.filteredConfigs[a].value]]),e("label",{class:"form-check-label",for:"filtered-config-"+a+"-checkbox"},u(t.filteredConfigs[a].value?"Включено":"Выключено"),9,jt)])):r("",!0),t.filteredConfigs[a].type==="geo"?(l(),i("div",Vt,[c(e("input",{class:"form-control",placeholder:"##.######,##.######","onUpdate:modelValue":h=>t.filteredConfigs[a].value=h,type:"text",id:"filtered-config-"+a+"-geo"},null,8,qt),[[d,"##.######,##.######"],[_,t.filteredConfigs[a].value]]),e("label",{for:"filtered-config-"+a+"-geo"},"Значение",8,zt)])):r("",!0),t.filteredConfigs[a].type==="script"?(l(),i("button",{key:3,type:"button",class:"btn btn-outline-light text-primary w-100 py-3",onClick:h=>n.content_show=!n.content_show},[n.content_show?(l(),i("i",Ot)):(l(),i("i",Ut)),n.content_show?(l(),i("span",It,"Скрыть выбор скриптов")):(l(),i("span",At,"Показать выбор скриптов"))],8,Pt)):r("",!0),t.filteredConfigs[a].type==="page"?(l(),i("button",{key:4,type:"button",class:"btn btn-outline-light text-primary w-100 py-3",onClick:h=>n.content_show=!n.content_show},[n.content_show?(l(),i("i",Mt)):(l(),i("i",Tt)),n.content_show?(l(),i("span",Rt,"Скрыть выбор страницы")):(l(),i("span",Dt,"Показать выбор страницы"))],8,Qt)):r("",!0),t.filteredConfigs[a].type==="phone"?(l(),i("div",Bt,[c(e("input",{class:"form-control",placeholder:"+7(###)###-##-##","onUpdate:modelValue":h=>t.filteredConfigs[a].value=h,type:"text",id:"filtered-config-"+a+"-phone"},null,8,Et),[[d,"+7(###)###-##-##"],[_,t.filteredConfigs[a].value]]),e("label",{for:"filtered-config-"+a+"-phone"},"Значение",8,Lt)])):r("",!0),t.filteredConfigs[a].type==="json"?(l(),i("button",{key:6,type:"button",class:"btn btn-outline-light text-primary w-100 py-3",onClick:h=>n.content_show=!n.content_show},[n.content_show?(l(),i("i",Jt)):(l(),i("i",Nt)),n.content_show?(l(),i("span",Yt,"Скрыть редактор JSON")):(l(),i("span",Ht,"Показать редактор JSON"))],8,Kt)):r("",!0),t.filteredConfigs[a].type==="color"?(l(),i("div",Gt,[c(e("input",{class:"form-control","onUpdate:modelValue":h=>t.filteredConfigs[a].value=h,type:"color",id:"filtered-config-"+a+"-color"},null,8,Wt),[[_,t.filteredConfigs[a].value]]),e("label",{for:"filtered-config-"+a+"-color"},[e("p",{style:de({color:t.filteredConfigs[a].value})},"Цвет: "+u(t.filteredConfigs[a].value),5)],8,Xt)])):r("",!0),t.filteredConfigs[a].type==="large-text"?(l(),i("div",Zt,[c(e("textarea",{class:"form-control",id:"field-input-"+a,"onUpdate:modelValue":h=>t.filteredConfigs[a].value=h,placeholder:"name@example.com"},`
                            `,8,xt),[[_,t.filteredConfigs[a].value]]),e("label",{for:"field-input-"+a},"Значение",8,es)])):r("",!0),t.filteredConfigs[a].type==="image"?(l(),i("button",{key:9,type:"button",class:"btn btn-outline-light text-primary w-100 py-3",onClick:h=>n.content_show=!n.content_show},[n.content_show?(l(),i("i",os)):(l(),i("i",ss)),n.content_show?(l(),i("span",is,"Скрыть выбор изображений")):(l(),i("span",ls,"Показать выбор изображений"))],8,ts)):r("",!0)])],2),n.content_show?(l(),i("tr",{key:0,class:g({"table-light":a%2===0})},[e("td",ns,[t.filteredConfigs[a].type==="image"?(l(),i("div",as,[c(e("input",{class:"form-control mb-2",id:"field-input-"+a,type:"text",disabled:"true","onUpdate:modelValue":h=>t.filteredConfigs[a].value=h,placeholder:"name@example.com"},null,8,ds),[[_,t.filteredConfigs[a].value]]),e("label",{for:"field-input-"+a},"FileId ссылка на изображение",8,rs),b(P,{"need-video":!1,"need-photo":!0,selected:[t.filteredConfigs[a].value],onSelect:h=>t.selectPhoto(h,a)},null,8,["selected","onSelect"])])):r("",!0),t.filteredConfigs[a].type==="json"?(l(),i("div",cs,[us,b(j(re),{mode:"form",modelValue:t.filteredConfigs[a].value,"onUpdate:modelValue":h=>t.filteredConfigs[a].value=h,"show-btns":!1,expandedOnStart:!0,onJsonChange:h=>t.onJsonChange(h,a)},null,8,["modelValue","onUpdate:modelValue","onJsonChange"])])):r("",!0),t.filteredConfigs[a].type==="page"?(l(),i("div",ms,[c(e("input",{class:"form-control mb-2","onUpdate:modelValue":h=>t.filteredConfigs[a].value=h,type:"text",id:"filtered-config-"+a+"-script"},null,8,hs),[[_,t.filteredConfigs[a].value]]),e("label",{for:"filtered-config-"+a+"-script"},"Значение",8,_s),b(K,{selected:[t.filteredConfigs[a].value],onCallback:h=>t.selectSlug(h,a),editor:!1},null,8,["selected","onCallback"])])):r("",!0),t.filteredConfigs[a].type==="script"?(l(),i("div",ps,[c(e("input",{class:"form-control mb-2","onUpdate:modelValue":h=>t.filteredConfigs[a].value=h,type:"text",id:"filtered-config-"+a+"-script"},null,8,bs),[[_,t.filteredConfigs[a].value]]),e("label",{for:"filtered-config-"+a+"-script"},"Значение",8,fs),b(qe,{onSelect:h=>t.selectSlug(h,a)},null,8,["onSelect"])])):r("",!0)])],2)):r("",!0)],64))),256))])])])])):(l(),i("div",gs,ys)),e("button",$s,[t.slugForm.id==null?(l(),i("span",ks," Сохранить команду ")):(l(),i("span",Fs," Обновить команду "))])],32)}}});const Cs={class:"card-header d-flex justify-content-between align-items-center"},Ss={class:"d-flex"},js=e("i",{class:"fa-solid fa-arrow-left"},null,-1),Vs=[js],qs={class:"dropdown"},zs=e("i",{class:"fa-solid fa-ellipsis"},null,-1),Ps=[zs],Us={class:"dropdown-menu"},Os=["data-bs-target"],As=e("i",{class:"fa-regular fa-pen-to-square mr-1"},null,-1),Is=e("i",{class:"fa-solid fa-clone mr-1"},null,-1),Qs=e("i",{class:"fa-regular fa-trash-can text-danger mr-1"},null,-1),Ts={key:0,class:"fa-solid fa-arrow-up-short-wide"},Ms={key:1,class:"fa-solid fa-arrow-down-short-wide"},Ds={class:"card-body"},Rs={class:"row"},Bs={class:"col-12"},Es={key:0},Ls={key:1,class:"list-group list-group-numbered"},Ks={class:"list-group-item d-flex justify-content-between align-items-start"},Ns={class:"ms-2 me-auto"},Js=e("div",{class:"fw-bold"},"Идентификатор",-1),Hs={class:"list-group-item d-flex justify-content-between align-items-start"},Ys={class:"ms-2 me-auto"},Gs=e("div",{class:"fw-bold"},"Команда",-1),Ws={class:"list-group-item d-flex justify-content-between align-items-start"},Xs={class:"ms-2 me-auto"},Zs=e("div",{class:"fw-bold"},"Мнемоническое имя",-1),xs={class:"list-group-item d-flex justify-content-between align-items-start"},eo={class:"ms-2 me-auto"},to=e("div",{class:"fw-bold"},"Пояснение",-1),so={key:0,class:"list-group-item d-flex justify-content-between align-items-start"},oo={class:"ms-2 me-auto"},lo=e("div",{class:"fw-bold"},"Набор параметров скрипта",-1),io={key:1,class:"list-group-item d-flex justify-content-between align-items-start"},no=e("div",{class:"ms-2 me-auto"},[e("div",{class:"fw-bold"},"Привязана страница")],-1),ao=[no],ro={key:2,class:"list-group-item d-flex justify-content-between align-items-start"},co=e("div",{class:"ms-2 me-auto"},[e("div",{class:"fw-bold"},"Глобальный скрипт")],-1),uo=[co],mo={class:"list-group-item d-flex justify-content-between align-items-start"},ho={class:"ms-2 me-auto w-100"},_o=e("div",{class:"fw-bold"},"Перенести данные из:",-1),po=e("option",{value:null},"Не выбрано",-1),bo=["value"],fo=e("p",{class:"my-2"},[e("em",null,"Перенос данных затирает текущие данные в данном скрипте")],-1),go=["disabled"],vo=["id"],yo={class:"modal-dialog modal-fullscreen"},$o={class:"modal-content"},ko={class:"modal-header"},Fo={class:"modal-title",id:"exampleModalLabel"},wo=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),Co={class:"modal-body"},So=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),jo={props:["item","bot","selectMode","isActive"],data(){return{selected_slug_id:null,slugs:[],load:!1,simple:!0}},watch:{simple:function(){this.simple||this.loadAllSlugs()}},mounted(){},methods:{selectCard(){this.$emit("select",this.item)},slugFormCallback(){this.load=!0,this.$emit("callback"),this.$nextTick(()=>{this.load=!1})},editSlug(){this.load=!0,this.$nextTick(()=>{this.load=!1})},selectSlug(){this.load=!0,this.$emit("select",this.item),this.$nextTick(()=>{this.load=!1})},duplicateSlug(){this.load=!0,this.$store.dispatch("duplicateSlug",{dataObject:{slugId:this.item.id}}).then(o=>{this.$notify({title:"Конструктор команд",text:"Команда успешно продублирована",type:"success"}),this.$emit("callback"),this.$nextTick(()=>{this.load=!1})}).catch(o=>{this.$emit("callback"),this.$nextTick(()=>{this.load=!1})}),this.$emit("callback"),this.$nextTick(()=>{this.load=!1})},submitRelocateData(){this.$store.dispatch("relocateSlugActionData",{slug_sender_id:this.selected_slug_id,slug_recipient_id:this.item.id,bot_id:this.bot.id}).then(o=>{this.$notify({title:"Конструктор команд",text:"Данные команды успешно перенесены",type:"success"})}).catch(o=>{this.$notify({title:"Конструктор команд",text:"Ошибка переноса данных",type:"error"})})},loadAllSlugs(){this.$store.dispatch("loadAllSlugs",{botId:this.bot.id}).then(o=>{this.slugs=o.data})},removeSlug(){this.load=!0,this.$store.dispatch("removeSlug",{dataObject:{slugId:this.item.id}}).then(o=>{this.$notify({title:"Конструктор команд",text:"Команда успешно удалена",type:"success"}),this.$emit("callback"),this.$nextTick(()=>{this.load=!1})}).catch(o=>{this.$emit("callback"),this.$nextTick(()=>{this.load=!1})})}}},Vo=Object.assign(jo,{__name:"Slug",setup(o){return(t,s)=>(l(),i(f,null,[e("div",{class:g(["card",{"deprecated-slug":o.item.deprecated_at!=null,"global-slug":o.item.is_global,"bg-success text-white":o.isActive}])},[e("div",Cs,[e("div",Ss,[e("button",{onClick:s[0]||(s[0]=(...d)=>t.selectSlug&&t.selectSlug(...d)),type:"button",title:"Выбрать команду",class:g(["btn btn-outline-primary mr-2",{"text-white":o.isActive}])},Vs,2),e("div",qs,[e("button",{class:g([{"text-white border-white":o.isActive},"btn btn-outline-secondary"]),type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},Ps,2),e("ul",Us,[e("li",null,[e("a",{class:"dropdown-item cursor-pointer",onClick:s[1]||(s[1]=(...d)=>t.editSlug&&t.editSlug(...d)),"data-bs-toggle":"modal","data-bs-target":"#edit-slug-"+o.item.id},[As,m(" Редактировать")],8,Os)]),e("li",null,[e("a",{class:"dropdown-item cursor-pointer",onClick:s[2]||(s[2]=(...d)=>t.duplicateSlug&&t.duplicateSlug(...d))},[Is,m(" Дублировать")])]),e("li",null,[e("a",{class:"dropdown-item cursor-pointer",onClick:s[3]||(s[3]=(...d)=>t.removeSlug&&t.removeSlug(...d))},[Qs,m(" Удалить")])])])])]),e("span",null,[e("small",null,[e("strong",null,"#"+u(o.item.id),1)])]),e("button",{type:"button",onClick:s[4]||(s[4]=d=>t.simple=!t.simple),class:g([{"text-white border-white":o.isActive},"btn btn-outline-primary ml-2"])},[t.simple?(l(),i("i",Ts)):(l(),i("i",Ms))],2)]),e("div",Ds,[e("div",Rs,[e("div",Bs,[t.simple?(l(),i("p",Es,u(o.item.command||"Нет команды"),1)):(l(),i("ol",Ls,[e("li",Ks,[e("div",Ns,[Js,m(" №"+u(o.item.id||"Нет идентификатора"),1)])]),e("li",Hs,[e("div",Ys,[Gs,m(" "+u(o.item.command||"Нет команды"),1)])]),e("li",Ws,[e("div",Xs,[Zs,m(" "+u(o.item.slug||"Slug"),1)])]),e("li",xs,[e("div",eo,[to,m(" "+u(o.item.comment||"Пояснение не указано"),1)])]),o.item.config?(l(),i("li",so,[e("div",oo,[lo,o.item.config?(l(!0),i(f,{key:0},$(o.item.config,d=>(l(),i("p",null,[e("strong",null,u(d.key||"Ключ не найден")+":",1),m(u(d.value||"Не указано"),1)]))),256)):r("",!0)])])):r("",!0),o.item.page?(l(),i("li",io,ao)):r("",!0),o.item.is_global?(l(),i("li",ro,uo)):r("",!0),e("li",mo,[e("div",ho,[e("form",{onSubmit:s[6]||(s[6]=C((...d)=>t.submitRelocateData&&t.submitRelocateData(...d),["prevent"]))},[_o,c(e("select",{class:"form-control w-100","onUpdate:modelValue":s[5]||(s[5]=d=>t.selected_slug_id=d),required:""},[po,(l(!0),i(f,null,$(t.slugs,d=>(l(),i("option",{value:d.id},"#"+u(d.id)+" "+u(d.slug||"Не указан"),9,bo))),256))],512),[[T,t.selected_slug_id]]),fo,e("button",{disabled:t.selected_slug_id==null,class:"btn btn-outline-warning w-100"}," Выполнить перенос ",8,go)],32)])])]))])])])],2),e("div",{class:"modal fade",id:"edit-slug-"+o.item.id,tabindex:"-1"},[e("div",yo,[e("div",$o,[e("div",ko,[e("h5",Fo,[m("Редактирование команды #"),e("span",null,u(o.item.id),1)]),wo]),e("div",Co,[t.load?r("",!0):(l(),y(_e,{key:0,item:o.item,onCallback:t.slugFormCallback},null,8,["item","onCallback"]))]),So])])],8,vo)],64))}}),qo={key:0,class:"row"},zo={class:"col-12 mb-2"},Po={key:0},Uo=e("i",{class:"fa-solid fa-scroll"},null,-1),Oo={key:1},Ao=e("i",{class:"fa-regular fa-square-minus"},null,-1),Io={key:0,class:"col-12"},Qo={class:"col-12"},To={class:"form-floating mb-3"},Mo=e("label",{for:"floatingInput"},"Быстрый поиск команды",-1),Do={class:"col-12 mb-2"},Ro={class:"form-check"},Bo={class:"form-check-label",for:"need_global"},Eo={key:0},Lo={key:1},Ko={class:"form-check"},No=e("label",{class:"form-check-label",for:"need_show_deleted"}," Удаленные ",-1),Jo={key:1,class:"mb-3 col-12 col-sm-12"},Ho={class:"table"},Yo=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"#"),e("th",{scope:"col"},"Команда"),e("th",{scope:"col"},"Пояснение"),e("th",{scope:"col"},"Глобальный"),e("th",{scope:"col"},"Действия")])],-1),Go=["onClick"],Wo={key:0},Xo=e("i",{class:"fa-solid fa-check text-success"},null,-1),Zo=[Xo],xo={key:1},el=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),tl=[el],sl={class:"dropdown"},ol=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),ll={class:"dropdown-menu"},il={key:0},nl=["onClick"],al=e("i",{class:"fa-solid fa-arrow-left mr-1"},null,-1),dl={key:1},rl=["onClick"],cl=e("a",{class:"dropdown-item cursor-pointer","data-bs-toggle":"modal","data-bs-target":"#edit-table-slug"},[e("i",{class:"fa-regular fa-pen-to-square mr-1"}),m(" Редактировать")],-1),ul=[cl],ml=["onClick"],hl=e("i",{class:"fa-solid fa-clone mr-1"},null,-1),_l=["href"],pl=e("i",{class:"fa-regular fa-file-excel mr-1"},null,-1),bl={key:2},fl=["onClick"],gl=e("i",{class:"fa-regular fa-trash-can text-danger mr-1"},null,-1),vl={key:3},yl=["onClick"],$l=e("i",{class:"fa-regular fa-trash-can text-danger mr-1"},null,-1),kl={key:3,class:"mb-3 col-md-12"},Fl=e("div",{class:"alert alert-danger",role:"alert"}," У Вас еще нет добавленных скриптов! ",-1),wl=[Fl],Cl={class:"modal fade",id:"edit-table-slug",tabindex:"-1"},Sl={class:"modal-dialog modal-fullscreen"},jl={key:0,class:"modal-content"},Vl={class:"modal-header"},ql={class:"modal-title",id:"exampleModalLabel"},zl=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),Pl={class:"modal-body"},Ul={class:"row"},Ol={class:"col-12"},Al=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),Il={props:["selected","command","canSelect"],data(){return{bot:null,relocated_slug_id:null,need_global:!0,need_show_deleted:!0,show:!1,load:!1,slugs:[],paginate:[],selectedSlug:null,ownSearch:null,slugForm:{command:null,comment:null,slug:null}}},watch:{ownSearch:function(o,t){this.loadSlugs()},need_global:function(o,t){this.loadSlugs()},need_show_deleted:function(o,t){this.loadSlugs()}},computed:{...S(["getCurrentBot","getSlugs","getSlugsPaginateObject"])},mounted(){this.loadCurrentBot().then(()=>{this.loadSlugs(),this.command&&this.$nextTick(()=>{this.slugForm.command=this.command})})},methods:{nextSlugs(o){this.loadSlugs(o)},loadSlugs(o=0){return console.log("selected",this.selected),this.$store.dispatch("loadSlugs",{dataObject:{botId:this.bot.id,needGlobal:this.need_global,needDeleted:this.need_show_deleted,search:this.ownSearch||null},page:o}).then(t=>{this.slugs=this.getSlugs,this.paginate=this.getSlugsPaginateObject})},loadCurrentBot(o=null){return this.$store.dispatch("updateCurrentBot",{bot:o}).then(()=>{this.bot=this.getCurrentBot})},callbackSlugs(){this.loadSlugs()},selectSlug(o){this.load=!0,this.$nextTick(()=>{this.selectedSlug=o,this.load=!1}),this.$emit("select",o)},selectCard(){this.$emit("select",this.item)},slugFormCallback(){this.load=!0;const o=this.selectedSlug;this.loadSlugs().then(()=>{let t=this.slugs.find(s=>s.id===o.id);this.selectSlug(t||null)}),this.$emit("callback"),this.$nextTick(()=>{this.load=!1})},editSlug(){this.load=!0,this.$nextTick(()=>{this.load=!1})},duplicateSlug(o){this.load=!0,this.$store.dispatch("duplicateSlug",{dataObject:{slugId:o.id}}).then(t=>{this.$notify({title:"Конструктор команд",text:"Команда успешно продублирована",type:"success"}),this.$emit("callback"),this.$nextTick(()=>{this.load=!1})}).catch(t=>{this.$emit("callback"),this.$nextTick(()=>{this.load=!1})}),this.loadSlugs(),this.$emit("callback"),this.$nextTick(()=>{this.load=!1})},submitRelocateData(){this.$store.dispatch("relocateSlugActionData",{slug_sender_id:this.relocated_slug_id,slug_recipient_id:this.item.id,bot_id:this.bot.id}).then(o=>{this.$notify({title:"Конструктор команд",text:"Данные команды успешно перенесены",type:"success"})}).catch(o=>{this.$notify({title:"Конструктор команд",text:"Ошибка переноса данных",type:"error"})})},restoreSlug(o){this.load=!0,this.$store.dispatch("restoreSlug",{dataObject:{slugId:o.id}}).then(t=>{this.$notify({title:"Конструктор команд",text:"Команда успешно восстановлена",type:"success"}),this.loadSlugs(),this.$nextTick(()=>{this.load=!1})}).catch(t=>{this.$emit("callback"),this.$nextTick(()=>{this.load=!1})})},removeSlug(o){this.load=!0,this.$store.dispatch("removeSlug",{dataObject:{slugId:o.id}}).then(t=>{this.$notify({title:"Конструктор команд",text:"Команда успешно удалена",type:"success"}),this.loadSlugs()}).catch(t=>{this.$emit("callback"),this.$nextTick(()=>{this.load=!1})})}}},Ql=Object.assign(Il,{__name:"BotSlugTableList",setup(o){return(t,s)=>(l(),i(f,null,[t.bot?(l(),i("div",qo,[e("div",zo,[e("button",{type:"button",onClick:s[0]||(s[0]=d=>t.show=!t.show),class:"btn btn-outline-success p-3 w-100"},[t.show?(l(),i("span",Oo,[Ao,m(" Свернуть форму добавления")])):(l(),i("span",Po,[Uo,m(" Добавить глобальный скрипт")]))])]),t.show?(l(),i("div",Io,[t.bot?(l(),y(x,{key:0,"can-add":!0,bot:t.bot,onCallback:t.loadSlugs},null,8,["bot","onCallback"])):r("",!0)])):r("",!0),e("div",Qo,[e("div",To,[c(e("input",{type:"search","onUpdate:modelValue":s[1]||(s[1]=d=>t.ownSearch=d),class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,512),[[_,t.ownSearch]]),Mo])]),e("div",Do,[e("div",Ro,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[2]||(s[2]=d=>t.need_global=d),type:"checkbox",id:"need_global"},null,512),[[k,t.need_global]]),e("label",Bo,[t.need_global?(l(),i("span",Eo,"Глобальные")):(l(),i("span",Lo,"Локальные"))])]),e("div",Ko,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[3]||(s[3]=d=>t.need_show_deleted=d),type:"checkbox",id:"need_show_deleted"},null,512),[[k,t.need_show_deleted]]),No])]),t.slugs&&t.bot?(l(),i("div",Jo,[e("table",Ho,[Yo,e("tbody",null,[(l(!0),i(f,null,$(t.slugs,(d,n)=>(l(),i("tr",{class:g({"border-info":d.deleted_at==null,"border-danger":d.deleted_at!=null})},[e("th",{scope:"row",class:g({"text-danger":d.deleted_at!=null})},u(d.id||"Нет идентификатора"),3),e("td",{onClick:a=>t.selectSlug(d),"data-bs-toggle":"modal","data-bs-target":"#edit-table-slug",class:g({"text-danger":d.deleted_at!=null})},u(d.command||"Нет команды"),11,Go),e("td",{class:g({"text-danger":d.deleted_at!=null})},u(d.comment||"Пояснение не указано"),3),e("td",null,[d.is_global?(l(),i("span",Wo,Zo)):(l(),i("span",xo,tl))]),e("td",null,[e("div",sl,[ol,e("ul",ll,[o.canSelect?(l(),i("li",il,[e("a",{onClick:a=>t.selectSlug(d),title:"Выбрать команду",class:"dropdown-item cursor-pointer"},[al,m(" Выбрать команду ")],8,nl)])):r("",!0),o.canSelect?(l(),i("hr",dl)):r("",!0),e("li",{onClick:a=>t.selectSlug(d)},ul,8,rl),e("li",null,[e("a",{class:"dropdown-item cursor-pointer",onClick:a=>t.duplicateSlug(d)},[hl,m(" Дублировать")],8,ml)]),e("li",null,[e("a",{class:"dropdown-item cursor-pointer",target:"_blank",href:"/admin/slugs/action-data-export/"+d.id},[pl,m(" Скачать данные участников")],8,_l)]),d.deleted_at==null?(l(),i("li",bl,[e("a",{class:"dropdown-item cursor-pointer",onClick:a=>t.removeSlug(d)},[gl,m(" Удалить")],8,fl)])):r("",!0),d.deleted_at!=null?(l(),i("li",vl,[e("a",{class:"dropdown-item cursor-pointer",onClick:a=>t.restoreSlug(d)},[$l,m(" Восстановить")],8,yl)])):r("",!0)])])])],2))),256))])])])):r("",!0),t.paginate?(l(),y(q,{key:2,onPagination_page:t.nextSlugs,pagination:t.paginate},null,8,["onPagination_page","pagination"])):r("",!0),t.slugs.length===0?(l(),i("div",kl,wl)):r("",!0)])):r("",!0),e("div",Cl,[e("div",Sl,[t.selectedSlug&&!t.load?(l(),i("div",jl,[e("div",Vl,[e("h5",ql,[m("Редактирование команды #"),e("span",null,u(t.selectedSlug.id),1)]),zl]),e("div",Pl,[e("div",Ul,[e("div",Ol,[b(_e,{item:t.selectedSlug,onCallback:t.slugFormCallback},null,8,["item","onCallback"])])])]),Al])):r("",!0)])])],64))}}),Tl={class:"row"},Ml={class:"col-12"},Dl=e("h6",null,"Добавление нового скрипта в бота",-1),Rl={key:0,class:"row"},Bl={class:"col-md-6 col-lg-4 col-sm-6 col-12 mb-2"},El={key:1,class:"row"},Ll=e("div",{class:"col-12"},[e("div",{class:"alert alert-danger",role:"alert"},' У Вас еще нет добавленных скриптов! Воспользуйтесь разделом "Скрипты" для добавления. ')],-1),Kl=[Ll],Nl={props:["bot","global","selected"],data(){return{load:!1,search:null,slugs:[],paginate:[]}},computed:{...S(["getSlugs","getSlugsPaginateObject"]),filteredSlugs(){return this.slugs?this.slugs.length===0?[]:this.search==null?this.slugs:this.slugs.filter(o=>{let t=o.slug||"",s=o.command||"",d=o.comment||"";return s.toLowerCase().indexOf(this.search.toLowerCase())!==-1||d.toLowerCase().indexOf(this.search.toLowerCase())!==-1||t.toLowerCase().indexOf(this.search.toLowerCase())!==-1}):[]}},mounted(){this.loadSlugs()},methods:{nextSlugs(o){this.loadSlugs(o)},selectSlug(o){this.$emit("callback",{id:o.id||null,slug:o.slug,comment:o.comment,command:o.command}),this.$notify("Вы выбрали скрипт из списка!")},loadSlugs(o=0){this.$store.dispatch("loadSlugs",{dataObject:{botId:this.bot.id,search:this.search||null,needGlobal:this.global},page:o}).then(t=>{this.slugs=this.getSlugs,this.paginate=this.getSlugsPaginateObject})},callbackSlugs(){}}},Jl=Object.assign(Nl,{__name:"BotSlugListSimple",setup(o){return(t,s)=>(l(),i("div",Tl,[e("div",Ml,[Dl,e("div",null,[c(e("input",{type:"text",class:"form-control mt-1 mb-1","onUpdate:modelValue":s[0]||(s[0]=d=>t.search=d),onKeyup:s[1]||(s[1]=(...d)=>t.loadSlugs&&t.loadSlugs(...d)),placeholder:"Поиск нужного скрипта по описанию"},null,544),[[_,t.search]])]),t.slugs.length>0?(l(),i("div",Rl,[(l(!0),i(f,null,$(t.slugs,(d,n)=>(l(),i("div",Bl,[b(Vo,{"is-active":(o.selected||[]).indexOf(d.id)!=-1,item:d,bot:o.bot,onCallback:t.callbackSlugs,onSelect:t.selectSlug},null,8,["is-active","item","bot","onCallback","onSelect"])]))),256)),t.paginate?(l(),y(q,{key:0,onPagination_page:t.nextSlugs,pagination:t.paginate},null,8,["onPagination_page","pagination"])):r("",!0)])):(l(),i("div",El,Kl))])]))}});const Hl={props:["param"],data(){return{expressions:[{expression:null,description:"Нет проверки"},{expression:"/([a-z0-9]+)/i",description:"Проверка набора из латинских букв и цифр"},{expression:"/([а-яё0-9]+)/iu",description:"Проверка на кириллицу и цифры"},{expression:"/(?P<digit>\\d+)/",description:"Проверка на число"},{expression:"/^([a-z0-9_-]+.)*[a-z0-9_-]+@[a-z0-9_-]+(.[a-z0-9_-]+)*.[a-z]{2,6}$/",description:"Проверка Email"},{expression:"/^((8|+7)[- ]?)?((?d{3})?[- ]?)?[d- ]{7,10}$/",description:"Проверка номера телефона: +7(982)000-00-00"},{expression:"/^(0[1-9]|[12][0-9]|3[01])[.](0[1-9]|1[012])[.](19|20)dd$/",description:"Проверка даты по формату DD.MM.YYYY"},{expression:"/^[0-9]{4}-(0[1-9]|1[012])-(0[1-9]|1[0-9]|2[0-9]|3[01])$/",description:"Проверка даты по формату YYYY-MM-DD"},{expression:"/^(https?://)?([da-z.-]+).([a-z.]{2,6})([/w .-]*)*/?$/",description:"Проверка доменного имени"}]}},methods:{expressionsSelect(o){this.$emit("callback",{param:this.param,text:o.expression})}}},Yl={class:"dropdown"},Gl=e("button",{class:"btn btn-link dropdown-toggle",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-regular fa-registered"})],-1),Wl={class:"dropdown-menu item-with-text cursor-pointer text-muted p-2"},Xl=["onClick"];function Zl(o,t,s,d,n,a){return l(),i("div",Yl,[Gl,e("div",Wl,[e("li",null,[(l(!0),i(f,null,$(n.expressions,h=>(l(),i("a",{class:"dropdown-item",onClick:p=>a.expressionsSelect(h)},u(h.description||"-"),9,Xl))),256))])])])}const xl=U(Hl,[["render",Zl]]),ei={class:"row mt-2"},ti={class:"col-12 d-flex justify-content-between align-items-center"},si=["onClick"],oi={class:"row mb-2"},li={class:"col-3"},ii={class:"form-floating"},ni=["onUpdate:modelValue"],ai=e("label",{for:"floatingInput"},"Значение параметра 1",-1),di={class:"col-3"},ri={class:"form-floating"},ci=["onUpdate:modelValue"],ui=e("option",{value:null,selected:""},"без действия",-1),mi=["value"],hi=e("label",{for:"floatingSelect"},"Доступные операции",-1),_i={class:"col-3"},pi={class:"form-floating"},bi=["onUpdate:modelValue"],fi=e("label",{for:"floatingInput"},"Значение параметра 2",-1),gi={class:"col-3"},vi={class:"form-floating"},yi=["disabled","onUpdate:modelValue"],$i=e("label",{for:"floatingInput"},"Переменная результата",-1),ki=e("div",{class:"row"},[e("div",{class:"col-6"},[e("h6",null,"Если условие выполнено")]),e("div",{class:"col-6"},[e("h6",null,[m("Если условие "),e("span",{class:"text-danger"},"не"),m(" выполнено")])])],-1),Fi={class:"row"},wi={class:"col-6"},Ci={class:"form-floating mb-3"},Si=["onUpdate:modelValue"],ji=e("label",{for:"floatingInput"},"Текст для пользователя",-1),Vi={class:"col-6"},qi={class:"form-floating mb-3"},zi=["onUpdate:modelValue"],Pi=e("label",{for:"floatingInput"},"Текст для пользователя",-1),Ui={class:"row"},Oi={class:"col-6"},Ai={class:"form-check mb-2"},Ii=["onUpdate:modelValue","id"],Qi=["for"],Ti={class:"col-6"},Mi={class:"form-check mb-2"},Di=["onUpdate:modelValue","id"],Ri=["for"],Bi={key:1,class:"alert alert-primary d-flex align-items-center mt-2",role:"alert"},Ei=e("i",{class:"fa-solid fa-triangle-exclamation mr-2"},null,-1),Li=e("div",null," Правила не добавлены ",-1),Ki=[Ei,Li],Ni={props:["modelValue"],data(){return{rules:[],operations:[{id:0,title:"Выдать результат без обработки"},{id:1,title:"Больше"},{id:2,title:"Меньше"},{id:3,title:"Равно"},{id:4,title:"Не равно"},{id:5,title:"Сложить"},{id:6,title:"Вычесть"},{id:7,title:"Логическое И"},{id:8,title:"Логическое ИЛИ"}]}},mounted(){this.modelValue&&(this.rules=this.modelValue)},methods:{addRule(){this.rules.push({param1:null,operation:null,param2:null,use_result_as:null,text_if_true:null,text_if_false:null,keyboard_if_true:null,keyboard_if_false:null,need_keyboard_if_true:!1,need_keyboard_if_false:!1}),this.$notify({title:"Конструктор ботов",text:"Успешная создано новое правило",type:"success"}),this.$emit("update:modelValue",this.rules)},testRule(o){let t=this.rules[o];return t.operation===5||t.operation===6},removeRule(o){this.rules.splice(o,1),this.$notify({title:"Конструктор ботов",text:"Успешная удалено выбранное правило",type:"success"})}}},Ji=Object.assign(Ni,{__name:"BotDialogResultRules",setup(o){return(t,s)=>(l(),i(f,null,[e("button",{type:"button",onClick:s[0]||(s[0]=(...d)=>t.addRule&&t.addRule(...d)),class:"btn btn-outline-info"},"Добавить правило "),t.rules.length>0?(l(!0),i(f,{key:0},$(t.rules,(d,n)=>(l(),i(f,null,[e("div",ei,[e("div",ti,[e("h6",null,"Шаг "+u(n+1),1),e("button",{onClick:a=>t.removeRule(n),type:"button",class:"btn btn-link"},"удалить правило ",8,si)])]),e("div",oi,[e("div",li,[e("div",ii,[c(e("input",{type:"text",class:"form-control","onUpdate:modelValue":a=>t.rules[n].param1=a,id:"floatingInput",placeholder:"name@example.com"},null,8,ni),[[_,t.rules[n].param1]]),ai])]),e("div",di,[e("div",ri,[c(e("select",{class:"form-select","onUpdate:modelValue":a=>t.rules[n].operation=a,id:"floatingSelect","aria-label":"Floating label select example"},[ui,(l(!0),i(f,null,$(t.operations,a=>(l(),i("option",{value:a.id},u(a.title||"-"),9,mi))),256))],8,ci),[[T,t.rules[n].operation]]),hi])]),e("div",_i,[e("div",pi,[c(e("input",{type:"text","onUpdate:modelValue":a=>t.rules[n].param2=a,class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,8,bi),[[_,t.rules[n].param2]]),fi])]),e("div",gi,[e("div",vi,[c(e("input",{type:"text",disabled:!t.testRule(n),"onUpdate:modelValue":a=>t.rules[n].use_result_as=a,class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,8,yi),[[_,t.rules[n].use_result_as]]),$i])])]),ki,e("div",Fi,[e("div",wi,[e("div",Ci,[c(e("input",{type:"text","onUpdate:modelValue":a=>t.rules[n].text_if_true=a,class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,8,Si),[[_,t.rules[n].text_if_true]]),ji])]),e("div",Vi,[e("div",qi,[c(e("input",{type:"text","onUpdate:modelValue":a=>t.rules[n].text_if_false=a,class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,8,zi),[[_,t.rules[n].text_if_false]]),Pi])])]),e("div",Ui,[e("div",Oi,[e("div",Ai,[c(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":a=>t.rules[n].need_keyboard_if_true=a,id:"need-keyboard-if-true-"+n},null,8,Ii),[[k,t.rules[n].need_keyboard_if_true]]),e("label",{class:"form-check-label",for:"need-keyboard-if-true-"+n}," Нужна клавиатура ",8,Qi)]),t.rules[n].need_keyboard_if_true?(l(),y(A,{key:0,type:"inline",modelValue:t.rules[n].keyboard_if_true,"onUpdate:modelValue":a=>t.rules[n].keyboard_if_true=a},null,8,["modelValue","onUpdate:modelValue"])):r("",!0)]),e("div",Ti,[e("div",Mi,[c(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":a=>t.rules[n].need_keyboard_if_false=a,id:"need-keyboard-if-false-"+n},null,8,Di),[[k,t.rules[n].need_keyboard_if_false]]),e("label",{class:"form-check-label",for:"need-keyboard-if-false-"+n}," Нужна клавиатура ",8,Ri)]),t.rules[n].need_keyboard_if_false?(l(),y(A,{key:0,type:"inline",modelValue:t.rules[n].keyboard_if_false,"onUpdate:modelValue":a=>t.rules[n].keyboard_if_false=a},null,8,["modelValue","onUpdate:modelValue"])):r("",!0)])])],64))),256)):(l(),i("div",Bi,Ki))],64))}});const Hi={props:["modelValue","bot"],data(){return{text:null,search:null,variables:[]}},watch:{text:{handler:function(o){this.$emit("update:modelValue",this.text)},deep:!0}},computed:{filteredVariable(){return this.search?this.variables.filter(o=>o.text.indexOf(this.search)!==-1):this.variables}},mounted(){this.text=this.modelValue,this.loadVariables()},methods:{select(o){this.text||(this.text=""),this.text+=o},addAll(){this.filteredVariable.forEach(o=>{this.select(o)})},loadVariables(){this.$store.dispatch("loadDialogVariables",{bot_id:this.bot.id}).then(o=>{this.variables=o.data})}}},Yi={class:"dropdown"},Gi=e("button",{class:"btn btn-link dropdown-toggle",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-spell-check"})],-1),Wi={class:"dropdown-menu item-with-text cursor-pointer text-muted p-2"},Xi=e("div",{class:"dropdown-divider"},null,-1),Zi=e("div",{class:"dropdown-divider"},null,-1),xi=["onClick"];function en(o,t,s,d,n,a){return l(),i("div",Yi,[Gi,e("div",Wi,[c(e("input",{type:"search",class:"form-control",id:"search-description-text","onUpdate:modelValue":t[0]||(t[0]=h=>n.search=h),placeholder:"Введите текст для поиска"},null,512),[[_,n.search]]),Xi,e("button",{type:"button",onClick:t[1]||(t[1]=(...h)=>a.addAll&&a.addAll(...h)),class:"btn-outline-light btn w-100 text-primary"},"Добавить все "),Zi,(l(!0),i(f,null,$(a.filteredVariable,(h,p)=>(l(),i("p",{class:"p-1 text-left w-100 mb-1",onClick:F=>a.select(h)},u(h),9,xi))),256))])])}const se=U(Hi,[["render",en]]),tn={class:"mb-2 px-0"},sn={type:"submit",class:"btn btn-outline-success"},on=e("i",{class:"fa-regular fa-floppy-disk mr-2"},null,-1),ln={key:0},nn={key:1},an={class:"nav nav-tabs"},dn={class:"nav-item"},rn=e("i",{class:"fa-regular fa-comment-dots mr-2"},null,-1),cn={class:"nav-item"},un=e("i",{class:"fa-solid fa-link mr-2"},null,-1),mn={key:0,class:"nav-item"},hn=e("i",{class:"fa-brands fa-uncharted mr-2"},null,-1),_n={key:1,class:"nav-item"},pn=e("i",{class:"fa-solid fa-hashtag mr-2"},null,-1),bn={key:0,class:"py-2 px-0"},fn={class:"form-check mb-2"},gn=["id"],vn=["for"],yn={key:0,class:"form-check mb-2"},$n=["id"],kn=["for"],Fn={key:1,class:"alert alert-info",role:"alert"},wn={class:"form-floating mb-2"},Cn=["id"],Sn=["for"],jn={key:2,class:"card"},Vn={class:"card-body"},qn=e("div",{class:"alert alert-light"}," Данные блоки настраивают отображение данных администратором ",-1),zn={class:"form-check"},Pn=["id"],Un=["for"],On={class:"alert alert-light"},An={class:"form-floating mb-2"},In=["id"],Qn=["for"],Tn={class:"form-check"},Mn=["id"],Dn=["for"],Rn={class:"form-check"},Bn=["id"],En=["for"],Ln={key:1,class:"form-floating mb-2"},Kn=e("label",{for:"floatingInput"},"Почта для отправки результата",-1),Nn={key:3,class:"mb-2"},Jn={class:"form-floating"},Hn=e("label",{for:"floatingPassword"},"Сохранить ответ пользователя как внутреннюю переменную",-1),Yn={key:4,class:"form-check mb-2"},Gn=e("label",{class:"form-check-label",for:"need-custom-stored-value"}," Нужно изменить данные в переменной ",-1),Wn={key:5,class:"mb-2"},Xn={class:"form-floating"},Zn=e("label",{for:"custom_stored_value"},"Поместить эти данные в результат",-1),xn={key:6,class:"form-floating mb-2"},ea=["disabled","id"],ta=["for"],sa={key:1,class:"py-2 px-0"},oa={class:"mb-2"},la={key:0,class:"row"},ia=e("div",{class:"col-12"},[e("h6",null,"Выбрать следующий диалог:")],-1),na={key:0,class:"col-12 mb-2"},aa=e("i",{class:"fa-solid fa-arrows-rotate"},null,-1),da={class:"col-md-12 mb-1"},ra={type:"button",class:"btn btn-outline-primary w-100 d-flex justify-content-between align-items-center",style:{"text-align":"left"}},ca=["onClick"],ua={key:1,class:"row"},ma=e("div",{class:"col-12"},[e("div",{class:"alert alert-danger",role:"alert"}," Диалогов для связывания нет ")],-1),ha=[ma],_a={key:2,class:"py-2 px-0"},pa={class:"form-check mb-2"},ba=e("label",{class:"form-check-label",for:"need-additional-functions"}," Нужен дополнительный функционал управления ",-1),fa={key:0,class:"form-floating mb-2"},ga=["id"],va=["for"],ya={key:1,class:"mb-2"},$a={class:"d-flex justify-content-between align-items-center"},ka=e("p",{class:"mb-2"},"Регулярное выражение для валидации данных ",-1),Fa={class:"form-floating"},wa=["id"],Ca=["for"],Sa={key:2,class:"mb-2"},ja={class:"d-flex justify-content-between align-items-center"},Va=e("p",{class:"mb-2"},"Канал для отправки данных ",-1),qa={class:"form-floating"},za=["id"],Pa=["for"],Ua={key:3,class:"mb-2"},Oa={class:"form-floating"},Aa=e("option",{selected:""},"Не выбрано",-1),Ia=["value"],Qa=e("label",{for:"store_variants"},"Сохранить в переменную",-1),Ta={class:"form-check mb-2"},Ma=e("label",{class:"form-check-label",for:"need-dialog-image"}," В диалоге нужно изображение ",-1),Da={key:4,class:"card mb-2"},Ra={class:"card-body"},Ba=e("h6",null,"Фотографии к диалогу",-1),Ea={class:"photo-preview d-flex justify-content-start flex-wrap w-100"},La={for:"location-photos",style:{"margin-right":"10px"},class:"photo-loader ml-2"},Ka=e("span",null,"+",-1),Na={class:"mb-2 img-preview",style:{"margin-right":"10px"}},Ja={class:"remove"},Ha=["onClick"],Ya={class:"mb-2 img-preview",style:{"margin-right":"10px"}},Ga={class:"remove"},Wa=["onClick"],Xa={class:"form-check mb-2"},Za=e("label",{class:"form-check-label",for:"need-dialog-videos"}," В диалоге нужно видео ",-1),xa={key:5,class:"card mb-2"},ed={class:"card-body"},td=e("h6",null,"Видео к диалогу",-1),sd={class:"form-check mb-2"},od=e("label",{class:"form-check-label",for:"need-dialog-documents"}," В диалоге нужен файл ",-1),ld={key:6,class:"card mb-2"},id={class:"card-body"},nd=e("h6",null,"Документ к диалогу",-1),ad={class:"form-check mb-2"},dd=e("label",{class:"form-check-label",for:"need-dialog-menu-inline"}," В диалоге нужно меню тексту ",-1),rd={key:7,class:"card mb-2"},cd=e("div",{class:"card-header"},[e("h6",null,"Кнопки к тексту вопроса")],-1),ud={class:"card-body"},md={class:"form-check mb-2"},hd=e("label",{class:"form-check-label",for:"need-dialog-menu-reply"}," В диалоге нужно нижнее меню ",-1),_d={key:8,class:"card mb-2"},pd=e("div",{class:"card-header"},[e("h6",null,"Кнопки в виде нижнего меню")],-1),bd={class:"card-body"},fd={class:"form-check mb-2"},gd=e("label",{class:"form-check-label",for:"need-chains"}," Нужны многоуровневые диалоги ",-1),vd={key:9,class:"mb-2"},yd={key:0,class:"w-100 my-3",style:{"border-collapse":"separate","border-spacing":"5px 10px"}},$d=e("tr",{style:{"border-top":"1px #eaeaea solid"}},[e("td"),e("td"),e("td",null,[e("strong",null,"Ответ")]),e("td",null,[e("strong",null,"Следующий диалог")])],-1),kd={style:{width:"40px"}},Fd=["onClick"],wd=e("i",{class:"fa-solid fa-toggle-off cursor-pointer text-secondary"},null,-1),Cd=[wd],Sd=["onClick"],jd=e("i",{class:"fa-solid fa-toggle-on cursor-pointer text-primary"},null,-1),Vd=[jd],qd={scope:"row"},zd={class:"input-group"},Pd={class:"input-group-text",id:"basic-addon1"},Ud=["onUpdate:modelValue"],Od={class:"form-floating"},Ad=["onUpdate:modelValue"],Id=e("label",{for:"floatingInput"},"Точный текст ответа",-1),Qd={class:"input-group"},Td={class:"form-floating"},Md=["onUpdate:modelValue"],Dd=e("label",{for:"floatingInput"},"Выберите\\введите диалог или введите его номер",-1),Rd={class:"dropdown d-flex"},Bd=e("button",{class:"btn btn-outline-secondary w-100",style:{"border-radius":"0px 5px 5px 0px"},"data-bs-auto-close":"outside",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-up-right-and-down-left-from-center"})],-1),Ed={class:"dropdown-menu p-2",style:{width:"400px","max-height":"300px","overflow-y":"auto"}},Ld={class:"list-group"},Kd=["onClick"],Nd=["onClick"],Jd={class:"px-3 pt-2"},Hd={class:"dropdown d-flex justify-content-center align-items-center"},Yd=e("button",{class:"btn btn-link",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-bars"})],-1),Gd={class:"dropdown-menu"},Wd=["onClick"],Xd={key:0},Zd=e("td",null,null,-1),xd=e("td",null,null,-1),er={class:"input-group"},tr={class:"form-floating"},sr=["onUpdate:modelValue"],or=e("label",{for:"floatingInput"},"Шаблон предполагаемого текста",-1),lr={class:"dropdown d-flex"},ir=e("button",{class:"btn btn-outline-secondary w-100",style:{"border-radius":"0px 5px 5px 0px"},type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-up-right-and-down-left-from-center"})],-1),nr={class:"dropdown-menu"},ar=["onClick"],dr=["onClick"],rr={class:"form-floating"},cr=["onUpdate:modelValue","id"],ur=["for"],mr={key:1,class:"alert alert-primary mt-2",role:"alert"},hr={class:"form-check mb-2"},_r=e("label",{class:"form-check-label",for:"need-set-flags"}," Установить флаги в соответствующее значение ",-1),pr={key:10,class:"mb-2"},br=e("p",null,"Выбрать флаги",-1),fr=["onClick"],gr={key:3,class:"py-2 px-0"},vr={props:["item","bot"],data(){return{tab:0,patterns:[{title:"Номер телефона РФ",value:"/^\\s?(\\+\\s?7|8)([- ()]*\\d){10}$/"},{title:"Дата в формате ДД/ММ/ГГГГ",value:"/(\\d{2})\\/(\\d{2})\\/(\\d{4})$/"},{title:"Время в формате ЧЧ:ММ[:СС]",value:"#^[01]?[0-9]|2[0-3]):[0-5][0-9](:[0-5][0-9])?$#"}],test:[],loading:!0,dialog_commands:[],dialog_commands_paginate_object:null,need_images:!1,need_videos:!1,need_documents:!1,need_inline_keyboard:!1,need_reply_keyboard:!1,need_custom_stored_value:!1,need_additional_functions:!1,need_chains:!1,need_set_flags:!1,flags_variants:[{title:"Является VIP",key:"is_vip",value:null},{title:"Является Админом",key:"is_admin",value:null},{title:"За работой",key:"is_work",value:null},{title:"Является менеджером",key:"is_manager",value:null}],store_variants:[{title:"Имя",key:"name"},{title:"Почта",key:"email"},{title:"Возраст",key:"age"},{title:"Город",key:"city"},{title:"Страна",key:"country"},{title:"Адрес",key:"address"},{title:"Телефон",key:"phone"},{title:"День рождение",key:"birthday"}],commandForm:{id:null,slug:null,pre_text:null,post_text:null,error_text:null,bot_id:null,input_pattern:null,inline_keyboard_id:null,reply_keyboard_id:null,images:null,videos:null,documents:null,next_bot_dialog_command_id:null,bot_dialog_group_id:null,is_empty:!1,is_inform:!1,custom_stored_value:null,send_params:{send_by_text:!0,format:null,send_by_file:!1,send_to_mail:!1,mail:null},result_flags:[],store_to:null,use_result_as:null,result_channel:null,inline_keyboard:null,reply_keyboard:null,answers:[],rules:[]},photos:[]}},watch:{"commandForm.is_inform":function(o,t){this.commandForm.is_inform&&(this.commandForm.is_empty=!1,this.commandForm.post_text=null,this.commandForm.answers=[])},need_custom_stored_value:function(o,t){this.need_custom_stored_value||(this.commandForm.custom_stored_value=null)},need_inline_keyboard:function(o,t){this.need_inline_keyboard||(this.commandForm.inline_keyboard_id=null,this.commandForm.inline_keyboard=null)},need_reply_keyboard:function(o,t){this.need_reply_keyboard||(this.commandForm.reply_keyboard_id=null,this.commandForm.reply_keyboard=null)},need_set_flags:function(o,t){this.need_set_flags||(this.commandForm.result_flags=[])},need_images:function(o,t){this.need_images||(this.commandForm.images=null)}},computed:{...S(["getDialogCommands","getDialogCommandsPaginateObject"]),filteredCommands(){return this.dialog_commands?this.dialog_commands.filter(o=>o.id!=this.commandForm.id):[]}},mounted(){this.item&&this.$nextTick(()=>{var o,t;this.commandForm={id:this.item.id||null,slug:this.item.slug||null,pre_text:this.item.pre_text||null,post_text:this.item.post_text||null,error_text:this.item.error_text||null,custom_stored_value:this.item.custom_stored_value||null,is_empty:this.item.is_empty||!1,is_inform:this.item.is_inform||!1,input_pattern:this.item.input_pattern||null,inline_keyboard_id:this.item.inline_keyboard_id||null,reply_keyboard_id:this.item.reply_keyboard_id||null,images:this.item.images||[],videos:this.item.videos||[],documents:this.item.documents||[],next_bot_dialog_command_id:this.item.next_bot_dialog_command_id||null,bot_dialog_group_id:this.item.bot_dialog_group_id||null,result_channel:this.item.result_channel||null,inline_keyboard:this.item.inline_keyboard||null,reply_keyboard:this.item.reply_keyboard||null,result_flags:this.item.result_flags||[],store_to:this.item.store_to||null,answers:this.item.answers||[],use_result_as:this.item.use_result_as||null,rules:this.item.rules||[],send_params:{send_by_text:!0,format:null,send_by_file:!1,send_to_mail:!1,mail:null}},this.item.send_params&&(this.commandForm.send_params.format=this.item.send_params.format||null,this.commandForm.send_params.send_by_text=this.item.send_params.send_by_text||!0,this.commandForm.send_params.send_by_file=this.item.send_params.send_by_file||!1,this.commandForm.send_params.send_to_mail=this.item.send_params.send_to_mail||!1,this.commandForm.send_params.mail=this.item.send_params.mail||null),this.bot&&(this.commandForm.bot_id=this.bot.id||null),this.commandForm.inline_keyboard_id!=null&&(this.need_inline_keyboard=!0),this.commandForm.reply_keyboard_id!=null&&(this.need_reply_keyboard=!0),this.commandForm.images.length>0&&(this.need_images=!0),((o=this.commandForm.videos)==null?void 0:o.length)>0&&(this.need_videos=!0),((t=this.commandForm.documents)==null?void 0:t.length)>0&&(this.need_documents=!0),this.commandForm.result_flags.length>0&&(this.need_set_flags=!0),this.commandForm.answers.length>0&&(this.need_chains=!0),this.commandForm.custom_stored_value&&(this.need_custom_stored_value=!0)}),this.bot&&this.$nextTick(()=>{this.commandForm.bot_id=this.bot.id}),this.loadDialogs()},methods:{selectDocument(o){this.commandForm.documents||(this.commandForm.documents=[]);let t=this.commandForm.documents.indexOf(o.file_id);t!==-1?this.commandForm.documents.splice(t,1):this.commandForm.documents.push(o.file_id)},selectVideo(o){this.commandForm.videos||(this.commandForm.videos=[]);let t=this.commandForm.videos.indexOf(o.file_id);t!==-1?this.commandForm.videos.splice(t,1):this.commandForm.videos.push(o.file_id)},toggleRepeatSelfDialog(){this.commandForm.next_bot_dialog_command_id!=null&&this.commandForm.next_bot_dialog_command_id!==this.commandForm.id?this.commandForm.next_bot_dialog_command_id=this.commandForm.id:this.commandForm.next_bot_dialog_command_id=this.commandForm.next_bot_dialog_command_id===null?this.commandForm.id:null},addAnswer(){this.commandForm.answers.push({id:null,bot_dialog_command_id:null,answer:null,need_print:!0,pattern:null,custom_stored_value:null,next_bot_dialog_command_id:null})},nextDialogs(o){this.loadDialogs(o)},removeDialogAnswer(o,t){if(o.id==null){this.commandForm.answers.splice(t,1);return}this.commandForm.answers.splice(t,1),this.loading=!0,this.$store.dispatch("removeDialogAnswer",{dataObject:{dialogAnswerId:o.id}}).then(s=>{this.loading=!1,this.loadDialogs()}).catch(()=>{this.loading=!1})},loadDialogs(o=0){this.loading=!0,this.$store.dispatch("loadLinkedDialogCommands",{dataObject:{botId:this.bot.id||null,order:"id",direction:"asc"},page:o,size:100}).then(t=>{this.loading=!1;let s=t.data;this.dialog_commands=s.data||[],delete s.data,this.dialog_commands_paginate_object=s}).catch(()=>{this.loading=!1})},doCommandLink(o){this.loading=!0,this.commandForm.next_bot_dialog_command_id=o},submit(){this.loading=!0;let o=new FormData;if(Object.keys(this.commandForm).forEach(t=>{const s=this.commandForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),this.photos){for(let t=0;t<this.photos.length;t++)o.append("files[]",this.photos[t]);o.delete("photos")}this.$store.dispatch(this.commandForm.id?"updateDialogCommand":"createDialogCommand",{dialogCommandForm:o}).then(t=>{this.loading=!1,this.$notify({title:"Конструктор ботов",text:"Успешная обработка диалоговой команды",type:"success"}),this.commandForm.id==null&&(this.commandForm={id:null,slug:null,pre_text:null,post_text:null,error_text:null,input_pattern:null,inline_keyboard_id:null,images:null,next_bot_dialog_command_id:null,bot_dialog_group_id:null,result_channel:null,inline_keyboard:null,is_inform:!1,is_empty:!1,result_flags:[],answers:[],store_to:null,custom_stored_value:null,use_result_as:null},this.photos=[]),this.$emit("callback")}).catch(t=>{this.loading=!1})},getPhoto(o){return{imageUrl:URL.createObjectURL(o)}},removePhoto(o,t){this[o].splice(t,1)},onChangePhotos(o){const t=o.target.files;for(let s=0;s<t.length;s++)this.photos.push(t[s])},addTextTo(o={param:null,text:null}){this.commandForm[o.param]=o.text},selectFlag(o){(!this.commandForm.result_flags||!Array.isArray(this.commandForm.result_flags))&&(this.commandForm.result_flags=[]);let t=this.commandForm.result_flags.indexOf(o.key);t===-1?this.commandForm.result_flags.push(o.key):this.commandForm.result_flags.splice(t,1)}}},oe=Object.assign(vr,{__name:"BotDialogCommandForm",setup(o){return(t,s)=>{const d=Q("lazy");return l(),i("form",{onSubmit:s[37]||(s[37]=C((...n)=>t.submit&&t.submit(...n),["prevent"]))},[e("div",tn,[e("button",sn,[on,t.commandForm.id?(l(),i("span",ln,"Обновить диалог #"+u(t.commandForm.id),1)):(l(),i("span",nn,"Добавить диалог"))])]),e("ul",an,[e("li",dn,[e("a",{class:g(["nav-link",{active:t.tab===0}]),onClick:s[0]||(s[0]=n=>t.tab=0),"aria-current":"page",href:"javascript:void(0)"},[rn,m(" Основное")],2)]),e("li",cn,[e("a",{class:g(["nav-link",{active:t.tab===1}]),onClick:s[1]||(s[1]=n=>t.tab=1),href:"javascript:void(0)"},[un,m(" Связывание диалогов")],2)]),t.commandForm.is_inform?r("",!0):(l(),i("li",mn,[e("a",{class:g(["nav-link",{active:t.tab===2}]),onClick:s[2]||(s[2]=n=>t.tab=2),href:"javascript:void(0)"},[hn,m(" Дополнительное")],2)])),t.commandForm.is_empty?(l(),i("li",_n,[e("a",{class:g(["nav-link",{active:t.tab===3}]),onClick:s[3]||(s[3]=n=>t.tab=3),href:"javascript:void(0)","aria-disabled":"true"},[pn,m(" Вычисление результата")],2)])):r("",!0)]),t.tab===0?(l(),i("div",bn,[e("div",fn,[c(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":s[4]||(s[4]=n=>t.commandForm.is_inform=n),id:"need-inform-dialog"+(t.commandForm.id||"new"),checked:""},null,8,gn),[[k,t.commandForm.is_inform]]),e("label",{class:"form-check-label",for:"need-inform-dialog"+(t.commandForm.id||"new")}," Диалог только выводит данные ",8,vn)]),t.commandForm.is_inform?r("",!0):(l(),i("div",yn,[c(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":s[5]||(s[5]=n=>t.commandForm.is_empty=n),id:"need-empty-dialog"+(t.commandForm.id||"new"),checked:""},null,8,$n),[[k,t.commandForm.is_empty]]),e("label",{class:"form-check-label",for:"need-empty-dialog"+(t.commandForm.id||"new")}," Диалог завершает цепочку (только вывод информации) ",8,kn)])),t.commandForm.is_inform?(l(),i("div",Fn," Данный диалог позволит вам сразу вызвать связанный с ним другой диалог без ожидания ввод данных от пользователя! ")):r("",!0),b(se,{modelValue:t.commandForm.pre_text,"onUpdate:modelValue":s[6]||(s[6]=n=>t.commandForm.pre_text=n),bot:o.bot},null,8,["modelValue","bot"]),e("div",wn,[c(e("textarea",{class:"form-control",id:"commandForm-pre-text-"+t.commandForm.id,placeholder:"Начни с малого...","onUpdate:modelValue":s[7]||(s[7]=n=>t.commandForm.pre_text=n),required:""},`
                `,8,Cn),[[_,t.commandForm.pre_text]]),e("label",{for:"commandForm-pre-text-"+t.commandForm.id},"Текст диалога",8,Sn)]),t.commandForm.is_empty?(l(),i("div",jn,[e("div",Vn,[qn,e("div",zn,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[8]||(s[8]=n=>t.commandForm.send_params.send_by_text=n),type:"checkbox",role:"switch",id:"send-result-by-text"+(t.commandForm.id||"new")},null,8,Pn),[[k,t.commandForm.send_params.send_by_text]]),e("label",{class:"form-check-label",for:"send-result-by-text"+(t.commandForm.id||"new")},"Отправить текстом",8,Un)]),t.commandForm.send_params.send_by_text?(l(),i(f,{key:0},[e("div",On,[m(" Выберите шаблон из списка "),b(se,{class:"d-inline",modelValue:t.commandForm.send_params.format,"onUpdate:modelValue":s[9]||(s[9]=n=>t.commandForm.send_params.format=n),bot:o.bot},null,8,["modelValue","bot"]),m(" для форматирования результата или оставьте поле пустым, тогда будут выданы все полученные данные. Если каких-то полей не будет в результате - они будут проигнорированы. ")]),e("div",An,[c(e("textarea",{class:"form-control",id:"commandForm-send-params-format-"+(t.commandForm.id||"new"),placeholder:"Начни с малого...","onUpdate:modelValue":s[10]||(s[10]=n=>t.commandForm.send_params.format=n)},`
                                `,8,In),[[_,t.commandForm.send_params.format]]),e("label",{for:"commandForm-send-params-format-"+(t.commandForm.id||"new")},"Шаблон результата",8,Qn)])],64)):r("",!0),e("div",Tn,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[11]||(s[11]=n=>t.commandForm.send_params.send_by_file=n),type:"checkbox",role:"switch",id:"send-result-by-file"+(t.commandForm.id||"new")},null,8,Mn),[[k,t.commandForm.send_params.send_by_file]]),e("label",{class:"form-check-label",for:"send-result-by-file"+(t.commandForm.id||"new")},"Отправить файлом",8,Dn)]),e("div",Rn,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[12]||(s[12]=n=>t.commandForm.send_params.send_to_mail=n),type:"checkbox",role:"switch",id:"send-result-to-mail"+(t.commandForm.id||"new")},null,8,Bn),[[k,t.commandForm.send_params.send_to_mail]]),e("label",{class:"form-check-label",for:"send-result-to-mail"+(t.commandForm.id||"new")},"Отправить на почту",8,En)]),t.commandForm.send_params.send_to_mail?(l(),i("div",Ln,[c(e("input",{type:"email","onUpdate:modelValue":s[13]||(s[13]=n=>t.commandForm.send_params.mail=n),class:"form-control",id:"floatingInput",placeholder:"name@example.com",required:""},null,512),[[_,t.commandForm.send_params.mail]]),Kn])):r("",!0)])])):r("",!0),t.commandForm.is_empty?r("",!0):(l(),i("div",Nn,[e("div",Jn,[c(e("input",{type:"text",class:"form-control",id:"floatingPassword","onUpdate:modelValue":s[14]||(s[14]=n=>t.commandForm.use_result_as=n),placeholder:"Password"},null,512),[[_,t.commandForm.use_result_as]]),Hn])])),t.commandForm.is_empty?r("",!0):(l(),i("div",Yn,[c(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":s[15]||(s[15]=n=>t.need_custom_stored_value=n),id:"need-custom-stored-value"},null,512),[[k,t.need_custom_stored_value]]),Gn])),!t.commandForm.is_empty&&t.need_custom_stored_value?(l(),i("div",Wn,[e("div",Xn,[c(e("input",{type:"text",class:"form-control",id:"custom_stored_value","onUpdate:modelValue":s[16]||(s[16]=n=>t.commandForm.custom_stored_value=n),placeholder:"Password"},null,512),[[_,t.commandForm.custom_stored_value]]),Zn])])):r("",!0),!t.commandForm.is_empty&&!t.commandForm.is_inform?(l(),i("div",xn,[c(e("textarea",{class:"form-control",disabled:t.commandForm.is_inform,id:"commandForm-post-text-"+t.commandForm.id,placeholder:"Начни с малого...","onUpdate:modelValue":s[17]||(s[17]=n=>t.commandForm.post_text=n)},`
            `,8,ea),[[_,t.commandForm.post_text]]),e("label",{for:"commandForm-post-text-"+t.commandForm.id},"Текст после успешного завершения диалога",8,ta)])):r("",!0)])):r("",!0),t.tab===1?(l(),i("div",sa,[e("div",oa,[t.filteredCommands.length>0?(l(),i("div",la,[ia,t.commandForm.id?(l(),i("div",na,[e("button",{type:"button",onClick:s[18]||(s[18]=(...n)=>t.toggleRepeatSelfDialog&&t.toggleRepeatSelfDialog(...n)),class:g([{"btn-outline-primary":t.commandForm.next_bot_dialog_command_id!==t.commandForm.id,"btn-primary":t.commandForm.next_bot_dialog_command_id===t.commandForm.id},"btn"])},[aa,m(" Зациклить диалог на себе в случае ошибки ")],2)])):r("",!0),(l(!0),i(f,null,$(t.filteredCommands,(n,a)=>(l(),i("div",da,[e("button",ra,[e("span",null,[t.commandForm.next_bot_dialog_command_id==n.id?(l(),i("i",{key:0,class:"fa-solid fa-unlink text-danger mr-2",onClick:s[19]||(s[19]=h=>t.doCommandLink(null))})):(l(),i("i",{key:1,onClick:h=>t.doCommandLink(n.id),class:"fa-solid fa-link mr-2 text-success"},null,8,ca)),m(" [#"+u(n.id)+"] Текст диалога: "+u(n.pre_text||"Без текста"),1)])])]))),256)),t.dialog_commands_paginate_object?(l(),y(q,{key:1,onPagination_page:t.nextDialogs,pagination:t.dialog_commands_paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])):(l(),i("div",ua,ha))])])):r("",!0),t.tab===2?(l(),i("div",_a,[e("div",pa,[c(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":s[20]||(s[20]=n=>t.need_additional_functions=n),id:"need-additional-functions"},null,512),[[k,t.need_additional_functions]]),ba]),!t.commandForm.is_empty&&t.need_additional_functions?(l(),i("div",fa,[c(e("textarea",{type:"text",class:"form-control",id:"commandForm-error-text-"+t.commandForm.id,placeholder:"Начни с малого...","onUpdate:modelValue":s[21]||(s[21]=n=>t.commandForm.error_text=n)},`
            `,8,ga),[[_,t.commandForm.error_text]]),e("label",{for:"commandForm-error-text-"+t.commandForm.id},"Текст на случай ошибки корректности данных",8,va)])):r("",!0),!t.commandForm.is_empty&&t.need_additional_functions?(l(),i("div",ya,[e("div",$a,[ka,b(xl,{param:"input_pattern",onCallback:t.addTextTo},null,8,["onCallback"])]),e("div",Fa,[c(e("input",{type:"text","onUpdate:modelValue":s[22]||(s[22]=n=>t.commandForm.input_pattern=n),maxlength:"255",class:"form-control",id:"commandForm-input-pattern-"+t.commandForm.id,placeholder:"Регулярное выражение"},null,8,wa),[[_,t.commandForm.input_pattern]]),e("label",{for:"commandForm-result-channel-"+t.commandForm.id},"Регулярное выражение",8,Ca)])])):r("",!0),t.need_additional_functions?(l(),i("div",Sa,[e("div",ja,[Va,o.bot?(l(),y(ue,{key:0,token:o.bot.bot_token,param:"result_channel",onCallback:t.addTextTo},null,8,["token","onCallback"])):r("",!0)]),e("div",qa,[c(e("input",{type:"number","onUpdate:modelValue":s[23]||(s[23]=n=>t.commandForm.result_channel=n),class:"form-control",id:"commandForm-result-channel-"+t.commandForm.id,placeholder:"id канала"},null,8,za),[[_,t.commandForm.result_channel]]),e("label",{for:"commandForm-result-channel-"+t.commandForm.id},"id канала",8,Pa)])])):r("",!0),t.need_additional_functions?(l(),i("div",Ua,[e("div",Oa,[c(e("select",{class:"form-select","onUpdate:modelValue":s[24]||(s[24]=n=>t.commandForm.store_to=n),id:"store_variants","aria-label":"Floating label select example"},[Aa,(l(!0),i(f,null,$(t.store_variants,n=>(l(),i("option",{value:n.key},u(n.title||"Не указано"),9,Ia))),256))],512),[[T,t.commandForm.store_to]]),Qa])])):r("",!0),e("div",Ta,[c(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":s[25]||(s[25]=n=>t.need_images=n),id:"need-dialog-image",checked:""},null,512),[[k,t.need_images]]),Ma]),t.need_images?(l(),i("div",Da,[e("div",Ra,[Ba,e("div",Ea,[e("label",La,[Ka,e("input",{type:"file",id:"location-photos",multiple:"",accept:"image/*",onChange:s[26]||(s[26]=(...n)=>t.onChangePhotos&&t.onChangePhotos(...n)),style:{display:"none"}},null,32)]),t.photos.length>0?(l(!0),i(f,{key:0},$(t.photos,(n,a)=>(l(),i("div",Na,[c(e("img",null,null,512),[[d,t.getPhoto(n).imageUrl]]),e("div",Ja,[e("a",{onClick:h=>t.removePhoto("photos",a)},"Удалить",8,Ha)])]))),256)):r("",!0),t.commandForm.images&&o.bot?(l(!0),i(f,{key:1},$(t.commandForm.images,(n,a)=>(l(),i("div",Ya,[c(e("img",null,null,512),[[d,"/images-by-bot-id/"+o.bot.id+"/"+n]]),e("div",Ga,[e("a",{onClick:h=>t.removePhoto("images",a)},"Удалить",8,Wa)])]))),256)):r("",!0)])])])):r("",!0),e("div",Xa,[c(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":s[27]||(s[27]=n=>t.need_videos=n),id:"need-dialog-videos",checked:""},null,512),[[k,t.need_videos]]),Za]),t.need_videos?(l(),i("div",xa,[e("div",ed,[td,b(P,{"need-video":!0,"need-video-note":!0,selected:t.commandForm.videos||[],onSelect:t.selectVideo},null,8,["selected","onSelect"])])])):r("",!0),e("div",sd,[c(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":s[28]||(s[28]=n=>t.need_documents=n),id:"need-dialog-documents",checked:""},null,512),[[k,t.need_documents]]),od]),t.need_documents?(l(),i("div",ld,[e("div",id,[nd,b(P,{"need-document":!0,selected:t.commandForm.documents||[],onSelect:t.selectDocument},null,8,["selected","onSelect"])])])):r("",!0),e("div",ad,[c(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":s[29]||(s[29]=n=>t.need_inline_keyboard=n),id:"need-dialog-menu-inline",checked:""},null,512),[[k,t.need_inline_keyboard]]),dd]),t.need_inline_keyboard?(l(),i("div",rd,[cd,e("div",ud,[b(A,{type:"inline",modelValue:t.commandForm.inline_keyboard,"onUpdate:modelValue":s[30]||(s[30]=n=>t.commandForm.inline_keyboard=n)},null,8,["modelValue"])])])):r("",!0),e("div",md,[c(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":s[31]||(s[31]=n=>t.need_reply_keyboard=n),id:"need-dialog-menu-reply",checked:""},null,512),[[k,t.need_reply_keyboard]]),hd]),t.need_reply_keyboard?(l(),i("div",_d,[pd,e("div",bd,[b(A,{type:"reply",modelValue:t.commandForm.reply_keyboard,"onUpdate:modelValue":s[32]||(s[32]=n=>t.commandForm.reply_keyboard=n)},null,8,["modelValue"])])])):r("",!0),e("div",fd,[c(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":s[33]||(s[33]=n=>t.need_chains=n),id:"need-chains",checked:""},null,512),[[k,t.need_chains]]),gd]),t.need_chains?(l(),i("div",vd,[e("button",{type:"button",class:"btn btn-outline-primary",onClick:s[34]||(s[34]=(...n)=>t.addAnswer&&t.addAnswer(...n))},"Добавить вариант ответа "),t.commandForm.answers.length>0?(l(),i("table",yd,[e("tbody",null,[(l(!0),i(f,null,$(t.commandForm.answers,(n,a)=>(l(),i(f,null,[$d,e("tr",null,[e("td",kd,[t.commandForm.answers[a].in_edit_mode?(l(),i("span",{key:1,onClick:h=>t.commandForm.answers[a].in_edit_mode=!1},Vd,8,Sd)):(l(),i("span",{key:0,onClick:h=>t.commandForm.answers[a].in_edit_mode=!0},Cd,8,Fd))]),e("th",qd,u(a+1),1),e("td",null,[e("div",zd,[e("span",Pd,[c(e("input",{class:"form-check-input","onUpdate:modelValue":h=>t.commandForm.answers[a].need_print=h,type:"checkbox",value:"",id:"flexCheckDefault"},null,8,Ud),[[k,t.commandForm.answers[a].need_print]])]),e("div",Od,[c(e("input",{type:"text","onUpdate:modelValue":h=>t.commandForm.answers[a].answer=h,class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,8,Ad),[[_,t.commandForm.answers[a].answer]]),Id])])]),e("td",null,[e("div",Qd,[e("div",Td,[c(e("input",{type:"text",class:"form-control","onUpdate:modelValue":h=>t.commandForm.answers[a].next_bot_dialog_command_id=h,id:"floatingInput",placeholder:"name@example.com",required:""},null,8,Md),[[_,t.commandForm.answers[a].next_bot_dialog_command_id]]),Dd]),e("div",Rd,[Bd,e("div",Ed,[e("ul",Ld,[e("li",{class:"list-group-item cursor-pointer font-12",onClick:h=>t.commandForm.answers[a].next_bot_dialog_command_id=null}," Не выбран ",8,Kd),(l(!0),i(f,null,$(t.getDialogCommands,h=>(l(),i("li",{class:"list-group-item cursor-pointer font-12",style:{"line-height":"100%","text-align":"left"},onClick:p=>t.commandForm.answers[a].next_bot_dialog_command_id=h.id}," #"+u(h.id||"-")+" "+u(h.pre_text||"-"),9,Nd))),256))]),e("div",Jd,[t.dialog_commands_paginate_object?(l(),y(q,{key:0,onPagination_page:t.nextDialogs,pagination:t.dialog_commands_paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])])])])]),e("td",null,[e("div",Hd,[Yd,e("ul",Gd,[e("li",null,[e("a",{class:"dropdown-item",onClick:h=>t.removeDialogAnswer(n,a),href:"javascript:void(0)"},"Удалить",8,Wd)])])])])]),t.commandForm.answers[a].in_edit_mode?(l(),i("tr",Xd,[Zd,xd,e("td",null,[e("div",er,[e("div",tr,[c(e("input",{type:"text","onUpdate:modelValue":h=>t.commandForm.answers[a].pattern=h,class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,8,sr),[[_,t.commandForm.answers[a].pattern]]),or]),e("div",lr,[ir,e("ul",nr,[e("li",null,[e("a",{class:"dropdown-item",onClick:h=>t.commandForm.answers[a].pattern=null,href:"javascript:void(0)"},"Не выбран",8,ar)]),e("li",null,[(l(!0),i(f,null,$(t.patterns,h=>(l(),i("a",{class:"dropdown-item",onClick:p=>t.commandForm.answers[a].pattern=h.value,href:"javascript:void(0)"},u(h.title||"-"),9,dr))),256))])])])])]),e("td",null,[e("div",rr,[c(e("input",{type:"text","onUpdate:modelValue":h=>t.commandForm.answers[a].custom_stored_value=h,class:"form-control",id:"custom_stored_value-"+a,placeholder:"name@example.com"},null,8,cr),[[_,t.commandForm.answers[a].custom_stored_value]]),e("label",{for:"custom_stored_value-"+a},"Поместить данный текст в переменную",8,ur)])])])):r("",!0)],64))),256))])])):(l(),i("div",mr," Добавьте один или несколько вариантов ответов "))])):r("",!0),e("div",hr,[c(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":s[35]||(s[35]=n=>t.need_set_flags=n),id:"need-set-flags",checked:""},null,512),[[k,t.need_set_flags]]),_r]),t.need_set_flags?(l(),i("div",pr,[br,(l(!0),i(f,null,$(t.flags_variants,n=>(l(),i("span",{class:g(["badge text-info mr-2",{"bg-info text-white":t.commandForm.result_flags.indexOf(n.key)!=-1}]),onClick:a=>t.selectFlag(n)},u(n.title),11,fr))),256))])):r("",!0)])):r("",!0),t.tab===3?(l(),i("div",gr,[b(Ji,{modelValue:t.commandForm.rules,"onUpdate:modelValue":s[36]||(s[36]=n=>t.commandForm.rules=n)},null,8,["modelValue"])])):r("",!0)],32)}}});const yr={class:"row"},$r={class:"col-md-2 col-12"},kr=e("i",{class:"fa-regular fa-comment-dots",style:{"margin-right":"10px"}},null,-1),Fr={class:"col-md-10 col-12"},wr={class:"input-group mb-3"},Cr={style:{width:"200px !important"}},Sr=B('<option value="25">25</option><option value="50">50</option><option value="100">100</option><option value="500">500</option><option value="1000">1000</option>',5),jr=[Sr],Vr={key:0,class:"row"},qr={class:"col-md-12"},zr={class:"table"},Pr=e("th",{class:"text-left",scope:"col",style:{width:"40px"}},null,-1),Ur=e("th",{class:"text-center",scope:"col",style:{width:"40px"}},"Команды",-1),Or=["id"],Ar={style:{width:"40px"}},Ir=["onClick"],Qr=e("i",{class:"fa-solid fa-toggle-off cursor-pointer text-secondary"},null,-1),Tr=[Qr],Mr=["onClick"],Dr=e("i",{class:"fa-solid fa-toggle-on cursor-pointer text-primary"},null,-1),Rr=[Dr],Br={scope:"row",class:"text-left",style:{width:"80px"}},Er={class:"d-flex justify-content-start align-items-center"},Lr={key:0,class:"fa-solid fa-flag-checkered ml-2"},Kr={key:1,class:"fa-solid fa-sitemap ml-2"},Nr={key:2,class:"fa-solid fa-arrows-rotate ml-2"},Jr={class:"text-left",style:{"min-width":"400px"}},Hr={key:0,class:"dropdown"},Yr={style:{"line-height":"100%","font-size":"14px","text-align":"left"},class:"btn btn-link m-0 p-0 text-decoration-none",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},Gr={class:"dropdown-menu p-2"},Wr=["onSubmit"],Xr=e("p",{class:"mb-0"},"Значение",-1),Zr=["onUpdate:modelValue"],xr=e("button",{class:"btn btn-outline-primary mt-2 w-100 text-center"}," Сохранить ",-1),ec={class:"dropdown my-2"},tc={style:{"text-align":"left !important"},class:"text-decoration-none fst-italic color-black w-100 d-flex justify-content-between align-items-center",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},sc={class:"dropdown-menu p-4 text-body-secondary",style:{"max-width":"400px","min-width":"400px",height:"200px","overflow-y":"scroll"}},oc=e("h6",null,"Основные параметры диалога",-1),lc={class:"table"},ic=e("td",null,"Есть ответы",-1),nc={key:0},ac={key:1},dc=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),rc=[dc],cc=e("td",null,"Цепочки",-1),uc={key:0,class:"badge bg-primary"},mc={key:1},hc=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),_c=[hc],pc=e("td",null,"Текст успеха",-1),bc={key:0},fc={key:1},gc=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),vc=[gc],yc=e("td",null,"Текст ошибки",-1),$c={key:0},kc={key:1},Fc=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),wc=[Fc],Cc=e("td",null,"Канал результата",-1),Sc={key:0},jc={key:1},Vc=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),qc=[Vc],zc=e("td",null,"Флаги",-1),Pc={key:0},Uc={class:"badge bg-primary"},Oc={key:1},Ac=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),Ic=[Ac],Qc=e("td",null,"Сохранить в",-1),Tc={key:0},Mc={key:1},Dc=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),Rc=[Dc],Bc=e("td",null,"Есть изображения",-1),Ec={key:0,class:"fa-solid fa-check text-success"},Lc={key:1,class:"fa-solid fa-xmark text-danger"},Kc=e("td",null,"Есть паттерны",-1),Nc={key:0},Jc={key:1},Hc=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),Yc=[Hc],Gc=e("td",null,"Пустой",-1),Wc={key:0,class:"fa-solid fa-check text-success"},Xc={key:1,class:"fa-solid fa-xmark text-danger"},Zc=e("td",null,"Информационный",-1),xc={key:0,class:"fa-solid fa-check text-success"},eu={key:1,class:"fa-solid fa-xmark text-danger"},tu=e("td",null,"Есть кнопки",-1),su={key:0,class:"fa-solid fa-check text-success"},ou={key:1,class:"fa-solid fa-xmark text-danger"},lu=e("td",null,"Есть меню",-1),iu={key:0,class:"fa-solid fa-check text-success"},nu={key:1,class:"fa-solid fa-xmark text-danger"},au={key:1,class:"small font-bold m-0"},du=e("i",{class:"fa-solid fa-angles-right mx-2"},null,-1),ru={style:{width:"150px"}},cu={class:"form-check"},uu=["onChange","onUpdate:modelValue","id"],mu=["for"],hu={style:{width:"90px"},class:"cursor-pointer"},_u={class:"d-flex m-0 align-items-center"},pu=["href"],bu=e("i",{class:"fa-solid fa-anchor"},null,-1),fu=[bu],gu=e("i",{class:"fa-solid fa-angles-right mr-1"},null,-1),vu=["onClick"],yu=e("small",{class:"ml-1"},[e("i",{class:"fa-solid fa-arrow-up-right-from-square text-primary"})],-1),$u=e("td",null,[e("i",{class:"fa-solid fa-arrow-right-long mx-2"})],-1),ku={style:{"max-width":"770px"}},Fu={class:"dropdown"},wu={style:{"line-height":"100%","font-size":"10px","text-align":"left"},class:"btn btn-link m-0 p-0 text-decoration-none",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},Cu={key:0},Su={key:1},ju={class:"dropdown-menu p-2"},Vu=["onSubmit"],qu=e("p",{class:"mb-0"},"Значение",-1),zu=["onUpdate:modelValue"],Pu=e("button",{class:"btn btn-outline-primary mt-2 w-100 text-center"}," Сохранить ",-1),Uu={key:0},Ou={key:0,class:"text-danger font-bold"},Au={key:1,class:"text-success font-bold"},Iu={key:2,class:"text-warning font-bold"},Qu={class:"cursor-pointer"},Tu={class:"d-flex mb-0"},Mu=["href"],Du=e("i",{class:"fa-solid fa-anchor"},null,-1),Ru=[Du],Bu=["onClick"],Eu=e("i",{class:"fa-solid fa-angles-right mr-1"},null,-1),Lu=e("small",{class:"ml-1"},[e("i",{class:"fa-solid fa-arrow-up-right-from-square text-primary"})],-1),Ku={key:0},Nu=e("i",{class:"fa-solid fa-arrow-right-long mx-2"},null,-1),Ju=[Nu],Hu={key:1,style:{"max-width":"770px"}},Yu={class:"mb-0",style:{"line-height":"100%","font-size":"10px"}},Gu={class:"text-center",style:{width:"40px"}},Wu={class:"dropdown"},Xu=["disabled"],Zu=e("i",{class:"fa-solid fa-ellipsis"},null,-1),xu=[Zu],em={class:"dropdown-menu"},tm=["onClick"],sm=e("i",{class:"fa-solid fa-arrow-left mr-1"},null,-1),om=e("hr",null,null,-1),lm=["onClick"],im=e("i",{class:"fa-solid fa-clone mr-1"},null,-1),nm=["onClick"],am=e("i",{class:"fa-solid fa-trash-can mr-1"},null,-1),dm={key:0},rm={colspan:"17"},cm={key:1,class:"row"},um=e("div",{class:"col-12"},[e("div",{class:"alert alert-danger",role:"alert"}," Не найдено ни одного диалога! ")],-1),mm=[um],hm={class:"modal fade",id:"dialog-command-modal-editor",tabindex:"-1"},_m={class:"modal-dialog modal-fullscreen"},pm={class:"modal-content"},bm=e("div",{class:"modal-header"},[e("h1",{class:"modal-title fs-5",id:"staticBackdropLabel"}," Создание диалогового сообщения "),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),fm={class:"modal-body"},gm=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),vm={data(){return{direction:"desc",order:"updated_at",size:500,variables:[],bot:null,selected:null,loading:!0,current_page:0,dialog_commands:[],search:null,dialog_commands_paginate_object:null}},computed:{...S(["getDialogCommands","getCurrentBot","getDialogCommandsPaginateObject"])},mounted(){this.loadCurrentBot().then(()=>{let o=localStorage.getItem("cashman_dialogs_current_page_"+this.bot.id)||0;this.loadDialogs(o)})},methods:{updateDialogCommand(o){let t=new FormData;Object.keys(o).forEach(s=>{const d=o[s]||"";typeof d=="object"?t.append(s,JSON.stringify(d)):t.append(s,d)}),this.$store.dispatch("updateDialogCommand",{dialogCommandForm:t}).then(s=>{this.loading=!1,this.$notify({title:"Конструктор ботов",text:"Успешная обработка диалоговой команды",type:"success"})}).catch(()=>{this.$notify({title:"Конструктор ботов",text:"Ошибка обработки диалоговой команды",type:"error"})})},updateAnswer(o){this.$store.dispatch("updatedDialogAnswer",{...o,bot_id:this.bot.id}).then(t=>{this.$notify({title:"Конструктор ботов",text:"Текст успешно обновлен",type:"success"})}).catch(t=>{})},loadAndOrder(o){this.order=o,this.direction=this.direction==="desc"?"asc":"desc",this.loadDialogs(0)},loadAndOpenEditor(o){this.loading=!0,this.$store.dispatch("loadLinkedDialogCommand",{command_id:o,bot_id:this.bot.id}).then(t=>{this.selected=t.data,console.log(t.data),this.loading=!1,new bootstrap.Modal(document.getElementById("dialog-command-modal-editor"),{}).show()}).catch(()=>{this.$notify({title:"Конструктор ботов",text:"Ошибка работы с командой",type:"error"})})},openEditor(o){this.loading=!0,o||this.dialog_commands.forEach(t=>{t.in_edit_mode=!1}),this.$nextTick(()=>{this.selected=o,this.loading=!1})},removeCommand(o){this.loading=!0,this.$store.dispatch("removeDialogCommand",{dataObject:{dialogCommandId:o}}).then(t=>{this.loading=!1,this.$notify({title:"Конструктор ботов",text:"Диалоговая команда успешно удалена!",type:"success"}),this.loadDialogs(),this.$emit("callback")}).catch(t=>{this.loading=!1})},duplicate(o){this.loading=!0,this.$store.dispatch("duplicateDialogCommand",{dataObject:{dialogCommandId:o}}).then(t=>{this.loading=!1,this.$notify({title:"Конструктор ботов",text:"Диалоговая команда успешно продублирована!",type:"success"}),this.loadDialogs(),this.$emit("callback")}).catch(t=>{this.loading=!1})},toggleEditMode(o){this.selected=o,o.in_edit_mode=!o.in_edit_mode},loadCurrentBot(o=null){return this.$store.dispatch("updateCurrentBot",{bot:o}).then(()=>{this.bot=this.getCurrentBot})},selectDialog(o){this.$emit("select-dialog",o),this.$notify("Вы выбрали диалог из списка!")},nextDialogs(o){this.loadDialogs(o)},selectElement(o){this.loading=!0,this.$nextTick(()=>{this.selected=this.dialog_commands.find(t=>t.id===o)||null,this.loading=!1})},loadDialogs(o=0){this.current_page=o,localStorage.setItem("cashman_dialogs_current_page_"+this.bot.id,this.current_page),this.$store.dispatch("loadDialogCommands",{dataObject:{botId:this.bot.id||null,search:this.search,order:this.order,direction:this.direction},page:o,size:this.size||25}).then(t=>{const s=this.selected;this.dialog_commands=this.getDialogCommands,this.dialog_commands_paginate_object=this.getDialogCommandsPaginateObject,this.loading=!0,this.$nextTick(()=>{s&&(this.selected=this.dialog_commands.find(d=>d.id===s.id)||null,this.selected.in_edit_mode=!1),this.loading=!1})}).catch(()=>{this.loading=!1})}}},pe=Object.assign(vm,{__name:"BotDialogGroupList",setup(o){return(t,s)=>(l(),i(f,null,[e("div",yr,[e("div",$r,[e("button",{type:"button",onClick:s[0]||(s[0]=d=>t.openEditor(null)),"data-bs-toggle":"modal","data-bs-target":"#dialog-command-modal-editor",class:"btn btn-outline-success mb-2 w-100"},[kr,m("Новый диалог ")])]),e("div",Fr,[e("div",wr,[c(e("input",{type:"search",class:"form-control",placeholder:"Поиск диалога","aria-label":"Поиск диалога","onUpdate:modelValue":s[1]||(s[1]=d=>t.search=d),"aria-describedby":"button-addon2"},null,512),[[_,t.search]]),e("div",Cr,[c(e("select",{onChange:s[2]||(s[2]=d=>t.loadDialogs(t.current_page)),"onUpdate:modelValue":s[3]||(s[3]=d=>t.size=d),class:"form-select rounded-0"},jr,544),[[T,t.size]])]),e("button",{class:"btn btn-outline-secondary",onClick:s[4]||(s[4]=d=>t.loadDialogs(0)),type:"button",id:"button-addon2"},"Найти ")])])]),t.dialog_commands.length>0?(l(),i("div",Vr,[e("div",qr,[e("table",zr,[e("thead",null,[e("tr",null,[Pr,e("th",{class:"text-left cursor-pointer",scope:"col",onClick:s[5]||(s[5]=d=>t.loadAndOrder("id")),style:{width:"80px"}}," # "),e("th",{class:"text-left cursor-pointer",scope:"col",onClick:s[6]||(s[6]=d=>t.loadAndOrder("pre_text")),style:{"min-width":"400px"}},"Текст диалога "),Ur])]),e("tbody",null,[(l(!0),i(f,null,$(t.dialog_commands,(d,n)=>(l(),i(f,null,[e("tr",{id:"key-"+d.id},[e("td",Ar,[d.in_edit_mode?(l(),i("span",{key:1,onClick:a=>t.toggleEditMode(d)},Rr,8,Mr)):(l(),i("span",{key:0,onClick:a=>t.toggleEditMode(d)},Tr,8,Ir))]),e("th",Br,[e("span",Er,[m(u(d.id)+" ",1),d.is_empty?(l(),i("i",Lr)):r("",!0),d.is_inform?(l(),i("i",Kr)):r("",!0),d.next_bot_dialog_command_id===d.id?(l(),i("i",Nr)):r("",!0)])]),e("td",Jr,[d.is_empty?r("",!0):(l(),i("div",Hr,[e("button",Yr,[m(" Результат будет сохранен в "),e("strong",null,u(d.use_result_as||"не задана"),1)]),e("div",Gr,[e("form",{onSubmit:C(a=>t.updateDialogCommand(d),["prevent"]),class:"p-2"},[Xr,c(e("textarea",{class:"form-control","onUpdate:modelValue":a=>d.use_result_as=a,name:"",id:"",cols:"30",rows:"10"},null,8,Zr),[[_,d.use_result_as]]),xr],40,Wr)])])),e("div",ec,[e("button",tc,u(d.pre_text||"-"),1),e("div",sc,[oc,e("table",lc,[e("tbody",null,[e("tr",null,[ic,e("td",null,[(d.answers||[]).length>0?(l(),i("p",nc,u(d.answers.length),1)):(l(),i("p",ac,rc))])]),e("tr",null,[cc,e("td",null,[d.next_bot_dialog_command_id?(l(),i("span",uc,"#"+u(d.next_bot_dialog_command_id||"-")+" ("+u(d.chain.length||0)+")",1)):(l(),i("span",mc,_c))])]),e("tr",null,[pc,e("td",null,[d.post_text?(l(),i("p",bc,u(d.post_text),1)):(l(),i("p",fc,vc))])]),e("tr",null,[yc,e("td",null,[d.error_text?(l(),i("p",$c,u(d.error_text),1)):(l(),i("p",kc,wc))])]),e("tr",null,[Cc,e("td",null,[d.result_channel?(l(),i("p",Sc,u(d.result_channel),1)):(l(),i("p",jc,qc))])]),e("tr",null,[zc,e("td",null,[d.result_flags.length>0?(l(),i("p",Pc,[(l(!0),i(f,null,$(d.result_flags,a=>(l(),i("span",Uc,u(a||"-"),1))),256))])):(l(),i("p",Oc,Ic))])]),e("tr",null,[Qc,e("td",null,[d.store_to?(l(),i("p",Tc,u(d.store_to),1)):(l(),i("p",Mc,Rc))])]),e("tr",null,[Bc,e("td",null,[(d.images||[]).length>0?(l(),i("i",Ec)):(l(),i("i",Lc))])]),e("tr",null,[Kc,e("td",null,[d.input_pattern?(l(),i("p",Nc,u(d.input_pattern),1)):(l(),i("p",Jc,Yc))])]),e("tr",null,[Gc,e("td",null,[d.is_empty?(l(),i("i",Wc)):(l(),i("i",Xc))])]),e("tr",null,[Zc,e("td",null,[d.is_inform?(l(),i("i",xc)):(l(),i("i",eu))])]),e("tr",null,[tu,e("td",null,[d.inline_keyboard_id!=null?(l(),i("i",su)):(l(),i("i",ou))])]),e("tr",null,[lu,e("td",null,[d.reply_keyboard_id!=null?(l(),i("i",iu)):(l(),i("i",nu))])])])])])]),(d.next_bot_dialog_command_id||(d.answers||[]).length>0)&&!d.is_inform?(l(),i("p",au,[m("Ответ"),du,m("диалог")])):r("",!0),e("table",null,[(l(!0),i(f,null,$(d.answers,(a,h)=>(l(),i("tr",null,[e("td",ru,[e("div",cu,[c(e("input",{class:"form-check-input",onChange:p=>t.updateAnswer(a),"onUpdate:modelValue":p=>d.answers[h].need_print=p,type:"checkbox",value:"",id:"answ-"+h+"-command-"+d.id},null,40,uu),[[k,d.answers[h].need_print]]),e("label",{class:"form-check-label",for:"answ-"+h+"-command-"+d.id},u(a.answer),9,mu)])]),e("td",hu,[e("p",_u,[e("a",{href:"#key-"+a.next_bot_dialog_command_id,class:"mx-2"},fu,8,pu),gu,e("span",{class:"d-flex",onClick:p=>t.loadAndOpenEditor(a.next_bot_dialog_command_id)},[m(u(a.next_bot_dialog_command_id)+" ",1),yu],8,vu)])]),$u,e("td",ku,[e("div",Fu,[e("button",wu,[a.custom_stored_value?(l(),i("span",Cu,u(a.custom_stored_value||"-"),1)):(l(),i("span",Su,"нажмите, чтобы добавить"))]),e("div",ju,[e("form",{onSubmit:C(p=>t.updateAnswer(a),["prevent"]),class:"p-2"},[qu,c(e("textarea",{class:"form-control","onUpdate:modelValue":p=>a.custom_stored_value=p,name:"",id:"",cols:"30",rows:"10"},null,8,zu),[[_,a.custom_stored_value]]),Pu],40,Vu)])])])]))),256)),d.next_bot_dialog_command_id?(l(),i("tr",Uu,[e("td",null,[(d.answers||[]).length>0&&!d.is_inform?(l(),i("span",Ou,"Другой ответ")):r("",!0),(d.answers||[]).length===0&&!d.is_inform?(l(),i("span",Au,"Любой ответ")):r("",!0),(d.answers||[]).length===0&&d.is_inform?(l(),i("span",Iu," Переход к диалогу ")):r("",!0)]),e("td",Qu,[e("p",Tu,[e("a",{href:"#key-"+d.next_bot_dialog_command_id,class:"mx-2"},Ru,8,Mu),e("span",{onClick:a=>t.loadAndOpenEditor(d.next_bot_dialog_command_id),class:"d-flex align-items-center"},[Eu,m(" "+u(d.next_bot_dialog_command_id||"-")+" ",1),Lu],8,Bu)])]),d.custom_stored_value?(l(),i("td",Ku,Ju)):r("",!0),d.custom_stored_value?(l(),i("td",Hu,[e("p",Yu,u(d.custom_stored_value||"-"),1)])):r("",!0)])):r("",!0)])]),e("td",Gu,[e("div",Wu,[e("button",{disabled:t.loading,class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},xu,8,Xu),e("ul",em,[e("li",null,[e("a",{onClick:a=>t.selectDialog(d),title:"Выбрать диалог",class:"dropdown-item cursor-pointer"},[sm,m(" Выбрать диалог ")],8,tm)]),om,e("li",null,[e("a",{title:"Дублирование команды",onClick:a=>t.duplicate(d.id),class:"dropdown-item cursor-pointer"},[im,m(" Дублирование диалога ")],8,lm)]),e("li",null,[e("a",{onClick:a=>t.removeCommand(d.id),title:"Удаление команды",class:"dropdown-item cursor-pointer"},[am,m(" Удаление диалога ")],8,nm)])])])])],8,Or),d.in_edit_mode?(l(),i("tr",dm,[e("td",rm,[t.bot&&!t.loading?(l(),y(oe,{key:0,item:t.selected,onCallback:t.loadDialogs,onSelectElement:t.selectElement,bot:t.bot},null,8,["item","onCallback","onSelectElement","bot"])):r("",!0)])])):r("",!0)],64))),256))])]),t.dialog_commands_paginate_object?(l(),y(q,{key:0,onPagination_page:t.nextDialogs,pagination:t.dialog_commands_paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])])):(l(),i("div",cm,mm)),e("div",hm,[e("div",_m,[e("div",pm,[bm,e("div",fm,[t.bot&&!t.loading?(l(),y(oe,{key:0,item:t.selected,onCallback:t.loadDialogs,onSelectElement:t.selectElement,bot:t.bot},null,8,["item","onCallback","onSelectElement","bot"])):r("",!0)]),gm])])])],64))}}),ym={props:["modelValue","fieldId"],data(){return{need_text_menu:!1,link:null,linkModal:null,fontModal:null,relinkModal:null,reLinkForm:{url:null,text:null},expressions:[{expression:"{{userName}}",description:'<i class="fa-solid fa-signature mr-2"></i>Имя пользователя'},{expression:"{{level_1_percent}}",description:'<i class="fa-solid fa-1 mr-2"></i>Процент кэшбэка 1 уровня'},{expression:"{{level_2_percent}}",description:'<i class="fa-solid fa-2 mr-2"></i>Процент кэшбэка 2 уровня'},{expression:"{{level_3_percent}}",description:'<i class="fa-solid fa-3 mr-2"></i>Процент кэшбэка 3 уровня'},{expression:"{{cashback_fire_percent}}",description:'<i class="fa-solid fa-fire mr-2"></i>Процент сжигания кэшбэка'},{expression:"{{is_admin}}",description:'<i class="fa-solid fa-user-tie mr-2"></i>Статус администратора'},{expression:"{{is_work}}",description:'<i class="fa-solid fa-building mr-2"></i>Статус работника'},{expression:"{{is_vip}}",description:'<i class="fa-solid fa-crown mr-2"></i>Статус VIP'},{expression:"{{is_manager}}",description:'<i class="fa-solid fa-people-roof mr-2"></i>Статус менеджера'},{expression:"{{is_deliveryman}}",description:'<i class="fa-solid fa-truck-ramp-box mr-2"></i>Статус доставщика'},{expression:"{{sex}}",description:'<i class="fa-solid fa-venus-mars mr-2"></i>Пол клиента'},{expression:"{{friendsCount}}",description:'<i class="fa-solid fa-user-group mr-2"></i>Число друзей пользователя'},{expression:"{{cashback}}",description:'<i class="fa-solid fa-coins mr-2"></i>Сумма КэшБэк пользователя'},{expression:"{{telegramChatId}}",description:'<i class="fa-brands fa-telegram mr-2"></i>Идентификатор чата'},{expression:"{{referralLink}}",description:'<i class="fa-solid fa-link mr-2"></i>Реферальная ссылка'},{expression:"{{referralQr}}",description:'<i class="fa-solid fa-qrcode mr-2"></i>Реферальный QR-код'}]}},mounted(){document.querySelector(this.fieldId).addEventListener("selectionchange",()=>{let s=this.getFieldSelection();s.end-s.start>0&&(this.need_text_menu=!0),s.end-s.start===0&&(this.need_text_menu=!1)}),[...document.querySelectorAll('[data-bs-toggle="tooltip"]')].map(s=>new bootstrap.Tooltip(s)),this.linkModal=new bootstrap.Modal(document.getElementById("link-enter-modal"),{}),this.fontModal=new bootstrap.Modal(document.getElementById("font-choose-modal"),{}),this.relinkModal=new bootstrap.Modal(document.getElementById("relink-modal"),{})},methods:{getFieldSelection(){let o=document.querySelector(this.fieldId),t=document.querySelector(this.fieldId);return this.fieldId?(o=o.selectionStart||0,t=t.selectionEnd||0,console.log(o),{start:o,end:t}):{start:0,end:0}},openReLinkModal(){this.relinkModal.show()},openFontModal(){this.fontModal.show()},reLinkSubmit(){this.$emit("submit-relink",this.reLinkForm),this.relinkModal.hide()},useTemplate(o,t){let s=this.getFieldSelection(),d=this.modelValue||"",n=d.slice(0,s.start);if(s.end-s.start>0&&s.end>0){let a=d.slice(s.start,s.end),h=d.slice(s.end);d=n+o+a+t+h,this.$emit("update:modelValue",d)}},boldTag(){this.useTemplate("<b>","</b>")},italic(){this.useTemplate("<i>","</i>")},underline(){this.useTemplate("<u>","</u>")},strike(){this.useTemplate("<s>","</s>")},code(){this.useTemplate("<code>","</code>")},spoiler(){this.useTemplate("<span class='tg-spoiler'>","</span>")},pre(){this.useTemplate("<pre>","</pre>")},blockquote(){this.useTemplate("<blockquote>","</blockquote>")},openLinkModal(){this.linkModal.show()},linkTag(){this.linkModal.hide();const o=this.link;this.useTemplate("<a href='"+o+"'>","</a>"),this.link=null},expressionsSelect(o){let t=this.getFieldSelection(),s=this.modelValue||"";s=s.slice(0,t.start)+o.expression+s.slice(t.start),this.$emit("update:modelValue",s)}}},$m={class:"d-inline-flex"},km=e("i",{class:"fa-solid fa-arrow-up-right-from-square"},null,-1),Fm=[km],wm=e("i",{class:"fa-solid fa-font"},null,-1),Cm=[wm],Sm=e("i",{class:"fa-solid fa-bold"},null,-1),jm=[Sm],Vm=e("i",{class:"fa-solid fa-italic"},null,-1),qm=[Vm],zm=e("i",{class:"fa-solid fa-underline"},null,-1),Pm=[zm],Um=e("i",{class:"fa-solid fa-hand-dots"},null,-1),Om=[Um],Am=e("i",{class:"fa-solid fa-strikethrough"},null,-1),Im=[Am],Qm=e("i",{class:"fa-solid fa-code"},null,-1),Tm=[Qm],Mm=e("i",{class:"fa-solid fa-quote-left"},null,-1),Dm=[Mm],Rm=e("i",{class:"fa-solid fa-link"},null,-1),Bm=[Rm],Em={class:"dropdown"},Lm=e("button",{class:"btn btn-link dropdown-toggle",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-brands fa-hire-a-helper"})],-1),Km={class:"dropdown-menu item-with-text cursor-pointer text-muted p-2"},Nm=["onClick"],Jm=["innerHTML"],Hm=B('<div class="modal fade" id="font-choose-modal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-centered"><div class="modal-content"><div class="modal-body"><h6 class="fw-bold"><strong class="text-primary">Внимание!</strong> Откройте ссылку с генератором шрифтов, выберите шрифт, введите текст, а затем скопируйте полученный результат в поле ниже - текст с этим шрифтом будет отображен пользователю!</h6><a href="https://textgenerator.ru/" class="btn btn-link w-100 text-center" target="_blank"><i class="fa-solid fa-arrow-up-right-from-square"></i> Открыть генератор шрифтов</a></div></div></div></div>',1),Ym={class:"modal fade",id:"link-enter-modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},Gm={class:"modal-dialog modal-dialog-centered"},Wm={class:"modal-body"},Xm=e("div",{class:"alert alert-light mb-2"},[e("strong",{class:"fw-bold"},"Внимание!"),m(" Добавьте ссылку, на которую должен перейти пользователь! ")],-1),Zm={class:"form-floating mb-2"},xm=e("label",{for:"floatingInput"},"Ссылка",-1),eh=B('<div class="d-flex justify-content-center"><div class="p-2 w-100"><button type="button" class="btn btn-secondary w-100" data-bs-dismiss="modal">Отмена </button></div><div class="p-2 w-100"><button type="submit" class="btn btn-primary w-100">Сохранить </button></div></div>',1),th={class:"modal fade",id:"relink-modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},sh={class:"modal-dialog modal-dialog-centered"},oh={class:"modal-body"},lh=e("div",{class:"alert alert-light mb-2"},[e("strong",{class:"fw-bold"},"Внимание!"),m(" Вы создаете кнопку к тексту, по которой пользователь сможет поделиться ссылкой и текстом к ней! ")],-1),ih={class:"form-floating mb-2"},nh=e("label",{for:"floatingInput"},"Ссылка,url",-1),ah={class:"form-floating"},dh=e("label",{for:"floatingTextarea2"},"Текст к ссылке",-1),rh=B('<div class="d-flex justify-content-center"><div class="p-2 w-100"><button type="button" class="btn btn-secondary w-100" data-bs-dismiss="modal">Отмена </button></div><div class="p-2 w-100"><button type="submit" class="btn btn-primary w-100">Сохранить </button></div></div>',1);function ch(o,t,s,d,n,a){return l(),i(f,null,[e("div",$m,[e("button",{type:"button",onClick:t[0]||(t[0]=(...h)=>a.openReLinkModal&&a.openReLinkModal(...h)),"data-bs-toggle":"tooltip","data-bs-title":"Добавить кнопку с пересылкой ссылки друзьям",class:"btn btn-link"},Fm),e("button",{type:"button",onClick:t[1]||(t[1]=(...h)=>a.openFontModal&&a.openFontModal(...h)),"data-bs-toggle":"tooltip","data-bs-title":"Настройка шрифта",class:"btn btn-link"},Cm),c(e("div",null,[e("button",{type:"button",onClick:t[2]||(t[2]=(...h)=>a.boldTag&&a.boldTag(...h)),"data-bs-toggle":"tooltip","data-bs-title":"Жирный текст",class:"btn btn-link"},jm),e("button",{type:"button",onClick:t[3]||(t[3]=(...h)=>a.italic&&a.italic(...h)),"data-bs-toggle":"tooltip","data-bs-title":"Курсив",class:"btn btn-link"},qm),e("button",{type:"button",onClick:t[4]||(t[4]=(...h)=>a.underline&&a.underline(...h)),"data-bs-toggle":"tooltip","data-bs-title":"Подчеркнутый текст",class:"btn btn-link"},Pm),e("button",{type:"button",onClick:t[5]||(t[5]=(...h)=>a.spoiler&&a.spoiler(...h)),"data-bs-toggle":"tooltip","data-bs-title":"Скрытый текст",class:"btn btn-link"},Om),e("button",{type:"button",onClick:t[6]||(t[6]=(...h)=>a.strike&&a.strike(...h)),"data-bs-toggle":"tooltip","data-bs-title":"Зачеркнутый текст",class:"btn btn-link"},Im),e("button",{type:"button",onClick:t[7]||(t[7]=(...h)=>a.code&&a.code(...h)),"data-bs-toggle":"tooltip","data-bs-title":"Фрагмент кода",class:"btn btn-link"},Tm),e("button",{type:"button",onClick:t[8]||(t[8]=(...h)=>a.blockquote&&a.blockquote(...h)),"data-bs-toggle":"tooltip","data-bs-title":"Цитата",class:"btn btn-link"},Dm),e("button",{type:"button",onClick:t[9]||(t[9]=(...h)=>a.openLinkModal&&a.openLinkModal(...h)),"data-bs-toggle":"tooltip","data-bs-title":"Ссылка",class:"btn btn-link"},Bm)],512),[[V,n.need_text_menu]]),e("div",Em,[Lm,e("div",Km,[(l(!0),i(f,null,$(n.expressions,h=>(l(),i("li",{onClick:p=>a.expressionsSelect(h)},[e("a",{class:"dropdown-item",href:"javascript:void(0)",innerHTML:h.description},null,8,Jm)],8,Nm))),256))])])]),Hm,e("div",Ym,[e("div",Gm,[e("form",{class:"modal-content",onSubmit:t[11]||(t[11]=C((...h)=>a.linkTag&&a.linkTag(...h),["prevent"]))},[e("div",Wm,[Xm,e("div",Zm,[c(e("input",{type:"text","onUpdate:modelValue":t[10]||(t[10]=h=>n.link=h),class:"form-control",id:"floatingInput",placeholder:"name@example.com",required:""},null,512),[[_,n.link]]),xm]),eh])],32)])]),e("div",th,[e("div",sh,[e("form",{class:"modal-content",onSubmit:t[14]||(t[14]=C((...h)=>a.reLinkSubmit&&a.reLinkSubmit(...h),["prevent"]))},[e("div",oh,[lh,e("div",ih,[c(e("input",{type:"url","onUpdate:modelValue":t[12]||(t[12]=h=>n.reLinkForm.url=h),class:"form-control",id:"floatingInput",placeholder:"name@example.com",required:""},null,512),[[_,n.reLinkForm.url]]),nh]),e("div",ah,[c(e("textarea",{class:"form-control","onUpdate:modelValue":t[13]||(t[13]=h=>n.reLinkForm.text=h),placeholder:"Leave a comment here",id:"floatingTextarea2",style:{"min-height":"100px"},required:""},null,512),[[_,n.reLinkForm.text]]),dh]),rh])],32)])])],64)}const uh=U(ym,[["render",ch]]),mh=e("div",{class:"alert alert-success",role:"alert"},' Проверка правил идет по методу "И" - все правила должны выполняться для перехода на данную страницу, иначе будет вызвана страница из блока "иначе". Действия для "иначе" добавлять не обязательно. ',-1),hh=e("h6",null,"Блок условий",-1),_h={key:0,class:"py-2"},ph={class:"form-label",id:"bot-domain"},bh=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),fh=e("div",null,"Напишите текст, который будет отображен пользователю вместе с основным контентом в случае если условие будет выполнено ",-1),gh={class:"dropdown mb-2"},vh=e("button",{class:"btn btn-outline-info dropdown-toggle w-100",type:"button",id:"dropdownMenuButton1","data-bs-toggle":"dropdown","aria-expanded":"false"}," Добавить условие ",-1),yh={class:"dropdown-menu","aria-labelledby":"dropdownMenuButton1"},$h=["onClick"],kh={key:1},Fh={key:2,class:"list-group"},wh={key:0,class:"list-group-item d-flex justify-content-between align-items-center"},Ch={class:"form-check"},Sh={class:"form-check-label",for:"bot-user-is-vip"},jh={key:0},Vh={key:1},qh=e("i",{class:"fa-solid fa-trash-can"},null,-1),zh=[qh],Ph={key:1,class:"list-group-item d-flex justify-content-between align-items-center"},Uh={class:"form-check"},Oh={class:"form-check-label",for:"bot-user-is-admin"},Ah={key:0},Ih={key:1},Qh=e("i",{class:"fa-solid fa-trash-can"},null,-1),Th=[Qh],Mh={key:2,class:"list-group-item d-flex justify-content-between align-items-center"},Dh={class:"form-check"},Rh={class:"form-check-label",for:"bot-user-is-deliveryman"},Bh={key:0},Eh={key:1},Lh=e("i",{class:"fa-solid fa-trash-can"},null,-1),Kh=[Lh],Nh={key:3,class:"list-group-item d-flex justify-content-between align-items-center"},Jh={class:"form-check"},Hh={class:"form-check-label",for:"bot-user-is-work"},Yh={key:0},Gh={key:1},Wh=e("i",{class:"fa-solid fa-trash-can"},null,-1),Xh=[Wh],Zh={key:4,class:"list-group-item d-flex justify-content-between align-items-center"},xh={class:"form-check"},e_={class:"form-check-label",for:"bot-user-in-location"},t_={key:0},s_={key:1},o_=e("i",{class:"fa-solid fa-trash-can"},null,-1),l_=[o_],i_={key:5,class:"list-group-item d-flex justify-content-between align-items-center"},n_=e("label",{class:"form-label",id:"bot-domain"}," Возраст от ",-1),a_=e("i",{class:"fa-solid fa-trash-can"},null,-1),d_=[a_],r_={key:6,class:"list-group-item d-flex justify-content-between align-items-center"},c_=e("label",{class:"form-label",id:"bot-domain"}," Только для города ",-1),u_=e("i",{class:"fa-solid fa-trash-can"},null,-1),m_=[u_],h_={key:7,class:"list-group-item d-flex justify-content-between align-items-center"},__={class:"form-check"},p_={class:"form-check-label",for:"bot-user-sex"},b_={key:0},f_={key:1},g_=e("i",{class:"fa-solid fa-trash-can"},null,-1),v_=[g_],y_={key:8,class:"list-group-item"},$_={class:"mb-3"},k_={class:"d-flex justify-content-between align-items-center"},F_={class:"form-label d-flex w-100 align-items-center",id:"bot-order-channel"},w_=["onClick"],C_=e("i",{class:"fa-solid fa-trash-can"},null,-1),S_=[C_],j_=["onUpdate:modelValue"],V_={key:3,class:"mt-5"},q_={key:4,class:"d-flex justify-content-between"},z_={key:6,class:"py-2"},P_={class:"form-label",id:"bot-domain"},U_=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),O_=e("div",null,'Напишите текст, который будет отображен пользователю вместе с основным контентом в случае если условие не будет выполнено и будет вызван блок "иначе" ',-1),A_={props:["bot","rulesForm"],data(){return{rules:[{id:1,title:"Является администратором",rules_block:"bot_user",rule:{is_admin:!0}},{id:2,title:"Является VIP-пользователем",rules_block:"bot_user",rule:{is_vip:!0}},{id:3,title:"Находится в заведении",rules_block:"bot_user",rule:{user_in_location:!0}},{id:4,title:"За работой",rules_block:"bot_user",rule:{is_work:!0}},{id:5,title:"Возраст от ...",rules_block:"bot_user",rule:{age:18}},{id:6,title:"Находится в городе ...",rules_block:"bot_user",rule:{city:"Краснодар"}},{id:7,title:"Пол",rules_block:"bot_user",rule:{sex:!0}},{id:8,title:"Состоит в канале",rules_block:"channels",rule:{channel:1}},{id:9,title:"Является Менеджером",rules_block:"bot_user",rule:{is_manager:!0}}]}},computed:{rulesForCustomFields(){let o=this.rules.filter(t=>t.key!=null);return console.log("filtered rules",o),o}},mounted(){},methods:{hasRuleKey(o){return this.rulesForm.rules_if==null?!1:(console.log("key=>",o||"-"),Object.keys(this.rulesForm.rules_if.bot_user).find(t=>t===o)!=null)},modifyChannel(o){this.rulesForm.rules_if.channels[o.param]=o.text},removeChannelFromRule(o){this.rulesForm.rules_if.channels.splice(o,1)},removeRule(o){delete this.rulesForm.rules_if.bot_user[o]},addRules(o){this.rulesForm.rules_if||(this.rulesForm.rules_if={bot_user:{},channels:[]}),o.rules_block==="bot_user"&&(this.rulesForm.rules_if.bot_user={...this.rulesForm.rules_if.bot_user,...o.rule}),o.rules_block==="channels"&&this.rulesForm.rules_if.channels.push(o.rule.channel)},loadCurrentBotFields(){return this.$store.dispatch("loadCurrentBotFields",{bot_id:this.bot.id}).then(o=>{(o.data||[]).forEach(s=>{s.is_active&&(this.rules.push({id:this.rules.length+1,title:s.label,key:s.key,type:s.type,rules_block:"bot_user",rule:{}}),s.type===0&&(this.rules[this.rules.length-1].rule[s.key]=""),s.type===1&&(this.rules[this.rules.length-1].rule[s.key]=0),s.type===2&&(this.rules[this.rules.length-1].rule[s.key]=!0))}),console.log("new rules=>",this.rules)})},attachPageToRule(o){o.id!=this.rulesForm.id?this.rulesForm.rules_else_page_id=o.id:this.$notify({title:"Конструктор страниц",text:"Вы не можете связать данную страницу с собой",type:"error"})}}},I_=Object.assign(A_,{__name:"PageRules",setup(o){return(t,s)=>{const d=z("Popper");return l(),i(f,null,[mh,hh,o.rulesForm.rules_if?(l(),i("div",_h,[e("label",ph,[b(d,null,{content:v(()=>[fh]),default:v(()=>[bh]),_:1}),m(" Сообщение при успешном прохождении условий (не обязательно) ")]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Текст сообщения","aria-label":"Текст сообщения","onUpdate:modelValue":s[0]||(s[0]=n=>o.rulesForm.rules_if_message=n),maxlength:"255","aria-describedby":"rules-else-message"},`
            `,512),[[_,o.rulesForm.rules_if_message]])])):r("",!0),e("div",gh,[vh,e("ul",yh,[(l(!0),i(f,null,$(t.rules,n=>(l(),i("li",null,[e("a",{onClick:a=>t.addRules(n),class:"dropdown-item",href:"javascript:void(0)"},u(n.title||"Не указан"),9,$h)]))),256))])]),o.rulesForm.rules_if?(l(),i("h6",kh,"Выбранные условия")):r("",!0),o.rulesForm.rules_if?(l(),i("ul",Fh,[t.hasRuleKey("is_vip")?(l(),i("li",wh,[e("div",Ch,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[1]||(s[1]=n=>o.rulesForm.rules_if.bot_user.is_vip=n),type:"checkbox",id:"bot-user-is-vip"},null,512),[[k,o.rulesForm.rules_if.bot_user.is_vip]]),e("label",Sh,[o.rulesForm.rules_if.bot_user.is_vip?(l(),i("span",jh,"Является VIP-пользователем")):(l(),i("span",Vh,"Не является VIP-пользователем"))])]),e("button",{type:"button",class:"btn btn-outline-info",onClick:s[2]||(s[2]=n=>t.removeRule("is_vip"))},zh)])):r("",!0),t.hasRuleKey("is_admin")?(l(),i("li",Ph,[e("div",Uh,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[3]||(s[3]=n=>o.rulesForm.rules_if.bot_user.is_admin=n),type:"checkbox",id:"bot-user-is-admin"},null,512),[[k,o.rulesForm.rules_if.bot_user.is_admin]]),e("label",Oh,[o.rulesForm.rules_if.bot_user.is_admin?(l(),i("span",Ah,"Является администратором")):(l(),i("span",Ih,"Не является администратором"))])]),e("button",{type:"button",class:"btn btn-outline-info",onClick:s[4]||(s[4]=n=>t.removeRule("is_admin"))},Th)])):r("",!0),t.hasRuleKey("is_deliveryman")?(l(),i("li",Mh,[e("div",Dh,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[5]||(s[5]=n=>o.rulesForm.rules_if.bot_user.is_deliveryman=n),type:"checkbox",id:"bot-user-is-deliveryman"},null,512),[[k,o.rulesForm.rules_if.bot_user.is_deliveryman]]),e("label",Rh,[o.rulesForm.rules_if.bot_user.is_deliveryman?(l(),i("span",Bh,"Является доставщиком")):(l(),i("span",Eh,"Не является доставщиком"))])]),e("button",{type:"button",class:"btn btn-outline-info",onClick:s[6]||(s[6]=n=>t.removeRule("is_deliveryman"))},Kh)])):r("",!0),t.hasRuleKey("is_work")?(l(),i("li",Nh,[e("div",Jh,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[7]||(s[7]=n=>o.rulesForm.rules_if.bot_user.is_work=n),type:"checkbox",id:"bot-user-is-work"},null,512),[[k,o.rulesForm.rules_if.bot_user.is_work]]),e("label",Hh,[o.rulesForm.rules_if.bot_user.is_work?(l(),i("span",Yh,"За работой")):(l(),i("span",Gh,"Не работает"))])]),e("button",{type:"button",class:"btn btn-outline-info",onClick:s[8]||(s[8]=n=>t.removeRule("is_work"))},Xh)])):r("",!0),t.hasRuleKey("user_in_location")?(l(),i("li",Zh,[e("div",xh,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[9]||(s[9]=n=>o.rulesForm.rules_if.bot_user.user_in_location=n),type:"checkbox",id:"bot-user-in-location"},null,512),[[k,o.rulesForm.rules_if.bot_user.user_in_location]]),e("label",e_,[o.rulesForm.rules_if.bot_user.user_in_location?(l(),i("span",t_,"Находится в заведении")):(l(),i("span",s_,"Не находится в заведении"))])]),e("button",{type:"button",class:"btn btn-outline-info",onClick:s[10]||(s[10]=n=>t.removeRule("user_in_location"))},l_)])):r("",!0),t.hasRuleKey("age")?(l(),i("li",i_,[e("div",null,[n_,c(e("input",{type:"text",class:"form-control",placeholder:"Возраст от","aria-label":"Возраст от","onUpdate:modelValue":s[11]||(s[11]=n=>o.rulesForm.rules_if.bot_user.age=n),maxlength:"255","aria-describedby":"bot-user-age"},null,512),[[_,o.rulesForm.rules_if.bot_user.age]])]),e("button",{type:"button",class:"btn btn-outline-info",onClick:s[12]||(s[12]=n=>t.removeRule("age"))},d_)])):r("",!0),t.hasRuleKey("city")?(l(),i("li",r_,[e("div",null,[c_,c(e("input",{type:"text",class:"form-control",placeholder:"Город","aria-label":"Город","onUpdate:modelValue":s[13]||(s[13]=n=>o.rulesForm.rules_if.bot_user.city=n),maxlength:"255","aria-describedby":"bot-user-city"},null,512),[[_,o.rulesForm.rules_if.bot_user.city]])]),e("button",{type:"button",class:"btn btn-outline-info",onClick:s[14]||(s[14]=n=>t.removeRule("city"))},m_)])):r("",!0),t.hasRuleKey("sex")?(l(),i("li",h_,[e("div",__,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[15]||(s[15]=n=>o.rulesForm.rules_if.bot_user.sex=n),type:"checkbox",id:"bot-user-sex"},null,512),[[k,o.rulesForm.rules_if.bot_user.sex]]),e("label",p_,[o.rulesForm.rules_if.bot_user.sex?(l(),i("span",b_,"Только для мужчин")):(l(),i("span",f_,"Только для женщин"))])]),e("button",{type:"button",class:"btn btn-outline-info",onClick:s[16]||(s[16]=n=>t.removeRule("sex"))},v_)])):r("",!0),o.rulesForm.rules_if.channels.length>0?(l(),i("li",y_,[m("Проверка нахождения в канале \\ группе: "),(l(!0),i(f,null,$(o.rulesForm.rules_if.channels,(n,a)=>(l(),i("div",$_,[e("div",k_,[e("label",F_,[b(ue,{token:o.bot.bot_token,param:`${a}`,onCallback:t.modifyChannel},null,8,["token","param","onCallback"]),m(" Канал для проверки ")]),e("button",{type:"button",class:"btn btn-link text-danger",onClick:h=>t.removeChannelFromRule(a)},S_,8,w_)]),c(e("input",{type:"text",class:"form-control",placeholder:"id канала","aria-label":"id канала","onUpdate:modelValue":h=>o.rulesForm.rules_if.channels[a]=h,maxlength:"255","aria-describedby":"bot-order-channel"},null,8,j_),[[_,o.rulesForm.rules_if.channels[a]]])]))),256))])):r("",!0)])):r("",!0),o.rulesForm.rules_if?(l(),i("h6",V_,"Иначе")):r("",!0),o.rulesForm.rules_else_page_id?(l(),i("p",q_,[m("Вы выбрали страницу #"+u(o.rulesForm.rules_else_page_id)+' в качестве условия "иначе" ',1),e("a",{href:"javascript:void(0)",onClick:s[17]||(s[17]=n=>o.rulesForm.rules_else_page_id=null)},"Очистить")])):r("",!0),o.rulesForm.rules_if?(l(),y(K,{key:5,current:o.rulesForm.id,onCallback:t.attachPageToRule,editor:!1},null,8,["current","onCallback"])):r("",!0),o.rulesForm.rules_if?(l(),i("div",z_,[e("label",P_,[b(d,null,{content:v(()=>[O_]),default:v(()=>[U_]),_:1}),m(" Сообщение в случае невыполнения условий (не обязательно) ")]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Текст сообщения","aria-label":"Текст сообщения","onUpdate:modelValue":s[18]||(s[18]=n=>o.rulesForm.rules_else_message=n),maxlength:"255","aria-describedby":"rules-else-message"},`
            `,512),[[_,o.rulesForm.rules_else_message]])])):r("",!0)],64)}}}),Q_={class:"page-container"},T_={class:"page-content"},M_={class:"row"},D_={class:"col"},R_={class:"row"},B_={class:"col"},E_={class:"row"},L_={class:"col"},K_={class:"row"},N_={class:"col-12"},J_=["innerHTML"],H_={key:0,class:"row"},Y_={class:"col-12"},G_={key:1,class:"row mt-2"},W_=e("p",{class:"mb-0"},[e("strong",null,"Нижнее меню")],-1),X_={class:"col-12"},Z_={props:["page"]},x_=Object.assign(Z_,{__name:"PagePreview",setup(o){return(t,s)=>{const d=Q("lazy");return l(),i("div",Q_,[e("div",T_,[e("div",M_,[o.page.images?(l(!0),i(f,{key:0},$(o.page.images,(n,a)=>(l(),i("div",D_,[c(e("img",null,null,512),[[d,"/images-by-bot-id/"+o.page.bot_id+"/"+n]])]))),256)):r("",!0)]),e("div",R_,[o.page.videos?(l(!0),i(f,{key:0},$(o.page.videos,(n,a)=>(l(),i("div",B_,[b(Z,{content:n,type:"video"},null,8,["content"])]))),256)):r("",!0)]),e("div",E_,[o.page.audios?(l(!0),i(f,{key:0},$(o.page.audios,(n,a)=>(l(),i("div",L_,[b(Z,{content:n,type:"audio"},null,8,["content"])]))),256)):r("",!0)]),e("div",K_,[e("div",N_,[e("p",{innerHTML:o.page.content},null,8,J_)])])]),o.page.inlineKeyboard?(l(),i("div",H_,[e("div",Y_,[o.page.inlineKeyboard.deleted_at?r("",!0):(l(),y(ee,{key:0,simple:!0,"select-mode":!0,keyboard:o.page.inlineKeyboard},null,8,["keyboard"]))])])):r("",!0),o.page.replyKeyboard?(l(),i("div",G_,[W_,e("div",X_,[o.page.replyKeyboard.deleted_at?r("",!0):(l(),y(ee,{key:0,simple:!0,"select-mode":!0,keyboard:o.page.replyKeyboard},null,8,["keyboard"]))])])):r("",!0)])}}}),ep={class:"d-flex justify-content-between btn-group mb-2"},tp=e("div",{class:"alert alert-light"},[e("strong",{class:"fw-bold"},"Внимание!"),m(" Если страница с таким название уже есть, то повторно она не будет создана! ")],-1),sp={class:"input-group mb-3"},op={class:"form-floating"},lp=["onUpdate:modelValue"],ip={for:"floatingInput"},np=["onClick"],ap=e("i",{class:"fa-solid fa-trash-can"},null,-1),dp=[ap],rp=["disabled"],cp=e("div",{class:"alert alert-light"},[e("strong",{class:"fw-bold"},"Внимание!"),m(" Если страница с таким название уже есть, то повторно она не будет создана! Каждая создаваемая вами страница получит текущий вариант меню. ")],-1),up=["disabled"],mp={data(){return{variant:0,bot:null,keyboard:null,settings:null,pages:[]}},computed:{...S(["getCurrentBot"])},mounted(){this.loadCurrentBot()},methods:{loadCurrentBot(o=null){return this.$store.dispatch("updateCurrentBot",{bot:o}).then(()=>{this.bot=this.getCurrentBot})},submit2(){this.$store.dispatch("addMultiPagesByKeyboard",{bot_id:this.bot.id,keyboard:this.keyboard,settings:this.settings}).then(()=>{this.keyboard=null,this.settings=null,this.$notify({title:"Конструктор страниц",text:"Вы успешно добавили страницы!",type:"success"}),this.$emit("callback")}).catch(()=>{this.$notify({title:"Конструктор страниц",text:"Ошибка добавления страниц",type:"error"})})},saveSettings(o){this.settings=o},submit(){this.$store.dispatch("addMultiPages",{bot_id:this.bot.id,pages:this.pages}).then(()=>{this.pages=[],this.$notify({title:"Конструктор страниц",text:"Вы успешно добавили страницы!",type:"success"}),this.$emit("callback")}).catch(()=>{this.$notify({title:"Конструктор страниц",text:"Ошибка добавления страниц",type:"error"})})},addPage(){this.pages.push("")},removePage(o){this.pages.splice(o,1)}}},hp=Object.assign(mp,{__name:"FastPageForm",setup(o){return(t,s)=>(l(),i(f,null,[e("div",ep,[e("button",{onClick:s[0]||(s[0]=d=>t.variant=0),class:g([{"btn-primary":t.variant===0,"btn-outline-primary":t.variant!==0},"btn w-100"])}," Через страницы ",2),e("button",{onClick:s[1]||(s[1]=d=>t.variant=1),class:g([{"btn-primary":t.variant===1,"btn-outline-primary":t.variant!==1},"btn w-100"])}," Через клавиатуру ",2)]),c(e("form",{onSubmit:s[3]||(s[3]=C((...d)=>t.submit&&t.submit(...d),["prevent"]))},[tp,(l(!0),i(f,null,$(t.pages,(d,n)=>(l(),i("div",sp,[e("div",op,[c(e("input",{"onUpdate:modelValue":a=>t.pages[n]=a,type:"text",class:"form-control",id:"floatingInput",placeholder:"name@example.com",required:""},null,8,lp),[[_,t.pages[n]]]),e("label",ip,"Название страницы #"+u(n+1),1)]),e("a",{onClick:a=>t.removePage(n),href:"javascript:void(0)",class:"input-group-text",id:"basic-addon1"},dp,8,np)]))),256)),e("button",{type:"button",onClick:s[2]||(s[2]=(...d)=>t.addPage&&t.addPage(...d)),class:"btn btn-outline-primary p-3 w-100 mb-2"},"Добавить еще страницу"),e("button",{disabled:t.pages.length===0,class:"btn btn-primary p-3 w-100"},"Сохранить страницы",8,rp)],544),[[V,t.variant===0]]),c(e("form",{onSubmit:s[5]||(s[5]=C((...d)=>t.submit2&&t.submit2(...d),["prevent"]))},[cp,b(A,{type:"reply",onSaveSettings:t.saveSettings,modelValue:t.keyboard,"onUpdate:modelValue":s[4]||(s[4]=d=>t.keyboard=d)},null,8,["onSaveSettings","modelValue"]),e("button",{disabled:t.keyboard==null||(t.keyboard||[]).length===0,class:"btn btn-primary p-3 w-100"},"Сохранить страницы",8,up)],544),[[V,t.variant===1]])],64))}});const _p={key:0,class:"row"},pp={class:"col-12"},bp={class:"alert alert-light",role:"alert"},fp=e("strong",{class:"fw-bold"},"Внимание!",-1),gp={style:{"font-size":"16px"}},vp={key:0,class:"row"},yp={class:"col-12 mb-2"},$p=e("h6",null,"На странице выбраны следующие разделы",-1),kp={class:"mini-pics justify-content-start d-inline-flex text-primary"},Fp=e("i",{class:"fa-regular fa-images"},null,-1),wp=[Fp],Cp=e("i",{class:"fa-regular fa-note-sticky"},null,-1),Sp=[Cp],jp=e("i",{class:"fa-solid fa-photo-film"},null,-1),Vp=[jp],qp=e("i",{class:"fa-regular fa-file-audio"},null,-1),zp=[qp],Pp=e("i",{class:"fa-regular fa-file-word"},null,-1),Up=[Pp],Op=e("i",{class:"fa-solid fa-link"},null,-1),Ap=[Op],Ip=e("i",{class:"fa-solid fa-scroll"},null,-1),Qp=[Ip],Tp=e("i",{class:"fa-regular fa-comment-dots"},null,-1),Mp=[Tp],Dp=e("i",{class:"fa-solid fa-scale-balanced"},null,-1),Rp=[Dp],Bp=e("i",{class:"fa-regular fa-keyboard"},null,-1),Ep=[Bp],Lp=e("i",{class:"fa-solid fa-ellipsis"},null,-1),Kp=[Lp],Np={class:"row"},Jp={class:"col-md-4 col-12 mb-2"},Hp={class:"input-group"},Yp={class:"form-floating"},Gp={class:"form-label",id:"bot-domain"},Wp=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Xp={key:0},Zp=e("a",{"data-bs-toggle":"tooltip","data-bs-title":"Обучение работе с системой",href:"https://telegra.ph/Sozdanie-stranic-bota-02-07",target:"_blank",class:"input-group-text px-3 text-primary"},[e("i",{class:"fa-solid fa-graduation-cap"})],-1),xp={class:"col-md-8 col-12 mb-2 d-flex justify-content-end align-items-end"},eb={class:"btn-group",style:{background:"white"},role:"group","aria-label":"Basic example"},tb=e("i",{class:"fa-solid fa-file-circle-plus"},null,-1),sb=[tb],ob={type:"submit",title:"Сохранить страницу",id:"save-page-btn","data-bs-toggle":"tooltip","data-bs-title":"Сохранить страницу",class:"btn btn-primary min-menu-btn"},lb=e("i",{class:"fa-regular fa-floppy-disk"},null,-1),ib=[lb],nb=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),ab=[nb],db=e("i",{class:"fa-solid fa-list-ol"},null,-1),rb=[db],cb={class:"row"},ub={class:"col-12 mb-2"},mb={class:"d-flex justify-content-between align-items-center"},hb=e("label",{class:"form-label mb-0",id:"bot-domain"},[e("span",{class:"badge rounded-pill text-bg-warning m-0"},"Желательно"),m(" Текст на странице ")],-1),_b={class:"form-floating"},pb={for:"main-text-field"},bb={key:0},fb={class:"col-12 mb-2"},gb={class:"nav nav-tabs justify-content-center"},vb=e("i",{class:"fa-regular fa-keyboard"},null,-1),yb=e("span",null,"Нижнее меню",-1),$b=[vb,yb],kb=e("i",{class:"fa-solid fa-ellipsis"},null,-1),Fb=e("span",null,"Меню под текстом",-1),wb=[kb,Fb],Cb=e("i",{class:"fa-regular fa-images"},null,-1),Sb=e("span",null,"Изображения",-1),jb=[Cb,Sb],Vb=e("i",{class:"fa-solid fa-photo-film"},null,-1),qb=e("span",null,"Видео",-1),zb=[Vb,qb],Pb=e("i",{class:"fa-regular fa-file-audio"},null,-1),Ub=e("span",null,"Аудио",-1),Ob=[Pb,Ub],Ab=e("i",{class:"fa-regular fa-file-word"},null,-1),Ib=e("span",null,"Документы",-1),Qb=[Ab,Ib],Tb=e("i",{class:"fa-solid fa-link"},null,-1),Mb=e("span",null,"Другая страница",-1),Db=[Tb,Mb],Rb=e("i",{class:"fa-solid fa-scroll"},null,-1),Bb=e("span",null,"Скрипт",-1),Eb=[Rb,Bb],Lb=e("i",{class:"fa-regular fa-comment-dots"},null,-1),Kb=e("span",null,"Начало диалога",-1),Nb=[Lb,Kb],Jb={class:"nav-item"},Hb={class:"dropdown"},Yb=e("button",{class:"nav-link dropdown-toggle d-flex flex-column justify-content-center align-items-center font-12",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-hamburger"}),m(" Другие возможности ")],-1),Gb={class:"dropdown-menu"},Wb=e("i",{class:"fa-solid fa-scale-balanced"},null,-1),Xb=e("i",{class:"fa fa-key","aria-hidden":"true"},null,-1),Zb=e("i",{class:"fa fa-money-bill","aria-hidden":"true"},null,-1),xb=e("i",{class:"fa-solid fa-sack-dollar"},null,-1),ef=e("i",{class:"fa-regular fa-note-sticky"},null,-1),tf={key:0,class:"col-12 mb-2"},sf={class:"form-check"},of=e("label",{class:"form-check-label",for:"need-reply-menu"}," Нижнее меню страницы ",-1),lf={key:1,class:"col-12 mb-2"},nf={class:"card"},af={class:"card-header d-flex justify-between align-items-center"},df=e("h6",null,"Конструктор нижнего меню",-1),rf={key:0},cf={key:1},uf={class:"card-body"},mf={class:"row"},hf={class:"col-12 mb-2"},_f={class:"form-label",id:"bot-domain"},pf=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),bf=e("div",null," Заголовок для нижнего меню ",-1),ff={class:"form-check form-switch"},gf=e("label",{class:"form-check-label",for:"need-page-create-from-keyboard"}," Нужно создать страницы на основе клавиатуры ",-1),vf={key:2,class:"col-12 mb-2"},yf={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},$f={class:"d-flex justify-content-center mb-3"},kf={alt:"",width:"100",height:"100"},Ff=e("h1",{class:"text-body-emphasis"},"Нижнее меню",-1),wf=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"}," Создание и настройка нижнего меню страницы бота. Добавление и редактирование функций кнопок бота на странице. Данное меню отображается пользователю всегда. ",-1),Cf={class:"d-inline-flex gap-2 mb-5"},Sf=["disabled"],jf=e("a",{href:"https://telegra.ph/Nizhnee-menyu-bota-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),Vf={key:0,class:"col-12 mb-2"},qf={class:"form-check"},zf=e("label",{class:"form-check-label",for:"need-inline-menu"}," Меню под текстом страницы ",-1),Pf={key:1,class:"col-12 mb-2"},Uf={class:"card"},Of={class:"card-header d-flex justify-between align-items-center"},Af=e("h6",null,"Конструктор меню в сообщении",-1),If={key:0},Qf={key:1},Tf={class:"card-body"},Mf={key:2,class:"col-12 mb-2"},Df={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},Rf={class:"d-flex justify-content-center mb-3"},Bf={alt:"",width:"100",height:"100"},Ef=e("h1",{class:"text-body-emphasis"},"Меню под текстом",-1),Lf=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"}," В отличии от нижнего меню, которое отображается всегда, меню под текстом показывается под контентом только в момент отображения этого контента. ",-1),Kf={class:"d-inline-flex gap-2 mb-5"},Nf=["disabled"],Jf=e("a",{href:"https://telegra.ph/Menyu-k-tekstu-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),Hf={key:0,class:"col-12 mb-2"},Yf={class:"form-check"},Gf=e("label",{class:"form-check-label",for:"need-page-images"}," Изображения на странице (максимум 10) ",-1),Wf={key:1,class:"col-12 mb-2"},Xf={class:"card mb-3"},Zf=e("div",{class:"card-header"},[e("h6",null,"Загрузите изображения с файловой системы")],-1),xf={class:"card-body d-flex justify-content-start"},e1={for:"photos",style:{"margin-right":"10px"},class:"photo-loader ml-2"},t1={class:"row"},s1={key:0,class:"col-12 d-flex flex-wrap"},o1={class:"mb-2 img-preview",style:{"margin-right":"10px"}},l1={class:"remove"},i1=["onClick"],n1={key:1},a1={key:2,class:"col-12 d-flex flex-wrap"},d1={class:"mb-2 img-preview",style:{"margin-right":"10px"}},r1={class:"remove"},c1=["onClick"],u1={key:2,class:"col-12 mb-2"},m1={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},h1={class:"d-flex justify-content-center mb-3"},_1={alt:"",width:"100",height:"100"},p1=e("h1",{class:"text-body-emphasis"},"Изображения",-1),b1=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"},[m(" Вы можете добавить к одной странице от "),e("b",null,"1"),m(" до "),e("b",null,"10"),m(" изображений. Изображения (от 2х) будут собраны в группу и показаны под текстовым содержимым страницы. Если изображение одно, то текст будет отображен под ним. ")],-1),f1={class:"d-inline-flex gap-2 mb-5"},g1=["disabled"],v1=e("a",{href:"https://telegra.ph/Dobavlenie-izobrazhenij-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),y1={key:0,class:"col-12 mb-2"},$1={class:"form-check"},k1=e("label",{class:"form-check-label",for:"need-page-video"}," Видео к странице ",-1),F1={key:1,class:"col-12 mb-2"},w1={key:2,class:"col-12 mb-2"},C1={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},S1={class:"d-flex justify-content-center mb-3"},j1={alt:"",width:"100",height:"100"},V1=e("h1",{class:"text-body-emphasis"},"Видео",-1),q1=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"},[m(" Вы можете добавить к одной странице от "),e("b",null,"1"),m(" до "),e("b",null,"10"),m(" видео. Ролики (от 2х) будут собраны в группу и показаны под текстовым содержимым страницы. ")],-1),z1={class:"d-inline-flex gap-2 mb-5"},P1=["disabled"],U1=e("a",{href:"https://telegra.ph/Dobavlenie-video-na-stranicu-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),O1={key:0,class:"col-12 mb-2"},A1={class:"form-check"},I1=e("label",{class:"form-check-label",for:"need-page-sticker"}," Стикер к странице ",-1),Q1={key:1,class:"col-12 mb-2"},T1={key:2,class:"col-12 mb-2"},M1={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},D1={class:"d-flex justify-content-center mb-3"},R1={alt:"",width:"100",height:"100"},B1=e("h1",{class:"text-body-emphasis"},"Стикеры",-1),E1=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"}," Вы можете переслать любой стикер в бота (от лица администратора) и затем этот стикер использовать для взаимодействия с пользователем. ",-1),L1={class:"d-inline-flex gap-2 mb-5"},K1=["disabled"],N1=e("a",{href:"https://telegra.ph/Dobavlenie-stikera-na-stranicu-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),J1={key:0,class:"col-12 mb-2"},H1={class:"form-check"},Y1=e("label",{class:"form-check-label",for:"need-page-audio"}," Звук к странице ",-1),G1={key:1,class:"col-12 mb-2"},W1={key:2,class:"col-12 mb-2"},X1={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},Z1={class:"d-flex justify-content-center mb-3"},x1={alt:"",width:"100",height:"100"},eg=e("h1",{class:"text-body-emphasis"},"Аудио",-1),tg=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"},[m(" Вы можете добавить к одной странице от "),e("b",null,"1"),m(" до "),e("b",null,"10"),m(" аудио. Музыка (от 2х) будет собрана в группу и показана под текстовым содержимым страницы. Если вы хотите использовать "),e("b",{class:"text-danger"},"голосовое"),m(", то можно использовать максимум "),e("b",{class:"text-danger"},"одну запись"),m(". Или же, вы можете конвертировать её в mp3 и залить как музыкальный файл в бота. ")],-1),sg={class:"d-inline-flex gap-2 mb-5"},og=["disabled"],lg=e("a",{href:"https://telegra.ph/Dobavlenie-audio-na-stranicu-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),ig={key:0,class:"col-12 mb-2"},ng={class:"form-check"},ag=e("label",{class:"form-check-label",for:"need-page-document"}," Документ \\ презентацию к странице \\ картинку в оригинале ",-1),dg={key:1,class:"col-12 mb-2"},rg={key:2,class:"col-12 mb-2"},cg={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},ug={class:"d-flex justify-content-center mb-3"},mg={alt:"",width:"100",height:"100"},hg=e("h1",{class:"text-body-emphasis"},"Документы",-1),_g=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"},[m(" Вы можете добавить к одной странице от "),e("b",null,"1"),m(" до "),e("b",null,"10"),m(" документов. Документы (от 2х) будут собраны в группу и показана под текстовым содержимым страницы. В качестве файлов вы можете использовать текстовые документы, презентации, файлы-pdf, изображения в оригинальном размере. ")],-1),pg={class:"d-inline-flex gap-2 mb-5"},bg=["disabled"],fg=e("a",{href:"https://telegra.ph/Dobavlenie-dokumenta-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),gg={class:"col-12 mb-2"},vg={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},yg={class:"d-flex justify-content-center mb-3"},$g={alt:"",width:"100",height:"100"},kg=e("h1",{class:"text-body-emphasis"},"Связь со страницей",-1),Fg=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"}," Вы можете привязать вызов другой страницы непосредственно после вызова текущей. Это позволит выводить контент по цепочке для пользователя. ",-1),wg={key:0,class:"my-3 text-success font-bold"},Cg={class:"d-inline-flex gap-2 mb-5"},Sg={key:1,"data-bs-toggle":"modal","data-bs-target":"#page-list-modal",class:"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill btn-primary",type:"button"},jg=e("a",{href:"https://telegra.ph/Svyazyvanie-so-stranicej-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),Vg=e("h6",{class:"mb-3"},"Конструктор цепочек",-1),qg={class:"d-flex justify-content-center align-items-center flex-wrap"},zg=e("span",{class:"px-2"},"Текущая страница",-1),Pg=e("i",{class:"fa-solid fa-arrow-right"},null,-1),Ug={class:"d-flex justify-content-center align-items-center px-3 py-2"},Og=["onClick"],Ag={class:"position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger"},Ig={key:0,class:"fa-solid fa-arrow-right ml-2"},Qg={key:0,class:"fa-solid fa-arrow-right"},Tg=e("button",{type:"button","data-bs-toggle":"modal","data-bs-target":"#page-list-modal",class:"btn btn-outline-secondary position-relative rounded-5 ml-5"},[e("i",{class:"fa-solid fa-plus"})],-1),Mg={key:0,class:"col-12 mb-2"},Dg=e("div",{class:"alert alert-info",role:"alert"}," Если в вашем боте нет каких-то предустановленных скриптов вы можете найти их в глобальном магазине скриптов ",-1),Rg={class:"form-check"},Bg=e("label",{class:"form-check-label",for:"need-show-global-slug-list"}," Добавить скрипты из глобального магазина? ",-1),Eg={key:1,class:"col-12 mb-2"},Lg={class:"form-check"},Kg=e("label",{class:"form-check-label",for:"need-slug-attach"}," Привязать скрипт ",-1),Ng={key:2,class:"col-12 mb-2"},Jg={key:0,class:"alert alert-success d-flex justify-content-between align-items-center",role:"alert"},Hg={key:3,class:"col-12 mb-2"},Yg={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},Gg={class:"d-flex justify-content-center mb-3"},Wg={alt:"",width:"100",height:"100"},Xg=e("h1",{class:"text-body-emphasis"},"Скрипты",-1),Zg=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"}," Скрипты содержат основной функционал системы. Вы можете к каждой странице привязать один скрипт, который будет вызван после вывода основного содержимого страницы. ",-1),xg={class:"d-inline-flex gap-2 mb-5"},ev=["disabled"],tv=e("a",{href:"https://telegra.ph/Svyazyvanie-so-skriptom-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),sv={key:0,class:"col-12 mb-2"},ov={class:"form-check"},lv=e("label",{class:"form-check-label",for:"need-dialog-attach"}," Привязать начало диалога ",-1),iv={key:1,class:"col-12 mb-2"},nv={key:0},av={key:2,class:"col-12 mb-2"},dv={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},rv={class:"d-flex justify-content-center mb-3"},cv={alt:"",width:"100",height:"100"},uv=e("h1",{class:"text-body-emphasis"},"Диалоги",-1),mv=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"}," Диалоги страницы - это инструмент запроса данных от пользователя. Вы можете привязать начало диалога к странице, а сам диалог будет вызван по цепочке. ",-1),hv={class:"d-inline-flex gap-2 mb-5"},_v=["disabled"],pv=e("a",{href:"https://telegra.ph/Dobavlenie-dialoga-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),bv={key:0,class:"col-12 mb-2"},fv={class:"form-check"},gv=e("label",{class:"form-check-label",for:"need-rules"}," Нужны правила загрузки страницы ",-1),vv={key:1,class:"col-12 mb-2"},yv={key:2,class:"col-12 mb-2"},$v={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},kv={class:"d-flex justify-content-center mb-3"},Fv={alt:"",width:"100",height:"100"},wv=e("h1",{class:"text-body-emphasis"},"Правила отображения страницы",-1),Cv=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"}," Вы можете создать правила, согласно которым будет отображена та или иная страница. Вы можете перенаправить пользователя с одной страницы на другую, в случае если ваше условие не выполнено. ",-1),Sv={class:"d-inline-flex gap-2 mb-5"},jv=["disabled"],Vv=e("a",{href:"https://telegra.ph/Pravila-na-stranice-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),qv={key:0,class:"col-12 mb-2"},zv={class:"form-check"},Pv=e("label",{class:"form-check-label",for:"need-secure-page"}," Безопасная страница ",-1),Uv={key:1,class:"col-12 mb-2"},Ov={class:"input-group mb-2"},Av={class:"form-floating"},Iv=e("label",{for:"floatingPassword"},"Пароль страницы",-1),Qv={class:"input-group-text",id:"basic-addon1"},Tv=e("i",{class:"fa fa-refresh","aria-hidden":"true"},null,-1),Mv=[Tv],Dv={class:"form-floating"},Rv={for:"floatingTextarea2"},Bv={key:0,class:"small"},Ev={key:2,class:"col-12 mb-2"},Lv={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},Kv={class:"d-flex justify-content-center mb-3"},Nv={alt:"",width:"100",height:"100"},Jv=e("h1",{class:"text-body-emphasis"},"Безопасная страница",-1),Hv=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"}," Создайте безопасную страницу, доступ к которой будет только у тех людей, кому вы дадите пароль! Люди, которые получат один раз пароль, смогут постоянно заходить на данную страницу, даже если вы смените его. ",-1),Yv={class:"d-inline-flex gap-2 mb-5"},Gv=["disabled"],Wv=e("a",{href:"https://telegra.ph/Nizhnee-menyu-bota-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),Xv={key:0,class:"col-12 mb-2"},Zv={class:"form-check"},xv=e("label",{class:"form-check-label",for:"need-payed-page"}," Платная страница ",-1),ey={key:1,class:"col-12 mb-2"},ty={key:0,class:"alert alert-light"},sy={class:"row"},oy={class:"col-lg-6"},ly={class:"form-floating mb-2"},iy=["disabled"],ny=e("label",{for:"page-price"},"Цена за открытие страницы, руб",-1),ay={class:"col-lg-6"},dy={class:"form-floating mb-2"},ry=["disabled"],cy=e("label",{for:"page-price-period"},"Период оплаты, дней",-1),uy={class:"form-floating"},my=["disabled"],hy={for:"floatingTextarea2"},_y={key:0,class:"small"},py={key:2,class:"col-12 mb-2"},by={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},fy={class:"d-flex justify-content-center mb-3"},gy={alt:"",width:"100",height:"100"},vy=e("h1",{class:"text-body-emphasis"},"Платная страница",-1),yy=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"}," Данная страница позволяет запросить оплату с пользователя за её просмотр. Задайте цену страницы, описание перед оплатой и др. настройки оплаты. Пользователи, оплатившие услугу, получат постоянный доступ к этой странице. ",-1),$y={class:"d-inline-flex gap-2 mb-5"},ky=["disabled"],Fy=e("a",{href:"https://telegra.ph/Nizhnee-menyu-bota-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),wy={class:"col-12 mb-2"},Cy={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},Sy={class:"d-flex justify-content-center mb-3"},jy={alt:"",width:"100",height:"100"},Vy=e("h1",{class:"text-body-emphasis"},"Начисление бонусов",-1),qy=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"}," При переходе на данную страницу пользователь разово может получить указанную сумму бонусов! Начисление произойдет перед выводом контента страницы. ",-1),zy={class:"row d-flex justify-content-center my-2"},Py={class:"col-md-4"},Uy={class:"form-floating mb-2 w-100"},Oy=e("label",{for:"page-price"},"Сумма начисления бонусов, руб",-1),Ay={class:"row"},Iy={class:"col-md-12 my-3"},Qy=e("h6",null,"Нужно ли запрашивать какие-то данные у пользователя?",-1),Ty={class:"d-flex d-flex justify-content-center"},My={key:0,class:"row justify-content-center"},Dy={class:"col-md-12 my-3"},Ry=e("h6",null,"Упрощенный вариант сбора данных?",-1),By=e("p",{class:"fst-italic"},"Упрощенный вариант подразумевает получение только номера телефона!",-1),Ey={class:"d-flex d-flex justify-content-center"},Ly={class:"col-md-6 my-5"},Ky={class:"form-floating"},Ny={for:"floatingTextarea2"},Jy={key:0},Hy={class:"d-inline-flex gap-2 mb-5"},Yy={key:0},Gy={key:1},Wy=e("a",{href:"https://telegra.ph/Nizhnee-menyu-bota-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),Xy={class:"row"},Zy={class:"col-12"},xy={class:"alert alert-info",role:"alert"},e$=e("h6",null,"Страница поддерживает комбинации клавиш:",-1),t$={class:"mb-0 mr-0 p-0"},s$=e("strong",null,"Ctrl+M",-1),o$=B("<li><strong>Ctrl+S</strong> - открыть\\закрыть окно сохранения</li><li><strong>Ctrl+D</strong> - просмотр страницы (для сохраненных страниц)</li><li><strong>Ctrl+пробел</strong> - открыть\\закрыть список страниц</li><li><strong>Ctrl+backspace</strong> - очистить страницу\\новая страница</li><li><strong>Ctrl+стрелка вправо</strong> - переключение между вкладка вперед</li><li><strong>Ctrl+стрелка влево</strong> - переключение между вкладка назад</li>",6),l$={class:"modal fade",id:"fast-pages-create",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},i$={class:"modal-dialog modal-lg"},n$={class:"modal-content"},a$=e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"exampleModalLabel"},"Быстрое создание страниц"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),d$={class:"modal-body"},r$=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Не сохранять")],-1),c$={class:"modal fade",id:"save-modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},u$={class:"modal-dialog"},m$={class:"modal-content"},h$=e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"exampleModalLabel"},"Сохранение страницы"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),_$={class:"modal-body"},p$={key:0,class:"row"},b$={class:"col-12 mb-2"},f$={class:"d-flex justify-between"},g$=["href"],v$={class:"col-12 mb-2"},y$=e("h6",null,"На странице выбраны следующие разделы",-1),$$={class:"mini-pics text-primary"},k$=e("i",{class:"fa-regular fa-images"},null,-1),F$=[k$],w$=e("i",{class:"fa-regular fa-note-sticky"},null,-1),C$=[w$],S$=e("i",{class:"fa-solid fa-photo-film"},null,-1),j$=[S$],V$=e("i",{class:"fa-regular fa-file-audio"},null,-1),q$=[V$],z$=e("i",{class:"fa-regular fa-file-word"},null,-1),P$=[z$],U$=e("i",{class:"fa-solid fa-link"},null,-1),O$=[U$],A$=e("i",{class:"fa-solid fa-scroll"},null,-1),I$=[A$],Q$=e("i",{class:"fa-regular fa-comment-dots"},null,-1),T$=[Q$],M$=e("i",{class:"fa-solid fa-scale-balanced"},null,-1),D$=[M$],R$=e("i",{class:"fa-regular fa-keyboard"},null,-1),B$=[R$],E$=e("i",{class:"fa-solid fa-ellipsis"},null,-1),L$=[E$],K$={key:0,class:"col-12 mb-2"},N$={class:"form-check"},J$=e("label",{class:"form-check-label",for:"need-show-qr-and-link"}," Показать ссылку на страницу и QR-код ",-1),H$={key:1,class:"col-12 mb-2"},Y$={class:"mb-2"},G$=e("div",{class:"alert alert-info mb-2"},[e("strong",{class:"fw-bold"},"Внимание!"),m(" Используйте метки "),e("strong",{class:"fw-bold text-primary"},"на английском языке"),m(" или "),e("strong",{class:"fw-bold text-primary"},"число"),m("! ")],-1),W$={class:"form-floating mb-2"},X$=e("label",{for:"utm-source"},"Укажите метку для статистики",-1),Z$={class:"d-flex justify-content-center"},x$={style:{width:"200px",height:"200px"}},e2={class:"col-12 mb-2"},t2={class:"form-label",id:"bot-domain"},s2=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),o2=e("div",null,"Напишите для себя пояснение для чего нужна данная страница. Это поможет другим менеджерам лучше понять Вас. ",-1),l2=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),i2={class:"col-12"},n2={class:"form-check"},a2=e("label",{class:"form-check-label",for:"need_log_user_action"}," Логировать действия пользователя в канал при переходе ",-1),d2={class:"col-12"},r2={class:"form-check"},c2=e("label",{class:"form-check-label",for:"need-stay-after-save"}," Остаться на текущей странице после сохранения ",-1),u2=e("div",{class:"col-12"},[e("button",{type:"submit",id:"submit-page",class:"btn btn-success w-100 p-3"},"Сохранить ")],-1),m2=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Не сохранять")],-1),h2={class:"modal fade",id:"page-list-modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},_2={class:"modal-dialog"},p2={class:"modal-content"},b2={class:"modal-body"},f2={class:"offcanvas offcanvas-end w-25",tabindex:"-1",id:"offcanvas","data-bs-keyboard":"true","data-bs-scroll":"true","data-bs-backdrop":"true"},g2=e("div",{class:"offcanvas-header"},[e("h6",{class:"offcanvas-title d-none d-sm-block"},"Ваши страницы (кнопки)"),e("button",{type:"button",class:"btn-close text-reset","data-bs-dismiss":"offcanvas","aria-label":"Close"})],-1),v2={class:"offcanvas-body"},y2={class:"row"},$2={class:"col-12"},k2={class:"offcanvas offcanvas-end w-25",tabindex:"-1",id:"page-preview","data-bs-keyboard":"true","data-bs-scroll":"true","data-bs-backdrop":"true"},F2=e("div",{class:"offcanvas-header"},[e("h6",{class:"offcanvas-title d-none d-sm-block"},"Демонстрация страницы"),e("button",{type:"button",class:"btn-close text-reset","data-bs-dismiss":"offcanvas","aria-label":"Close"})],-1),w2={class:"offcanvas-body"},C2={key:1},S2={data(){return{module_configs:{},need_page_create_from_keyboard:!1,tab:0,links:[],saveModal:null,pageModal:null,fastPageModal:null,pagePreviewModal:null,page:null,need_clean:!1,load:!1,photos:[],showReplyTemplateSelector:!1,showInlineTemplateSelector:!1,loaded_page_list:!0,load_slug_simple_list:!0,showMenu:!1,need_show_qr_and_link:!1,utm_source:null,need_stay_after_save:!0,need_show_global_slug_list:!1,need_page_sticker:!1,need_page_audios:!1,need_page_documents:!1,need_page_video:!1,need_page_images:!1,need_inline_menu:!1,need_reply_menu:!1,need_attach_page:!1,need_attach_dialog:!1,need_attach_slug:!1,need_rules:!1,need_secure_page:!1,need_payed_page:!1,need_cashback_page:!1,bot:null,pageForm:{id:null,content:"",command:null,slug:null,comment:null,password:null,password_description:null,price:null,cashback:null,cashback_config:{need_request_user_data:!1,simple_form:!0,description:null},price_description:null,price_period:1,videos:[],images:[],audios:[],documents:[],sticker:null,reply_keyboard_title:null,reply_keyboard:null,inline_keyboard:null,is_external:!1,need_log_user_action:!1,next_page_id:null,next_bot_dialog_command_id:null,next_bot_menu_slug_id:null,rules_if:null,rules_else_page_id:null,rules_if_message:null,rules_else_message:null}}},watch:{need_cashback_page:function(o,t){this.need_cashback_page||(this.pageForm.cashback=null)},need_payed_page:function(o,t){this.need_payed_page||(this.pageForm.price=null,this.pageForm.price_description=null)},need_secure_page:function(o,t){this.need_secure_page||(this.pageForm.password=null,this.pageForm.password_description=null)},need_page_images:function(o,t){this.need_page_images||(this.photos=[],this.pageForm.images=[])},need_page_audios:function(o,t){this.need_page_audios||(this.pageForm.audios=[])},need_page_documents:function(o,t){this.need_page_documents||(this.pageForm.documents=[])},need_page_sticker:function(o,t){this.need_page_sticker||(this.pageForm.sticker=null)},need_page_video:function(o,t){this.need_page_video||(this.pageForm.videos=[])},need_inline_menu:function(o,t){this.need_inline_menu||(this.pageForm.inline_keyboard=null,this.pageForm.inline_keyboard_id=null)},need_rules:function(o,t){this.need_rules||(this.pageForm.rules_if=null,this.pageForm.rules_else_page_id=null,this.pageForm.rules_if_message=null,this.pageForm.rules_else_message=null)},need_reply_menu:function(o,t){this.need_reply_menu||(this.pageForm.reply_keyboard=null,this.pageForm.reply_keyboard_id=null)},need_attach_page:function(o,t){this.need_attach_page||(this.pageForm.next_page_id=null)},need_attach_dialog:function(o,t){this.need_attach_dialog||(this.pageForm.next_bot_dialog_command_id=null)},need_attach_slug:function(o,t){this.need_attach_slug||(this.pageForm.next_bot_menu_slug_id=null)},pageForm:{handler:function(o){this.pageForm.reply_keyboard!=null&&(this.need_reply_menu=!0),this.pageForm.inline_keyboard!=null&&(this.need_inline_menu=!0),this.pageForm.images.length>0&&(this.need_page_images=!0),this.pageForm.next_bot_dialog_command_id!=null&&(this.need_attach_dialog=!0),this.pageForm.next_bot_menu_slug_id!=null&&(this.need_attach_slug=!0),this.pageForm.next_page_id!=null&&(this.need_attach_page=!0),this.pageForm.rules_if!=null&&(this.need_rules=!0),this.pageForm.videos.length>0&&(this.need_page_video=!0),this.pageForm.audios.length>0&&(this.need_page_audios=!0),this.pageForm.documents.length>0&&(this.need_page_documents=!0),this.pageForm.sticker&&(this.need_page_sticker=!0),this.pageForm.password!=null&&(this.need_secure_page=!0),this.pageForm.price!=null&&(this.need_payed_page=!0),this.pageForm.cashback!=null&&(this.need_cashback_page=!0),this.need_clean=!0},deep:!0}},computed:{...S(["getCurrentBot"]),qr(){return"https://api.qrserver.com/v1/create-qr-code/?size=450x450&qzone=2&data="+this.pageLink},selectedLinkIds(){let o=this.links.map(t=>t.id);return this.page==null?o:this.page.id!=null?[this.page.id,...o]:o},hasParts(){return this.need_page_sticker||this.need_page_audios||this.need_page_documents||this.need_page_video||this.need_page_images||this.need_inline_menu||this.need_reply_menu||this.need_attach_page||this.need_attach_dialog||this.need_attach_slug||this.need_secure_page||this.need_payed_page||this.need_cashback_page||this.need_rules},pageLink(){if(!this.pageForm.id)return"Ссылка недоступна";let o="";for(let t=0;t<10-(""+this.pageForm.id).length;t++)o+="0";return o+=this.pageForm.id,"https://t.me/"+this.getCurrentBot.bot_domain+"?start="+Pe.encode("004"+o+(this.utm_source!=null?"utm"+this.utm_source:""))}},mounted(){[...document.querySelectorAll('[data-bs-toggle="tooltip"]')].map(t=>new bootstrap.Tooltip(t)),this.page?this.preparePageForm(this.page):this.clearForm(),this.loadCurrentBot().then(()=>{this.saveModal=new bootstrap.Modal(document.getElementById("save-modal"),{})}),this.pageModal=new bootstrap.Offcanvas(document.getElementById("offcanvas"),{scroll:!0}),this.fastPageModal=new bootstrap.Modal(document.getElementById("fast-pages-create"),{}),this.pagePreviewModal=new bootstrap.Offcanvas(document.getElementById("page-preview"),{scroll:!0}),window.addEventListener("keydown",t=>{if(t.ctrlKey&&t.keyCode==8&&(t.preventDefault(),this.clearForm()),t.ctrlKey&&t.code=="KeyM"&&(t.preventDefault(),this.fastCreate()),t.ctrlKey&&t.code=="KeyD"&&(t.preventDefault(),this.pagePreviewModal.toggle()),t.ctrlKey&&t.keyCode==32&&(t.preventDefault(),this.pageModal.toggle()),t.ctrlKey&&t.code=="KeyS"){t.preventDefault();const s=document.querySelector("#save-page-btn");s?s.click():this.$notify({title:"Конструктор страниц",text:"Вы еще не начали создавать страницу!",type:"warning"})}t.ctrlKey&&t.keyCode==39&&(t.preventDefault(),this.tab===10?this.tab=0:this.tab++),t.ctrlKey&&t.keyCode==37&&(t.preventDefault(),this.tab===0?this.tab=10:this.tab--)})},methods:{submitReLink(o){this.need_inline_menu=!0,this.tab=1;let t={text:"🔗Поделиться ссылкой",url:`https://t.me/share/url?url=${o.url}&text=${o.text}`};console.log("menu",this.pageForm.inline_keyboard),this.pageForm.inline_keyboard==null?this.pageForm.inline_keyboard={menu:[[{...t}]]}:this.pageForm.inline_keyboard.push([{...t}])},goToBotSettings(){this.$emit("bot-settings")},callbackFastPageCreate(){this.loaded_page_list=!1,this.$nextTick(()=>{this.loaded_page_list=!0}),this.fastPageModal.hide()},fastCreate(){this.fastPageModal.show()},chainCollapseTest(o){return this.page==null?this.links.filter(t=>t.id==o.id).length>1:[this.page,...this.links].filter(t=>t.id==o.id).length>1},loadPageChains(){return this.$store.dispatch("loadPageChains",{dataObject:{start_page_id:this.page.id}}).then(o=>{this.links=o.data})},openSideBarPageList(){const o=document.querySelector("#offcanvas");new bootstrap.Offcanvas(o).show()},renewPassword(){let o="0123456789ABCDEF",t="";for(let s=0;s<10;s++)t+=o[Math.floor(Math.random()*o.length)];this.pageForm.password=t},removeLink(o){this.links.splice(o,1)},loadSlugs(){this.load_slug_simple_list=!1,this.need_show_global_slug_list=!1,this.$nextTick(()=>{this.load_slug_simple_list=!0})},preparePageForm(o){this.need_show_qr_and_link=!1,this.need_show_global_slug_list=!1,this.need_page_sticker=!1,this.need_page_audios=!1,this.need_page_documents=!1,this.need_page_video=!1,this.need_page_images=!1,this.need_inline_menu=!1,this.need_reply_menu=!1,this.need_attach_page=!1,this.need_attach_dialog=!1,this.need_attach_slug=!1,this.need_secure_page=!1,this.need_payed_page=!1,this.need_cashback_page=!1,this.need_rules=!1,this.links=[],this.page=o,this.photos=[],this.$nextTick(()=>{var t;if(this.pageForm.id=o.id,this.pageForm.slug_id=o.slug?o.slug.id:null,this.pageForm.content=o.content,this.pageForm.password=o.password||null,this.pageForm.password_description=o.password_description||null,this.pageForm.price=o.price||null,this.pageForm.cashback=o.cashback||null,o.cashback_config&&(this.pageForm.cashback_config={need_request_user_data:o.cashback_config.need_request_user_data||!1,simple_form:o.cashback_config.simple_form||!0,description:o.cashback_config.description||null}),this.pageForm.price_description=o.price_description||null,this.pageForm.command=o.slug?o.slug.command:null,this.pageForm.slug=o.slug?o.slug.slug:null,this.pageForm.comment=o.slug?o.slug.comment:null,this.pageForm.images=o.images||[],this.pageForm.sticker=o.sticker||null,this.pageForm.reply_keyboard_title=o.reply_keyboard_title||null,this.pageForm.reply_keyboard_id=o.reply_keyboard_id||null,this.pageForm.inline_keyboard_id=o.inline_keyboard_id||null,this.pageForm.reply_keyboard=o.replyKeyboard||null,this.pageForm.reply_keyboard!=null){let s=((t=o.reply_keyboard)==null?void 0:t.settings)||null;s!=null&&(this.pageForm.reply_keyboard_settings={resize_keyboard:s.resize_keyboard||!0,one_time_keyboard:s.one_time_keyboard||!1,input_field_placeholder:s.input_field_placeholder||null,is_persistent:s.is_persistent||!1})}this.pageForm.inline_keyboard=o.inlineKeyboard||null,this.pageForm.next_page_id=o.next_page_id||null,this.pageForm.next_bot_dialog_command_id=o.next_bot_dialog_command_id||null,this.pageForm.next_bot_menu_slug_id=o.next_bot_menu_slug_id||null,this.pageForm.is_external=o.is_external||!1,this.pageForm.need_log_user_action=o.need_log_user_action||!1,this.pageForm.rules_if=o.rules_if||null,this.pageForm.rules_else_page_id=o.rules_else_page_id||null,this.pageForm.audios=o.audios||[],this.pageForm.documents=o.documents||[],this.pageForm.videos=o.videos||[],this.pageForm.rules_if_message=o.rules_if_message||null,this.pageForm.rules_else_message=o.rules_else_message||null,this.pageForm.id!=null&&this.pageForm.next_page_id!=null&&this.loadPageChains()})},copyToClipBoard(o){navigator.clipboard.writeText(o).then(()=>{this.$notify({title:"Копирование",text:"Ссылка скопирована в буфер"})}).catch(t=>{this.$notify({title:"Копирование",text:"Ошибка копирования",type:"error"})})},associateDialog(o){this.pageForm.next_bot_dialog_command_id=o.id},associateSlug(o){this.pageForm.next_bot_menu_slug_id=o.id},loadCurrentBot(o=null){return this.$store.dispatch("updateCurrentBot",{bot:o}).then(()=>{this.bot=this.getCurrentBot})},clearLinks(){this.links=[],this.pageForm.next_page_id=null},attachPage(o){this.links.length==0&&(o.id!=this.pageForm.id?(this.$notify({title:"Конструктор страниц",text:"Вы успешно связали страницы!",type:"success"}),this.pageForm.next_page_id=o.id):this.$notify({title:"Конструктор страниц",text:"Вы не можете связать данную страницу с собой",type:"error"})),(this.page==null?this.links.findIndex(s=>s.id===o.id)!=-1:this.links.findIndex(s=>s.id===o.id)!=-1||o.id===this.page.id)||this.links.push(o)},clearForm(){this.photos=[],this.pageForm={id:null,content:null,command:null,slug:null,comment:null,sticker:null,password:null,password_description:null,price:null,cashback:null,cashback_config:{need_request_user_data:!1,simple_form:!0,description:null},price_description:null,images:[],reply_keyboard:null,inline_keyboard:null,is_external:!1,need_log_user_action:!1,videos:[],audios:[],documents:[],reply_keyboard_title:null,reply_keyboard_id:null,inline_keyboard_id:null,next_page_id:null,next_menu_slug:null,next_bot_dialog_command_id:null,next_bot_menu_slug_id:null,rules_if_message:null,rules_else_message:null},this.photos=[],this.showReplyTemplateSelector=!1,this.showInlineTemplateSelector=!1,this.need_page_images=!1,this.need_page_video=!1,this.need_inline_menu=!1,this.need_reply_menu=!1,this.need_attach_page=!1,this.need_attach_dialog=!1,this.need_attach_slug=!1,this.need_rules=!1,this.need_page_audios=!1,this.need_page_documents=!1,this.need_page_sticker=!1,this.need_payed_page=!1,this.need_cashback_page=!1,this.need_secure_page=!1,this.links=[],this.$nextTick(()=>{this.need_clean=!1})},openSaveModal(){(this.pageForm.comment||"").length===0&&(this.pageForm.comment=this.pageForm.command),this.saveModal.show()},submitPage(){let o=new FormData;if(Object.keys(this.pageForm).forEach(t=>{const s=this.pageForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),this.need_page_create_from_keyboard&&o.append("need_page_create_from_keyboard",this.need_page_create_from_keyboard),this.bot&&o.append("bot_id",this.bot.id),this.photos.length>0)for(let t=0;t<this.photos.length;t++)o.append("photos[]",this.photos[t]);this.$store.dispatch(this.pageForm.id==null?"createPage":"updatePage",{pageForm:o}).then(t=>{this.pageForm.id==null&&this.preparePageForm(t.data),this.links.length>0&&this.$store.dispatch("storePageChains",{dataObject:{start_page_id:t.data.id,links:this.links.map(s=>s.id)}}),this.need_stay_after_save||(this.load=!0,this.$nextTick(()=>{this.load=!1,this.clearForm()})),this.loaded_page_list=!1,this.$nextTick(()=>{this.loaded_page_list=!0}),this.saveModal.hide(),this.$emit("callback",t.data),this.$notify({title:"Конструктор ботов",text:this.pageForm.id==null?"Страница успешно создана!":"Страница успешно обновлена!",type:"success"}),this.$store.dispatch("loadPages",{dataObject:{botId:this.bot.id,needNewFirst:!0},page:localStorage.getItem(`cashman_pagelist_${this.bot.id}_page_index`)||0})}).catch(t=>{})},saveInlineKeyboard(o){this.pageForm.inline_keyboard=o},saveSettings(o){console.log("settings save",o),this.pageForm.reply_keyboard_settings={resize_keyboard:o.resize_keyboard||!0,one_time_keyboard:o.one_time_keyboard||!1,input_field_placeholder:o.input_field_placeholder||null,is_persistent:o.is_persistent||!1}},selectReplyKeyboard(o){this.pageForm.reply_keyboard=o,this.showReplyTemplateSelector=!1},selectInlineKeyboard(o){this.pageForm.inline_keyboard=o,this.showInlineTemplateSelector=!1},getPhoto(o){return{imageUrl:URL.createObjectURL(o)}},removePhoto(o){this.photos.splice(o,1)},removeImage(o){this.pageForm.images.splice(o,1)},onChangePhotos(o){const t=o.target.files;for(let s=0;s<t.length;s++)this.photos.push(t[s])},onChange(o){this.pageForm.content=o},selectPhoto(o){this.pageForm.images||(this.pageForm.images=[]);let t=this.pageForm.images.indexOf(o.file_id);t!==-1?this.pageForm.images.splice(t,1):this.pageForm.images.push(o.file_id)},selectSticker(o){this.pageForm.sticker=o.file_id},selectVideo(o){this.pageForm.videos||(this.pageForm.videos=[]);let t=this.pageForm.videos.indexOf(o.file_id);t!==-1?this.pageForm.videos.splice(t,1):this.pageForm.videos.push(o.file_id)},selectAudio(o){this.pageForm.audios||(this.pageForm.audios=[]);let t=this.pageForm.audios.indexOf(o.file_id);if(o.type==="voice"){if(t!==-1){this.pageForm.audios.splice(t,1);return}this.pageForm.audios=[o.file_id];return}t!==-1?this.pageForm.audios.splice(t,1):this.pageForm.audios.push(o.file_id)},selectDocument(o){this.pageForm.documents||(this.pageForm.documents=[]);let t=this.pageForm.documents.indexOf(o.file_id);t!==-1?this.pageForm.documents.splice(t,1):this.pageForm.documents.push(o.file_id)},pageListCallback(o){this.$notify("Вы выбрали страницу из списка! Все остальные действия будут производится для этой страницы"),this.load=!0,this.preparePageForm(o),this.$nextTick(()=>{this.load=!1})}}},j2=Object.assign(S2,{__name:"Page",setup(o){return(t,s)=>{const d=z("Popper"),n=Q("lazy");return l(),i(f,null,[t.pageForm.id?(l(),i("div",_p,[e("div",pp,[e("div",bp,[fp,m(" Вы в режиме редактирования страницы (кнопки) "),e("strong",gp,u(t.page.slug?t.page.slug.command:"Без названия"),1),m(", если хотите создать новую нажмите "),e("a",{href:"javascript:void(0)",class:"btn btn-primary ml-2",onClick:s[0]||(s[0]=(...a)=>t.clearForm&&t.clearForm(...a))},"Создать новую страницу")])])])):r("",!0),t.bot?(l(),i("form",{key:1,id:"page-construct",class:"py-3",onSubmit:s[70]||(s[70]=C((...a)=>t.openSaveModal&&t.openSaveModal(...a),["prevent"]))},[t.hasParts?(l(),i("div",vp,[e("div",yp,[$p,e("ul",kp,[e("li",{class:g(["mr-1",{active:t.need_page_images}]),title:"Изображения"},wp,2),e("li",{class:g(["mr-1",{active:t.need_page_sticker}]),title:"Стикеры"},Sp,2),e("li",{class:g(["mr-1",{active:t.need_page_video}]),title:"Видео"},Vp,2),e("li",{class:g(["mr-1",{active:t.need_page_audios}]),title:"Аудио"},zp,2),e("li",{class:g(["mr-1",{active:t.need_page_documents}]),title:"Документы"},Up,2),e("li",{class:g(["mr-1",{active:t.need_attach_page}]),title:"Страницы"},Ap,2),e("li",{class:g(["mr-1",{active:t.need_attach_slug}]),title:"Скрипты"},Qp,2),e("li",{class:g(["mr-1",{active:t.need_attach_dialog}]),title:"Диалоги"},Mp,2),e("li",{class:g(["mr-1",{active:t.need_rules}]),title:"Правила"},Rp,2),e("li",{class:g(["mr-1",{active:t.need_reply_menu}]),title:"Нижнее меню"},Ep,2),e("li",{title:"Текстовое меню",class:g({active:t.need_inline_menu})},Kp,2)])])])):r("",!0),e("div",Np,[e("div",Jp,[e("div",Hp,[e("div",Yp,[c(e("input",{type:"text",class:"form-control",placeholder:"Команда","aria-label":"Команда","onUpdate:modelValue":s[1]||(s[1]=a=>t.pageForm.command=a),maxlength:"255","aria-describedby":"bot-domain",required:""},null,512),[[_,t.pageForm.command]]),e("label",Gp,[Wp,m(" Название страницы "),(t.pageForm.command||"").length>0?(l(),i("span",Xp,u(t.pageForm.command.length)+"/255",1)):r("",!0)])]),Zp])]),e("div",xp,[e("div",eb,[e("button",{type:"button",title:"Быстрое создание страниц",onClick:s[2]||(s[2]=(...a)=>t.fastCreate&&t.fastCreate(...a)),"data-bs-toggle":"tooltip","data-bs-title":"Быстрое создание страниц",class:"btn btn-outline-primary min-menu-btn"},sb),c(e("button",ob,ib,512),[[V,t.pageForm.id||t.need_clean]]),c(e("button",{type:"button",onClick:s[3]||(s[3]=(...a)=>t.clearForm&&t.clearForm(...a)),title:"Очистить \\ Новая страница","data-bs-toggle":"tooltip","data-bs-title":"Очистить \\ Новая страница",class:"btn btn-outline-primary min-menu-btn"},ab,512),[[V,t.pageForm.id||t.need_clean]]),e("button",{type:"button",title:"Список страниц","data-bs-toggle":"tooltip","data-bs-title":"Список страниц",onClick:s[4]||(s[4]=(...a)=>t.openSideBarPageList&&t.openSideBarPageList(...a)),class:"btn btn-outline-primary min-menu-btn"},rb)])])]),c(e("div",cb,[e("div",ub,[e("div",mb,[hb,b(uh,{modelValue:t.pageForm.content,"onUpdate:modelValue":s[5]||(s[5]=a=>t.pageForm.content=a),onSubmitRelink:t.submitReLink,"field-id":"#main-text-field"},null,8,["modelValue","onSubmitRelink"])]),e("div",_b,[c(e("textarea",{class:"form-control","onUpdate:modelValue":s[6]||(s[6]=a=>t.pageForm.content=a),maxlength:"4096",placeholder:"Введите текст",id:"main-text-field",style:{"min-height":"150px"}},null,512),[[_,t.pageForm.content]]),e("label",pb,[m("Текст "),t.pageForm.content?(l(),i("span",bb,u(t.pageForm.content.length)+"/4096 ",1)):r("",!0)])])]),e("div",fb,[e("ul",gb,[e("li",{class:"nav-item",onClick:s[7]||(s[7]=a=>t.tab=0)},[e("a",{class:g([{active:t.tab===0,"primary-mark":t.need_reply_menu},"nav-link d-flex flex-column justify-content-center align-items-center font-12"]),href:"javascript:void(0)"},$b,2)]),e("li",{class:"nav-item",onClick:s[8]||(s[8]=a=>t.tab=1)},[e("a",{class:g([{active:t.tab===1,"primary-mark":t.need_inline_menu},"nav-link d-flex flex-column justify-content-center align-items-center font-12"]),href:"javascript:void(0)"},wb,2)]),e("li",{class:"nav-item",onClick:s[9]||(s[9]=a=>t.tab=2)},[e("a",{class:g([{active:t.tab===2,"primary-mark":t.need_page_images},"nav-link d-flex flex-column justify-content-center align-items-center font-12"]),href:"javascript:void(0)"},jb,2)]),e("li",{class:"nav-item",onClick:s[10]||(s[10]=a=>t.tab=3)},[e("a",{class:g([{active:t.tab===3,"primary-mark":t.need_page_video},"nav-link d-flex flex-column justify-content-center align-items-center font-12"]),href:"javascript:void(0)"},zb,2)]),e("li",{class:"nav-item",onClick:s[11]||(s[11]=a=>t.tab=5)},[e("a",{class:g([{active:t.tab===5,"primary-mark":t.need_page_audios},"nav-link d-flex flex-column justify-content-center align-items-center font-12"]),href:"javascript:void(0)"},Ob,2)]),e("li",{class:"nav-item",onClick:s[12]||(s[12]=a=>t.tab=6)},[e("a",{class:g([{active:t.tab===6,"primary-mark":t.need_page_documents},"nav-link d-flex flex-column justify-content-center align-items-center font-12"]),href:"javascript:void(0)"},Qb,2)]),e("li",{class:"nav-item",onClick:s[13]||(s[13]=a=>t.tab=7)},[e("a",{class:g([{active:t.tab===7,"primary-mark":t.need_attach_page},"nav-link d-flex flex-column justify-content-center align-items-center font-12"]),href:"javascript:void(0)"},Db,2)]),e("li",{class:"nav-item",onClick:s[14]||(s[14]=a=>t.tab=8)},[e("a",{class:g([{active:t.tab===8,"primary-mark":t.need_attach_slug},"nav-link d-flex flex-column justify-content-center align-items-center font-12"]),href:"javascript:void(0)"},Eb,2)]),e("li",{class:"nav-item",onClick:s[15]||(s[15]=a=>t.tab=9)},[e("a",{class:g([{active:t.tab===9,"primary-mark":t.need_attach_dialog},"nav-link d-flex flex-column justify-content-center align-items-center font-12"]),href:"javascript:void(0)"},Nb,2)]),e("li",Jb,[e("div",Hb,[Yb,e("ul",Gb,[e("li",{onClick:s[16]||(s[16]=a=>t.tab=10)},[e("a",{class:g(["dropdown-item",{active:t.tab===10,"primary-mark":t.need_rules}]),href:"javascript:void(0)"},[Wb,m(" Правила на странице")],2)]),e("li",{onClick:s[17]||(s[17]=a=>t.tab=11)},[e("a",{class:g(["dropdown-item",{active:t.tab===11,"primary-mark":t.need_secure_page}]),href:"javascript:void(0)"},[Xb,m(" Безопасная страница")],2)]),e("li",{onClick:s[18]||(s[18]=a=>t.tab=12)},[e("a",{class:g(["dropdown-item",{active:t.tab===12,"primary-mark":t.need_payed_page}]),href:"javascript:void(0)"},[Zb,m(" Платная страница")],2)]),e("li",{onClick:s[19]||(s[19]=a=>t.tab=13)},[e("a",{class:g(["dropdown-item",{active:t.tab===13,"primary-mark":t.need_cashback_page}]),href:"javascript:void(0)"},[xb,m(" Начислить бонусы")],2)]),e("li",{onClick:s[20]||(s[20]=a=>t.tab=4)},[e("a",{class:g(["dropdown-item",{active:t.tab===4,"primary-mark":t.need_page_sticker}]),href:"javascript:void(0)"},[ef,m(" Стикеры")],2)])])])])])]),c(e("div",null,[t.need_reply_menu?(l(),i("div",tf,[e("div",sf,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[21]||(s[21]=a=>t.need_reply_menu=a),type:"checkbox",id:"need-reply-menu"},null,512),[[k,t.need_reply_menu]]),of])])):r("",!0),t.need_reply_menu?(l(),i("div",lf,[e("div",nf,[e("div",af,[df,e("button",{class:g(["btn",{"btn-outline-primary":!t.showReplyTemplateSelector,"btn-primary":t.showReplyTemplateSelector}]),type:"button",onClick:s[22]||(s[22]=a=>t.showReplyTemplateSelector=!t.showReplyTemplateSelector)},[t.showReplyTemplateSelector?(l(),i("span",cf," Скрыть шаблоны меню")):(l(),i("span",rf," Открыть шаблоны меню"))],2)]),e("div",uf,[e("div",mf,[e("div",hf,[e("label",_f,[b(d,null,{content:v(()=>[bf]),default:v(()=>[pf]),_:1}),m(" Заголовок ")]),c(e("input",{type:"text",class:"form-control",placeholder:"Заголовок меню","aria-label":"Заголовок меню","onUpdate:modelValue":s[23]||(s[23]=a=>t.pageForm.reply_keyboard_title=a),maxlength:"255","aria-describedby":"bot-domain"},null,512),[[_,t.pageForm.reply_keyboard_title]])])]),t.showReplyTemplateSelector?(l(),y(R,{key:0,class:"mb-2",type:"reply",onSelect:t.selectReplyKeyboard,"select-mode":!0},null,8,["onSelect"])):(l(),y(A,{key:1,type:"reply",modelValue:t.pageForm.reply_keyboard,"onUpdate:modelValue":s[24]||(s[24]=a=>t.pageForm.reply_keyboard=a)},null,8,["modelValue"])),e("div",ff,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[25]||(s[25]=a=>t.need_page_create_from_keyboard=a),type:"checkbox",role:"switch",id:"need-page-create-from-keyboard"},null,512),[[k,t.need_page_create_from_keyboard]]),gf])])])])):(l(),i("div",vf,[e("div",yf,[e("div",$f,[c(e("img",kf,null,512),[[n,"../images/icon.png"]])]),Ff,wf,e("div",Cf,[e("button",{disabled:t.need_reply_menu,onClick:s[26]||(s[26]=a=>t.need_reply_menu=!0),class:g([{"btn-primary":!t.need_reply_menu,"btn-outline-secondary":t.need_reply_menu},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,Sf),jf])])]))],512),[[V,t.tab===0]]),c(e("div",null,[t.need_inline_menu?(l(),i("div",Vf,[e("div",qf,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[27]||(s[27]=a=>t.need_inline_menu=a),type:"checkbox",id:"need-inline-menu"},null,512),[[k,t.need_inline_menu]]),zf])])):r("",!0),t.need_inline_menu?(l(),i("div",Pf,[e("div",Uf,[e("div",Of,[Af,e("button",{class:g(["btn",{"btn-outline-primary":!t.showInlineTemplateSelector,"btn-primary":t.showInlineTemplateSelector}]),type:"button",onClick:s[28]||(s[28]=a=>t.showInlineTemplateSelector=!t.showInlineTemplateSelector)},[t.showInlineTemplateSelector?(l(),i("span",Qf," Скрыть шаблоны меню")):(l(),i("span",If," Открыть шаблоны меню"))],2)]),e("div",Tf,[t.showInlineTemplateSelector?(l(),y(R,{key:0,class:"mb-2",type:"inline",onSelect:t.selectInlineKeyboard,"select-mode":!0},null,8,["onSelect"])):(l(),y(A,{key:1,type:"inline",modelValue:t.pageForm.inline_keyboard,"onUpdate:modelValue":s[29]||(s[29]=a=>t.pageForm.inline_keyboard=a)},null,8,["modelValue"]))])])])):(l(),i("div",Mf,[e("div",Df,[e("div",Rf,[c(e("img",Bf,null,512),[[n,"../images/icon.png"]])]),Ef,Lf,e("div",Kf,[e("button",{disabled:t.need_inline_menu,onClick:s[30]||(s[30]=a=>t.need_inline_menu=!0),class:g([{"btn-primary":!t.need_inline_menu,"btn-outline-secondary":t.need_inline_menu},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,Nf),Jf])])]))],512),[[V,t.tab===1]]),c(e("div",null,[t.need_page_images?(l(),i("div",Hf,[e("div",Yf,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[31]||(s[31]=a=>t.need_page_images=a),type:"checkbox",id:"need-page-images"},null,512),[[k,t.need_page_images]]),Gf])])):r("",!0),t.need_page_images?(l(),i("div",Wf,[e("div",Xf,[Zf,e("div",xf,[e("label",e1,[m(" + "),e("input",{type:"file",id:"photos",multiple:"",accept:"image/*",onChange:s[32]||(s[32]=(...a)=>t.onChangePhotos&&t.onChangePhotos(...a)),style:{display:"none"}},null,32)]),e("div",t1,[t.photos.length>0?(l(),i("div",s1,[(l(!0),i(f,null,$(t.photos,(a,h)=>(l(),i("div",o1,[c(e("img",null,null,512),[[n,t.getPhoto(a).imageUrl]]),e("div",l1,[e("a",{onClick:p=>t.removePhoto(h)},"Удалить",8,i1)])]))),256))])):r("",!0),t.pageForm.images.length>0?(l(),i("h6",n1,"Ранее загруженные фотографии")):r("",!0),t.pageForm.images.length>0?(l(),i("div",a1,[(l(!0),i(f,null,$(t.pageForm.images,(a,h)=>(l(),i("div",d1,[c(e("img",null,null,512),[[n,"/images-by-bot-id/"+t.bot.id+"/"+a]]),e("div",r1,[e("a",{onClick:p=>t.removeImage(h)},"Удалить",8,c1)])]))),256))])):r("",!0)])])])])):(l(),i("div",u1,[e("div",m1,[e("div",h1,[c(e("img",_1,null,512),[[n,"../images/icon.png"]])]),p1,b1,e("div",f1,[e("button",{disabled:t.need_page_images,onClick:s[33]||(s[33]=a=>t.need_page_images=!0),class:g([{"btn-primary":!t.need_page_images,"btn-outline-secondary":t.need_page_images},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,g1),v1])])]))],512),[[V,t.tab===2]]),c(e("div",null,[t.need_page_video?(l(),i("div",y1,[e("div",$1,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[34]||(s[34]=a=>t.need_page_video=a),type:"checkbox",id:"need-page-video"},null,512),[[k,t.need_page_video]]),k1])])):r("",!0),t.need_page_video?(l(),i("div",F1,[b(P,{"need-video":!0,"need-video-note":!0,selected:t.pageForm.videos,onSelect:t.selectVideo},null,8,["selected","onSelect"])])):(l(),i("div",w1,[e("div",C1,[e("div",S1,[c(e("img",j1,null,512),[[n,"../images/icon.png"]])]),V1,q1,e("div",z1,[e("button",{disabled:t.need_page_video,onClick:s[35]||(s[35]=a=>t.need_page_video=!0),class:g([{"btn-primary":!t.need_page_video,"btn-outline-secondary":t.need_page_video},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,P1),U1])])]))],512),[[V,t.tab===3]]),c(e("div",null,[t.need_page_sticker?(l(),i("div",O1,[e("div",A1,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[36]||(s[36]=a=>t.need_page_sticker=a),type:"checkbox",id:"need-page-sticker"},null,512),[[k,t.need_page_sticker]]),I1])])):r("",!0),t.need_page_sticker?(l(),i("div",Q1,[b(P,{"need-sticker":!0,selected:[t.pageForm.sticker],onSelect:t.selectSticker},null,8,["selected","onSelect"])])):(l(),i("div",T1,[e("div",M1,[e("div",D1,[c(e("img",R1,null,512),[[n,"../images/icon.png"]])]),B1,E1,e("div",L1,[e("button",{disabled:t.need_page_sticker,onClick:s[37]||(s[37]=a=>t.need_page_sticker=!0),class:g([{"btn-primary":!t.need_page_sticker,"btn-outline-secondary":t.need_page_sticker},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,K1),N1])])]))],512),[[V,t.tab===4]]),c(e("div",null,[t.need_page_audios?(l(),i("div",J1,[e("div",H1,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[38]||(s[38]=a=>t.need_page_audios=a),type:"checkbox",id:"need-page-audio"},null,512),[[k,t.need_page_audios]]),Y1])])):r("",!0),t.need_page_audios?(l(),i("div",G1,[b(P,{"need-audio":!0,selected:t.pageForm.audios,onSelect:t.selectAudio},null,8,["selected","onSelect"])])):(l(),i("div",W1,[e("div",X1,[e("div",Z1,[c(e("img",x1,null,512),[[n,"../images/icon.png"]])]),eg,tg,e("div",sg,[e("button",{disabled:t.need_page_audios,onClick:s[39]||(s[39]=a=>t.need_page_audios=!0),class:g([{"btn-primary":!t.need_page_audios,"btn-outline-secondary":t.need_page_audios},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,og),lg])])]))],512),[[V,t.tab===5]]),c(e("div",null,[t.need_page_documents?(l(),i("div",ig,[e("div",ng,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[40]||(s[40]=a=>t.need_page_documents=a),type:"checkbox",id:"need-page-document"},null,512),[[k,t.need_page_documents]]),ag])])):r("",!0),t.need_page_documents?(l(),i("div",dg,[b(P,{"need-document":!0,selected:t.pageForm.documents,onSelect:t.selectDocument},null,8,["selected","onSelect"])])):(l(),i("div",rg,[e("div",cg,[e("div",ug,[c(e("img",mg,null,512),[[n,"../images/icon.png"]])]),hg,_g,e("div",pg,[e("button",{disabled:t.need_page_documents,onClick:s[41]||(s[41]=a=>t.need_page_documents=!0),class:g([{"btn-primary":!t.need_page_documents,"btn-outline-secondary":t.need_page_documents},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,bg),fg])])]))],512),[[V,t.tab===6]]),c(e("div",null,[e("div",gg,[e("div",vg,[e("div",yg,[c(e("img",$g,null,512),[[n,"../images/icon.png"]])]),kg,Fg,t.pageForm.next_page_id?(l(),i("p",wg,"Связано со страницей #"+u(t.pageForm.next_page_id),1)):r("",!0),e("div",Cg,[t.pageForm.next_page_id?(l(),i("button",{key:0,class:"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill btn-danger",type:"button",onClick:s[42]||(s[42]=(...a)=>t.clearLinks&&t.clearLinks(...a))},"Очистить ")):(l(),i("button",Sg," Связать ")),jg]),Vg,e("div",qg,[zg,Pg,(l(!0),i(f,null,$(t.links,(a,h)=>(l(),i("div",Ug,[e("button",{type:"button",onClick:p=>t.removeLink(h),class:g([{"btn-danger":t.chainCollapseTest(a)},"btn btn-primary position-relative rounded-5"])},[m(u(a.slug.command||"-")+" ",1),e("span",Ag," #"+u(a.id),1)],10,Og),h<t.links.length-1?(l(),i("i",Ig)):r("",!0)]))),256)),t.links.length>0?(l(),i("i",Qg)):r("",!0),Tg])])])],512),[[V,t.tab===7]]),c(e("div",null,[t.need_attach_slug?(l(),i("div",Mg,[Dg,e("div",Rg,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[43]||(s[43]=a=>t.need_show_global_slug_list=a),type:"checkbox",id:"need-show-global-slug-list"},null,512),[[k,t.need_show_global_slug_list]]),Bg]),t.bot&&t.need_show_global_slug_list?(l(),y(x,{key:0,"can-add":!0,bot:t.bot,onCallback:t.loadSlugs},null,8,["bot","onCallback"])):r("",!0)])):r("",!0),t.need_attach_slug?(l(),i("div",Eg,[e("div",Lg,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[44]||(s[44]=a=>t.need_attach_slug=a),type:"checkbox",id:"need-slug-attach"},null,512),[[k,t.need_attach_slug]]),Kg])])):r("",!0),t.need_attach_slug?(l(),i("div",Ng,[t.pageForm.next_bot_menu_slug_id?(l(),i("div",Jg,[m(" Связано со скриптом #"+u(t.pageForm.next_bot_menu_slug_id)+" ",1),e("a",{class:"btn btn-link text-danger",onClick:s[45]||(s[45]=a=>t.pageForm.next_bot_menu_slug_id=null)},"Очистить")])):r("",!0),t.bot&&t.load_slug_simple_list?(l(),y(Jl,{key:1,global:!0,"can-select":!0,selected:[t.pageForm.next_bot_menu_slug_id],onCallback:t.associateSlug,bot:t.bot},null,8,["selected","onCallback","bot"])):r("",!0)])):(l(),i("div",Hg,[e("div",Yg,[e("div",Gg,[c(e("img",Wg,null,512),[[n,"../images/icon.png"]])]),Xg,Zg,e("div",xg,[e("button",{disabled:t.need_attach_slug,onClick:s[46]||(s[46]=a=>t.need_attach_slug=!0),class:g([{"btn-primary":!t.need_attach_slug,"btn-outline-secondary":t.need_attach_slug},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,ev),tv])])]))],512),[[V,t.tab===8]]),c(e("div",null,[t.need_attach_dialog?(l(),i("div",sv,[e("div",ov,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[47]||(s[47]=a=>t.need_attach_dialog=a),type:"checkbox",id:"need-dialog-attach"},null,512),[[k,t.need_attach_dialog]]),lv])])):r("",!0),t.need_attach_dialog?(l(),i("div",iv,[t.pageForm.next_bot_dialog_command_id?(l(),i("p",nv,[m("Связано с диалогом #"+u(t.pageForm.next_bot_dialog_command_id)+" ",1),e("a",{class:"btn btn-link",onClick:s[48]||(s[48]=a=>t.pageForm.next_bot_dialog_command_id=null)},"Очистить")])):r("",!0),t.bot?(l(),y(pe,{key:1,onSelectDialog:t.associateDialog,bot:t.bot},null,8,["onSelectDialog","bot"])):r("",!0)])):(l(),i("div",av,[e("div",dv,[e("div",rv,[c(e("img",cv,null,512),[[n,"../images/icon.png"]])]),uv,mv,e("div",hv,[e("button",{disabled:t.need_attach_dialog,onClick:s[49]||(s[49]=a=>t.need_attach_dialog=!0),class:g([{"btn-primary":!t.need_attach_dialog,"btn-outline-secondary":t.need_attach_dialog},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,_v),pv])])]))],512),[[V,t.tab===9]]),c(e("div",null,[t.need_rules?(l(),i("div",bv,[e("div",fv,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[50]||(s[50]=a=>t.need_rules=a),type:"checkbox",id:"need-rules"},null,512),[[k,t.need_rules]]),gv])])):r("",!0),t.need_rules?(l(),i("div",vv,[b(I_,{bot:t.bot,"rules-form":t.pageForm},null,8,["bot","rules-form"])])):(l(),i("div",yv,[e("div",$v,[e("div",kv,[c(e("img",Fv,null,512),[[n,"../images/icon.png"]])]),wv,Cv,e("div",Sv,[e("button",{disabled:t.need_rules,onClick:s[51]||(s[51]=a=>t.need_rules=!0),class:g([{"btn-primary":!t.need_rules,"btn-outline-secondary":t.need_rules},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,jv),Vv])])]))],512),[[V,t.tab===10]]),c(e("div",null,[t.need_secure_page?(l(),i("div",qv,[e("div",zv,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[52]||(s[52]=a=>t.need_secure_page=a),type:"checkbox",id:"need-secure-page"},null,512),[[k,t.need_secure_page]]),Pv])])):r("",!0),t.need_secure_page?(l(),i("div",Uv,[e("div",Ov,[e("div",Av,[c(e("input",{type:"text","onUpdate:modelValue":s[53]||(s[53]=a=>t.pageForm.password=a),class:"form-control",id:"floatingPassword",placeholder:"Пароль",required:""},null,512),[[_,t.pageForm.password]]),Iv]),e("span",Qv,[e("a",{href:"javascript:void(0)",onClick:s[54]||(s[54]=(...a)=>t.renewPassword&&t.renewPassword(...a))},Mv)])]),e("div",Dv,[c(e("textarea",{class:"form-control","onUpdate:modelValue":s[55]||(s[55]=a=>t.pageForm.password_description=a),placeholder:"Пояснение",id:"floatingTextarea2",style:{height:"200px"}},null,512),[[_,t.pageForm.password_description]]),e("label",Rv,[m(" Пояснение для пользователя "),(t.pageForm.password_description||"").length>0?(l(),i("span",Bv,u(t.pageForm.password_description.length)+"/512",1)):r("",!0)])])])):(l(),i("div",Ev,[e("div",Lv,[e("div",Kv,[c(e("img",Nv,null,512),[[n,"../images/icon.png"]])]),Jv,Hv,e("div",Yv,[e("button",{disabled:t.need_secure_page,onClick:s[56]||(s[56]=a=>t.need_secure_page=!0),class:g([{"btn-primary":!t.need_secure_page,"btn-outline-secondary":t.need_secure_page},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,Gv),Wv])])]))],512),[[V,t.tab===11]]),c(e("div",null,[t.need_payed_page?(l(),i("div",Xv,[e("div",Zv,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[57]||(s[57]=a=>t.need_payed_page=a),type:"checkbox",id:"need-payed-page"},null,512),[[k,t.need_payed_page]]),xv])])):r("",!0),t.need_payed_page?(l(),i("div",ey,[t.bot.payment_provider_token==null?(l(),i("div",ty,[m("Вы не добавили тоукен платежной системы в "),e("span",{onClick:s[58]||(s[58]=(...a)=>t.goToBotSettings&&t.goToBotSettings(...a)),class:"cursor-pointer text-primary fw-bold text-decoration-underline"},"настройках бота!")])):r("",!0),e("div",sy,[e("div",oy,[e("div",ly,[c(e("input",{type:"number",min:"100",disabled:t.bot.payment_provider_token==null,"onUpdate:modelValue":s[59]||(s[59]=a=>t.pageForm.price=a),class:"form-control",id:"page-price",placeholder:"Цена",required:""},null,8,iy),[[_,t.pageForm.price]]),ny])]),e("div",ay,[e("div",dy,[c(e("input",{type:"number",min:"1",disabled:t.bot.payment_provider_token==null,"onUpdate:modelValue":s[60]||(s[60]=a=>t.pageForm.price_period=a),class:"form-control",id:"page-price-period",placeholder:"Период",required:""},null,8,ry),[[_,t.pageForm.price_period]]),cy])])]),e("div",uy,[c(e("textarea",{class:"form-control",disabled:t.bot.payment_provider_token==null,"onUpdate:modelValue":s[61]||(s[61]=a=>t.pageForm.price_description=a),placeholder:"Пояснение",id:"floatingTextarea2",style:{height:"200px"}},null,8,my),[[_,t.pageForm.price_description]]),e("label",hy,[m(" Пояснение для пользователя "),(t.pageForm.price_description||"").length>0?(l(),i("span",_y,u(t.pageForm.price_description.length)+"/512",1)):r("",!0)])])])):(l(),i("div",py,[e("div",by,[e("div",fy,[c(e("img",gy,null,512),[[n,"../images/icon.png"]])]),vy,yy,e("div",$y,[e("button",{disabled:t.need_payed_page,onClick:s[62]||(s[62]=a=>t.need_payed_page=!0),class:g([{"btn-primary":!t.need_payed_page,"btn-outline-secondary":t.need_payed_page},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,ky),Fy])])]))],512),[[V,t.tab===12]]),c(e("div",null,[e("div",wy,[e("div",Cy,[e("div",Sy,[c(e("img",jy,null,512),[[n,"../images/icon.png"]])]),Vy,qy,t.need_cashback_page?(l(),i(f,{key:0},[e("div",zy,[e("div",Py,[e("div",Uy,[c(e("input",{type:"number",min:"0","onUpdate:modelValue":s[63]||(s[63]=a=>t.pageForm.cashback=a),class:"form-control w-100",id:"page-price",placeholder:"Бонусы",required:""},null,512),[[_,t.pageForm.cashback]]),Oy])])]),e("div",Ay,[e("div",Iy,[Qy,e("div",Ty,[e("button",{onClick:s[64]||(s[64]=a=>t.pageForm.cashback_config.need_request_user_data=!t.pageForm.cashback_config.need_request_user_data),class:g([{"btn-primary":t.pageForm.cashback_config.need_request_user_data,"btn-outline-primary":!t.pageForm.cashback_config.need_request_user_data},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill mr-2"]),type:"button"}," Да ",2),e("button",{onClick:s[65]||(s[65]=a=>t.pageForm.cashback_config.need_request_user_data=!t.pageForm.cashback_config.need_request_user_data),class:g([{"btn-primary":!t.pageForm.cashback_config.need_request_user_data,"btn-outline-primary":t.pageForm.cashback_config.need_request_user_data},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Нет ",2)])])]),t.pageForm.cashback_config.need_request_user_data?(l(),i("div",My,[e("div",Dy,[Ry,By,e("div",Ey,[e("button",{onClick:s[66]||(s[66]=a=>t.pageForm.cashback_config.simple_form=!t.pageForm.cashback_config.simple_form),class:g([{"btn-primary":t.pageForm.cashback_config.simple_form,"btn-outline-primary":!t.pageForm.cashback_config.simple_form},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill mr-2"]),type:"button"}," Да ",2),e("button",{onClick:s[67]||(s[67]=a=>t.pageForm.cashback_config.simple_form=!t.pageForm.cashback_config.simple_form),class:g([{"btn-primary":!t.pageForm.cashback_config.simple_form,"btn-outline-primary":t.pageForm.cashback_config.simple_form},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Нет ",2)])]),e("div",Ly,[e("div",Ky,[c(e("textarea",{class:"form-control",maxlength:"255","onUpdate:modelValue":s[68]||(s[68]=a=>t.pageForm.cashback_config.description=a),placeholder:"Leave a comment here",id:"floatingTextarea2",style:{height:"100px"}},null,512),[[_,t.pageForm.cashback_config.description]]),e("label",Ny,[m(" Пояснение для пользователя "),(t.pageForm.cashback_config.description||"").length>0?(l(),i("span",Jy,u(t.pageForm.cashback_config.description.length)+" / 255",1)):r("",!0)])])])])):r("",!0)],64)):r("",!0),e("div",Hy,[e("button",{onClick:s[69]||(s[69]=a=>t.need_cashback_page=!t.need_cashback_page),class:g([{"btn-primary":!t.need_cashback_page,"btn-danger":t.need_cashback_page},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"},[t.need_cashback_page?r("",!0):(l(),i("span",Yy,"Добавить")),t.need_cashback_page?(l(),i("span",Gy,"Убрать")):r("",!0)],2),Wy])])])],512),[[V,t.tab===13]])],512),[[V,!t.pageForm.is_external]])],32)):r("",!0),e("div",Xy,[e("div",Zy,[e("div",xy,[e$,e("ul",t$,[e("li",{class:"underline cursor-pointer",onClick:s[71]||(s[71]=(...a)=>t.fastCreate&&t.fastCreate(...a))},[s$,m(" - быстрое создание страниц! ")]),o$])])])]),e("div",l$,[e("div",i$,[e("div",n$,[a$,e("div",d$,[b(hp,{onCallback:t.callbackFastPageCreate},null,8,["onCallback"])]),r$])])]),e("div",c$,[e("div",u$,[e("div",m$,[h$,e("div",_$,[t.bot?(l(),i("div",p$,[e("div",b$,[e("h6",f$,[e("span",null,[m("Вы создаете страницу для "),e("a",{href:"https://t.me/"+t.bot.bot_domain,target:"_blank"},u(t.bot.bot_domain),9,g$)])])])])):r("",!0),e("form",{onSubmit:s[78]||(s[78]=C((...a)=>t.submitPage&&t.submitPage(...a),["prevent"])),class:"row"},[e("div",v$,[y$,e("ul",$$,[e("li",{class:g({active:t.need_page_images})},F$,2),e("li",{class:g({active:t.need_page_sticker})},C$,2),e("li",{class:g({active:t.need_page_video})},j$,2),e("li",{class:g({active:t.need_page_audios})},q$,2),e("li",{class:g({active:t.need_page_documents})},P$,2),e("li",{class:g({active:t.need_attach_page})},O$,2),e("li",{class:g({active:t.need_attach_slug})},I$,2),e("li",{class:g({active:t.need_attach_dialog})},T$,2),e("li",{class:g({active:t.need_rules})},D$,2),e("li",{class:g({active:t.need_reply_menu})},B$,2),e("li",{class:g({active:t.need_inline_menu})},L$,2)])]),t.pageForm.id?(l(),i("div",K$,[e("div",N$,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[72]||(s[72]=a=>t.need_show_qr_and_link=a),type:"checkbox",id:"need-show-qr-and-link"},null,512),[[k,t.need_show_qr_and_link]]),J$])])):r("",!0),t.pageForm.id&&t.need_show_qr_and_link?(l(),i("div",H$,[e("p",Y$,[m("Ссылка на текущую страницу: "),e("span",{style:{"word-wrap":"break-word"},class:"bg-secondary text-white font-bold cursor-pointer",onClick:s[73]||(s[73]=a=>t.copyToClipBoard(t.pageLink))},u(t.pageLink),1)]),G$,e("div",W$,[c(e("input",{type:"text",maxlength:"100","onUpdate:modelValue":s[74]||(s[74]=a=>t.utm_source=a),class:"form-control",id:"utm-source",placeholder:"name@example.com"},null,512),[[_,t.utm_source]]),X$]),e("div",Z$,[c(e("img",x$,null,512),[[n,t.qr]])])])):r("",!0),e("div",e2,[e("label",t2,[b(d,null,{content:v(()=>[o2]),default:v(()=>[s2]),_:1}),m(" Описание страницы "),l2]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Описание страницы","aria-label":"Описание страницы","onUpdate:modelValue":s[75]||(s[75]=a=>t.pageForm.comment=a),maxlength:"255","aria-describedby":"bot-domain",required:""},`
            `,512),[[_,t.pageForm.comment]])]),e("div",i2,[e("div",n2,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[76]||(s[76]=a=>t.pageForm.need_log_user_action=a),type:"checkbox",id:"need_log_user_action"},null,512),[[k,t.pageForm.need_log_user_action]]),a2])]),e("div",d2,[e("div",r2,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[77]||(s[77]=a=>t.need_stay_after_save=a),type:"checkbox",id:"need-stay-after-save"},null,512),[[k,t.need_stay_after_save]]),c2])]),u2],32)]),m2])])]),e("div",h2,[e("div",_2,[e("div",p2,[e("div",b2,[b(K,{current:t.pageForm.id,selected:t.selectedLinkIds,onCallback:t.attachPage,editor:!1},null,8,["current","selected","onCallback"])])])])]),e("div",f2,[g2,e("div",v2,[e("div",y2,[e("div",$2,[t.loaded_page_list?(l(),y(K,{key:0,editor:!0,current:t.page,onCallback:t.pageListCallback},null,8,["current","onCallback"])):r("",!0)])])])]),e("div",k2,[F2,e("div",w2,[t.page?(l(),y(x_,{key:0,page:t.page},null,8,["page"])):(l(),i("p",C2,"Сперва сохраните страницу"))])])],64)}}}),V2={props:["bot","item"],data(){return{sectionForm:{section:null},categoryForm:{label:null},tab:0,types:[{title:"Готовый продукт",value:1},{title:"Товар на вес",value:2},{title:"Конструктор товара",value:3}],productCategories:[],sections:["Общие характеристики","Дополнительная информация"],photos:[],categories:[],removed_options:[],productForm:{article:null,vk_product_id:null,frontpad_article:null,iiko_article:null,title:null,description:null,images:[],type:1,old_price:null,current_price:null,variants:[],in_stop_list_at:null,bot_id:null,options:[],reviews:[],categories:[],not_for_delivery:!1,dimension:{width:0,height:0,length:0,weight:0}}}},computed:{...S(["getProductCategories"]),filteredCategories(){return this.productCategories.length===0?this.categories:this.categories.filter(o=>this.productCategories.indexOf(o.value)===-1)}},mounted(){this.loadProductCategories(),this.item&&this.$nextTick(()=>{this.productForm={id:this.item.id||null,article:this.item.article||null,vk_product_id:this.item.vk_product_id||null,frontpad_article:this.item.frontpad_article||null,iiko_article:this.item.iiko_article||null,title:this.item.title||null,description:this.item.description||null,images:this.item.images||null,type:this.item.type||1,old_price:this.item.old_price||null,current_price:this.item.current_price||null,variants:this.item.variants||null,in_stop_list_at:this.item.in_stop_list_at||null,bot_id:this.item.bot_id||null,options:this.item.options||null,reviews:this.item.reviews||null,not_for_delivery:this.item.not_for_delivery||!1,dimension:{width:this.item.dimension.width||0,height:this.item.dimension.height||0,length:this.item.dimension.length||0,weight:this.item.dimension.weight||0}},this.options=[],this.item.categories.forEach(o=>{this.productCategories.push(o.id)})})},methods:{prepareCategoryName(o){let t=this.categories.find(s=>s.value===o);return console.log(t),t?t.label:o},addCategory(){const o=this.categoryForm.label;this.productCategories.push(o),this.categoryForm.label=null},selectCategory(o){this.productCategories.push(o.value)},submit(){let o=new FormData;if(Object.keys(this.productForm).forEach(t=>{const s=this.productForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),this.bot&&o.append("bot_id",this.bot.id),this.photos.length>0)for(let t=0;t<this.photos.length;t++)o.append("photos[]",this.photos[t]);this.removed_options.length>0&&o.append("removed_options",JSON.stringify(this.removed_options)),this.productCategories.length>0&&o.append("categories",JSON.stringify(this.productCategories)),this.$store.dispatch("saveProduct",{productForm:o}).then(t=>{this.load=!0,this.$notify({title:"Конструктор ботов",text:"Продукт успешно сохранен!",type:"success"}),this.clearForm(),this.$emit("refresh")}).catch(t=>{})},onChangePhotos(o){const t=o.target.files;for(let s=0;s<t.length;s++)this.photos.push(t[s])},loadProductCategories(){this.$store.dispatch("loadProductCategories",{dataObject:{bot_id:this.bot.id}}).then(()=>{this.getProductCategories.forEach(t=>{this.categories.push({value:t.id,label:t.title})})})},getPhoto(o){return{imageUrl:URL.createObjectURL(o)}},removeSection(o){this.sections.splice(o,1)},addSection(){this.sections.push(this.sectionForm.section),this.sectionForm.section=null},addOption(){this.productForm.options||(this.productForm.options=[]),this.productForm.options.push({id:null,key:null,value:null,title:null,section:null})},addVariant(){this.productForm.variants||(this.productForm.variants=[]),this.productForm.variants.push({key:null,value:null})},removeProductCategory(o){this.productCategories.splice(o,1)},removeVariant(o){this.productForm.variants.splice(o,1)},removeOption(o){this.productForm.options[o].id&&this.removed_options.push(this.productForm.options[o].id),this.productForm.options.splice(o,1)},removeImage(o){this.productForm.images.splice(o,1)},removePhoto(o){this.photos.splice(o,1)},clearForm(){const o={article:null,vk_product_id:null,title:null,description:null,images:[],type:1,old_price:null,current_price:null,variants:[],in_stop_list_at:null,bot_id:null,options:[],reviews:[],categories:[],not_for_delivery:!1,dimension:{width:0,height:0,length:0,weight:0}};this.photos=[],this.removed_options=[],this.productCategories=[],this.productForm=o}}},q2={class:"nav nav-tabs"},z2={class:"nav-item"},P2={class:"nav-item"},U2={class:"nav-item"},O2={key:0},A2=e("div",{class:"col-12"},[e("button",{type:"submit",class:"btn btn-outline-primary"},[e("i",{class:"fa-regular fa-floppy-disk mr-2"}),m(" Сохранить товар ")])],-1),I2={class:"col-md-8 d-flex align-items-center"},Q2={class:"form-check"},T2=e("label",{class:"form-check-label",for:"in-stop-list"}," Товар находится в стоп-листе ",-1),M2={class:"col-md-4 d-flex justify-content-end"},D2={class:"col-md-12"},R2={class:"form-check"},B2=e("label",{class:"form-check-label",for:"not_for_delivery"}," Не для доставки ",-1),E2={class:"col-md-12 mb-3"},L2=["onClick"],K2={class:"dropdown"},N2=e("button",{type:"button",class:"btn btn-outline-info w-100","data-bs-toggle":"dropdown","data-bs-display":"static","aria-expanded":"false"},[e("p",{class:"mb-0"},"Выберите категорию")],-1),J2={class:"dropdown-menu w-100",style:{"overflow-y":"scroll",height:"300px"}},H2={class:"p-3"},Y2=e("label",{for:"exampleDropdownFormEmail1",class:"form-label"},"Новая категория",-1),G2={class:"p-3"},W2=e("li",null,[e("hr",{class:"dropdown-divider"})],-1),X2=["onClick"],Z2={class:"col-md-6"},x2={class:"form-floating mb-3"},ek=e("label",{for:"article"},"Артикул товара",-1),tk={class:"col-md-6"},sk={class:"form-floating mb-3"},ok=e("label",{for:"article"},"Артикул товара FrontPad",-1),lk={class:"col-md-6"},ik={class:"form-floating mb-3"},nk=e("label",{for:"article"},"Артикул товара в IIKO",-1),ak={class:"col-md-6"},dk={class:"form-floating mb-3"},rk=e("label",{for:"vk-product-id"},"Идентификатор товара VK",-1),ck={class:"col-md-6"},uk={class:"form-floating mb-3"},mk=e("label",{for:"title"},"Названи товара",-1),hk={class:"col-md-6"},_k={class:"form-floating mb-3"},pk=["value"],bk=e("label",{for:"type"},"Тип товара",-1),fk={class:"col-md-12"},gk={class:"form-floating mb-3"},vk=e("label",{for:"description"},"Описание товара",-1),yk={class:"col-md-6"},$k={class:"form-floating mb-3"},kk=e("label",{for:"current-price"},"Актуальная цена",-1),Fk={class:"col-md-6"},wk={class:"form-floating mb-3"},Ck=e("label",{for:"old-price"},"Старая цена",-1),Sk={class:"col-md-6"},jk={class:"form-floating mb-3"},Vk=e("label",{for:"vk-product-id"},"Высота",-1),qk={class:"col-md-6"},zk={class:"form-floating mb-3"},Pk=e("label",{for:"vk-product-id"},"Ширина",-1),Uk={class:"col-md-6"},Ok={class:"form-floating mb-3"},Ak=e("label",{for:"vk-product-id"},"Длина",-1),Ik={class:"col-md-6"},Qk={class:"form-floating mb-3"},Tk=e("label",{for:"vk-product-id"},"Вес",-1),Mk={class:"col-md-12 mb-3"},Dk={class:"card"},Rk={class:"card-header"},Bk={key:0},Ek={class:"card-body"},Lk={class:"row"},Kk={class:"col-12 mb-3"},Nk={class:"col-md-6 mb-3"},Jk={class:"card w-100"},Hk={class:"card-body"},Yk={class:"form-floating mb-3"},Gk=["onUpdate:modelValue","id"],Wk=["for"],Xk={class:"form-floating mb-3"},Zk=["onUpdate:modelValue","id"],xk=["for"],e0={class:"card-footer"},t0=["onClick"],s0=e("i",{class:"fa-solid fa-trash-can"},null,-1),o0=[s0],l0={class:"col-md-12 mb-3"},i0={class:"card"},n0=e("div",{class:"card-header"},[e("h6",null,"Характеристики товара")],-1),a0={class:"card-body"},d0={class:"row mb-3"},r0={class:"col-12"},c0=e("button",{class:"btn btn-outline-info",type:"submit",id:"button-addon2"},"Добавить секцию ",-1),u0={class:"badge bg-info mr-1"},m0=["onClick"],h0=e("i",{class:"fa-solid fa-xmark"},null,-1),_0=[h0],p0={class:"row"},b0={class:"col-md-4 mb-3"},f0={class:"card w-100"},g0={class:"card-body"},v0={class:"form-floating mb-3"},y0=["onUpdate:modelValue","id"],$0=["for"],k0={class:"form-floating mb-3"},F0=["onUpdate:modelValue","id"],w0=["for"],C0={class:"form-floating mb-3"},S0=["onUpdate:modelValue","id"],j0=e("option",{value:null},"Без секции",-1),V0=["value"],q0=["for"],z0={class:"card-footer"},P0=["onClick"],U0=e("i",{class:"fa-solid fa-trash-can"},null,-1),O0=[U0],A0={class:"row"},I0={class:"col-12"},Q0={class:"col-md-12 mb-3"},T0=e("h6",null,"Фотографии товара",-1),M0={class:"photo-preview d-flex justify-content-start flex-wrap w-100"},D0={for:"location-photos",style:{"margin-right":"10px"},class:"photo-loader ml-2"},R0=e("span",null,"+",-1),B0={class:"mb-2 img-preview",style:{"margin-right":"10px"}},E0={class:"remove"},L0=["onClick"],K0={class:"mb-2 img-preview",style:{"margin-right":"10px"}},N0={class:"remove"},J0=["onClick"],H0={key:1};function Y0(o,t,s,d,n,a){const h=Q("lazy");return l(),i(f,null,[e("ul",q2,[e("li",z2,[e("a",{class:g(["nav-link",{active:n.tab===0}]),onClick:t[0]||(t[0]=p=>n.tab=0),"aria-current":"page",href:"#product-form-info"},"Информация о товаре",2)]),e("li",P2,[e("a",{class:g(["nav-link",{active:n.tab===1}]),onClick:t[1]||(t[1]=p=>n.tab=1),href:"#product-reviews"},"Комментарии",2)]),e("li",U2,[e("a",{class:g(["nav-link",{active:n.tab===2}]),onClick:t[2]||(t[2]=p=>n.tab=2),href:"#product-reviews"},"Заказы",2)])]),n.tab===0?(l(),i("div",O2,[e("form",{onSubmit:t[26]||(t[26]=C((...p)=>a.submit&&a.submit(...p),["prevent"])),class:"row py-2"},[A2,e("div",I2,[e("div",Q2,[c(e("input",{class:"form-check-input","onUpdate:modelValue":t[3]||(t[3]=p=>n.productForm.in_stop_list_at=p),type:"checkbox",value:"false",id:"in-stop-list"},null,512),[[k,n.productForm.in_stop_list_at]]),T2])]),e("div",M2,[e("a",{href:"#",class:"btn btn-link",onClick:t[4]||(t[4]=(...p)=>a.clearForm&&a.clearForm(...p))},"Новый товар")]),e("div",D2,[e("div",R2,[c(e("input",{class:"form-check-input","onUpdate:modelValue":t[5]||(t[5]=p=>n.productForm.not_for_delivery=p),type:"checkbox",value:"false",id:"not_for_delivery"},null,512),[[k,n.productForm.not_for_delivery]]),B2])]),e("div",E2,[(l(!0),i(f,null,$(n.productCategories,(p,F)=>(l(),i("span",{class:"badge bg-info mr-1 mb-1 cursor-pointer",onClick:w=>a.removeProductCategory(F)},u(a.prepareCategoryName(p)),9,L2))),256)),e("div",K2,[N2,e("ul",J2,[e("div",H2,[Y2,c(e("input",{type:"text",class:"form-control","onUpdate:modelValue":t[6]||(t[6]=p=>n.categoryForm.label=p),id:"exampleDropdownFormEmail1",placeholder:"Название категории"},null,512),[[_,n.categoryForm.label]])]),e("div",G2,[e("button",{class:"btn btn-primary w-100",type:"button",onClick:t[7]||(t[7]=(...p)=>a.addCategory&&a.addCategory(...p))},"Добавить категорию ")]),W2,(l(!0),i(f,null,$(a.filteredCategories,p=>(l(),i("li",null,[e("button",{class:"dropdown-item",type:"button",onClick:F=>a.selectCategory(p)},u(p.label),9,X2)]))),256))])])]),e("div",Z2,[e("div",x2,[c(e("input",{type:"text","onUpdate:modelValue":t[8]||(t[8]=p=>n.productForm.article=p),class:"form-control",id:"article",placeholder:"name@example.com"},null,512),[[_,n.productForm.article]]),ek])]),e("div",tk,[e("div",sk,[c(e("input",{type:"text","onUpdate:modelValue":t[9]||(t[9]=p=>n.productForm.frontpad_article=p),class:"form-control",id:"article",placeholder:"name@example.com"},null,512),[[_,n.productForm.frontpad_article]]),ok])]),e("div",lk,[e("div",ik,[c(e("input",{type:"text","onUpdate:modelValue":t[10]||(t[10]=p=>n.productForm.iiko_article=p),class:"form-control",id:"article",placeholder:"name@example.com"},null,512),[[_,n.productForm.iiko_article]]),nk])]),e("div",ak,[e("div",dk,[c(e("input",{type:"text","onUpdate:modelValue":t[11]||(t[11]=p=>n.productForm.vk_product_id=p),disabled:!0,class:"form-control",id:"vk-product-id",placeholder:"name@example.com"},null,512),[[_,n.productForm.vk_product_id]]),rk])]),e("div",ck,[e("div",uk,[c(e("input",{type:"text","onUpdate:modelValue":t[12]||(t[12]=p=>n.productForm.title=p),class:"form-control",id:"title",placeholder:"name@example.com"},null,512),[[_,n.productForm.title]]),mk])]),e("div",hk,[e("div",_k,[c(e("select",{class:"form-select","onUpdate:modelValue":t[13]||(t[13]=p=>n.productForm.type=p),id:"type","aria-label":"Floating label select example"},[(l(!0),i(f,null,$(n.types,(p,F)=>(l(),i("option",{value:p.value},u(p.title),9,pk))),256))],512),[[T,n.productForm.type]]),bk])]),e("div",fk,[e("div",gk,[c(e("textarea",{class:"form-control","onUpdate:modelValue":t[14]||(t[14]=p=>n.productForm.description=p),placeholder:"Leave a comment here",id:"description"},null,512),[[_,n.productForm.description]]),vk])]),e("div",yk,[e("div",$k,[c(e("input",{type:"number","onUpdate:modelValue":t[15]||(t[15]=p=>n.productForm.current_price=p),class:"form-control",id:"current-price",placeholder:"name@example.com"},null,512),[[_,n.productForm.current_price]]),kk])]),e("div",Fk,[e("div",wk,[c(e("input",{type:"number","onUpdate:modelValue":t[16]||(t[16]=p=>n.productForm.old_price=p),class:"form-control",id:"old-price",placeholder:"name@example.com"},null,512),[[_,n.productForm.old_price]]),Ck])]),e("div",Sk,[e("div",jk,[c(e("input",{type:"text","onUpdate:modelValue":t[17]||(t[17]=p=>n.productForm.dimension.height=p),class:"form-control",id:"vk-product-id",placeholder:"Идентификатор"},null,512),[[_,n.productForm.dimension.height]]),Vk])]),e("div",qk,[e("div",zk,[c(e("input",{type:"text","onUpdate:modelValue":t[18]||(t[18]=p=>n.productForm.dimension.width=p),class:"form-control",id:"vk-product-id",placeholder:"Идентификатор"},null,512),[[_,n.productForm.dimension.width]]),Pk])]),e("div",Uk,[e("div",Ok,[c(e("input",{type:"text","onUpdate:modelValue":t[19]||(t[19]=p=>n.productForm.dimension.length=p),class:"form-control",id:"vk-product-id",placeholder:"Идентификатор"},null,512),[[_,n.productForm.dimension.length]]),Ak])]),e("div",Ik,[e("div",Qk,[c(e("input",{type:"text","onUpdate:modelValue":t[20]||(t[20]=p=>n.productForm.dimension.weight=p),class:"form-control",id:"vk-product-id",placeholder:"Идентификатор"},null,512),[[_,n.productForm.dimension.weight]]),Tk])]),e("div",Mk,[e("div",Dk,[e("div",Rk,[e("h6",null,[m("Варианты товара "),n.productForm.variants?(l(),i("span",Bk,"("+u(n.productForm.variants.length)+")",1)):r("",!0)])]),e("div",Ek,[e("div",Lk,[e("div",Kk,[e("button",{type:"button",class:"btn btn-outline-info w-100",onClick:t[21]||(t[21]=(...p)=>a.addVariant&&a.addVariant(...p))},"Добавить вариант ")]),(l(!0),i(f,null,$(n.productForm.variants,(p,F)=>(l(),i("div",Nk,[e("div",Jk,[e("div",Hk,[e("div",Yk,[c(e("input",{type:"text","onUpdate:modelValue":w=>n.productForm.variants[F].key=w,class:"form-control",id:"variant-key-"+F,placeholder:"name@example.com",required:""},null,8,Gk),[[_,n.productForm.variants[F].key]]),e("label",{for:"variant-key-"+F},"Ключ",8,Wk)]),e("div",Xk,[c(e("input",{type:"text","onUpdate:modelValue":w=>n.productForm.variants[F].value=w,class:"form-control",id:"variant-value-"+F,placeholder:"name@example.com",required:""},null,8,Zk),[[_,n.productForm.variants[F].value]]),e("label",{for:"variant-value-"+F},"Значение",8,xk)])]),e("div",e0,[e("button",{type:"button",class:"btn btn-outline-danger",onClick:w=>a.removeVariant(F)},o0,8,t0)])])]))),256))])])])]),e("div",l0,[e("div",i0,[n0,e("div",a0,[e("div",d0,[e("div",r0,[e("form",{onSubmit:t[23]||(t[23]=C((...p)=>a.addSection&&a.addSection(...p),["prevent"])),class:"input-group mb-3"},[c(e("input",{type:"text","onUpdate:modelValue":t[22]||(t[22]=p=>n.sectionForm.section=p),class:"form-control border-info",placeholder:"Название секции","aria-label":"Recipient's username","aria-describedby":"button-addon2",required:""},null,512),[[_,n.sectionForm.section]]),c0],32),(l(!0),i(f,null,$(n.sections,(p,F)=>(l(),i("span",u0,[m(u(p)+" ",1),e("strong",{onClick:w=>a.removeSection(F)},_0,8,m0)]))),256))])]),e("div",p0,[(l(!0),i(f,null,$(n.productForm.options,(p,F)=>(l(),i("div",b0,[e("div",f0,[e("div",g0,[e("div",v0,[c(e("input",{type:"text","onUpdate:modelValue":w=>n.productForm.options[F].title=w,class:"form-control",id:"option-title-"+F,placeholder:"name@example.com"},null,8,y0),[[_,n.productForm.options[F].title]]),e("label",{for:"option-title-"+F},"Название характеристики",8,$0)]),e("div",k0,[c(e("input",{type:"text","onUpdate:modelValue":w=>n.productForm.options[F].value=w,class:"form-control",id:"option-value-"+F,placeholder:"name@example.com"},null,8,F0),[[_,n.productForm.options[F].value]]),e("label",{for:"option-value-"+F},"Значение характеристики",8,w0)]),e("div",C0,[c(e("select",{class:"form-select","onUpdate:modelValue":w=>n.productForm.options[F].section=w,id:"option-section-"+F,"aria-label":"Floating label select example"},[j0,(l(!0),i(f,null,$(n.sections,w=>(l(),i("option",{value:w},u(w),9,V0))),256))],8,S0),[[T,n.productForm.options[F].section]]),e("label",{for:"option-section-"+F},"Секция товара",8,q0)])]),e("div",z0,[e("button",{type:"button",class:"btn btn-outline-danger",onClick:w=>a.removeOption(F)},O0,8,P0)])])]))),256))]),e("div",A0,[e("div",I0,[e("button",{type:"button",class:"btn btn-outline-info w-100",onClick:t[24]||(t[24]=(...p)=>a.addOption&&a.addOption(...p))},"Добавить характеристику ")])])])])]),e("div",Q0,[T0,e("div",M0,[e("label",D0,[R0,e("input",{type:"file",id:"location-photos",multiple:"",accept:"image/*",onChange:t[25]||(t[25]=(...p)=>a.onChangePhotos&&a.onChangePhotos(...p)),style:{display:"none"}},null,32)]),n.productForm.images?(l(!0),i(f,{key:0},$(n.productForm.images,(p,F)=>(l(),i("div",B0,[c(e("img",null,null,512),[[h,p]]),e("div",E0,[e("a",{onClick:w=>a.removeImage(F)},"Удалить",8,L0)])]))),256)):r("",!0),n.photos.length>0?(l(!0),i(f,{key:1},$(n.photos,(p,F)=>(l(),i("div",K0,[c(e("img",null,null,512),[[h,a.getPhoto(p).imageUrl]]),e("div",N0,[e("a",{onClick:w=>a.removePhoto(F)},"Удалить",8,J0)])]))),256)):r("",!0)])])],32)])):r("",!0),n.tab===1?(l(),i("div",H0," Отзывы ")):r("",!0)],64)}const be=U(V2,[["render",Y0]]);({...S(["getCurrentBot"])});const G0=e("button",{class:"btn btn-outline-info",type:"submit",id:"button-addon2"}," Найти ",-1),W0={key:0},X0={class:"row"},Z0={class:"col-12"},x0={class:"table"},e3=e("thead",null,[e("tr",null,[e("th",{scope:"col"}),e("th",{scope:"col"},"#"),e("th",{scope:"col"},"Название"),e("th",{scope:"col"},"Картинка"),e("th",{scope:"col"},"Действия")])],-1),t3=["onClick"],s3=e("i",{class:"fa-solid fa-toggle-off cursor-pointer text-secondary"},null,-1),o3=[s3],l3=["onClick"],i3=e("i",{class:"fa-solid fa-toggle-on cursor-pointer text-primary"},null,-1),n3=[i3],a3={scope:"row"},d3=["onClick"],r3=["src"],c3={key:1},u3={class:"d-flex"},m3=e("i",{class:"fa-regular fa-copy"},null,-1),h3=[m3],_3=e("i",{class:"fa-solid fa-trash-can"},null,-1),p3=[_3],b3={key:0},f3={colspan:"5"},g3={props:["bot"],data(){return{search:null,products:[],paginate:null}},computed:{...S(["getProducts","getProductsPaginateObject"]),filteredProducts(){return this.search?this.products.filter(o=>o.title.toLowerCase().trim().indexOf(this.search.toLowerCase().trim())>=0):this.products}},mounted(){this.loadProducts()},methods:{refresh(){this.products.forEach(o=>{o.in_edit_mode=!1})},toggleEditProduct(o){console.log("product0",o),o.in_edit_mode=!o.in_edit_mode},selectProduct(o){this.$emit("select",o)},nextProducts(o){this.loadProducts(o)},preparedImgUrl(o){return o.toLocaleLowerCase().startsWith("https://")||o.toLocaleLowerCase().startsWith("http://")?o:"/images-by-bot-id/"+this.bot.id+"/"+o},removeProduct(o){this.$store.dispatch("removeProduct",o.id).then(t=>{this.$notify({title:"Конструктор ботов",text:"Продукт успешно удален!",type:"success"})}).catch(t=>{})},duplicateProduct(o){this.$store.dispatch("duplicateProduct",o.id).then(t=>{this.$notify({title:"Конструктор ботов",text:"Продукт успешно продублирован!",type:"success"})}).catch(t=>{})},loadProducts(o=0){return this.$store.dispatch("loadProducts",{dataObject:{bot_id:this.bot.id,search:this.search},page:o}).then(()=>{this.products=this.getProducts,this.paginate=this.getProductsPaginateObject})}}},v3=Object.assign(g3,{__name:"ProductTableList",setup(o){return(t,s)=>(l(),i(f,null,[e("form",{class:"input-group mb-3",onSubmit:s[1]||(s[1]=C(d=>t.loadProducts(0),["prevent"]))},[c(e("input",{type:"text",class:"form-control border-info",placeholder:"Поиск товара","aria-label":"Поиск товара","onUpdate:modelValue":s[0]||(s[0]=d=>t.search=d),"aria-describedby":"button-addon2",required:""},null,512),[[_,t.search]]),G0],32),e("p",null,[m("Всего товаров: "),t.paginate?(l(),i("span",W0,u(t.paginate.meta.total||0),1)):r("",!0)]),e("div",X0,[e("div",Z0,[e("table",x0,[e3,e("tbody",null,[(l(!0),i(f,null,$(t.filteredProducts,(d,n)=>(l(),i(f,null,[e("tr",null,[e("td",null,[d.in_edit_mode?(l(),i("span",{key:1,onClick:a=>t.toggleEditProduct(d)},n3,8,l3)):(l(),i("span",{key:0,onClick:a=>t.toggleEditProduct(d)},o3,8,t3))]),e("th",a3,u(d.id),1),e("td",null,[e("a",{href:"javascript:void(0)",onClick:a=>t.selectProduct(d)},u(d.title),9,d3)]),e("td",null,[(d.images||[]).length>0?(l(),i("img",{key:0,src:t.preparedImgUrl(d.images[0]),style:{width:"100px",height:"100px","object-fit":"cover"},class:"d-block",alt:"..."},null,8,r3)):(l(),i("p",c3,"Не добавлено"))]),e("td",null,[e("div",u3,[e("button",{title:"Дублировать товар",onClick:s[2]||(s[2]=(...a)=>t.duplicateProduct&&t.duplicateProduct(...a)),class:"btn btn-outline-info mr-1"},h3),e("button",{title:"Удалить товар",onClick:s[3]||(s[3]=(...a)=>t.removeProduct&&t.removeProduct(...a)),class:"btn btn-outline-danger"},p3)])])]),d.in_edit_mode?(l(),i("tr",b3,[e("td",f3,[b(be,{bot:o.bot,item:d,onRefresh:t.refresh},null,8,["bot","item","onRefresh"])])])):r("",!0)],64))),256))])])])]),t.paginate?(l(),y(q,{key:0,onPagination_page:t.nextProducts,pagination:t.paginate},null,8,["onPagination_page","pagination"])):r("",!0)],64))}}),y3=e("button",{class:"btn btn-outline-info",type:"submit",id:"button-addon2"}," Найти ",-1),$3={key:0},k3={class:"row"},F3={class:"col-12"},w3={class:"table"},C3=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"#"),e("th",{scope:"col"},"Название"),e("th",{scope:"col"},"Состояние"),e("th",{scope:"col"},"Позиция в выдаче"),e("th",{scope:"col"},"Действия")])],-1),S3={scope:"row"},j3=["onClick"],V3=["onClick"],q3={key:0},z3={key:1},P3=["onChange","onUpdate:modelValue"],U3=["onClick"],O3=e("i",{class:"fa-solid fa-trash-can"},null,-1),A3=[O3],I3={props:["bot"],data(){return{search:null,categories:[],paginate:null}},computed:{...S(["getProductCategories","getProductCategoriesPaginateObject"]),filteredProductCategories(){return this.search?this.categories.filter(o=>o.title.toLowerCase().trim().indexOf(this.search.toLowerCase().trim())>=0):this.categories}},mounted(){this.loadProductCategories()},methods:{updateCategory(o){console.log("update",o),this.$store.dispatch("storeProductCategory",{category:o,bot_id:this.bot.id}).then(t=>{this.$notify({title:"Конструктор ботов",text:"Данные сохранены!",type:"success"})}).catch(t=>{this.$notify({title:"Конструктор ботов",text:"Ошибка сохранения данных!",type:"error"})})},changeCategoryStatus(o){let t=this.categories.findIndex(s=>o.id===s.id);t!==-1&&(this.categories[t].is_active=!this.categories[t].is_active,this.$store.dispatch("changeProductCategoryStatus",o.id).then(s=>{this.$notify({title:"Конструктор ботов",text:"Статус категории успешно изменен!",type:"success"})}).catch(s=>{}))},selectProductCategory(o){this.$emit("select",o)},nextProductCategories(o){this.loadProductCategories(o)},removeProductCategory(o){this.$store.dispatch("removeProductCategory",o.id).then(t=>{this.$notify({title:"Конструктор ботов",text:"Продукт успешно удален!",type:"success"})}).catch(t=>{})},loadProductCategories(o=0){return this.$store.dispatch("loadProductCategories",{dataObject:{bot_id:this.bot.id,search:this.search},page:o}).then(()=>{this.categories=this.getProductCategories,this.paginate=this.getProductCategoriesPaginateObject})}}},Q3=Object.assign(I3,{__name:"ProductCategoryTableList",setup(o){return(t,s)=>(l(),i(f,null,[e("form",{class:"input-group mb-3",onSubmit:s[1]||(s[1]=C(d=>t.loadProductCategories(0),["prevent"]))},[c(e("input",{type:"text",class:"form-control border-info",placeholder:"Поиск категории товара","aria-label":"Поиск категории товара","onUpdate:modelValue":s[0]||(s[0]=d=>t.search=d),"aria-describedby":"button-addon2",required:""},null,512),[[_,t.search]]),y3],32),e("p",null,[m("Всего категорий: "),t.paginate?(l(),i("span",$3,u(t.paginate.meta.total||0),1)):r("",!0)]),e("div",k3,[e("div",F3,[e("table",w3,[C3,e("tbody",null,[(l(!0),i(f,null,$(t.filteredProductCategories,(d,n)=>(l(),i("tr",null,[e("th",S3,u(d.id),1),e("td",null,[e("a",{href:"javascript:void(0)",onClick:a=>t.selectProductCategory(d),"data-bs-toggle":"modal","data-bs-target":"#product-form-edit"},null,8,j3),m(u(d.title),1)]),e("td",null,[e("button",{type:"button",onClick:a=>t.changeCategoryStatus(d),class:"btn btn-outline-success"},[d.is_active?(l(),i("span",q3,"Активная")):(l(),i("span",z3,"Не активная"))],8,V3)]),e("td",null,[c(e("input",{type:"number",onChange:a=>t.updateCategory(d),"onUpdate:modelValue":a=>d.order_position=a,class:"form-control"},null,40,P3),[[_,d.order_position]])]),e("td",null,[e("button",{title:"Удалить товар",onClick:a=>t.removeProductCategory(d),class:"btn btn-outline-danger"},A3,8,U3)])]))),256))])])])]),t.paginate?(l(),y(q,{key:0,onPagination_page:t.nextProductCategories,pagination:t.paginate},null,8,["onPagination_page","pagination"])):r("",!0)],64))}}),T3={class:"nav nav-tabs my-3"},M3={class:"nav-item"},D3={class:"nav-item"},R3={class:"nav-item"},B3={class:"nav-item"},E3={key:0},L3={class:"card mb-2"},K3=e("div",{class:"card-header"},[e("h6",null,"Управление магазином")],-1),N3={class:"card-body"},J3={class:"row"},H3={class:"col-12"},Y3={class:"form-label d-flex justify-content-between mt-2",id:"bot-level-3"},G3=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),W3=e("div",null,"Ссылка на страницу ВК с товарами для вашего магазина в боте ",-1),X3=e("a",{href:"https://vk.com/groups?w=groups_create",target:"_blank"},"Создать",-1),Z3=["disabled"],x3=e("i",{class:"fa-regular fa-floppy-disk mr-2"},null,-1),e5={class:"row mb-3"},t5={class:"col-md-3"},s5=["href"],o5=B('<div class="col-md-3"><button class="btn btn-outline-info w-100">Экспорт в XLS</button></div><div class="col-md-3"><button class="btn btn-outline-info w-100">Импорт из XLS</button></div><div class="col-md-3"><button class="btn btn-outline-danger w-100">Удалить товары</button></div>',3),l5=e("div",{class:"row"},[e("div",{class:"col-md-3"},[e("button",{class:"btn btn-outline-info w-100"},"Экспортировать заказы")])],-1),i5={key:1},n5={class:"modal fade",id:"product-form-edit",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},a5={class:"modal-dialog"},d5={class:"modal-content"},r5=e("div",{class:"modal-header"},[e("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"Modal title"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),c5={class:"modal-body"},u5=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close"),e("button",{type:"button",class:"btn btn-primary"},"Save changes")],-1),m5={key:2},h5={key:3},_5={data(){return{load:!1,tab:0,url:null,link:null,bot:null,selectedProduct:null,selectedCategory:null,botForm:{vk_shop_link:null}}},computed:{...S(["getCurrentBot"])},mounted(){this.bot=this.getCurrentBot,this.botForm.vk_shop_link=this.bot.vk_shop_link||null,this.updateProducts()},methods:{updateShopLink(){this.load=!0,this.botForm.bot_id=this.bot.id,this.$store.dispatch("updateShopLink",{botForm:this.botForm}).then(o=>{this.load=!1,this.updateProducts(),this.$notify({title:"Менеджер магазина",text:"Ссылка на источник в ВК обновлена"})}).catch(()=>{this.load=!1})},refresh(){this.load=!0,this.selectedProduct=null,this.$nextTick(()=>{this.load=!1})},selectProduct(o){this.load=!0,this.$nextTick(()=>{this.selectedProduct=o,this.load=!1})},selectProductCategory(o){this.load=!0,this.$nextTick(()=>{this.selectedCategory=o,this.load=!1})},updateProducts(){this.load=!0,this.$store.dispatch("updateProductsFromVk",{dataObject:{bot_domain:this.getCurrentBot.bot_domain}}).then(o=>{this.link=o.data.url,this.load=!1,this.url=null}).catch(()=>{this.load=!1})}}},p5=Object.assign(_5,{__name:"Shop",setup(o){return(t,s)=>{const d=z("Popper");return l(),i(f,null,[e("ul",T3,[e("li",M3,[e("a",{class:g(["nav-link",{active:t.tab===0}]),onClick:s[0]||(s[0]=n=>t.tab=0),"aria-current":"page",href:"#"},"Товары",2)]),e("li",D3,[e("a",{class:g(["nav-link",{active:t.tab===3}]),onClick:s[1]||(s[1]=n=>t.tab=3),href:"#"},"Категории товаров",2)]),e("li",R3,[e("a",{class:g(["nav-link",{active:t.tab===1}]),onClick:s[2]||(s[2]=n=>t.tab=1),href:"#"},"Настройка&Обновление",2)]),e("li",B3,[e("a",{class:g(["nav-link",{active:t.tab===2}]),onClick:s[3]||(s[3]=n=>t.tab=2),href:"#"},"Заказы",2)])]),t.tab===1?(l(),i("div",E3,[e("div",L3,[K3,e("div",N3,[e("div",J3,[e("div",H3,[e("form",{onSubmit:s[5]||(s[5]=C((...n)=>t.updateShopLink&&t.updateShopLink(...n),["prevent"])),class:"mb-2"},[e("label",Y3,[e("div",null,[b(d,null,{content:v(()=>[W3]),default:v(()=>[G3]),_:1}),m(" ВК-группа ")]),X3]),c(e("input",{type:"url",class:"form-control",placeholder:"Ссылка на группу ВК","aria-label":"ссылка на группу ВК","onUpdate:modelValue":s[4]||(s[4]=n=>t.botForm.vk_shop_link=n),"aria-describedby":"vk_shop_link"},null,512),[[_,t.botForm.vk_shop_link]]),e("button",{disabled:t.load,class:"btn btn-outline-primary mt-2 mb-2 w-100"},[x3,m(" Сохранить ")],8,Z3)],32)])]),e("div",e5,[e("div",t5,[e("a",{target:"_blank",href:t.link,class:"btn btn-primary w-100"}," Обновить товар ",8,s5)]),o5]),l5])])])):r("",!0),t.tab===0?(l(),i("div",i5,[t.bot&&!t.load?(l(),y(v3,{key:0,bot:t.bot,onSelect:t.selectProduct},null,8,["bot","onSelect"])):r("",!0),e("div",n5,[e("div",a5,[e("div",d5,[r5,e("div",c5,[t.bot&&!t.load?(l(),y(be,{key:0,bot:t.bot,item:t.selectedProduct,onRefresh:t.refresh},null,8,["bot","item","onRefresh"])):r("",!0)]),u5])])])])):r("",!0),t.tab===2?(l(),i("div",m5)):r("",!0),t.tab===3?(l(),i("div",h5,[t.bot&&!t.load?(l(),y(Q3,{key:0,bot:t.bot,onSelect:t.selectProductCategory},null,8,["bot","onSelect"])):r("",!0)])):r("",!0)],64)}}}),b5={props:["data"],data(){return{hasConnect:!1,bot:null,amoForm:{client_id:null,client_secret:null,auth_code:null,redirect_uri:null,subdomain:null,bot_id:null}}},computed:{...S(["getCurrentBot"])},mounted(){this.bot=this.getCurrentBot,this.data?this.$nextTick(()=>{this.amoForm.client_id=this.data.client_id||null,this.amoForm.client_secret=this.data.client_secret||null,this.amoForm.auth_code=this.data.auth_code||null,this.amoForm.redirect_uri=this.data.redirect_uri||null,this.amoForm.subdomain=this.data.subdomain||null,this.amoForm.bot_id=this.data.bot_id||this.bot.id||null}):this.amoForm.bot_id=this.bot.id||null},methods:{submitAmo(){let o=new FormData;Object.keys(this.amoForm).forEach(t=>{const s=this.amoForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),this.$store.dispatch("saveAmoCRM",{amoForm:o}).then(t=>{this.$notify("Данные CRM успешно сохранены")}).catch(t=>{})}}},f5=e("div",{class:"col-12"},[e("p",null,[e("a",{target:"_blank",href:"https://www.amocrm.ru/developers/content/oauth/step-by-step"},"Документация для разработчика "),m(" по шагам")])],-1),g5={class:"col-md-6 col-12 mb-2"},v5={class:"form-label",id:"client_id"},y5=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),$5=e("div",null,"ID интеграции",-1),k5=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),F5={class:"col-md-6 col-12 mb-2"},w5={class:"form-label",id:"client_secret"},C5=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),S5=e("div",null,"Секрет интеграции",-1),j5=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),V5={class:"col-md-6 mb-2"},q5={class:"form-label",id:"auth_code"},z5=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),P5=e("div",null,"Полученный код авторизации",-1),U5=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),O5={class:"col-md-6 col-12 mb-2"},A5={class:"form-label",id:"subdomain2"},I5=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Q5=e("div",null,"Ваш поддомен в системе AMO CRM",-1),T5=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),M5=e("div",{class:"col-md-12 col-12"},[e("button",{type:"submit",class:"btn btn-outline-primary p-3 w-100"},[e("i",{class:"fa-solid fa-cloud-arrow-down mr-1"}),m(" Сохранить настройку AMO ")])],-1);function D5(o,t,s,d,n,a){const h=z("Popper");return l(),i("form",{onSubmit:t[4]||(t[4]=C((...p)=>a.submitAmo&&a.submitAmo(...p),["prevent"])),class:"row"},[f5,e("div",g5,[e("label",v5,[b(h,null,{content:v(()=>[$5]),default:v(()=>[y5]),_:1}),m(" client_id "),k5]),c(e("input",{type:"text",class:"form-control",placeholder:"client_id","aria-label":"client_id","onUpdate:modelValue":t[0]||(t[0]=p=>n.amoForm.client_id=p),"aria-describedby":"client_id"},null,512),[[_,n.amoForm.client_id]])]),e("div",F5,[e("label",w5,[b(h,null,{content:v(()=>[S5]),default:v(()=>[C5]),_:1}),m(" client_secret "),j5]),c(e("input",{type:"text",class:"form-control",placeholder:"client_secret","aria-label":"client_secret","onUpdate:modelValue":t[1]||(t[1]=p=>n.amoForm.client_secret=p),"aria-describedby":"client_secret"},null,512),[[_,n.amoForm.client_secret]])]),e("div",V5,[e("label",q5,[b(h,null,{content:v(()=>[P5]),default:v(()=>[z5]),_:1}),m(" auth_code "),U5]),c(e("textarea",{class:"form-control",placeholder:"auth_code","aria-label":"auth_code","onUpdate:modelValue":t[2]||(t[2]=p=>n.amoForm.auth_code=p),"aria-describedby":"auth_code"},`
                                    `,512),[[_,n.amoForm.auth_code]])]),e("div",O5,[e("label",A5,[b(h,null,{content:v(()=>[Q5]),default:v(()=>[I5]),_:1}),m(" subdomain "),T5]),c(e("input",{type:"text",class:"form-control",placeholder:"subdomain","aria-label":"subdomain","onUpdate:modelValue":t[3]||(t[3]=p=>n.amoForm.subdomain=p),"aria-describedby":"subdomain"},null,512),[[_,n.amoForm.subdomain]])]),M5],32)}const R5=U(b5,[["render",D5]]),B5={props:["data"],data(){return{bot:null,cdekForm:{account:null,secure_password:null,is_active:!0,bot_id:null}}},computed:{...S(["getCurrentBot"])},mounted(){this.bot=this.getCurrentBot,this.data?this.$nextTick(()=>{this.cdekForm.account=this.data.account||null,this.cdekForm.secure_password=this.data.secure_password||null,this.cdekForm.is_active=this.data.is_active||!0,this.cdekForm.bot_id=this.data.bot_id||this.bot.id||null}):this.cdekForm.bot_id=this.bot.id||null},methods:{submitCdek(){let o=new FormData;Object.keys(this.cdekForm).forEach(t=>{const s=this.cdekForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),this.$store.dispatch("saveCdek",{cdekForm:o}).then(t=>{this.$notify("Данные успешно сохранены")}).catch(t=>{})}}},E5={class:"col-md-6 col-12 mb-2"},L5={class:"form-floating"},K5=e("label",{class:"form-label",id:"account"}," Аккаунт ",-1),N5={class:"col-md-6 col-12 mb-2"},J5={class:"form-floating"},H5=e("label",{class:"form-label",id:"secure_password"}," Пароль приложения ",-1),Y5={class:"col-md-6 mb-2"},G5={class:"form-check form-switch"},W5={class:"form-check-label",for:"is_active"},X5={key:0,class:"fw-bold text-primary"},Z5={key:1,class:"fw-bold text-primary"},x5=e("div",{class:"col-md-12 col-12"},[e("button",{type:"submit",class:"btn btn-outline-primary p-3 w-100"},[e("i",{class:"fa-solid fa-cloud-arrow-down mr-1"}),m(" Сохранить настройку ")])],-1);function eF(o,t,s,d,n,a){return l(),i("form",{onSubmit:t[3]||(t[3]=C((...h)=>a.submitCdek&&a.submitCdek(...h),["prevent"])),class:"row py-3"},[e("div",E5,[e("div",L5,[c(e("input",{type:"text",class:"form-control",placeholder:"account","aria-label":"account","onUpdate:modelValue":t[0]||(t[0]=h=>n.cdekForm.account=h),"aria-describedby":"account"},null,512),[[_,n.cdekForm.account]]),K5])]),e("div",N5,[e("div",J5,[c(e("input",{type:"text",class:"form-control",placeholder:"secure_password","aria-label":"secure_password","onUpdate:modelValue":t[1]||(t[1]=h=>n.cdekForm.secure_password=h),"aria-describedby":"secure_password"},null,512),[[_,n.cdekForm.secure_password]]),H5])]),e("div",Y5,[e("div",G5,[c(e("input",{class:"form-check-input","onUpdate:modelValue":t[2]||(t[2]=h=>n.cdekForm.is_active=h),type:"checkbox",role:"switch",id:"is_active"},null,512),[[k,n.cdekForm.is_active]]),e("label",W5,[m("Статус "),n.cdekForm.is_active?(l(),i("span",X5,"вкл")):(l(),i("span",Z5,"выкл"))])])]),x5],32)}const tF=U(B5,[["render",eF]]),sF={props:["data"],data(){return{load:!1,bot:null,yClientsForm:{login:null,password:null,partner_token:null,company:null}}},computed:{...S(["getCurrentBot"])},mounted(){this.bot=this.getCurrentBot,this.data&&this.$nextTick(()=>{this.yClientsForm.login=this.data.login||null,this.yClientsForm.password=this.data.password||null,this.yClientsForm.partner_token=this.data.partner_token||null,this.yClientsForm.company=this.data.company||null})},methods:{submitYClients(){let o=new FormData;Object.keys(this.yClientsForm).forEach(t=>{const s=this.yClientsForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),o.append("bot_id",this.bot.id),this.$store.dispatch("saveYClients",{yClientsForm:o}).then(t=>{this.$notify({title:"Работа с YClients",text:"Данные YClients успешно сохранены",type:"success"})}).catch(t=>{this.$notify({title:"Работа с YClients",text:"Ошибка сохранения данных",type:"error"})})}}},oF=e("h6",null,"Настройка YClients",-1),lF={class:"row"},iF={class:"col-md-12"},nF={class:"mb-2"},aF=e("label",{class:"form-label d-flex justify-content-between mt-2",for:"login"},[m(" Логин "),e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно")],-1),dF={class:"mb-2"},rF=e("label",{class:"form-label d-flex justify-content-between mt-2",for:"password"},[m(" Пароль "),e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно")],-1),cF={class:"mb-2"},uF=e("label",{class:"form-label d-flex justify-content-between mt-2",for:"partner_token"},[m(" Партнерский тоукен "),e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно")],-1),mF={class:"mb-2"},hF=e("label",{class:"form-label d-flex justify-content-between mt-2",for:"partner_token"},[m(" ID компании, в которую записывать клиентов "),e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно")],-1),_F=e("button",{class:"btn btn-success w-100 r mb-3 text-uppercase font-900"}," Сохранить ",-1);function pF(o,t,s,d,n,a){return l(),i(f,null,[oF,e("form",{onSubmit:t[4]||(t[4]=C((...h)=>a.submitYClients&&a.submitYClients(...h),["prevent"]))},[e("div",lF,[e("div",iF,[e("div",nF,[aF,c(e("input",{type:"text",id:"login",class:"form-control",placeholder:"Ваш логин","aria-label":"Ваш логин","onUpdate:modelValue":t[0]||(t[0]=h=>n.yClientsForm.login=h),"aria-describedby":"Ваш логин",required:""},null,512),[[_,n.yClientsForm.login]])]),e("div",dF,[rF,c(e("input",{type:"text",id:"password",class:"form-control",placeholder:"Ваш пароль","aria-label":"Ваш пароль","onUpdate:modelValue":t[1]||(t[1]=h=>n.yClientsForm.password=h),"aria-describedby":"Ваш пароль",required:""},null,512),[[_,n.yClientsForm.password]])]),e("div",cF,[uF,c(e("input",{type:"text",id:"partner_token",class:"form-control",placeholder:"Ваш партнерский тоукен","aria-label":"Ваш партнерский тоукен","onUpdate:modelValue":t[2]||(t[2]=h=>n.yClientsForm.partner_token=h),"aria-describedby":"Ваш партнерский тоукен",required:""},null,512),[[_,n.yClientsForm.partner_token]])]),e("div",mF,[hF,c(e("input",{type:"number",id:"throttle",class:"form-control",placeholder:"ID компании","aria-label":"ID компании","onUpdate:modelValue":t[3]||(t[3]=h=>n.yClientsForm.company=h),"aria-describedby":"ID компании",required:""},null,512),[[_,n.yClientsForm.company]])])])]),_F],32)],64)}const bF=U(sF,[["render",pF]]),fF={class:"py-2"},gF={class:"nav nav-tabs"},vF={class:"nav-item"},yF={class:"nav-item"},$F={key:0,class:"row"},kF={class:"col-12 py-2"},FF={key:1,class:"row"},wF={class:"col-12 py-2"},CF={class:"col-12"},SF={props:["bot"],data(){return{tab:1,load:!1,loadMailingTable:!1}},mounted(){},methods:{callbackPersonalMail(){this.loadMailingTable=!0,this.$nextTick(()=>{this.loadMailingTable=!1})}}},jF=Object.assign(SF,{__name:"Mail",setup(o){return(t,s)=>(l(),i("div",fF,[e("ul",gF,[e("li",vF,[e("a",{class:g(["nav-link",{active:t.tab===0}]),onClick:s[0]||(s[0]=d=>t.tab=0),"aria-current":"page",href:"#"},"Рассылка в канал",2)]),e("li",yF,[e("a",{class:g(["nav-link",{active:t.tab===1}]),onClick:s[1]||(s[1]=d=>t.tab=1),href:"#"},"Рассылка в бота",2)])]),t.tab===0?(l(),i("div",$F,[e("div",kF,[b($e)])])):r("",!0),t.tab===1?(l(),i("div",FF,[e("div",wF,[b(ke,{onCallback:t.callbackPersonalMail},null,8,["onCallback"])]),e("div",CF,[t.loadMailingTable?r("",!0):(l(),y(Fe,{key:0,bot:o.bot},null,8,["bot"]))])])):r("",!0)]))}}),VF={data(){return{load:!1,bot:null,fieldTypes:[{title:"Текст",value:0},{title:"Число",value:1},{title:"Логический",value:2},{title:"Дата и время",value:3}],fieldForm:{fields:[]}}},computed:{...S(["getCurrentBot"])},mounted(){this.loadCurrentBot().then(()=>{this.bot=this.getCurrentBot,this.$nextTick(()=>{this.fieldForm.fields=this.bot.field_settings||[]}),this.loadCurrentBotFields()})},methods:{loadCurrentBotFields(){return this.$store.dispatch("loadCurrentBotFields",{bot_id:this.bot.id}).then(o=>{this.fieldForm.fields=o.data||[]})},loadCurrentBot(o=null){return this.$store.dispatch("updateCurrentBot",{bot:o}).then(()=>{this.bot=this.getCurrentBot})},removeField(o){this.fieldForm.fields.splice(o,1)},submit(){let o=new FormData;Object.keys(this.fieldForm).forEach(t=>{const s=this.fieldForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),o.append("bot_id",this.bot.id),this.$store.dispatch("storeBotFields",{dataObject:o}).then(t=>{this.$notify({title:"Конструктор ботов",text:"Поля успешно обновлены",type:"success"}),this.fieldForm.fields=[],this.fieldForm.fields=t.data}).catch(t=>{this.$notify({title:"Конструктор ботов",text:"Ошибка обновления полей",type:"error"})})},addField(){if(this.fieldForm.fields||(this.fieldForm.fields=[]),this.fieldForm.fields.length>0&&this.fieldForm.fields.findIndex(t=>t.key==null)!==-1){this.$notify({title:"Настраиваемые поля",text:"У вас есть пустые ключевые поля!",type:"error"});return}this.fieldForm.fields.push({key:null,type:0,label:null,description:null,required:!1,validate_pattern:null})}}},qF={class:"mb-2"},zF={class:"d-flex justify-content-between"},PF=e("h6",null,"Настройка полей пользователя бота",-1),UF=e("i",{class:"fa-solid fa-plus mr-2"},null,-1),OF=e("p",null,[e("em",null,"Данные поля будут добавлены пользователю бота и будут автоматически учитываться в условиях страниц, скриптах (в формах заполнения данных), диалогах. Ключи должны быть уникальные для каждого бота. Если ключ дублируется, то будет использовано более позднее его значение. Если поле добавлено и сохранено, то удалить его уже нельзя, только скрыть. "),m(". "),e("br"),e("span",{class:"text-danger"},"*"),m(" - обязательное поле ")],-1),AF={class:"table"},IF=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"#"),e("th",{scope:"col"},[m("Ключ"),e("span",{class:"text-danger"},"*")]),e("th",{scope:"col"},[m("Подпись поля"),e("span",{class:"text-danger"},"*")]),e("th",{scope:"col"},[m("Тип поля"),e("span",{class:"text-danger"},"*")]),e("th",{scope:"col"},"Паттерн"),e("th",{scope:"col"},"Обязательный"),e("th",{scope:"col"},[m("Вопрос для анкеты"),e("span",{class:"text-danger"},"*")]),e("th",{scope:"col"})])],-1),QF={scope:"row"},TF={scope:"col"},MF=["onUpdate:modelValue"],DF={scope:"col"},RF=["onUpdate:modelValue"],BF={scope:"col"},EF=["onUpdate:modelValue"],LF=["value"],KF={scope:"col"},NF=["disabled","onUpdate:modelValue"],JF={scope:"col"},HF={class:"form-check"},YF=["onUpdate:modelValue","id"],GF=["for"],WF={key:0},XF={key:1},ZF={scope:"col"},xF=["onUpdate:modelValue"],ew={scope:"col"},tw=["onClick"],sw=e("i",{class:"fa-regular fa-trash-can"},null,-1),ow=[sw],lw={key:1,class:"form-check mt-2"},iw=["onUpdate:modelValue","id"],nw=["for"],aw={key:0},dw=e("i",{class:"fa-solid fa-eye text-success"},null,-1),rw=[dw],cw={key:1},uw=e("i",{class:"fa-solid fa-eye-slash text-danger"},null,-1),mw=[uw],hw=e("button",{type:"submit",class:"btn btn-success w-100 p-3"}," Сохранить поля ",-1);function _w(o,t,s,d,n,a){return l(),i("div",qF,[e("div",zF,[PF,e("button",{type:"button",onClick:t[0]||(t[0]=h=>a.addField()),class:"btn mb-2 rounded-sm btn-outline-info"},[UF,m(" Добавить параметр ")])]),OF,e("form",{onSubmit:t[1]||(t[1]=C((...h)=>a.submit&&a.submit(...h),["prevent"]))},[e("table",AF,[IF,e("tbody",null,[(l(!0),i(f,null,$(n.fieldForm.fields,(h,p)=>(l(),i("tr",null,[e("th",QF,u(p+1),1),e("th",TF,[c(e("input",{type:"text",class:"form-control mb-2 w-100",placeholder:"Ключ","aria-label":"Ключ",maxlength:"255","onUpdate:modelValue":F=>n.fieldForm.fields[p].key=F,required:""},null,8,MF),[[_,n.fieldForm.fields[p].key]])]),e("th",DF,[c(e("input",{type:"text",class:"form-control mb-2 w-100",placeholder:"Подпись поля","aria-label":"Название поля",maxlength:"255","onUpdate:modelValue":F=>n.fieldForm.fields[p].label=F,required:""},null,8,RF),[[_,n.fieldForm.fields[p].label]])]),e("th",BF,[c(e("select",{class:"form-select","onUpdate:modelValue":F=>n.fieldForm.fields[p].type=F},[(l(!0),i(f,null,$(n.fieldTypes,F=>(l(),i("option",{value:F.value},u(F.title||"Не указан"),9,LF))),256))],8,EF),[[T,n.fieldForm.fields[p].type]])]),e("th",KF,[c(e("input",{type:"text",class:"form-control mb-2 w-100",placeholder:"Паттерн","aria-label":"Паттерн",maxlength:"255",disabled:n.fieldForm.fields[p].type===2,"onUpdate:modelValue":F=>n.fieldForm.fields[p].validate_pattern=F},null,8,NF),[[_,n.fieldForm.fields[p].validate_pattern]])]),e("th",JF,[e("div",HF,[c(e("input",{class:"form-check-input","onUpdate:modelValue":F=>n.fieldForm.fields[p].required=F,type:"checkbox",value:"",id:"field-required"+p},null,8,YF),[[k,n.fieldForm.fields[p].required]]),e("label",{class:"form-check-label",for:"field-required"+p},[n.fieldForm.fields[p].required?(l(),i("span",WF,"Да")):r("",!0),n.fieldForm.fields[p].required?r("",!0):(l(),i("span",XF,"Нет"))],8,GF)])]),e("th",ZF,[c(e("input",{type:"text",class:"form-control mb-2 w-100",placeholder:"Описание вопроса","aria-label":"Описание вопроса",maxlength:"255","onUpdate:modelValue":F=>n.fieldForm.fields[p].description=F,required:""},null,8,xF),[[_,n.fieldForm.fields[p].description]])]),e("th",ew,[n.fieldForm.fields[p].id?(l(),i("div",lw,[c(e("input",{class:"form-check-input d-none","onUpdate:modelValue":F=>n.fieldForm.fields[p].is_active=F,type:"checkbox",value:"",id:"field-is_active-"+p},null,8,iw),[[k,n.fieldForm.fields[p].is_active]]),e("label",{class:"form-check-label",for:"field-is_active-"+p},[n.fieldForm.fields[p].is_active?(l(),i("span",aw,rw)):r("",!0),n.fieldForm.fields[p].is_active?r("",!0):(l(),i("span",cw,mw))],8,nw)])):(l(),i("button",{key:0,type:"button",onClick:F=>a.removeField(p),class:"btn btn-link text-danger"},ow,8,tw))])]))),256))])]),hw],32)])}const pw=U(VF,[["render",_w]]),bw={class:"row"},fw={class:"input-group mb-3"},gw={key:0,class:"row"},vw={class:"col-12 col-md-12 mb-3"},yw={class:"table"},$w=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"#"),e("th",{scope:"col"},"Тип"),e("th",{scope:"col"},"Подпись"),e("th",{scope:"col"},"File Id"),e("th",{scope:"col"},"Действия")])],-1),kw={scope:"row"},Fw={class:"badge bg-info rounded-pill"},ww={style:{"word-break":"break-all"}},Cw={style:{"word-break":"break-all"}},Sw={style:{"min-width":"200px"}},jw=["onClick"],Vw=e("i",{class:"fa-solid fa-eye"},null,-1),qw=[Vw],zw=["onClick"],Pw=e("i",{class:"fa-brands fa-telegram"},null,-1),Uw=[Pw],Ow=["onClick"],Aw=e("i",{class:"fa-solid fa-trash"},null,-1),Iw=[Aw],Qw={class:"col-12"},Tw={key:1,class:"row"},Mw=e("div",{class:"col-12"},[e("div",{class:"alert alert-warning",role:"alert"}," У выбранного бота нет медиа-файлов ")],-1),Dw=[Mw],Rw={class:"modal fade",id:"preview-modal",tabindex:"-1","aria-labelledby":"preview-modal-label","aria-hidden":"true"},Bw={class:"modal-dialog"},Ew={class:"modal-content"},Lw={class:"modal-body"},Kw={key:0,class:"d-flex justify-content-center align-items-center"},Nw=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),Jw={data(){return{bot:null,previewContent:null,loading:!0,media:[],search:null,media_paginate_object:null}},computed:{...S(["getMedia","getMediaPaginateObject","getCurrentBot"])},mounted(){this.loadCurrentBot().then(()=>{this.loadMedia()})},methods:{selectMedia(o){this.$emit("select",o)},loadCurrentBot(o=null){return this.$store.dispatch("updateCurrentBot",{bot:o}).then(()=>{this.bot=this.getCurrentBot})},nextMedia(o){this.loadMedia(o)},remove(o){this.$store.dispatch("removeMedia",{dataObject:{mediaId:o}}).then(t=>{this.loadMedia(),this.$notify({title:"Удаление медиа-контента",text:"Медиа контент удален"})}).catch(()=>{})},showPreview(o){this.previewContent=null,this.$nextTick(()=>{this.previewContent=o,new bootstrap.Modal("#preview-modal",{}).show()})},showPreviewInTg(o){this.$store.dispatch("showMediaPreview",{dataObject:{mediaId:o}}).then(t=>{this.$notify({title:"Превью медиа-контента",text:"Отправлено в бота"})}).catch(()=>{})},loadMedia(o=0){this.loading=!0,this.$store.dispatch("loadMedia",{dataObject:{bot_id:this.bot.id||null,search:this.search,needVideo:!0,needVideoNote:!0,needPhoto:!0,needAudio:!0,needDocument:!0,needSticker:!0},page:o}).then(t=>{this.loading=!1,this.media=this.getMedia,this.media_paginate_object=this.getMediaPaginateObject}).catch(()=>{this.loading=!1})}}},Hw=Object.assign(Jw,{__name:"BotMediaTable",setup(o){return(t,s)=>(l(),i(f,null,[e("div",bw,[e("div",fw,[c(e("input",{type:"search",class:"form-control",placeholder:"Поиск файла","aria-label":"Поиск файла","onUpdate:modelValue":s[0]||(s[0]=d=>t.search=d)},null,512),[[_,t.search]]),e("button",{class:"btn btn-outline-secondary",onClick:s[1]||(s[1]=d=>t.loadMedia(0)),type:"button",id:"button-addon2"},"Найти ")])]),t.media.length>0?(l(),i("div",gw,[e("div",vw,[e("table",yw,[$w,e("tbody",null,[(l(!0),i(f,null,$(t.media,(d,n)=>(l(),i("tr",null,[e("th",kw,u(d.id),1),e("td",null,[e("span",Fw,u(d.type),1)]),e("td",null,[e("p",ww,u(d.caption??"Без подписи"),1)]),e("td",null,[e("p",Cw,u(d.file_id),1)]),e("td",null,[e("div",Sw,[e("a",{href:"javascript:void(0)",class:"btn btn-info mr-2",onClick:a=>t.showPreview(d)},qw,8,jw),e("a",{href:"javascript:void(0)",class:"btn btn-info mr-2",onClick:a=>t.showPreviewInTg(d.id)},Uw,8,zw),e("a",{href:"javascript:void(0)",class:"btn btn-outline-danger text-danger",onClick:a=>t.remove(d.id)},Iw,8,Ow)])])]))),256))])])]),e("div",Qw,[t.media_paginate_object?(l(),y(q,{key:0,onPagination_page:t.nextMedia,pagination:t.media_paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])])):(l(),i("div",Tw,Dw)),e("div",Rw,[e("div",Bw,[e("div",Ew,[e("div",Lw,[t.previewContent!=null?(l(),i("div",Kw,[b(Z,{type:t.previewContent.type,content:t.previewContent.file_id},null,8,["type","content"])])):r("",!0)]),Nw])])])],64))}}),Yw={class:"row"},Gw={class:"col-12 mb-3"},Ww={class:"form-label",id:"service-title"},Xw=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Zw=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),xw={class:"col-12 mb-3"},eC={key:0},tC=["onClick"],sC={class:"form-label",id:"service-category"},oC=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),lC=e("div",null,"Категория услуги (используется для группировки) ",-1),iC=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),nC={class:"col-12 mb-3"},aC={class:"form-label",id:"service-description"},dC=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),rC=e("div",null," Краткая информация об оказываемой услуге ",-1),cC=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),uC={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},mC={class:"col-12 col-md-6 mb-3"},hC={class:"form-label",id:"service-title"},_C=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),pC=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),bC={class:"col-12 col-md-6 mb-3"},fC={class:"form-label",id:"service-title"},gC=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),vC=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),yC={class:"col-12 mb-3"},$C={class:"form-check"},kC=e("label",{class:"form-check-label",for:"need_images"}," Необходимо добавить изображения к сервиус ",-1),FC={key:0,class:"col-12 mb-3"},wC={class:"form-label",id:"service-images"},CC=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),SC=e("div",null," Изображение, которое видит пользователь при выборе услуги ",-1),jC=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),VC={class:"col-12 mb-3"},qC={class:"form-check"},zC=e("label",{class:"form-check-label",for:"need_prepayment"}," Необходима предоплата ",-1),PC={class:"row"},UC={class:"col-12"},OC={type:"submit",class:"btn btn-outline-success w-100 p-3"},AC={key:0},IC={key:1},QC={props:["eventId","bot","service"],data(){return{load:!1,need_reset:!1,need_images:!1,categories:[],serviceForm:{id:null,title:null,appointment_event_id:null,description:null,category:null,images:[],need_prepayment:!1,price:0,discount_price:0}}},watch:{serviceForm:{handler(o){this.need_reset=!0},deep:!0}},mounted(){this.loadAppointmentServiceCategories(),console.log("Service form",this.service),this.service&&this.$nextTick(()=>{this.serviceForm={id:this.service.id||null,appointment_event_id:this.service.appointment_event_id||null,title:this.service.title||null,category:this.service.category||null,description:this.service.description||null,images:this.service.images||[],need_prepayment:this.service.need_prepayment||!1,price:this.service.price||0,discount_price:this.service.discount_price||0}})},methods:{loadAppointmentServiceCategories(){this.$store.dispatch("loadAppointmentServiceCategories",{dataObject:{bot_id:this.bot.id||null,event_id:this.eventId||null}}).then(o=>{this.categories=o})},selectPhotos(o){this.serviceForm.images||(this.serviceForm.images=[]);let t=this.serviceForm.images.indexOf(o.file_id);t!==-1?this.serviceForm.images.splice(t,1):this.serviceForm.images.push(o.file_id)},resetForm(){},submitForm(){let o=new FormData;Object.keys(this.serviceForm).forEach(t=>{const s=this.serviceForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),o.append("bot_id",this.bot.id),o.append("appointment_event_id",this.eventId),this.$store.dispatch(this.serviceForm.id===null?"addAppointmentService":"updateAppointmentService",{appointmentServiceForm:o}).then(t=>{this.$emit("callback",t.data),this.$notify("Услуги успешно создано")}).catch(t=>{this.$notify("Услуги создания события")})}}},TC=Object.assign(QC,{__name:"AppointmentServiceForm",setup(o){return(t,s)=>{const d=z("Popper");return l(),i("form",{onSubmit:s[7]||(s[7]=C((...n)=>t.submitForm&&t.submitForm(...n),["prevent"]))},[e("div",Yw,[e("div",Gw,[e("label",Ww,[b(d,{content:"Название оказываемой услуги"},{default:v(()=>[Xw]),_:1}),m(" Название услуги "),Zw]),c(e("input",{type:"text",class:"form-control",placeholder:"Название","aria-label":"Название","onUpdate:modelValue":s[0]||(s[0]=n=>t.serviceForm.title=n),maxlength:"255","aria-describedby":"service-title",required:""},null,512),[[_,t.serviceForm.title]])]),e("div",xw,[t.categories?(l(),i("p",eC,[m(" Ранее созданные категории: "),(l(!0),i(f,null,$(t.categories,n=>(l(),i("span",{onClick:a=>t.serviceForm.category=n,class:"badge bg-primary mr-1 cursor-pointer"},u(n),9,tC))),256))])):r("",!0),e("label",sC,[b(d,null,{content:v(()=>[lC]),default:v(()=>[oC]),_:1}),m(" Категория услуги "),iC]),c(e("input",{type:"text",class:"form-control",placeholder:"Категория услуги","aria-label":"Категория услуги","onUpdate:modelValue":s[1]||(s[1]=n=>t.serviceForm.category=n),maxlength:"255","aria-describedby":"service-category",required:""},null,512),[[_,t.serviceForm.category]])]),e("div",nC,[e("label",aC,[b(d,null,{content:v(()=>[rC]),default:v(()=>[dC]),_:1}),m(" Описание услуги "),cC,t.serviceForm.description?(l(),i("small",uC," Длина текста "+u(t.serviceForm.description.length)+" / 255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Описание услуги","aria-label":"Описание услуги",maxlength:"255","onUpdate:modelValue":s[2]||(s[2]=n=>t.serviceForm.description=n),"aria-describedby":"service-description",required:""},`
                    `,512),[[_,t.serviceForm.description]])]),e("div",mC,[e("label",hC,[b(d,{content:"Цена оказываемой услуги"},{default:v(()=>[_C]),_:1}),m(" Цена услуги, руб "),pC]),c(e("input",{type:"number",class:"form-control",placeholder:"Цена","aria-label":"Цена",min:"0","onUpdate:modelValue":s[3]||(s[3]=n=>t.serviceForm.price=n),"aria-describedby":"price",required:""},null,512),[[_,t.serviceForm.price]])]),e("div",bC,[e("label",fC,[b(d,{content:"Цена скидки на оказываемую услугу"},{default:v(()=>[gC]),_:1}),m(" Цена скидки на услугу, руб "),vC]),c(e("input",{type:"number",class:"form-control",placeholder:"Цена","aria-label":"Цена",min:"0","onUpdate:modelValue":s[4]||(s[4]=n=>t.serviceForm.discount_price=n),"aria-describedby":"price",required:""},null,512),[[_,t.serviceForm.discount_price]])]),e("div",yC,[e("div",$C,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[5]||(s[5]=n=>t.need_images=n),type:"checkbox",id:"need_images"},null,512),[[k,t.need_images]]),kC])]),t.need_images?(l(),i("div",FC,[e("label",wC,[b(d,null,{content:v(()=>[SC]),default:v(()=>[CC]),_:1}),m(" Изображение к услуге "),jC]),b(P,{"need-photo":!0,selected:t.serviceForm.images,onSelect:t.selectPhotos},null,8,["selected","onSelect"])])):r("",!0),e("div",VC,[e("div",qC,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[6]||(s[6]=n=>t.serviceForm.need_prepayment=n),type:"checkbox",id:"need_prepayment"},null,512),[[k,t.serviceForm.need_prepayment]]),zC])])]),e("div",PC,[e("div",UC,[e("button",OC,[t.serviceForm.id===null?(l(),i("span",AC,"Создать услугу")):(l(),i("span",IC,"Обновить услугу"))])])])],32)}}}),MC={class:"row py-3"},DC={class:"col-12"},RC={class:"row"},BC={class:"col-12"},EC={key:0},LC={key:1},KC={key:0,class:"col-12 mb-3"},NC={class:"col-12 mb-3"},JC={key:0},HC={key:1},YC={key:1,class:"col-12 mb-3"},GC={class:"row py-3"},WC=e("div",{class:"col-12"},[e("p",{class:"mb-0"},"Выбор статуса")],-1),XC={class:"col-md-3"},ZC=["onClick"],xC={class:"row"},e4={class:"col-12 mb-3"},t4={class:"form-label",id:"service-title"},s4=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),o4=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),l4={class:"col-12 mb-3"},i4={class:"form-label",id:"service-title"},n4=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),a4=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),d4={class:"col-12 mb-3"},r4={class:"form-label",id:"appointment-info"},c4=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),u4=e("div",null," Краткая информация от клиента ",-1),m4=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),h4={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},_4={class:"row"},p4={class:"col-12"},b4={type:"submit",class:"btn btn-outline-success w-100 p-3"},f4={key:0},g4={key:1},v4={props:["eventId","bot","appointment"],data(){return{step:0,load:!1,selected_schedule_time:null,selected_bot_user:null,need_load_users:!1,need_schedule_time:!1,statuses:[{value:0,title:"Новая запись"},{value:1,title:"Подтверждение записи"},{value:2,title:"Прохождение по записи"},{value:3,title:"Отмена записи"}],days:["понедельник","вторник","среду","четверг","пятницу","субботу","воскресенье"],appointmentForm:{id:null,appointment_event_id:null,appointment_schedule_id:null,bot_user_id:null,status:0,name:null,phone:null,info:null}}},mounted(){this.appointment&&this.$nextTick(()=>{this.appointmentForm={id:this.appointment.id||null,appointment_event_id:this.appointment.appointment_event_id||null,appointment_schedule_id:this.appointment.appointment_schedule_id||null,bot_user_id:this.appointment.bot_user_id||null,status:this.appointment.status||0,name:this.appointment.name||null,phone:this.appointment.phone||null,info:this.appointment.info||null},this.selected_schedule_time=this.appointment.schedule||null,this.selected_bot_user=this.appointment.botUser||null})},methods:{selectScheduleTime(o){if(o.appointment){this.$notify("Данное время уже занято!");return}this.selected_schedule_time=o,this.need_schedule_time=!1},selectBotUser(o){this.selected_bot_user=o,this.need_load_users=!1},clearAppointmentForm(){this.appointmentForm={id:null,appointment_event_id:null,appointment_schedule_id:null,bot_user_id:null,status:0},this.selected_schedule_time=null,this.selected_bot_user=null},submitForm(){this.appointmentForm.bot_user_id=this.selected_bot_user.id,this.appointmentForm.appointment_schedule_id=this.selected_schedule_time.id,this.appointmentForm.appointment_event_id=this.eventId;let o=new FormData;Object.keys(this.appointmentForm).forEach(t=>{const s=this.appointmentForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),o.append("bot_id",this.bot.id),this.$store.dispatch("storeAppointment",{dataObject:{appointmentForm:o}}).then(t=>{this.clearAppointmentForm(),this.$emit("callback"),this.$notify("Запись успешно создана")}).catch(t=>{this.$notify("Ошибка создания записи")})}}},y4=Object.assign(v4,{__name:"AppointmentForm",setup(o){return(t,s)=>{const d=z("Popper"),n=Q("mask");return l(),i(f,null,[e("div",MC,[e("div",DC,[e("button",{onClick:s[0]||(s[0]=(...a)=>t.clearAppointmentForm&&t.clearAppointmentForm(...a)),class:"btn btn-primary"},"Новая заявка ")])]),e("form",{onSubmit:s[6]||(s[6]=C((...a)=>t.submitForm&&t.submitForm(...a),["prevent"]))},[e("div",RC,[e("div",BC,[e("a",{href:"javascript:void(0)",class:"btn btn-link",onClick:s[1]||(s[1]=a=>t.need_load_users=!t.need_load_users)},[t.selected_bot_user==null?(l(),i("span",EC,"Выберите пользователя")):r("",!0),t.selected_bot_user?(l(),i("span",LC," Пользователь "+u(t.selected_bot_user.name||t.selected_bot_user.fio_from_telegram||t.selected_bot_user.telegram_chat_id||"-"),1)):r("",!0)])]),t.need_load_users?(l(),i("div",KC,[b(J,{simple:!0,onSelect:t.selectBotUser},null,8,["onSelect"])])):r("",!0),e("div",NC,[e("a",{href:"javascript:void(0)",class:"btn btn-link",onClick:s[2]||(s[2]=a=>t.need_schedule_time=!t.need_schedule_time)},[t.selected_schedule_time==null?(l(),i("span",JC,"Выберите время в расписании")):r("",!0),t.selected_schedule_time?(l(),i("span",HC," Запись на "+u(t.days[t.selected_schedule_time.day-1]||"-")+" с "+u(t.selected_schedule_time.start_time||"-")+" до "+u(t.selected_schedule_time.end_time||"-"),1)):r("",!0)])]),t.need_schedule_time?(l(),i("div",YC,[b(ce,{"event-id":o.eventId,bot:o.bot,onSelect:t.selectScheduleTime},null,8,["event-id","bot","onSelect"])])):r("",!0)]),e("div",GC,[WC,(l(!0),i(f,null,$(t.statuses,a=>(l(),i("div",XC,[e("button",{type:"button",class:g([{"btn-success text-white":t.appointmentForm.status==a.value},"btn btn-outline-success w-100"]),onClick:h=>t.appointmentForm.status=a.value},u(a.title||"не указано"),11,ZC)]))),256))]),e("div",xC,[e("div",e4,[e("label",t4,[b(d,{content:"ФИО человека, который посетит запись"},{default:v(()=>[s4]),_:1}),m(" Ф.И.О. посетителя "),o4]),c(e("input",{type:"text",class:"form-control",placeholder:"Иванов Иван Иванович","aria-label":"ФИО","onUpdate:modelValue":s[3]||(s[3]=a=>t.appointmentForm.name=a),maxlength:"255","aria-describedby":"appointment-name",required:""},null,512),[[_,t.appointmentForm.name]])]),e("div",l4,[e("label",i4,[b(d,{content:"Номер телефона человека, который посетит запись"},{default:v(()=>[n4]),_:1}),m(" Телефонный номер "),a4]),c(e("input",{type:"text",class:"form-control",placeholder:"+7(000)000-00-00","aria-label":"номер телефона","onUpdate:modelValue":s[4]||(s[4]=a=>t.appointmentForm.phone=a),maxlength:"255","aria-describedby":"appointment-phone",required:""},null,512),[[n,"+7(###)###-##-##"],[_,t.appointmentForm.phone]])]),e("div",d4,[e("label",r4,[b(d,null,{content:v(()=>[u4]),default:v(()=>[c4]),_:1}),m(" Описание услуги "),m4,t.appointmentForm.info?(l(),i("small",h4," Длина текста "+u(t.appointmentForm.info.length)+" / 255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Информация от клиента","aria-label":"Информация от клиента",maxlength:"255","onUpdate:modelValue":s[5]||(s[5]=a=>t.appointmentForm.info=a),"aria-describedby":"appointment-info",required:""},`
                    `,512),[[_,t.appointmentForm.info]])])]),e("div",_4,[e("div",p4,[e("button",b4,[t.appointmentForm.id==null?(l(),i("span",f4,"Записаться")):(l(),i("span",g4,"Обновить запись"))])])])],32)],64)}}}),$4={class:"row"},k4={class:"col-12"},F4={key:0,class:"table"},w4=e("th",{scope:"col"},"Действие",-1),C4=["onClick"],S4={scope:"row"},j4={key:0},V4={key:0,class:"dropdown"},q4=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),z4={class:"dropdown-menu"},P4={key:0},U4=["onClick"],O4={key:1},A4={class:"col-12"},I4={props:["bot","eventId"],data(){return{direction:"desc",order:"updated_at",show:!0,is_group:!1,loading:!0,services:[],search:null,statuses:["Новая запись","Подтверждение записи","Прохождение по записи","Отмена записи"],days:["понедельник","вторник","среду","четверг","пятницу","субботу","воскресенье"],paginate_object:null}},computed:{...S(["getAppointments","getAppointmentsPaginateObject"])},mounted(){this.loadAppointments()},methods:{nextAppointments(o){this.loadAppointments(o)},selectAppointment(o){this.$emit("select",o)},loadAndOrder(o){this.order=o,this.direction=this.direction==="desc"?"asc":"desc",this.loadAppointments(0)},removeAppointment(o){this.loading=!0,this.$store.dispatch("removeAppointment",{dataObject:{appointmentId:o}}).then(t=>{this.loading=!1,this.loadAppointments(0),this.$notify("Запись успешно удалена")}).catch(()=>{this.loading=!1,this.$notify("Ошибка удаления записи")})},loadAppointments(o=0){this.loading=!0,this.$store.dispatch("loadAppointments",{dataObject:{event_id:this.eventId,bot_id:this.bot.id||null,search:this.search,order:this.order,direction:this.direction},page:o,size:100}).then(t=>{this.loading=!1,this.services=this.getAppointments,this.paginate_object=this.getAppointmentsPaginateObject}).catch(()=>{this.loading=!1})}}},Q4=Object.assign(I4,{__name:"AppointmentsTable",setup(o){return(t,s)=>(l(),i("div",$4,[e("div",k4,[t.services.length>0?(l(),i("table",F4,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:s[0]||(s[0]=d=>t.loadAndOrder("id"))},"#"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[1]||(s[1]=d=>t.loadAndOrder("bot_user_id"))},"Пользователь"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[2]||(s[2]=d=>t.loadAndOrder("appointment_schedule_id"))},"Дата записи "),e("th",{scope:"col",class:"cursor-pointer",onClick:s[3]||(s[3]=d=>t.loadAndOrder("status"))},"Статус"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[4]||(s[4]=d=>t.loadAndOrder("name"))},"Посетитель"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[5]||(s[5]=d=>t.loadAndOrder("phone"))},"Телефон посетителя"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[6]||(s[6]=d=>t.loadAndOrder("info"))},"Доп.инф"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[7]||(s[7]=d=>t.loadAndOrder("updated_at"))},"Дата изменения"),w4])]),e("tbody",null,[(l(!0),i(f,null,$(t.services,(d,n)=>(l(),i("tr",{onClick:a=>t.selectAppointment(d),class:g({"border-info":d.deleted_at==null,"border-danger":d.deleted_at!=null})},[e("th",S4,u(d.id),1),e("td",null,u(d.botUser.fio_from_telegram||d.botUser.telegram_chat_id||"Не указано"),1),e("td",null,[d.schedule?(l(),i("p",j4," Запись на "+u(t.days[d.schedule.day-1]||"Не указано")+" с "+u(d.schedule.start_time||"Не указано")+" до "+u(d.schedule.end_time||"Не указано"),1)):r("",!0)]),e("td",null,u(t.statuses[d.status]),1),e("td",null,u(t.$filters.current(d.updated_at)),1),e("td",null,u(d.name||"не указано"),1),e("td",null,u(d.phone||"не указано"),1),e("td",null,u(d.info||"не указано"),1),e("td",null,[d.id?(l(),i("div",V4,[q4,e("ul",z4,[d.deleted_at==null?(l(),i("li",P4,[e("a",{class:"dropdown-item",onClick:a=>t.removeAppointment(d.id),href:"javascript:void(0)"},"Удалить",8,U4)])):r("",!0)])])):r("",!0)])],10,C4))),256))])])):(l(),i("p",O4,"На текущий момент нет ни одного созданного сервиса"))]),e("div",A4,[t.paginate_object?(l(),y(q,{key:0,onPagination_page:t.nextAppointments,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])]))}}),T4={class:"row py-2"},M4={class:"col-12"},D4={class:"input-group mb-3"},R4={class:"col-12"},B4={key:0,class:"table"},E4=e("th",{scope:"col"},"Действие",-1),L4={scope:"row"},K4=["onClick"],N4={key:0,class:"fa-solid fa-chevron-down text-success"},J4={key:1,class:"fa-solid fa-xmark text-danger"},H4={key:0,class:"dropdown"},Y4=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),G4={class:"dropdown-menu"},W4={key:0},X4=["onClick"],Z4={key:1},x4=["onClick"],e8={key:1},t8={class:"col-12"},s8={props:["bot"],data(){return{direction:"desc",order:"updated_at",show:!0,is_group:!1,loading:!0,events:[],search:null,paginate_object:null}},computed:{...S(["getAppointmentEvents","getAppointmentEventsPaginateObject"])},mounted(){this.loadAppointmentEvents()},methods:{duplicateAppointmentEvent(o){this.loading=!0,this.$store.dispatch("duplicateAppointmentEvent",{dataObject:{appointmentEventId:o,bot_id:this.bot.id}}).then(t=>{this.loading=!1,this.loadAppointmentEvents(0),this.$notify("Событие успешно продублировано")}).catch(()=>{this.loading=!1,this.$notify("Ошибка дублирования события")})},removeAppointmentEvent(o){this.loading=!0,this.$store.dispatch("removeAppointmentEvent",{dataObject:{appointmentEventId:o}}).then(t=>{this.loading=!1,this.loadAppointmentEvents(0),this.$notify("Событие успешно удалено")}).catch(()=>{this.loading=!1,this.$notify("Ошибка удаления события")})},nextAppointmentEvents(o){this.loadAppointmentEvents(o)},selectEvent(o){this.$emit("select",o)},loadAndOrder(o){this.order=o,this.direction=this.direction==="desc"?"asc":"desc",this.loadAppointmentEvents(0)},loadAppointmentEvents(o=0){this.loading=!0,this.$store.dispatch("loadAppointmentEvents",{dataObject:{bot_id:this.bot.id||null,search:this.search,is_group:this.is_group,order:this.order,direction:this.direction},page:o,size:20}).then(t=>{this.loading=!1,this.events=this.getAppointmentEvents,this.paginate_object=this.getAppointmentEventsPaginateObject}).catch(()=>{this.loading=!1})}}},o8=Object.assign(s8,{__name:"AppointmentEventTable",setup(o){return(t,s)=>(l(),i("div",T4,[e("div",M4,[e("div",D4,[c(e("input",{type:"search",class:"form-control",placeholder:"Поиск события","aria-label":"Поиск события","onUpdate:modelValue":s[0]||(s[0]=d=>t.search=d),"aria-describedby":"appointment-search-event"},null,512),[[_,t.search]]),e("button",{class:"btn btn-outline-secondary",onClick:s[1]||(s[1]=d=>t.loadAppointmentEvents(0)),type:"button",id:"appointment-search-event"},"Найти ")])]),e("div",R4,[t.events.length>0?(l(),i("table",B4,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:s[2]||(s[2]=d=>t.loadAndOrder("id"))},"#"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[3]||(s[3]=d=>t.loadAndOrder("title"))},"Название"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[4]||(s[4]=d=>t.loadAndOrder("subtitle"))},"Подзаголовок"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[5]||(s[5]=d=>t.loadAndOrder("address"))},"Адрес"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[6]||(s[6]=d=>t.loadAndOrder("description"))},"Описание"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[7]||(s[7]=d=>t.loadAndOrder("is_group"))},"Групповое"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[8]||(s[8]=d=>t.loadAndOrder("updated_at"))},"Дата изменения"),E4])]),e("tbody",null,[(l(!0),i(f,null,$(t.events,(d,n)=>(l(),i("tr",{class:g({"border-info":d.deleted_at==null,"border-danger":d.deleted_at!=null})},[e("th",L4,u(d.id),1),e("td",{onClick:a=>t.selectEvent(d)},u(d.title||"Не указано"),9,K4),e("td",null,u(d.subtitle||"Не указано"),1),e("td",null,u(d.address||"Не указано"),1),e("td",null,u(d.description||"Не указано"),1),e("td",null,[d.is_group?(l(),i("i",N4)):(l(),i("i",J4))]),e("td",null,u(t.$filters.current(d.updated_at)),1),e("td",null,[d.id?(l(),i("div",H4,[Y4,e("ul",G4,[d.deleted_at==null?(l(),i("li",W4,[e("a",{class:"dropdown-item",onClick:a=>t.removeAppointmentEvent(d.id),href:"javascript:void(0)"},"Удалить",8,X4)])):r("",!0),d.deleted_at==null?(l(),i("li",Z4,[e("a",{class:"dropdown-item",onClick:a=>t.duplicateAppointmentEvent(d.id),href:"javascript:void(0)"},"Дублировать",8,x4)])):r("",!0)])])):r("",!0)])],2))),256))])])):(l(),i("p",e8,"На текущий момент нет событий в вашем списке"))]),e("div",t8,[t.paginate_object?(l(),y(q,{key:0,onPagination_page:t.nextAppointmentEvents,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])]))}}),l8={class:"row"},i8={class:"col-12"},n8={key:0,class:"table"},a8=e("th",{scope:"col"},"Действие",-1),d8={scope:"row"},r8=["onClick"],c8={key:0,class:"fa-solid fa-chevron-down text-success"},u8={key:1,class:"fa-solid fa-xmark text-danger"},m8={key:0,class:"dropdown"},h8=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),_8={class:"dropdown-menu"},p8={key:0},b8=["onClick"],f8={key:1},g8={class:"col-12"},v8={props:["bot","eventId"],data(){return{direction:"desc",order:"updated_at",show:!0,is_group:!1,loading:!0,services:[],search:null,paginate_object:null}},computed:{...S(["getAppointmentServices","getAppointmentServicesPaginateObject"])},mounted(){this.loadAppointmentServices()},methods:{nextAppointmentService(o){this.loadAppointmentServices(o)},selectService(o){this.$emit("select",o)},removeAppointmentService(o){this.loading=!0,this.$store.dispatch("removeAppointmentService",{dataObject:{appointmentServiceId:o}}).then(t=>{this.loading=!1,this.loadAppointmentServices(0),this.$notify("Сервис успешно удален")}).catch(()=>{this.loading=!1,this.$notify("Ошибка удаления сервиса")})},loadAndOrder(o){this.order=o,this.direction=this.direction==="desc"?"asc":"desc",this.loadAppointmentServices(0)},loadAppointmentServices(o=0){this.loading=!0,this.$store.dispatch("loadAppointmentServices",{dataObject:{event_id:this.eventId,bot_id:this.bot.id||null,search:this.search,order:this.order,direction:this.direction},page:o,size:100}).then(t=>{this.loading=!1,this.services=this.getAppointmentServices,this.paginate_object=this.getAppointmentServicesPaginateObject}).catch(()=>{this.loading=!1})}}},y8=Object.assign(v8,{__name:"AppointmentServicesTable",setup(o){return(t,s)=>(l(),i("div",l8,[e("div",i8,[t.services.length>0?(l(),i("table",n8,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:s[0]||(s[0]=d=>t.loadAndOrder("id"))},"#"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[1]||(s[1]=d=>t.loadAndOrder("title"))},"Название"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[2]||(s[2]=d=>t.loadAndOrder("subtitle"))},"Подзаголовок"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[3]||(s[3]=d=>t.loadAndOrder("description"))},"Описание"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[4]||(s[4]=d=>t.loadAndOrder("is_group"))},"Групповое"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[5]||(s[5]=d=>t.loadAndOrder("updated_at"))},"Дата изменения"),a8])]),e("tbody",null,[(l(!0),i(f,null,$(t.services,(d,n)=>(l(),i("tr",{class:g({"border-info":d.deleted_at==null,"border-danger":d.deleted_at!=null})},[e("th",d8,u(d.id),1),e("td",{onClick:a=>t.selectService(d)},u(d.title||"Не указано"),9,r8),e("td",null,u(d.subtitle||"Не указано"),1),e("td",null,u(d.description||"Не указано"),1),e("td",null,[d.is_group?(l(),i("i",c8)):(l(),i("i",u8))]),e("td",null,u(t.$filters.current(d.updated_at)),1),e("td",null,[d.id?(l(),i("div",m8,[h8,e("ul",_8,[d.deleted_at==null?(l(),i("li",p8,[e("a",{class:"dropdown-item",onClick:a=>t.removeAppointmentService(d.id),href:"javascript:void(0)"},"Удалить",8,b8)])):r("",!0)])])):r("",!0)])],2))),256))])])):(l(),i("p",f8,"На текущий момент нет ни одного созданого сервиса"))]),e("div",g8,[t.paginate_object?(l(),y(q,{key:0,onPagination_page:t.nextAppointmentService,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])]))}}),$8={class:"row"},k8={class:"col-12 mb-3"},F8={class:"form-label",id:"event-title"},w8=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),C8=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),S8={class:"col-12 mb-3"},j8={class:"form-label",id:"event-subtitle"},V8=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),q8=e("div",null,"Подзаголовок события или доп. инфа под названием события ",-1),z8=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),P8={class:"col-12 mb-3"},U8={class:"form-check"},O8=e("label",{class:"form-check-label",for:"need_add_address"}," Нужно указать адрес и координат мероприятия ",-1),A8={key:0,class:"col-12 mb-3"},I8={class:"form-label",id:"event-address"},Q8=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),T8=e("div",null,"Адрес, указывающий точное место проведения события \\ мероприятия ",-1),M8={key:1,class:"col-12 mb-3"},D8={class:"form-label",id:"event-coords"},R8=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),B8=e("div",null,"Координаты мероприятия ",-1),E8={class:"col-12 mb-3"},L8={class:"form-label",id:"event-description"},K8=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),N8=e("div",null," Краткая информация о происходящем мероприятии ",-1),J8=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),H8={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},Y8={class:"col-12 mb-3"},G8={class:"form-label",id:"event-on_start_appointment"},W8=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),X8=e("div",null," Текст, который будет отображен клиенту, когда тот записался ",-1),Z8=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),x8={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},e6={class:"col-12 mb-3"},t6={class:"form-label",id:"event-on_cancel_appointment"},s6=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),o6=e("div",null," Текст, который будет отображен клиенту, когда тот отменил запись ",-1),l6=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),i6={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},n6={class:"col-12 mb-3"},a6={class:"form-label",id:"event-on_after_appointment"},d6=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),r6=e("div",null," Текст, который будет отображен клиенту, когда тот прошел событие успешно ",-1),c6=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),u6={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},m6={class:"col-12 mb-3"},h6={class:"form-label",id:"event-on_repeat_appointment"},_6=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),p6=e("div",null," Текст, который будет отображен клиенту, когда тот записывается 2й и более раз ",-1),b6=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),f6={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},g6={class:"col-12 mb-3"},v6={class:"form-check"},y6=e("label",{class:"form-check-label",for:"need_media"}," Нужно изображение к событию ",-1),$6={key:2,class:"col-12 mb-3"},k6={class:"form-label",id:"event-images"},F6=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),w6=e("div",null," Изображение, которое видит пользователь при выборе события ",-1),C6=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),S6={class:"col-12 mb-3"},j6={class:"form-check"},V6=e("label",{class:"form-check-label",for:"is-group"}," Является групповым мероприятием ",-1),q6={key:3,class:"col-md-6 col-12 mb-3"},z6={class:"form-label",id:"event-min_people"},P6=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),U6=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),O6={key:4,class:"col-md-6 col-12 mb-3"},A6={class:"form-label",id:"event-max_people"},I6=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Q6=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),T6={class:"row"},M6={class:"col-12"},D6={type:"submit",class:"btn btn-outline-success w-100 p-3"},R6={key:0},B6={key:1},E6={props:["event","bot"],data(){return{step:0,load:!1,need_reset:!1,need_services:!1,need_add_address:!1,need_media:!1,eventForm:{id:null,title:null,subtitle:null,description:null,address:null,coords:null,images:[],services:[],times:[],is_group:!1,max_people:0,min_people:0,on_start_appointment:null,on_cancel_appointment:null,on_after_appointment:null,on_repeat_appointment:null}}},watch:{eventForm:{handler(o){this.need_reset=!0},deep:!0}},mounted(){this.event&&this.$nextTick(()=>{this.eventForm={id:this.event.id||null,title:this.event.title||null,subtitle:this.event.subtitle||null,description:this.event.description||null,images:this.event.images||[],is_group:this.event.is_group||!1,address:this.event.address||null,coords:this.event.coords||null,max_people:this.event.max_people||0,min_people:this.event.min_people||0,on_start_appointment:this.event.on_start_appointment||null,on_cancel_appointment:this.event.on_cancel_appointment||null,on_after_appointment:this.event.on_after_appointment||null,on_repeat_appointment:this.event.on_repeat_appointment||null}})},methods:{selectPhotos(o){this.eventForm.images||(this.eventForm.images=[]);let t=this.eventForm.images.indexOf(o.file_id);t!==-1?this.eventForm.images.splice(t,1):this.eventForm.images.push(o.file_id)},resetForm(){},submitForm(){let o=new FormData;Object.keys(this.eventForm).forEach(t=>{const s=this.eventForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),o.append("bot_id",this.bot.id),this.$store.dispatch(this.eventForm.id===null?"addAppointmentEvent":"updateAppointmentEvent",{appointmentEventForm:o}).then(t=>{this.$emit("callback",t.data),this.$nextTick(()=>{this.eventForm={id:null,title:null,subtitle:null,description:null,address:null,coords:null,images:[],services:[],times:[],is_group:!1,max_people:0,min_people:0,on_start_appointment:null,on_cancel_appointment:null,on_after_appointment:null,on_repeat_appointment:null}}),this.$notify("Событие успешно создано")}).catch(t=>{this.$notify("Ошибка создания события")})}}},le=Object.assign(E6,{__name:"AppointmentEventForm",setup(o){return(t,s)=>{const d=z("Popper"),n=Q("mask");return l(),i("form",{onSubmit:s[14]||(s[14]=C((...a)=>t.submitForm&&t.submitForm(...a),["prevent"]))},[e("div",$8,[e("div",k8,[e("label",F8,[b(d,{content:"Название вашего события (или специалиста), на которое планируется осуществить запись"},{default:v(()=>[w8]),_:1}),m(" Название события "),C8]),c(e("input",{type:"text",class:"form-control",placeholder:"Название","aria-label":"Название","onUpdate:modelValue":s[0]||(s[0]=a=>t.eventForm.title=a),maxlength:"255","aria-describedby":"event-title",required:""},null,512),[[_,t.eventForm.title]])]),e("div",S8,[e("label",j8,[b(d,null,{content:v(()=>[q8]),default:v(()=>[V8]),_:1}),m(" Подзаголовок события "),z8]),c(e("input",{type:"text",class:"form-control",placeholder:"Подзаголовок","aria-label":"Подзаголовок","onUpdate:modelValue":s[1]||(s[1]=a=>t.eventForm.subtitle=a),maxlength:"255","aria-describedby":"event-subtitle",required:""},null,512),[[_,t.eventForm.subtitle]])]),e("div",P8,[e("div",U8,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[2]||(s[2]=a=>t.need_add_address=a),type:"checkbox",id:"need_add_address"},null,512),[[k,t.need_add_address]]),O8])]),t.need_add_address?(l(),i("div",A8,[e("label",I8,[b(d,null,{content:v(()=>[T8]),default:v(()=>[Q8]),_:1}),m(" Адрес события \\ мероприятия ")]),c(e("input",{type:"text",class:"form-control",placeholder:"Адрес события","aria-label":"Адрес события","onUpdate:modelValue":s[3]||(s[3]=a=>t.eventForm.address=a),maxlength:"255","aria-describedby":"event-address",required:""},null,512),[[_,t.eventForm.address]])])):r("",!0),t.need_add_address?(l(),i("div",M8,[e("label",D8,[b(d,null,{content:v(()=>[B8]),default:v(()=>[R8]),_:1}),m(" Координаты мероприятия: широта, долгота ")]),c(e("input",{type:"text",class:"form-control",placeholder:"00.0000,00.0000","aria-label":"Координаты события","onUpdate:modelValue":s[4]||(s[4]=a=>t.eventForm.coords=a),maxlength:"255","aria-describedby":"event-coords",required:""},null,512),[[_,t.eventForm.coords],[n,"##.####,##.####"]])])):r("",!0),e("div",E8,[e("label",L8,[b(d,null,{content:v(()=>[N8]),default:v(()=>[K8]),_:1}),m(" Описание события "),J8,t.eventForm.description?(l(),i("small",H8," Длина текста "+u(t.eventForm.description.length)+"/255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Описание мероприятия","aria-label":"Описание мероприятия",maxlength:"255","onUpdate:modelValue":s[5]||(s[5]=a=>t.eventForm.description=a),"aria-describedby":"event-description",required:""},`
                    `,512),[[_,t.eventForm.description]])]),e("div",Y8,[e("label",G8,[b(d,null,{content:v(()=>[X8]),default:v(()=>[W8]),_:1}),m(" Текст при записи на событие "),Z8,t.eventForm.on_start_appointment?(l(),i("small",x8," Длина текста "+u(t.eventForm.on_start_appointment.length)+"/255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Текст при записи на событие","aria-label":"Текст при записи на событие","onUpdate:modelValue":s[6]||(s[6]=a=>t.eventForm.on_start_appointment=a),maxlength:"255","aria-describedby":"event-on_start_appointment",required:""},`
                    `,512),[[_,t.eventForm.on_start_appointment]])]),e("div",e6,[e("label",t6,[b(d,null,{content:v(()=>[o6]),default:v(()=>[s6]),_:1}),m(" Текст при отмене записи на событие "),l6,t.eventForm.on_cancel_appointment?(l(),i("small",i6," Длина текста "+u(t.eventForm.on_cancel_appointment.length)+"/255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Текст при отмене записи на событие","aria-label":"Текст при отмене записи на событие","onUpdate:modelValue":s[7]||(s[7]=a=>t.eventForm.on_cancel_appointment=a),maxlength:"255","aria-describedby":"event-on_cancel_appointment",required:""},`
                    `,512),[[_,t.eventForm.on_cancel_appointment]])]),e("div",n6,[e("label",a6,[b(d,null,{content:v(()=>[r6]),default:v(()=>[d6]),_:1}),m(" Текст после прохождения события "),c6,t.eventForm.on_after_appointment?(l(),i("small",u6," Длина текста "+u(t.eventForm.on_after_appointment.length)+"/255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Текст после прохождения события","aria-label":"Текст после прохождения события","onUpdate:modelValue":s[8]||(s[8]=a=>t.eventForm.on_after_appointment=a),maxlength:"255","aria-describedby":"event-on_after_appointment",required:""},`
                    `,512),[[_,t.eventForm.on_after_appointment]])]),e("div",m6,[e("label",h6,[b(d,null,{content:v(()=>[p6]),default:v(()=>[_6]),_:1}),m(" Текст при повторной записи на событие "),b6,t.eventForm.on_repeat_appointment?(l(),i("small",f6," Длина текста "+u(t.eventForm.on_repeat_appointment.length)+"/255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:" Текст при повторной записи на событие","aria-label":" Текст при повторной записи на событие","onUpdate:modelValue":s[9]||(s[9]=a=>t.eventForm.on_repeat_appointment=a),maxlength:"255","aria-describedby":"event-on_repeat_appointment",required:""},`
                    `,512),[[_,t.eventForm.on_repeat_appointment]])]),e("div",g6,[e("div",v6,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[10]||(s[10]=a=>t.need_media=a),type:"checkbox",id:"need_media"},null,512),[[k,t.need_media]]),y6])]),t.need_media?(l(),i("div",$6,[e("label",k6,[b(d,null,{content:v(()=>[w6]),default:v(()=>[F6]),_:1}),m(" Изображение к событию "),C6]),b(P,{"need-photo":!0,selected:t.eventForm.images,onSelect:t.selectPhotos},null,8,["selected","onSelect"])])):r("",!0),e("div",S6,[e("div",j6,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[11]||(s[11]=a=>t.eventForm.is_group=a),type:"checkbox",id:"is-group"},null,512),[[k,t.eventForm.is_group]]),V6])]),t.eventForm.is_group?(l(),i("div",q6,[e("label",z6,[b(d,{content:"Минимально необходимое число людей, для начала 1 мероприятия"},{default:v(()=>[P6]),_:1}),m(" Минимальное число посетителей в группе "),U6]),c(e("input",{type:"number",class:"form-control",placeholder:"Минимальное число посетителей","aria-label":"Название","onUpdate:modelValue":s[12]||(s[12]=a=>t.eventForm.min_people=a),"aria-describedby":"event-min_people",required:""},null,512),[[_,t.eventForm.min_people]])])):r("",!0),t.eventForm.is_group?(l(),i("div",O6,[e("label",A6,[b(d,{content:"Количество людей, которые могут посетить мероприятие за 1 сеанс"},{default:v(()=>[I6]),_:1}),m(" Максимальное число посетителей в группе "),Q6]),c(e("input",{type:"number",class:"form-control",placeholder:"Максимальное число посетителей","aria-label":"Название","onUpdate:modelValue":s[13]||(s[13]=a=>t.eventForm.max_people=a),"aria-describedby":"event-max_people",required:""},null,512),[[_,t.eventForm.max_people]])])):r("",!0)]),e("div",T6,[e("div",M6,[e("button",D6,[t.eventForm.id==null?(l(),i("span",R6,"Создать событие")):(l(),i("span",B6,"Обновить событие"))])])])],32)}}}),L6={class:"row pt-3"},K6={class:"col-md-4"},N6={class:"form-floating mb-3"},J6=e("label",{for:"config-step"},"Шаг, минуты",-1),H6={class:"col-md-4"},Y6={class:"form-floating mb-3"},G6=e("label",{for:"config-start-time"},"Начало, часы",-1),W6={class:"col-md-4"},X6={class:"form-floating mb-3"},Z6=["min"],x6=e("label",{for:"config-end-time"},"Конец, часы",-1),e7=e("hr",null,null,-1),t7={key:0,class:"row"},s7={class:"col-12 d-flex justify-content-end pb-3"},o7={class:"row"},l7={class:"col-md-4 text-center"},i7={key:0,class:"fa-solid fa-arrow-down-short-wide"},n7={key:1,class:"fa-solid fa-arrow-up-wide-short"},a7={class:"col-md-4 text-center"},d7={key:0,class:"fa-solid fa-arrow-down-short-wide"},r7={key:1,class:"fa-solid fa-arrow-up-wide-short"},c7={class:"col-md-4 text-center"},u7={key:0,class:"fa-solid fa-arrow-down-short-wide"},m7={key:1,class:"fa-solid fa-arrow-up-wide-short"},h7={class:"col-md-4"},_7={class:"form-floating"},p7=["onUpdate:modelValue","id"],b7=["for"],f7={class:"col-md-4"},g7={class:"form-floating"},v7=["onUpdate:modelValue","id"],y7=["for"],$7={class:"col-md-4"},k7={class:"form-floating"},F7=["onUpdate:modelValue","id"],w7=["for"],C7={class:"row mt-3"},S7={class:"col-12"},j7={class:"row"},V7={class:"col-12"},q7={class:"col-12"},z7={class:"text-center"},P7={class:"row d-flex justify-content-center"},U7={class:"col-md-4"},O7={class:"table"},A7=e("th",{scope:"col"},"#",-1),I7={scope:"col"},Q7={scope:"row"},T7=["onClick"],M7={key:0,class:"fa-solid fa-check"},D7={key:1,class:"fa-solid fa-xmark"},R7={components:{VueDatePicker:H},props:["eventId","bot"],data(){return{date:null,load:!1,step:30,start:8,end:18,order:null,direction:null,paginate_object:null,years:[2024,2025],months:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","октябрь","Ноябрь","Декабрь"],days:["Понедельник","Вторник","Среда","Четверг","Пятница","Суббота","Воскресенье"],schedule:[],added_schedule:[]}},watch:{date:{handler:function(o){this.loadAppointmentSchedules()},deep:!0}},computed:{...S(["getAppointmentSchedules","getAppointmentSchedulesPaginateObject"]),currentWeek(){return new Date().getWeek()},currentMonthWeek(){return new Date().getMonthWeek()},currentMonth(){return new Date().getMonth()},currentYear(){return new Date().getFullYear()},times(){let o=this.step,t=[],s=0,d=0;for(let n=0;s<24*60;n++){let a=Math.floor(s/60);if(a>=this.start&&a<=this.end){let h=s%60;t[d]=("0"+a).slice(-2)+":"+("0"+h).slice(-2),d++}s=s+o}return t}},mounted(){this.date=new Date,this.loadAppointmentSchedules()},methods:{removeAppointmentSchedule(o){this.loading=!0,this.$store.dispatch("removeAppointmentSchedule",{dataObject:{appointmentScheduleId:o}}).then(t=>{this.loading=!1,this.loadAppointmentSchedules(0),this.$notify("Время успешно удалено")}).catch(()=>{this.loading=!1,this.$notify("Ошибка удаления времени")})},loadAndOrder(o){this.order=o,this.direction=this.direction==="desc"?"asc":"desc",this.loadAppointmentSchedules(0)},nextAppointmentSchedule(o){this.loadAppointmentSchedules(o)},loadAppointmentSchedules(o=0){this.loading=!0,this.$store.dispatch("loadAppointmentSchedules",{dataObject:{date:this.date||null,event_id:this.eventId,bot_id:this.bot.id||null,order:this.order,direction:this.direction},page:o,size:20}).then(t=>{this.loading=!1,this.schedule=this.getAppointmentSchedules,this.paginate_object=this.getAppointmentSchedulesPaginateObject}).catch(()=>{this.loading=!1})},storeSchedule(){this.$store.dispatch("storeAppointmentSchedule",{dataObject:{schedule:[...this.schedule,...this.added_schedule],bot_id:this.bot.id,appointment_event_id:this.eventId}}).then(()=>{this.$notify("Расписание успешно сохранено"),this.loadAppointmentSchedules(),this.added_schedule=[]}).catch(()=>{this.$notify("Ошибка сохраения расписания")})},inScheduleRow(o){return this.schedule.findIndex(t=>t.start_time==this.times[o])!=-1||this.added_schedule.findIndex(t=>t.start_time==this.times[o])!=-1},inSchedule(o,t){return this.schedule.findIndex(s=>s.day==t&&s.start_time==this.times[o])!=-1||this.added_schedule.findIndex(s=>s.day==t&&s.start_time==this.times[o])!=-1},setScheduleItem(o,t){let s=this.schedule.findIndex(d=>d.day==t&&d.start_time==this.times[o]);if(s!==-1){this.schedule.splice(s,1);return}if(s=this.added_schedule.findIndex(d=>d.day==t&&d.start_time==this.times[o]),s!==-1){this.added_schedule.splice(s,1);return}this.added_schedule.push({day:t,start_time:this.times[o]||null,end_time:this.times[o+1]||null,week:this.date==null?this.currentWeek:new Date(this.date).getWeek(),month:this.date==null?this.currentMonth:new Date(this.date).getMonth(),year:this.date==null?this.currentYear:new Date(this.date).getFullYear()})}}},B7=Object.assign(R7,{__name:"AppointmentScheduleForm",setup(o){return(t,s)=>(l(),i(f,null,[e("div",L6,[e("div",K6,[e("div",N6,[c(e("input",{type:"number",class:"form-control","onUpdate:modelValue":s[0]||(s[0]=d=>t.step=d),min:"0",id:"config-step",placeholder:"30 минут"},null,512),[[_,t.step]]),J6])]),e("div",H6,[e("div",Y6,[c(e("input",{type:"number","onUpdate:modelValue":s[1]||(s[1]=d=>t.start=d),min:"0",max:"23",class:"form-control",id:"config-start-time",placeholder:"Часы"},null,512),[[_,t.start]]),G6])]),e("div",W6,[e("div",X6,[c(e("input",{type:"number","onUpdate:modelValue":s[2]||(s[2]=d=>t.end=d),min:t.start,max:"23",class:"form-control",id:"config-end-time",placeholder:"Часы"},null,8,Z6),[[_,t.end]]),x6])])]),e7,t.schedule.length>0||t.added_schedule.length>0?(l(),i("div",t7,[e("div",s7,[e("button",{onClick:s[3]||(s[3]=(...d)=>t.storeSchedule&&t.storeSchedule(...d)),class:"btn btn-primary"},"Сохранить текущий график ")]),e("div",o7,[e("div",l7,[e("a",{onClick:s[4]||(s[4]=d=>t.loadAndOrder("day")),href:"javascript:void(0)"},[m("День "),t.order==="day"&&t.direction==="asc"?(l(),i("i",i7)):r("",!0),t.order==="day"&&t.direction==="desc"?(l(),i("i",n7)):r("",!0)])]),e("div",a7,[e("a",{onClick:s[5]||(s[5]=d=>t.loadAndOrder("start_time")),href:"javascript:void(0)"},[m("Начало "),t.order==="start_time"&&t.direction==="asc"?(l(),i("i",d7)):r("",!0),t.order==="start_time"&&t.direction==="desc"?(l(),i("i",r7)):r("",!0)])]),e("div",c7,[e("a",{onClick:s[6]||(s[6]=d=>t.loadAndOrder("end_time")),href:"javascript:void(0)"},[m("Конец "),t.order==="end_time"&&t.direction==="asc"?(l(),i("i",u7)):r("",!0),t.order==="end_time"&&t.direction==="desc"?(l(),i("i",m7)):r("",!0)])])])])):r("",!0),(l(!0),i(f,null,$([...t.schedule,...t.added_schedule],(d,n)=>(l(),i("div",{class:g(["row py-2",{"bg-warning":d.id==null}])},[e("div",h7,[e("div",_7,[c(e("input",{type:"text","onUpdate:modelValue":a=>t.days[d.day-1]=a,class:"form-control",id:"day-of-week-"+n,placeholder:"День недели"},null,8,p7),[[_,t.days[d.day-1]]]),e("label",{for:"day-of-week-"+n},"День недели",8,b7)])]),e("div",f7,[e("div",g7,[c(e("input",{type:"text","onUpdate:modelValue":a=>d.start_time=a,class:"form-control",id:"day-of-start-at-"+n,placeholder:"Время начало"},null,8,v7),[[_,d.start_time]]),e("label",{for:"day-of-start-at-"+n},"Начало",8,y7)])]),e("div",$7,[e("div",k7,[c(e("input",{type:"text","onUpdate:modelValue":a=>d.end_time=a,class:"form-control",id:"day-of-end-at-"+n,placeholder:"Время окончания"},null,8,F7),[[_,d.end_time]]),e("label",{for:"day-of-end-at-"+n},"Окончание",8,w7)])])],2))),256)),e("div",C7,[e("div",S7,[t.paginate_object?(l(),y(q,{key:0,onPagination_page:t.nextAppointmentSchedule,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])]),e("div",j7,[e("div",V7,[e("button",{class:"btn btn-primary",onClick:s[7]||(s[7]=d=>t.schedule=[])},"Очистить таблицу")]),e("div",q7,[e("p",z7,[m(" Год: "),e("strong",null,u(t.currentYear),1),m(" Месяц: "),e("strong",null,u(t.months[t.currentMonth]),1),m(" Неделя: "),e("strong",null,u(t.currentWeek),1)])])]),e("div",P7,[e("div",U7,[b(j(H),{modelValue:t.date,"onUpdate:modelValue":s[8]||(s[8]=d=>t.date=d)},null,8,["modelValue"])])]),e("table",O7,[e("thead",null,[e("tr",null,[A7,(l(!0),i(f,null,$(t.days,d=>(l(),i("th",I7,u(d),1))),256))])]),e("tbody",null,[(l(!0),i(f,null,$(t.times,(d,n)=>(l(),i("tr",{class:g({"table-light":t.inScheduleRow(n)})},[e("th",Q7,u(d),1),(l(),i(f,null,$(7,a=>e("td",null,[e("button",{class:g([{"btn-primary text-white":t.inSchedule(n,a)},"btn btn-outline-primary"]),onClick:h=>t.setScheduleItem(n,a)},[t.inSchedule(n,a)?(l(),i("i",M7)):(l(),i("i",D7))],10,T7)])),64))],2))),256))])])],64))}});(function(){try{if(typeof document<"u"){var o=document.createElement("style");o.appendChild(document.createTextNode(".vue3-star-ratings[data-v-7fab3f62]{width:fit-content;overflow:hidden;position:relative;white-space:nowrap}.vue3-star-ratings *[data-v-7fab3f62]{box-sizing:border-box;margin:0;padding:0;line-height:1}.vue3-star-ratings__inner[data-v-7fab3f62],.vue3-star-ratings__outer[data-v-7fab3f62]{height:inherit}.vue3-star-ratings__outer[data-v-7fab3f62]{position:absolute;top:0;left:0;width:var(--vue3StarRatingOuterWidth);max-width:100%;overflow:hidden;color:var(--vue3StarRatingsOuterColor);transition:width .32s cubic-bezier(.075,.82,.165,1)}.vue3-star-ratings__inner[data-v-7fab3f62]{color:var(--vue3StarRatingsInnerColor)}.vue3-star-ratings__icon[data-v-7fab3f62]{fill:currentColor;width:var(--vue3StarRatingIconSize);aspect-ratio:1;cursor:pointer;display:inline-block}")),document.head.appendChild(o)}}catch(t){console.error("vite-plugin-css-injected-by-js",t)}})();const fe=(o,t)=>{const s=o.__vccOpts||o;for(const[d,n]of t)s[d]=n;return s},E7={},L7={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512.002 512.002"},K7=e("path",{d:"M511.267 197.258a14.995 14.995 0 00-12.107-10.209l-158.723-23.065-70.985-143.827a14.998 14.998 0 00-26.901 0l-70.988 143.827-158.72 23.065a14.998 14.998 0 00-8.312 25.585l114.848 111.954-27.108 158.083a14.999 14.999 0 0021.763 15.812l141.967-74.638 141.961 74.637a15 15 0 0021.766-15.813l-27.117-158.081 114.861-111.955a14.994 14.994 0 003.795-15.375z"},null,-1),N7=[K7];function J7(o,t){return l(),i("svg",L7,N7)}const ie=fe(E7,[["render",J7]]),H7={class:"vue3-star-ratings__outer"},Y7={class:"vue3-star-ratings__inner"},G7=we({__name:"Vue3StarRatings",props:{modelValue:{default:0},numberOfStars:{default:5},starColor:{default:"#ff9800"},inactiveColor:{default:"#333333"},starSize:{default:24},disableClick:{type:Boolean},customSvg:{default:ie}},emits:["update:modelValue"],setup(o,{emit:t}){const s=o,d=W(()=>s.customSvg||ie),n={rounded(w,I){const O=Math.pow(10,I);return Math.round(w*O)/O}},a=Ce(),h=W({get(){return s.modelValue},set(w){const I=n.rounded(w,1);t("update:modelValue",I)}});function p(w){if(s.disableClick)return;const I=this.getBoundingClientRect(),{pageX:O}=w,G=O-I.left,ge=I.width,ve=s.numberOfStars,ye=G/ge*ve;h.value=ye}const F=W(()=>(h.value<0?0:h.value>s.numberOfStars?s.numberOfStars:h.value)/s.numberOfStars*100);return Se(()=>{var w;const I={"--vue3StarRatingsInnerColor":s.inactiveColor,"--vue3StarRatingsOuterColor":s.starColor,"--vue3StarRatingOuterWidth":`${F.value}%`,"--vue3StarRatingIconSize":`${s.starSize}px`};for(const[O,G]of Object.entries(I))(w=a.value)==null||w.style.setProperty(O,G)}),je(()=>{var w;(w=a.value)==null||w.addEventListener("click",p)}),Ve(()=>{var w;(w=a.value)==null||w.removeEventListener("click",p)}),(w,I)=>(l(),i("div",{class:"vue3-star-ratings",ref_key:"starsContainer",ref:a,style:de({pointerEvents:w.disableClick?"none":"auto"})},[e("div",H7,[(l(!0),i(f,null,$(w.numberOfStars,O=>(l(),y(te(d.value),{key:O,class:"vue3-star-ratings__icon"}))),128))]),e("div",Y7,[(l(!0),i(f,null,$(w.numberOfStars,O=>(l(),y(te(d.value),{key:O,class:"vue3-star-ratings__icon"}))),128))])],4))}}),Y=fe(G7,[["__scopeId","data-v-7fab3f62"]]),W7={class:"row py-3"},X7={class:"col-12"},Z7={class:"row"},x7={class:"col-12"},e9={key:0},t9={key:1},s9={key:0,class:"col-12 mb-3"},o9={class:"col-12 mb-3"},l9={key:0},i9={key:1},n9={key:1,class:"col-12 mb-3"},a9={class:"col-12 mb-3"},d9={class:"col-12 mb-3"},r9={class:"form-label",id:"event-on_after_appointment"},c9=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),u9=e("div",null," Текст, который пользователь оставляет после прохождения услуги ",-1),m9=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),h9={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},_9={class:"row"},p9={class:"col-12"},b9={type:"submit",class:"btn btn-outline-success w-100 p-3"},f9={key:0},g9={key:1},v9={props:["eventId","bot","review"],components:{vue3starRatings:Y},data(){return{step:0,load:!1,selected_schedule_time:null,selected_bot_user:null,need_load_users:!1,need_schedule_time:!1,days:["понедельник","вторник","среду","четверг","пятницу","субботу","воскресенье"],reviewForm:{id:null,appointment_event_id:null,appointment_schedule_id:null,bot_user_id:null,rating:null,text:null}}},watch:{reviewForm:{handler(o){this.need_reset=!0},deep:!0}},mounted(){this.review&&this.$nextTick(()=>{this.reviewForm={id:this.review.id||null,appointment_event_id:this.review.appointment_event_id||null,appointment_schedule_id:this.review.appointment_schedule_id||null,bot_user_id:this.review.bot_user_id||null,rating:this.review.rating||null,text:this.review.text||null},this.selected_schedule_time=this.review.schedule||null,this.selected_bot_user=this.review.botUser||null})},methods:{selectScheduleTime(o){this.selected_schedule_time=o,this.need_schedule_time=!1},selectBotUser(o){this.selected_bot_user=o,this.need_load_users=!1},clearReviewForm(){this.reviewForm={id:null,appointment_event_id:null,appointment_schedule_id:null,bot_user_id:null,rating:null,text:null},this.selected_schedule_time=null,this.selected_bot_user=null},submitForm(){this.reviewForm.bot_user_id=this.selected_bot_user.id,this.reviewForm.appointment_schedule_id=this.selected_schedule_time.id,this.reviewForm.appointment_event_id=this.eventId;let o=new FormData;Object.keys(this.reviewForm).forEach(t=>{const s=this.reviewForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),o.append("bot_id",this.bot.id),this.$store.dispatch("storeAppointmentReview",{dataObject:{appointmentReviewForm:o}}).then(t=>{this.$emit("callback",t.data),this.$notify("Отзыв успешно создан"),this.clearReviewForm()}).catch(t=>{this.$notify("Ошибка создания отзыва")})}}},y9=Object.assign(v9,{__name:"AppointmentReviewForm",setup(o){return(t,s)=>{const d=z("Popper");return l(),i(f,null,[e("div",W7,[e("div",X7,[e("button",{onClick:s[0]||(s[0]=(...n)=>t.clearReviewForm&&t.clearReviewForm(...n)),class:"btn btn-primary"},"Новый отзыв")])]),e("form",{onSubmit:s[5]||(s[5]=C((...n)=>t.submitForm&&t.submitForm(...n),["prevent"]))},[e("div",Z7,[e("div",x7,[e("a",{href:"javascript:void(0)",class:"btn btn-link",onClick:s[1]||(s[1]=n=>t.need_load_users=!t.need_load_users)},[t.selected_bot_user==null?(l(),i("span",e9,"Выберите пользователя")):r("",!0),t.selected_bot_user?(l(),i("span",t9," Пользователь "+u(t.selected_bot_user.name||t.selected_bot_user.fio_from_telegram||t.selected_bot_user.telegram_chat_id||"-"),1)):r("",!0)])]),t.need_load_users?(l(),i("div",s9,[b(J,{simple:!0,onSelect:t.selectBotUser},null,8,["onSelect"])])):r("",!0),e("div",o9,[e("a",{href:"javascript:void(0)",class:"btn btn-link",onClick:s[2]||(s[2]=n=>t.need_schedule_time=!t.need_schedule_time)},[t.selected_schedule_time==null?(l(),i("span",l9,"Выберите время в расписании")):r("",!0),t.selected_schedule_time?(l(),i("span",i9," Запись на "+u(t.days[t.selected_schedule_time.day-1]||"-")+" с "+u(t.selected_schedule_time.start_time||"-")+" до "+u(t.selected_schedule_time.end_time||"-"),1)):r("",!0)])]),t.need_schedule_time?(l(),i("div",n9,[b(ce,{"event-id":o.eventId,bot:o.bot,onSelect:t.selectScheduleTime},null,8,["event-id","bot","onSelect"])])):r("",!0),e("div",a9,[e("p",null," Рейтинг: "+u(t.reviewForm.rating||0),1),b(j(Y),{modelValue:t.reviewForm.rating,"onUpdate:modelValue":s[3]||(s[3]=n=>t.reviewForm.rating=n)},null,8,["modelValue"])]),e("div",d9,[e("label",r9,[b(d,null,{content:v(()=>[u9]),default:v(()=>[c9]),_:1}),m(" Текст отзыва "),m9,t.reviewForm.text?(l(),i("small",h9," Длина текста "+u(t.reviewForm.text.length)+"/255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Текст отзыва","aria-label":"Текст отзыва","onUpdate:modelValue":s[4]||(s[4]=n=>t.reviewForm.text=n),maxlength:"255","aria-describedby":"review-text",required:""},`
                    `,512),[[_,t.reviewForm.text]])])]),e("div",_9,[e("div",p9,[e("button",b9,[t.reviewForm.id==null?(l(),i("span",f9,"Оставить отзыв")):(l(),i("span",g9,"Обновить отзыв"))])])])],32)],64)}}}),$9={class:"row"},k9={class:"col-12"},F9={key:0,class:"table"},w9=e("th",{scope:"col"},"Действие",-1),C9=["onClick"],S9={scope:"row"},j9={class:"d-flex align-items-center"},V9={class:"ml-2"},q9={key:0,class:"dropdown"},z9=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),P9={class:"dropdown-menu"},U9={key:0},O9=["onClick"],A9={key:1},I9={class:"col-12"},Q9={props:["bot","eventId"],components:{vue3starRatings:Y},data(){return{direction:"desc",order:"updated_at",show:!0,is_group:!1,loading:!0,reviews:[],search:null,paginate_object:null}},computed:{...S(["getAppointmentReviews","getAppointmentReviewsPaginateObject"])},mounted(){this.loadAppointmentReviews()},methods:{nextAppointmentReviews(o){this.loadAppointmentReviews(o)},selectReview(o){this.$emit("select",o)},loadAndOrder(o){this.order=o,this.direction=this.direction==="desc"?"asc":"desc",this.loadAppointmentReviews(0)},removeAppointmentReview(o){this.loading=!0,this.$store.dispatch("removeAppointmentReview",{dataObject:{appointmentReviewId:o}}).then(t=>{this.loadAppointmentReviews(0),this.$notify("Сервис успешно удален"),this.loading=!1}).catch(()=>{this.loading=!1,this.$notify("Ошибка удаления сервиса")})},loadAppointmentReviews(o=0){this.loading=!0,this.$store.dispatch("loadAppointmentReviews",{dataObject:{event_id:this.eventId,bot_id:this.bot.id||null,search:this.search,order:this.order,direction:this.direction},page:o,size:100}).then(t=>{this.loading=!1,this.reviews=this.getAppointmentReviews,this.paginate_object=this.getAppointmentReviewsPaginateObject}).catch(()=>{this.loading=!1})}}},T9=Object.assign(Q9,{__name:"AppointmentReviewsTable",setup(o){return(t,s)=>(l(),i("div",$9,[e("div",k9,[t.reviews.length>0?(l(),i("table",F9,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:s[0]||(s[0]=d=>t.loadAndOrder("id"))},"#"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[1]||(s[1]=d=>t.loadAndOrder("bot_user_id"))},"Пользователь"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[2]||(s[2]=d=>t.loadAndOrder("rating"))},"Рейтинг"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[3]||(s[3]=d=>t.loadAndOrder("text"))},"Текст"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[4]||(s[4]=d=>t.loadAndOrder("updated_at"))},"Дата изменения"),w9])]),e("tbody",null,[(l(!0),i(f,null,$(t.reviews,(d,n)=>(l(),i("tr",{onClick:a=>t.selectReview(d),class:g({"border-info":d.deleted_at==null,"border-danger":d.deleted_at!=null})},[e("th",S9,u(d.id),1),e("td",null,u(d.botUser.fio_from_telegram||d.botUser.telegram_chat_id||"Не указано"),1),e("td",null,[e("p",j9,[b(j(Y),{disableClick:!0,modelValue:d.rating,"onUpdate:modelValue":a=>d.rating=a},null,8,["modelValue","onUpdate:modelValue"]),e("span",V9,u(d.rating||0),1)])]),e("td",null,u(d.text||"Не указано"),1),e("td",null,u(t.$filters.current(d.updated_at)),1),e("td",null,[d.id?(l(),i("div",q9,[z9,e("ul",P9,[d.deleted_at==null?(l(),i("li",U9,[e("a",{class:"dropdown-item",onClick:a=>t.removeAppointmentReview(d.id),href:"javascript:void(0)"},"Удалить",8,O9)])):r("",!0)])])):r("",!0)])],10,C9))),256))])])):(l(),i("p",A9,"На текущий момент нет ни одного созданного отзыва"))]),e("div",I9,[t.paginate_object?(l(),y(q,{key:0,onPagination_page:t.nextAppointmentReviews,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])]))}}),M9={key:0,class:"py-2"},D9={class:"row"},R9={class:"col-12"},B9={key:1,class:"py-2"},E9={class:"row"},L9={class:"col-12"},K9={key:2,class:"py-2"},N9={class:"row"},J9={class:"col-12"},H9={class:"nav nav-tabs justify-content-center"},Y9={key:0,class:"row py-3"},G9={class:"col-12"},W9={key:1,class:"row py-3"},X9={class:"col-12"},Z9={class:"col-12 py-3"},x9=e("h4",null,"Доступные сервисы в событии",-1),eS={key:2,class:"row"},tS={class:"col-12"},sS={key:3,class:"row"},oS={class:"col-12"},lS={class:"col-12 py-3"},iS=e("h4",null,"Актуальные записи на событие",-1),nS={key:4,class:"row"},aS={class:"col-12"},dS={class:"col-12 py-3"},rS=e("h4",null,"Отзывы к событию",-1),cS={props:["bot"],data(){return{part:0,tab:0,loadTable:!1,loadService:!1,loadReviewForm:!1,loadAppointments:!1,loadReviews:!1,loadAppointmentForm:!1,loadForm:!1,selectedEvent:null,selectedService:null,selectedAppointment:null,selectedReview:null}},computed:{...S(["getAppointmentEvents","getAppointmentEventsPaginateObject"])},mounted(){},methods:{callbackForm(){this.loadTable=!0,this.$nextTick(()=>{this.loadTable=!1})},callbackAppointment(){this.loadAppointments=!0,this.$nextTick(()=>{this.loadAppointments=!1})},callbackReview(){this.loadReviews=!0,this.$nextTick(()=>{this.loadReviews=!1})},createEvent(){this.part=2},selectAppointment(o){this.loadAppointmentForm=!0,this.selectedAppointment=o,this.$nextTick(()=>{this.loadAppointmentForm=!1})},selectService(o){this.loadService=!0,this.selectedService=o,this.$nextTick(()=>{this.loadService=!1})},selectReview(o){this.loadReviewForm=!0,this.selectedReview=o,this.$nextTick(()=>{this.loadReviewForm=!1})},selectEvent(o){this.loadForm=!0,this.$nextTick(()=>{this.loadForm=!1,this.selectedEvent=o,this.part=1,this.tab=0})}}},uS=Object.assign(cS,{__name:"Appointment",setup(o){return(t,s)=>(l(),i(f,null,[t.part===0?(l(),i("div",M9,[e("div",D9,[e("div",R9,[e("button",{type:"button",onClick:s[0]||(s[0]=(...d)=>t.createEvent&&t.createEvent(...d)),class:"btn btn-primary"}," Создать новое событие ")])]),t.loadTable?r("",!0):(l(),y(o8,{key:0,onSelect:t.selectEvent,bot:o.bot},null,8,["onSelect","bot"]))])):r("",!0),t.part===2?(l(),i("div",B9,[e("div",E9,[e("div",L9,[e("button",{type:"button",onClick:s[1]||(s[1]=d=>t.part=0),class:"btn btn-outline-primary"}," Назад ")])]),t.loadForm?r("",!0):(l(),y(le,{key:0,onCallback:t.callbackForm,bot:o.bot},null,8,["onCallback","bot"]))])):r("",!0),t.part===1?(l(),i("div",K9,[e("div",N9,[e("div",J9,[e("button",{type:"button",onClick:s[2]||(s[2]=d=>t.part=0),class:"btn btn-outline-primary"}," Назад ")])]),e("ul",H9,[e("li",{class:"nav-item",onClick:s[3]||(s[3]=d=>t.tab=0)},[e("a",{class:g(["nav-link",{active:t.tab===0}]),"aria-current":"page",href:"javascript:void(0)"},"Информация о событии",2)]),e("li",{class:"nav-item",onClick:s[4]||(s[4]=d=>t.tab=1)},[e("a",{class:g(["nav-link",{active:t.tab===1}]),href:"javascript:void(0)"},"Сервисы в событии",2)]),e("li",{class:"nav-item",onClick:s[5]||(s[5]=d=>t.tab=2)},[e("a",{class:g(["nav-link",{active:t.tab===2}]),href:"javascript:void(0)"},"График",2)]),e("li",{class:"nav-item",onClick:s[6]||(s[6]=d=>t.tab=3)},[e("a",{class:g(["nav-link",{active:t.tab===3}]),href:"javascript:void(0)"},"Записи на событие",2)]),e("li",{class:"nav-item",onClick:s[7]||(s[7]=d=>t.tab=4)},[e("a",{class:g(["nav-link",{active:t.tab===4}]),href:"javascript:void(0)"},"Отзывы о событии",2)])]),t.tab===0?(l(),i("div",Y9,[e("div",G9,[t.loadForm?r("",!0):(l(),y(le,{key:0,onCallback:t.callbackForm,event:t.selectedEvent,bot:o.bot},null,8,["onCallback","event","bot"]))])])):r("",!0),t.tab===1?(l(),i("div",W9,[e("div",X9,[t.loadService?r("",!0):(l(),y(TC,{key:0,service:t.selectedService,"event-id":t.selectedEvent.id,bot:o.bot},null,8,["service","event-id","bot"]))]),e("div",Z9,[x9,b(y8,{"event-id":t.selectedEvent.id,onSelect:t.selectService,bot:o.bot},null,8,["event-id","onSelect","bot"])])])):r("",!0),t.tab===2?(l(),i("div",eS,[e("div",tS,[b(B7,{"event-id":t.selectedEvent.id,bot:o.bot},null,8,["event-id","bot"])])])):r("",!0),t.tab===3?(l(),i("div",sS,[e("div",oS,[t.loadAppointmentForm?r("",!0):(l(),y(y4,{key:0,bot:o.bot,onCallback:t.callbackAppointment,"event-id":t.selectedEvent.id,appointment:t.selectedAppointment},null,8,["bot","onCallback","event-id","appointment"]))]),e("div",lS,[iS,t.loadAppointments?r("",!0):(l(),y(Q4,{key:0,"event-id":t.selectedEvent.id,onSelect:t.selectAppointment,bot:o.bot},null,8,["event-id","onSelect","bot"]))])])):r("",!0),t.tab===4?(l(),i("div",nS,[e("div",aS,[t.loadReviewForm?r("",!0):(l(),y(y9,{key:0,review:t.selectedReview,bot:o.bot,onCallback:s[8]||(s[8]=d=>t.callbackReview()),"event-id":t.selectedEvent.id},null,8,["review","bot","event-id"]))]),e("div",dS,[rS,t.loadReviews?r("",!0):(l(),y(T9,{key:0,bot:o.bot,onSelect:t.selectReview,"event-id":t.selectedEvent.id},null,8,["bot","onSelect","event-id"]))])])):r("",!0)])):r("",!0)],64))}}),mS={props:["param"],data(){return{htmlInjections:[{title:"Кнопка синяя",value:"<a href='http://test.com/test' class='w-100 btn btn-primary'>Текст кнопки</a>"},{title:"Кнопка без цвета",value:"<a href='http://test.com/test' class='w-100 btn btn-link'>Текст кнопки</a>"},{title:"Кнопка с синей обводкой",value:"<a href='http://test.com/test' class='w-100 btn btn-outline-primary'>Текст кнопки</a>"}]}},mounted(){},methods:{attachTo(o){this.$emit("callback",{param:this.param||null,value:o})}}},hS={class:"dropdown"},_S=e("button",{class:"btn btn-link dropdown-toggle",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"}," Кнопки ",-1),pS={class:"dropdown-menu"},bS=["onClick"],fS={class:"dropdown-item",href:"javascript:void(0)"};function gS(o,t,s,d,n,a){return l(),i("div",hS,[_S,e("ul",pS,[(l(!0),i(f,null,$(n.htmlInjections,h=>(l(),i("li",{onClick:p=>a.attachTo(h.value)},[e("a",fS,u(h.title||"Не указано"),1)],8,bS))),256))])])}const N=U(mS,[["render",gS]]),vS={class:"row"},yS={class:"col-12 mb-3"},$S={class:"form-label",id:"quiz-title"},kS=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),FS=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),wS={class:"col-12 mb-3"},CS={class:"form-check"},SS=e("label",{class:"form-check-label",for:"need_media"}," Нужен медиа-контент ",-1),jS={key:0,class:"col-12 mb-3"},VS={class:"form-label",id:"quiz-images"},qS=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),zS=e("div",null," Изображение, которое видит пользователь при выборе квиза ",-1),PS=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),US={class:"col-12 mb-3"},OS={class:"form-label",id:"quiz-description"},AS=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),IS=e("div",null," Краткая информация о квизе ",-1),QS=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),TS={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},MS={class:"col-12 mb-3"},DS={class:"form-check"},RS=e("label",{class:"form-check-label",for:"polling_mode"}," Квиз в режиме опроса (без команд и таймеров) ",-1),BS={key:1,class:"col-12 mb-3"},ES={class:"form-label",id:"quiz-time_limit"},LS=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),KS=e("div",null," Время на ответ ",-1),NS=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),JS={class:"col-12 mb-3"},HS={class:"form-check"},YS=e("label",{class:"form-check-label",for:"is-group"}," Показывать ответы по окончанию раунда ",-1),GS={class:"col-12 mb-3"},WS={class:"form-check"},XS=e("label",{class:"form-check-label",for:"is_active"}," Квиз виден пользователям ",-1),ZS={key:2,class:"col-12 mb-3"},xS={class:"form-check"},ej=e("label",{class:"form-check-label",for:"round_mode"}," Использовать систему раундов ",-1),tj={class:"col-12 mb-3"},sj={class:"form-label",id:"quiz-time_limit"},oj=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),lj=e("div",null," Число попыток прохождения квиза ",-1),ij=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),nj={class:"col-12 mb-3"},aj={class:"form-label",id:"quiz-time_limit"},dj=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),rj=e("div",null," Сколько % нужно ответить чтоб пройти ",-1),cj=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),uj={class:"row"},mj={class:"col-12 py-2"},hj={class:"col-12 mb-3"},_j={class:"row"},pj={class:"col-10"},bj={class:"d-flex justify-content-between"},fj={class:"form-label",id:"quiz-success_message"},gj=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),vj=e("div",null," Текст в случае успешного прохождения квиза ",-1),yj=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),$j={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},kj=["onUpdate:modelValue"],Fj={class:"col-2 d-flex align-items-center justify-content-center"},wj=["disabled","onClick"],Cj={class:"row"},Sj={class:"col-12 mb-2"},jj={class:"form-check"},Vj=e("label",{class:"form-check-label",for:"need_inline_menu_on_success"}," Меню под текстом страницы при выигрыше ",-1),qj={key:0,class:"col-12 mb-2"},zj={class:"card"},Pj={class:"card-header d-flex justify-between align-items-center"},Uj=e("h6",null,"Конструктор меню в сообщении",-1),Oj={key:0},Aj={key:1},Ij={class:"card-body"},Qj={class:"row"},Tj={class:"col-12 py-2"},Mj={class:"col-12 mb-3"},Dj={class:"row"},Rj={class:"col-10"},Bj={class:"d-flex justify-content-between"},Ej=["id"],Lj=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Kj=e("div",null," Текст в случае неудачного прохождения квиза ",-1),Nj=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Jj={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},Hj=["onUpdate:modelValue"],Yj={class:"col-2 d-flex align-items-center justify-content-center"},Gj=["disabled","onClick"],Wj={class:"row"},Xj={class:"col-12 mb-2"},Zj={class:"form-check"},xj=e("label",{class:"form-check-label",for:"need_template_selector_on_failure"}," Меню под текстом страницы при проигрыше ",-1),eV={key:0,class:"col-12 mb-2"},tV={class:"card"},sV={class:"card-header d-flex justify-between align-items-center"},oV=e("h6",null,"Конструктор меню в сообщении",-1),lV={key:0},iV={key:1},nV={class:"card-body"},aV={class:"row"},dV={class:"col-12 mb-3"},rV={class:"form-floating"},cV=["value","selected"],uV=e("label",{for:"quiz-display-type"},"Тип вывода вопросов",-1),mV={class:"row"},hV={class:"col-12"},_V={type:"submit",class:"btn btn-outline-success w-100 p-3"},pV={key:0},bV={key:1},fV={props:["quiz","bot"],data(){return{step:0,load:!1,need_reset:!1,need_services:!1,need_media:!1,need_inline_menu_on_success:!1,need_template_selector_on_success:!1,need_template_selector_on_failure:!1,need_inline_menu_on_failure:!1,types:["По порядку","Перемешать всё","Перемешать ответы","Перемешать вопросы"],quizForm:{id:null,title:null,image:null,description:null,completed_at:null,start_at:null,end_at:null,display_type:0,time_limit:30,show_answers:!1,polling_mode:!1,round_mode:!0,is_active:!1,try_count:1,success_percent:50,success_message:["Задание успешно пройдено!"],failure_message:["К сожалению вы не прошли задание!"],success_inline_keyboard_id:null,success_inline_keyboard:null,failure_inline_keyboard_id:null,failure_inline_keyboard:null}}},watch:{quizForm:{handler(o){this.need_reset=!0},deep:!0},"quizForm.polling_mode":{handler(o){this.quizForm.round_mode=!1},deep:!0}},mounted(){this.quiz&&this.$nextTick(()=>{this.quizForm={id:this.quiz.id||null,title:this.quiz.title||null,image:this.quiz.image||null,description:this.quiz.description||null,completed_at:this.quiz.completed_at?this.$filters.currentFull(this.quiz.completed_at):null,start_at:this.quiz.start_at?this.$filters.currentFull(this.quiz.start_at):null,end_at:this.quiz.end_at?this.$filters.currentFull(this.quiz.end_at):null,display_type:this.quiz.display_type||0,time_limit:this.quiz.time_limit||30,show_answers:this.quiz.show_answers||!1,polling_mode:this.quiz.polling_mode||!1,round_mode:this.quiz.round_mode||!1,is_active:this.quiz.is_active||!1,try_count:this.quiz.try_count||1,success_inline_keyboard_id:this.quiz.success_inline_keyboard_id||null,success_inline_keyboard:this.quiz.success_inline_keyboard||null,failure_inline_keyboard_id:this.quiz.failure_inline_keyboard_id||null,failure_inline_keyboard:this.quiz.failure_inline_keyboard||null,success_percent:this.quiz.success_percent||50,success_message:this.quiz.success_message||["Задание успешно пройдено!"],failure_message:this.quiz.failure_message||["К сожалению вы не прошли задание!"]},this.quizForm.success_inline_keyboard&&(this.need_inline_menu_on_success=!0),this.quizForm.failure_inline_keyboard&&(this.need_inline_menu_on_failure=!0)})},methods:{selectInlineKeyboardOnSuccess(o){this.quizForm.success_inline_keyboard=o,this.need_template_selector_on_success=!1},selectInlineKeyboardOnFailure(o){this.quizForm.failure_inline_keyboard=o,this.need_template_selector_on_failure=!1},attachTo(o,t){this.quizForm[o.param][t]==null?this.quizForm[o.param][t]=o.value:this.quizForm[o.param][t]+=o.value},selectPhoto(o){this.quizForm.image=o.file_id},removeMessage(o,t){this.quizForm[o||"success_message"].splice(t,1)},addMessage(o,t){this.quizForm[o||"success_message"].push(t)},submitForm(){let o=new FormData;Object.keys(this.quizForm).forEach(t=>{const s=this.quizForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),o.append("bot_id",this.bot.id),this.$store.dispatch("storeQuiz",{quizForm:o}).then(t=>{this.quizForm={id:null,title:null,image:null,description:null,completed_at:null,start_at:null,end_at:null,display_type:0,time_limit:30,show_answers:!1,polling_mode:!1,round_mode:!1,is_active:!1,try_count:1,success_percent:50,success_inline_keyboard_id:null,success_inline_keyboard:null,failure_inline_keyboard_id:null,failure_inline_keyboard:null,success_message:["Задание успешно пройдено!"],failure_message:["К сожалению вы не прошли задание!"]},this.$emit("callback",t.data),this.$notify("Событие успешно создано")}).catch(t=>{this.$notify("Ошибка создания события")})}}},ne=Object.assign(fV,{__name:"QuizForm",setup(o){return(t,s)=>{const d=z("Popper");return l(),i("form",{onSubmit:s[19]||(s[19]=C((...n)=>t.submitForm&&t.submitForm(...n),["prevent"])),class:"py-3"},[e("div",vS,[e("div",yS,[e("label",$S,[b(d,{content:"Название вашего квиза"},{default:v(()=>[kS]),_:1}),m(" Название квиза "),FS]),c(e("input",{type:"text",class:"form-control",placeholder:"Название","aria-label":"Название","onUpdate:modelValue":s[0]||(s[0]=n=>t.quizForm.title=n),maxlength:"255","aria-describedby":"quiz-title",required:""},null,512),[[_,t.quizForm.title]])]),e("div",wS,[e("div",CS,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[1]||(s[1]=n=>t.need_media=n),type:"checkbox",id:"need_media"},null,512),[[k,t.need_media]]),SS])]),t.need_media?(l(),i("div",jS,[e("label",VS,[b(d,null,{content:v(()=>[zS]),default:v(()=>[qS]),_:1}),m(" Изображение к квизу "),PS]),b(P,{"need-photo":!0,selected:t.quizForm.image,onSelect:t.selectPhoto},null,8,["selected","onSelect"])])):r("",!0),e("div",US,[e("label",OS,[b(d,null,{content:v(()=>[IS]),default:v(()=>[AS]),_:1}),m(" Описание события "),QS,t.quizForm.description?(l(),i("small",TS," Длина текста "+u(t.quizForm.description.length)+"/255",1)):r("",!0)]),c(e("textarea",{class:"form-control",placeholder:"Описание мероприятия","aria-label":"Описание мероприятия",maxlength:"255","onUpdate:modelValue":s[2]||(s[2]=n=>t.quizForm.description=n),"aria-describedby":"quiz-description",required:""},`
                    `,512),[[_,t.quizForm.description]])]),e("div",MS,[e("div",DS,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[3]||(s[3]=n=>t.quizForm.polling_mode=n),type:"checkbox",id:"polling_mode"},null,512),[[k,t.quizForm.polling_mode]]),RS])]),t.quizForm.polling_mode?r("",!0):(l(),i("div",BS,[e("label",ES,[b(d,null,{content:v(()=>[KS]),default:v(()=>[LS]),_:1}),m(" Лимит времени на ответ в секундах "),NS]),c(e("input",{type:"number",class:"form-control",placeholder:"Лимит времени на ответ","aria-label":"Лимит времени на ответ",step:"0.1",min:"0","onUpdate:modelValue":s[4]||(s[4]=n=>t.quizForm.time_limit=n),"aria-describedby":"quiz-time_limit",required:""},null,512),[[_,t.quizForm.time_limit]])])),e("div",JS,[e("div",HS,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[5]||(s[5]=n=>t.quizForm.show_answers=n),type:"checkbox",id:"is-group"},null,512),[[k,t.quizForm.show_answers]]),YS])]),e("div",GS,[e("div",WS,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[6]||(s[6]=n=>t.quizForm.is_active=n),type:"checkbox",id:"is_active"},null,512),[[k,t.quizForm.is_active]]),XS])]),t.quizForm.polling_mode?r("",!0):(l(),i("div",ZS,[e("div",xS,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[7]||(s[7]=n=>t.quizForm.round_mode=n),type:"checkbox",id:"round_mode"},null,512),[[k,t.quizForm.round_mode]]),ej])])),e("div",tj,[e("label",sj,[b(d,null,{content:v(()=>[lj]),default:v(()=>[oj]),_:1}),m(" Количество попыток "),ij]),c(e("input",{type:"number",class:"form-control",placeholder:"Число попыток","aria-label":"Число попыток",step:"1",min:"1","onUpdate:modelValue":s[8]||(s[8]=n=>t.quizForm.try_count=n),"aria-describedby":"quiz-try_count",required:""},null,512),[[_,t.quizForm.try_count]])]),e("div",nj,[e("label",aj,[b(d,null,{content:v(()=>[rj]),default:v(()=>[dj]),_:1}),m(" % для прохождения "),cj]),c(e("input",{type:"number",class:"form-control",placeholder:"Процент для победы","aria-label":"Процент для победы",step:"1",min:"0","onUpdate:modelValue":s[9]||(s[9]=n=>t.quizForm.success_percent=n),"aria-describedby":"quiz-success_percent",required:""},null,512),[[_,t.quizForm.success_percent]])])]),e("div",uj,[e("div",mj,[e("button",{class:"btn btn-outline-info rounded-5",type:"button",onClick:s[10]||(s[10]=n=>t.addMessage("success_message",null))},"Добавить еще вариант текста ")]),(l(!0),i(f,null,$(t.quizForm.success_message,(n,a)=>(l(),i("div",hj,[e("div",_j,[e("div",pj,[e("div",bj,[e("label",fj,[b(d,null,{content:v(()=>[vj]),default:v(()=>[gj]),_:1}),m(" Текст при победе "),yj,t.quizForm.success_message[a]?(l(),i("small",$j," Длина текста "+u(t.quizForm.success_message[a].length)+"/255",1)):r("",!0)]),b(N,{param:"success_message",onCallback:h=>t.attachTo(h,a)},null,8,["onCallback"])]),c(e("textarea",{class:"form-control",placeholder:"Текст при победе","aria-label":"Текст при победе",maxlength:"255","onUpdate:modelValue":h=>t.quizForm.success_message[a]=h,"aria-describedby":"quiz-success_message",required:""},`
                    `,8,kj),[[_,t.quizForm.success_message[a]]])]),e("div",Fj,[e("button",{class:"btn btn-outline-danger",disabled:t.quizForm.success_message.length<=1,onClick:h=>t.removeMessage("success_message",a)},"Удалить ",8,wj)])])]))),256))]),e("div",Cj,[e("div",Sj,[e("div",jj,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[11]||(s[11]=n=>t.need_inline_menu_on_success=n),type:"checkbox",id:"need_inline_menu_on_success"},null,512),[[k,t.need_inline_menu_on_success]]),Vj])]),t.need_inline_menu_on_success?(l(),i("div",qj,[e("div",zj,[e("div",Pj,[Uj,e("button",{class:g(["btn",{"btn-outline-primary":!t.need_template_selector_on_success,"btn-primary":t.need_template_selector_on_success}]),type:"button",onClick:s[12]||(s[12]=n=>t.need_template_selector_on_success=!t.need_template_selector_on_success)},[t.need_template_selector_on_success?(l(),i("span",Aj," Скрыть шаблоны меню")):(l(),i("span",Oj," Открыть шаблоны меню"))],2)]),e("div",Ij,[t.need_template_selector_on_success?(l(),y(R,{key:0,class:"mb-2",type:"inline",onSelect:t.selectInlineKeyboardOnSuccess,"select-mode":!0},null,8,["onSelect"])):(l(),y(A,{key:1,type:"inline",modelValue:t.quizForm.success_inline_keyboard,"onUpdate:modelValue":s[13]||(s[13]=n=>t.quizForm.success_inline_keyboard=n)},null,8,["modelValue"]))])])])):r("",!0)]),e("div",Qj,[e("div",Tj,[e("button",{class:"btn btn-outline-info rounded-5",type:"button",onClick:s[14]||(s[14]=n=>t.addMessage("failure_message",null))},"Добавить еще вариант текста ")]),(l(!0),i(f,null,$(t.quizForm.failure_message,(n,a)=>(l(),i("div",Mj,[e("div",Dj,[e("div",Rj,[e("div",Bj,[e("label",{class:"form-label",id:"quiz-failure_message"+a},[b(d,null,{content:v(()=>[Kj]),default:v(()=>[Lj]),_:1}),m(" Текст при проигрыше "),Nj,t.quizForm.failure_message[a]?(l(),i("small",Jj," Длина текста "+u(t.quizForm.failure_message[a].length)+"/255",1)):r("",!0)],8,Ej),b(N,{param:"failure_message",onCallback:h=>t.attachTo(h,a)},null,8,["onCallback"])]),c(e("textarea",{class:"form-control",placeholder:"Текст при проигрыше","aria-label":"Текст при проигрыше",maxlength:"255","onUpdate:modelValue":h=>t.quizForm.failure_message[a]=h,"aria-describedby":"quiz-success_message",required:""},`
                    `,8,Hj),[[_,t.quizForm.failure_message[a]]])]),e("div",Yj,[e("button",{class:"btn btn-outline-danger",disabled:t.quizForm.failure_message.length<=1,onClick:h=>t.removeMessage("failure_message",a)},"Удалить ",8,Gj)])])]))),256))]),e("div",Wj,[e("div",Xj,[e("div",Zj,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[15]||(s[15]=n=>t.need_inline_menu_on_failure=n),type:"checkbox",id:"need_template_selector_on_failure"},null,512),[[k,t.need_inline_menu_on_failure]]),xj])]),t.need_inline_menu_on_failure?(l(),i("div",eV,[e("div",tV,[e("div",sV,[oV,e("button",{class:g(["btn",{"btn-outline-primary":!t.need_template_selector_on_failure,"btn-primary":t.need_template_selector_on_failure}]),type:"button",onClick:s[16]||(s[16]=n=>t.need_template_selector_on_failure=!t.need_template_selector_on_failure)},[t.need_template_selector_on_failure?(l(),i("span",iV," Скрыть шаблоны меню")):(l(),i("span",lV," Открыть шаблоны меню"))],2)]),e("div",nV,[t.need_template_selector_on_failure?(l(),y(R,{key:0,class:"mb-2",type:"inline",onSelect:t.selectInlineKeyboardOnFailure,"select-mode":!0},null,8,["onSelect"])):(l(),y(A,{key:1,type:"inline",modelValue:t.quizForm.failure_inline_keyboard,"onUpdate:modelValue":s[17]||(s[17]=n=>t.quizForm.failure_inline_keyboard=n)},null,8,["modelValue"]))])])])):r("",!0)]),e("div",aV,[e("div",dV,[e("div",rV,[c(e("select",{class:"form-select","onUpdate:modelValue":s[18]||(s[18]=n=>t.quizForm.display_type=n),id:"quiz-display-type","aria-label":"quiz-display-type"},[(l(!0),i(f,null,$(t.types,(n,a)=>(l(),i("option",{value:a,selected:a==t.quizForm.display_type},u(n),9,cV))),256))],512),[[T,t.quizForm.display_type]]),uV])])]),e("div",mV,[e("div",hV,[e("button",_V,[t.quizForm.id==null?(l(),i("span",pV,"Создать квиз")):(l(),i("span",bV,"Обновить квиз"))])])])],32)}}}),gV={class:"row py-2"},vV={class:"col-12"},yV={class:"input-group mb-3"},$V={class:"col-12"},kV={key:0,class:"table"},FV=e("th",{scope:"col"},"Число вопросов",-1),wV=e("th",{scope:"col"},"Число команд",-1),CV=e("th",{scope:"col"},"Действие",-1),SV={scope:"row"},jV=["onClick"],VV={key:0,style:{width:"50px",height:"50px"},alt:""},qV={key:1},zV={key:0,class:"mb-0"},PV={key:1},UV={key:0,class:"mb-0"},OV={key:1},AV={key:0,class:"mb-0"},IV={key:1},QV={key:0,class:"fa-solid fa-chevron-down text-success"},TV={key:1,class:"fa-solid fa-xmark text-danger"},MV={key:0,class:"fa-solid fa-chevron-down text-success"},DV={key:1,class:"fa-solid fa-xmark text-danger"},RV={key:0,class:"dropdown"},BV=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),EV={class:"dropdown-menu"},LV={key:0},KV=["onClick"],NV={key:1},JV=e("div",{class:"alert alert-warning alert-dismissible fade show",role:"alert"},[e("strong",null,"Внимание!"),m(" Вы еще не добавили ни одного квиза! "),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"alert","aria-label":"Close"})],-1),HV={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},YV={class:"d-flex justify-content-center mb-3"},GV={alt:"",width:"100",height:"100"},WV=e("h1",{class:"text-body-emphasis"},"Создание Квиза",-1),XV=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"}," Квиз - это игра. Создавайте игры и делитесь с клиентами ссылкой на игру. Формируйте команды, начисляйте баллы, меняйте баллы на вкусные призы. Всё в ваших руках. ",-1),ZV={class:"d-inline-flex gap-2 mb-5"},xV=e("a",{href:"https://telegra.ph/Sozdanie-Kviza-01-13",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),eq={key:0,class:"col-12"},tq={props:["bot"],data(){return{direction:"desc",order:"updated_at",show:!0,loading:!0,quizzes:[],search:null,paginate_object:null}},computed:{...S(["getQuizzes","getQuizzesPaginateObject"])},mounted(){this.loadQuizzes()},methods:{removeQuiz(o){this.loading=!0,this.$store.dispatch("removeQuiz",{quizId:o}).then(t=>{this.loading=!1,this.loadQuizzes(0),this.$notify("Событие успешно удалено")}).catch(()=>{this.loading=!1,this.$notify("Ошибка удаления события")})},createQuiz(){this.$emit("create")},nextQuizzes(o){this.loadQuizzes(o)},selectEvent(o){this.$emit("select",o)},loadAndOrder(o){this.order=o,this.direction=this.direction==="desc"?"asc":"desc",this.loadQuizzes(0)},loadQuizzes(o=0){this.loading=!0,this.$store.dispatch("loadQuizzes",{dataObject:{bot_id:this.bot.id||null,search:this.search,order:this.order,direction:this.direction},page:o,size:20}).then(t=>{this.loading=!1,this.quizzes=this.getQuizzes,this.paginate_object=this.getQuizzesPaginateObject}).catch(()=>{this.loading=!1})}}},sq=Object.assign(tq,{__name:"QuizTable",setup(o){return(t,s)=>{const d=Q("lazy");return l(),i("div",gV,[e("div",vV,[e("div",yV,[c(e("input",{type:"search",class:"form-control",placeholder:"Поиск квиза","aria-label":"Поиск квиза","onUpdate:modelValue":s[0]||(s[0]=n=>t.search=n),"aria-describedby":"quiz-search-quiz"},null,512),[[_,t.search]]),e("button",{class:"btn btn-outline-secondary",onClick:s[1]||(s[1]=n=>t.loadQuizzes(0)),type:"button",id:"quiz-search-quiz"},"Найти ")])]),e("div",$V,[t.quizzes.length>0?(l(),i("table",kV,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:s[2]||(s[2]=n=>t.loadAndOrder("id"))},"#"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[3]||(s[3]=n=>t.loadAndOrder("title"))},"Название"),FV,wV,e("th",{scope:"col",class:"cursor-pointer",onClick:s[4]||(s[4]=n=>t.loadAndOrder("image"))},"Изображение к квизу"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[5]||(s[5]=n=>t.loadAndOrder("description"))},"Описание"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[6]||(s[6]=n=>t.loadAndOrder("completed_at"))},"Квиз пройден"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[7]||(s[7]=n=>t.loadAndOrder("start_at"))},"Дата и время начала"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[8]||(s[8]=n=>t.loadAndOrder("end_at"))},"Дата и время завершения"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[9]||(s[9]=n=>t.loadAndOrder("display_type"))},"Тип отображения"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[10]||(s[10]=n=>t.loadAndOrder("show_answers"))},"Показывать ответы по окончанию раунда "),e("th",{scope:"col",class:"cursor-pointer",onClick:s[11]||(s[11]=n=>t.loadAndOrder("is_active"))},"Активный "),e("th",{scope:"col",class:"cursor-pointer",onClick:s[12]||(s[12]=n=>t.loadAndOrder("updated_at"))},"Дата изменения"),CV])]),e("tbody",null,[(l(!0),i(f,null,$(t.quizzes,(n,a)=>(l(),i("tr",{class:g({"border-info":n.deleted_at==null,"border-danger":n.deleted_at!=null})},[e("th",SV,u(n.id),1),e("td",{onClick:h=>t.selectEvent(n)},u(n.title||"Не указано"),9,jV),e("td",null,u((n.questions||[]).length),1),e("td",null,u((n.commands||[]).length),1),e("td",null,[n.image!=null?c((l(),i("img",VV,null,512)),[[d,"/file-by-file-id/"+n.image]]):(l(),i("p",qV,"не указано"))]),e("td",null,u(n.description||"Не указано"),1),e("td",null,[n.completed_at?(l(),i("p",zV,u(t.$filters.currentFull(n.completed_at)),1)):(l(),i("p",PV,"Не задано"))]),e("td",null,[n.start_at?(l(),i("p",UV,u(t.$filters.currentFull(n.start_at)),1)):(l(),i("p",OV,"Не задано"))]),e("td",null,[n.end_at?(l(),i("p",AV,u(t.$filters.currentFull(n.end_at)),1)):(l(),i("p",IV,"Не задано"))]),e("td",null,u(n.display_type),1),e("td",null,u(n.time_limit),1),e("td",null,[n.show_answers?(l(),i("i",QV)):(l(),i("i",TV))]),e("td",null,[n.is_active?(l(),i("i",MV)):(l(),i("i",DV))]),e("td",null,u(t.$filters.current(n.updated_at)),1),e("td",null,[n.id?(l(),i("div",RV,[BV,e("ul",EV,[n.deleted_at==null?(l(),i("li",LV,[e("a",{class:"dropdown-item",onClick:h=>t.removeQuiz(n.id),href:"javascript:void(0)"},"Удалить",8,KV)])):r("",!0)])])):r("",!0)])],2))),256))])])):(l(),i("div",NV,[JV,e("div",HV,[e("div",YV,[c(e("img",GV,null,512),[[d,"../images/icon.png"]])]),WV,XV,e("div",ZV,[e("button",{onClick:s[13]||(s[13]=(...n)=>t.createQuiz&&t.createQuiz(...n)),class:"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill btn-primary",type:"button"}," Добавить "),xV])])]))]),t.quizzes.length>0?(l(),i("div",eq,[t.paginate_object?(l(),y(q,{key:0,onPagination_page:t.nextQuizzes,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])):r("",!0)])}}}),oq={props:{type:String,value:String}},lq={class:"d-flex mb-2"},iq={class:"form-floating mb-3"},nq=["value"],aq=e("label",{for:"custom-url-link-for-success"},"Ссылка на файл",-1);function dq(o,t,s,d,n,a){return l(),i(f,null,[e("div",lq,[e("span",{class:g(["badge bg-secondary cursor-pointer mr-1",{"bg-success":s.type=="video"}]),onClick:t[0]||(t[0]=h=>o.$emit("update:type","video"))},"Видео",2),e("span",{class:g(["badge bg-secondary cursor-pointer mr-1",{"bg-success":s.type=="video_note"}]),onClick:t[1]||(t[1]=h=>o.$emit("update:type","video_note"))},"Кружок",2),e("span",{class:g(["badge bg-secondary cursor-pointer mr-1",{"bg-success":s.type=="photo"}]),onClick:t[2]||(t[2]=h=>o.$emit("update:type","photo"))},"Изображение",2),e("span",{class:g(["badge bg-secondary cursor-pointer mr-1",{"bg-success":s.type=="audio"}]),onClick:t[3]||(t[3]=h=>o.$emit("update:type","audio"))},"Звук",2)]),e("div",iq,[e("input",{type:"text",class:"form-control",value:s.value,onInput:t[4]||(t[4]=h=>o.$emit("update:value",h.target.value)),id:"custom-url-link-for-success",placeholder:"https://...."},null,40,nq),aq])],64)}const X=U(oq,[["render",dq]]),rq={class:"row py-3"},cq={class:"col-12"},uq={class:"row"},mq={class:"col-12 mb-3"},hq={key:0},_q=["onClick"],pq={class:"form-label",id:"quiz-round"},bq=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),fq=e("div",null," Раунд, в котором будет отображен вопрос ",-1),gq=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),vq={class:"col-12 mb-3"},yq={class:"form-label",id:"event-on_after_appointment"},$q=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),kq=e("div",null," Текст вопроса ",-1),Fq=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),wq={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},Cq={class:"col-12 mb-3"},Sq={class:"form-check"},jq=e("label",{class:"form-check-label",for:"need_media"}," Нужен медиа-контент ",-1),Vq={key:0,class:"col-12 mb-3"},qq={class:"form-label",id:"quiz-images"},zq=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Pq=e("div",null," Изображение, видео, аудио сопровождение вопроса ",-1),Uq={key:0,class:"badge rounded-pill text-bg-info m-0"},Oq=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Aq=e("h6",null,"Вставьте ссылку на контент...",-1),Iq=e("h6",null,"...или выберите из доступных",-1),Qq={class:"col-12 mb-3"},Tq={class:"form-check"},Mq=e("label",{class:"form-check-label",for:"is_multiply"}," Множественные ответы ",-1),Dq={class:"col-12 mb-3"},Rq={class:"form-check"},Bq=e("label",{class:"form-check-label",for:"is_open"}," Открытый вопрос ",-1),Eq={class:"col-12 mb-3"},Lq={class:"d-flex justify-content-between"},Kq={class:"form-label",id:"quiz-description"},Nq=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Jq=e("div",null," Текст при выборе правильного ответа ",-1),Hq=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Yq={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},Gq={class:"col-12 mb-3"},Wq={class:"form-check"},Xq=e("label",{class:"form-check-label",for:"need_media_for_success"}," Нужен медиа-контент при правильном ответе ",-1),Zq={key:1,class:"col-12 mb-3"},xq=e("h6",null,"Вставьте ссылку на контент...",-1),ez=e("h6",null,"...или выберите из доступных",-1),tz={class:"col-12 mb-3"},sz={class:"d-flex justify-content-between"},oz={class:"form-label",id:"quiz-description"},lz=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),iz=e("div",null," Текст в выбора неправильного ответа ",-1),nz=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),az={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},dz={class:"col-12 mb-3"},rz={class:"form-check"},cz=e("label",{class:"form-check-label",for:"need_media_for_failed"}," Нужен медиа-контент при неправильном ответе ",-1),uz={key:2,class:"col-12 mb-3"},mz=e("h6",null,"Вставьте ссылку на контент...",-1),hz=e("h6",null,"...или выберите из доступных",-1),_z={class:"row"},pz={class:"col-12"},bz={class:"col-12"},fz={key:0,class:"table"},gz=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"#"),e("th",{scope:"col"},"Текст вопроса"),e("th",{scope:"col"},"Баллы"),e("th",{scope:"col"},"Контент"),e("th",{scope:"col"},"Тип контента"),e("th",{scope:"col"},"Является верным"),e("th",{scope:"col"},"Действие")])],-1),vz={scope:"row"},yz={class:"form-floating mb-3"},$z=["onUpdate:modelValue","id"],kz=["for"],Fz={class:"form-floating mb-3"},wz=["onUpdate:modelValue","id"],Cz=["for"],Sz=["onClick"],jz={class:"form-check"},Vz=["onUpdate:modelValue","id"],qz=["for"],zz={class:"dropdown"},Pz=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),Uz={class:"dropdown-menu"},Oz={key:0},Az=["onClick"],Iz={key:1},Qz=["onClick"],Tz={key:1},Mz={class:"row"},Dz={class:"col-12"},Rz={type:"submit",class:"btn btn-outline-success w-100 p-3"},Bz={key:0},Ez={key:1},Lz={class:"modal fade",id:"chooseMediaContent",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},Kz={class:"modal-dialog"},Nz={class:"modal-content"},Jz={key:0,class:"modal-body"},Hz=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),Yz={class:"modal fade",id:"chooseSuccessMediaContent",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},Gz={class:"modal-dialog"},Wz={class:"modal-content"},Xz={class:"modal-body"},Zz=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),xz={class:"modal fade",id:"chooseFailureMediaContent",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},eP={class:"modal-dialog"},tP={class:"modal-content"},sP={class:"modal-body"},oP=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),lP={class:"modal fade",id:"chooseBaseMediaContent",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},iP={class:"modal-dialog"},nP={class:"modal-content"},aP={class:"modal-body"},dP=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),rP={props:["quizId","bot","question"],data(){return{step:0,load:!1,selectedQuestionIndex:null,need_media:!1,need_media_for_success:!1,need_media_for_failed:!1,rounds:[],questionForm:{id:null,text:null,round:null,media_content:null,content_type:null,is_multiply:!1,is_open:!1,answers:[],success_message:null,failure_message:null,success_media_content:null,failure_media_content:null,success_media_content_type:null,failure_media_content_type:null}}},watch:{questionForm:{handler(o){this.need_reset=!0},deep:!0},need_media:function(o,t){this.need_page_images||(this.questionForm.media_content=null,this.questionForm.content_type=null)},need_media_for_success:function(o,t){this.need_page_images||(this.questionForm.success_media_content=null,this.questionForm.success_media_content_type=null)},need_media_for_failed:function(o,t){this.need_page_images||(this.questionForm.failure_media_content=null,this.questionForm.failure_media_content_type=null)}},mounted(){this.loadQuizRounds(),this.question&&(this.question.media_content!=null&&(this.need_media=!0),this.question.success_media_content!=null&&(this.need_media_for_success=!0),this.question.failure_media_content!=null&&(this.need_media_for_failed=!0),this.$nextTick(()=>{this.questionForm={id:this.question.id||null,text:this.question.text||null,round:this.question.round||null,media_content:this.question.media_content||null,content_type:this.question.content_type||null,is_multiply:this.question.is_multiply||!1,is_open:this.question.is_open||!1,answers:this.question.answers||[],success_message:this.question.success_message||null,failure_message:this.question.failure_message||null,success_media_content:this.question.success_media_content||null,failure_media_content:this.question.failure_media_content||null,success_media_content_type:this.question.success_media_content_type||null,failure_media_content_type:this.question.failure_media_content_type||null}}))},methods:{attachTo(o){this.questionForm[o.param]==null?this.questionForm[o.param]=o.value:this.questionForm[o.param]+=o.value},loadQuizRounds(){this.$store.dispatch("loadQuizRounds",{dataObject:{bot_id:this.bot.id||null,quiz_id:this.quizId||null}}).then(o=>{this.rounds=o})},chooseBaseMediaContent(o){new bootstrap.Modal(document.getElementById("chooseBaseMediaContent"),{}).show()},chooseSuccessMediaContent(o){new bootstrap.Modal(document.getElementById("chooseSuccessMediaContent"),{}).show()},chooseFailureMediaContent(o){new bootstrap.Modal(document.getElementById("chooseFailureMediaContent"),{}).show()},chooseMediaContent(o){this.selectedQuestionIndex=null,this.$nextTick(()=>{this.selectedQuestionIndex=o}),new bootstrap.Modal(document.getElementById("chooseMediaContent"),{}).show()},selectMediaForFailure(o){this.questionForm.failure_media_content=o.file_id,this.questionForm.failure_media_content_type=o.type},selectMediaForSuccess(o){this.questionForm.success_media_content=o.file_id,this.questionForm.success_media_content_type=o.type},selectMediaForAnswer(o){this.questionForm.answers[this.selectedQuestionIndex].media_content=o.file_id,this.questionForm.answers[this.selectedQuestionIndex].content_type=o.type},selectMedia(o){this.questionForm.media_content=o.file_id,this.questionForm.content_type=o.type},clearQuestionForm(){this.questionForm={id:null,text:null,round:null,media_content:null,content_type:null,is_multiply:!1,is_open:!1,answers:[],success_message:null,failure_message:null,success_media_content:null,failure_media_content:null,success_media_content_type:null,failure_media_content_type:null}},addNewAnswer(){this.questionForm.answers.push({text:null,media_content:null,content_type:null,is_right_answer:!1,points:0})},removeAnswerFromArray(o){this.questionForm.answers.splice(o,1)},removeAnswer(o){this.$store.dispatch("removeQuizAnswer",{quizAnswerId:o}).then(t=>{this.$notify("Вопрос успешно удален");let s=this.questionForm.answers.findIndex(d=>d.id==o);this.questionForm.answers.splice(s,1)}).catch(t=>{this.$notify("Ошибка удаления вопроса")})},submitForm(){let o=new FormData;Object.keys(this.questionForm).forEach(t=>{const s=this.questionForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),o.append("bot_id",this.bot.id),o.append("quiz_id",this.quizId),this.$store.dispatch("storeQuizQuestion",{quizQuestionForm:o}).then(t=>{this.$emit("callback",t.data),this.$notify("Вопрос успешно создан"),this.clearQuestionForm(),this.loadQuizRounds()}).catch(t=>{this.$notify("Ошибка создания вопроса")})}}},cP=Object.assign(rP,{__name:"QuizQuestionForm",setup(o){return(t,s)=>{const d=z("Popper");return l(),i(f,null,[e("div",rq,[e("div",cq,[e("button",{onClick:s[0]||(s[0]=(...n)=>t.clearQuestionForm&&t.clearQuestionForm(...n)),class:"btn btn-primary"},"Новый вопрос ")])]),e("form",{onSubmit:s[20]||(s[20]=C((...n)=>t.submitForm&&t.submitForm(...n),["prevent"]))},[e("div",uq,[e("div",mq,[t.rounds.length>0?(l(),i("p",hq,[m(" Ранее созданные раунды: "),(l(!0),i(f,null,$(t.rounds,n=>(l(),i("span",{onClick:a=>t.questionForm.round=n,class:"badge bg-primary mr-1 cursor-pointer"},u(n),9,_q))),256))])):r("",!0),e("label",pq,[b(d,null,{content:v(()=>[fq]),default:v(()=>[bq]),_:1}),m(" Раунд "),gq]),c(e("input",{type:"number",class:"form-control",placeholder:"Раунд","aria-label":"Раундт",step:"1",min:"1","onUpdate:modelValue":s[1]||(s[1]=n=>t.questionForm.round=n),"aria-describedby":"quiz-round",required:""},null,512),[[_,t.questionForm.round]])]),e("div",vq,[e("label",yq,[b(d,null,{content:v(()=>[kq]),default:v(()=>[$q]),_:1}),m(" Текст вопроса "),Fq,t.questionForm.text?(l(),i("small",wq," Длина текста "+u(t.questionForm.text.length)+"/255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Текст вопроса","aria-label":"Текст вопроса","onUpdate:modelValue":s[2]||(s[2]=n=>t.questionForm.text=n),maxlength:"255","aria-describedby":"review-text",required:""},`
                    `,512),[[_,t.questionForm.text]])]),e("div",Cq,[e("div",Sq,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[3]||(s[3]=n=>t.need_media=n),type:"checkbox",id:"need_media"},null,512),[[k,t.need_media]]),jq])]),t.need_media?(l(),i("div",Vq,[e("label",qq,[b(d,null,{content:v(()=>[Pq]),default:v(()=>[zq]),_:1}),m(" Медиа контент к вопросу "),t.questionForm.content_type?(l(),i("span",Uq,u(t.questionForm.content_type),1)):r("",!0),Oq]),Aq,b(X,{value:t.questionForm.media_content,type:t.questionForm.content_type,"onUpdate:type":s[4]||(s[4]=n=>t.questionForm.content_type=n),"onUpdate:value":s[5]||(s[5]=n=>t.questionForm.media_content=n)},null,8,["value","type"]),Iq,e("button",{type:"button",onClick:s[6]||(s[6]=(...n)=>t.chooseBaseMediaContent&&t.chooseBaseMediaContent(...n)),class:"btn btn-outline-info rounded-lg"},"Выбрать медиа-файл ")])):r("",!0),e("div",Qq,[e("div",Tq,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[7]||(s[7]=n=>t.questionForm.is_multiply=n),type:"checkbox",id:"is_multiply"},null,512),[[k,t.questionForm.is_multiply]]),Mq])]),e("div",Dq,[e("div",Rq,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[8]||(s[8]=n=>t.questionForm.is_open=n),type:"checkbox",id:"is_open"},null,512),[[k,t.questionForm.is_open]]),Bq])]),e("div",Eq,[e("div",Lq,[e("label",Kq,[b(d,null,{content:v(()=>[Jq]),default:v(()=>[Nq]),_:1}),m(" Текст при выборе правильного ответа "),Hq,t.questionForm.success_message?(l(),i("small",Yq," Длина текста "+u(t.questionForm.success_message.length)+"/255",1)):r("",!0)]),b(N,{param:"success_message",onCallback:t.attachTo},null,8,["onCallback"])]),c(e("textarea",{class:"form-control",placeholder:"Текст при правильном ответе","aria-label":"Текст при правильном ответе",maxlength:"255","onUpdate:modelValue":s[9]||(s[9]=n=>t.questionForm.success_message=n),"aria-describedby":"quiz-question-success_message"},`
                    `,512),[[_,t.questionForm.success_message]])]),e("div",Gq,[e("div",Wq,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[10]||(s[10]=n=>t.need_media_for_success=n),type:"checkbox",id:"need_media_for_success"},null,512),[[k,t.need_media_for_success]]),Xq])]),t.need_media_for_success?(l(),i("div",Zq,[xq,b(X,{type:t.questionForm.success_media_content_type,"onUpdate:type":s[11]||(s[11]=n=>t.questionForm.success_media_content_type=n),value:t.questionForm.success_media_content,"onUpdate:value":s[12]||(s[12]=n=>t.questionForm.success_media_content=n)},null,8,["type","value"]),ez,e("button",{type:"button",onClick:s[13]||(s[13]=(...n)=>t.chooseSuccessMediaContent&&t.chooseSuccessMediaContent(...n)),class:"btn btn-outline-info rounded-lg"},"Выбрать медиа-файл ")])):r("",!0),e("div",tz,[e("div",sz,[e("label",oz,[b(d,null,{content:v(()=>[iz]),default:v(()=>[lz]),_:1}),m(" Текст при выборе неправильного ответа "),nz,t.questionForm.failure_message?(l(),i("small",az," Длина текста "+u(t.questionForm.failure_message.length)+"/255",1)):r("",!0)]),b(N,{param:"failure_message",onCallback:t.attachTo},null,8,["onCallback"])]),c(e("textarea",{class:"form-control",placeholder:"Текст при неправильном ответе","aria-label":"Текст при неправильном ответе",maxlength:"255","onUpdate:modelValue":s[14]||(s[14]=n=>t.questionForm.failure_message=n),"aria-describedby":"quiz-question-failure-message"},`
                    `,512),[[_,t.questionForm.failure_message]])]),e("div",dz,[e("div",rz,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[15]||(s[15]=n=>t.need_media_for_failed=n),type:"checkbox",id:"need_media_for_failed"},null,512),[[k,t.need_media_for_failed]]),cz])]),t.need_media_for_failed?(l(),i("div",uz,[mz,b(X,{type:t.questionForm.failure_media_content_type,"onUpdate:type":s[16]||(s[16]=n=>t.questionForm.failure_media_content_type=n),value:t.questionForm.failure_media_content,"onUpdate:value":s[17]||(s[17]=n=>t.questionForm.failure_media_content=n)},null,8,["type","value"]),hz,e("button",{type:"button",onClick:s[18]||(s[18]=(...n)=>t.chooseFailureMediaContent&&t.chooseFailureMediaContent(...n)),class:"btn btn-outline-info rounded-lg"},"Выбрать медиа-файл ")])):r("",!0)]),e("div",_z,[e("div",pz,[e("button",{onClick:s[19]||(s[19]=(...n)=>t.addNewAnswer&&t.addNewAnswer(...n)),type:"button",class:"btn btn-outline-success rounded-5"}," Добавить ответы ")]),e("div",bz,[t.questionForm.answers.length>0?(l(),i("table",fz,[gz,e("tbody",null,[(l(!0),i(f,null,$(t.questionForm.answers,(n,a)=>(l(),i("tr",{class:g({"border-info":n.deleted_at==null,"border-danger":n.deleted_at!=null})},[e("th",vz,u(n.id||"Новый"),1),e("td",null,[e("div",yz,[c(e("input",{type:"text","onUpdate:modelValue":h=>t.questionForm.answers[a].text=h,class:"form-control",id:"answer-text-"+a,placeholder:"Текст ответа"},null,8,$z),[[_,t.questionForm.answers[a].text]]),e("label",{for:"answer-text-"+a},"Текст ответа",8,kz)])]),e("td",null,[e("div",Fz,[c(e("input",{type:"text","onUpdate:modelValue":h=>t.questionForm.answers[a].points=h,class:"form-control",id:"answer-points-"+a,placeholder:"Текст ответа"},null,8,wz),[[_,t.questionForm.answers[a].points]]),e("label",{for:"answer-points-"+a},"Баллы",8,Cz)])]),e("td",null,[e("p",{class:"cursor-pointer",onClick:h=>t.chooseMediaContent(a)},u(n.media_content||"Не указано"),9,Sz)]),e("td",null,u(n.content_type||"Не указано"),1),e("td",null,[e("div",jz,[c(e("input",{class:"form-check-input","onUpdate:modelValue":h=>t.questionForm.answers[a].is_right_answer=h,type:"checkbox",id:"answer-is_right_answer-"+a},null,8,Vz),[[k,t.questionForm.answers[a].is_right_answer]]),e("label",{class:"form-check-label",for:"answer-is_right_answer-"+a}," Правильный ответ ",8,qz)])]),e("td",null,[e("div",zz,[Pz,e("ul",Uz,[n.id==null?(l(),i("li",Oz,[e("a",{class:"dropdown-item",onClick:h=>t.removeAnswerFromArray(a),href:"javascript:void(0)"},"Удалить",8,Az)])):r("",!0),n.deleted_at==null&&n.id!=null?(l(),i("li",Iz,[e("a",{class:"dropdown-item",onClick:h=>t.removeAnswer(n.id),href:"javascript:void(0)"},"Удалить",8,Qz)])):r("",!0)])])])],2))),256))])])):(l(),i("p",Tz,"На текущий момент нет ни одного созданного ответа"))])]),e("div",Mz,[e("div",Dz,[e("button",Rz,[t.questionForm.id==null?(l(),i("span",Bz,"Сохранить вопрос")):(l(),i("span",Ez,"Обновить вопрос"))])])])],32),e("div",Lz,[e("div",Kz,[e("div",Nz,[t.selectedQuestionIndex!=null?(l(),i("div",Jz,[b(P,{"need-video":!0,"need-video-note":!0,"need-audio":!0,"need-photo":!0,selected:[t.questionForm.answers[t.selectedQuestionIndex||0].media_content||""],onSelect:t.selectMediaForAnswer},null,8,["selected","onSelect"])])):r("",!0),Hz])])]),e("div",Yz,[e("div",Gz,[e("div",Wz,[e("div",Xz,[b(P,{"need-video":!0,"need-video-note":!0,"need-audio":!0,"need-photo":!0,selected:[t.questionForm.success_media_content],onSelect:t.selectMediaForSuccess},null,8,["selected","onSelect"])]),Zz])])]),e("div",xz,[e("div",eP,[e("div",tP,[e("div",sP,[b(P,{"need-video":!0,"need-video-note":!0,"need-audio":!0,"need-photo":!0,selected:[t.questionForm.failure_media_content],onSelect:t.selectMediaForFailure},null,8,["selected","onSelect"])]),oP])])]),e("div",lP,[e("div",iP,[e("div",nP,[e("div",aP,[b(P,{"need-video":!0,"need-video-note":!0,"need-audio":!0,"need-photo":!0,selected:[t.questionForm.media_content],onSelect:t.selectMedia},null,8,["selected","onSelect"])]),dP])])])],64)}}}),uP={class:"row"},mP={class:"col-12"},hP={key:0,class:"table"},_P=e("th",{scope:"col"},"Число ответов",-1),pP=e("th",{scope:"col"},"Действие",-1),bP={scope:"row"},fP=["onClick"],gP={key:0,class:"fa-solid fa-chevron-down text-success"},vP={key:1,class:"fa-solid fa-xmark text-danger"},yP={key:0,class:"fa-solid fa-chevron-down text-success"},$P={key:1,class:"fa-solid fa-xmark text-danger"},kP={key:0,class:"dropdown"},FP=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),wP={class:"dropdown-menu"},CP={key:0},SP=["onClick"],jP={key:1},VP={class:"col-12"},qP={props:["bot","quizId"],data(){return{direction:"desc",order:"updated_at",show:!0,is_group:!1,loading:!0,questions:[],search:null,paginate_object:null}},computed:{...S(["getQuizQuestions","getQuizQuestionsPaginateObject"])},mounted(){this.loadQuizQuestions()},methods:{nextQuizQuestion(o){this.loadQuizQuestions(o)},selectQuizQuestion(o){this.$emit("select",o),this.$notify("Вопрос успешно выбран")},removeQuizQuestion(o){this.loading=!0,this.$store.dispatch("removeQuizQuestion",{quizQuestionId:o}).then(t=>{this.loading=!1,this.loadQuizQuestions(0),this.$notify("Вопрос успешно удален")}).catch(()=>{this.loading=!1,this.$notify("Вопрос удаления сервиса")})},loadAndOrder(o){this.order=o,this.direction=this.direction==="desc"?"asc":"desc",this.loadQuizQuestions(0)},loadQuizQuestions(o=0){this.loading=!0,this.$store.dispatch("loadQuizQuestions",{dataObject:{quiz_id:this.quizId,bot_id:this.bot.id||null,search:this.search,order:this.order,direction:this.direction},page:o,size:100}).then(t=>{this.loading=!1,this.questions=this.getQuizQuestions,this.paginate_object=this.getQuizQuestionsPaginateObject}).catch(()=>{this.loading=!1})}}},zP=Object.assign(qP,{__name:"QuizQuestionTable",setup(o){return(t,s)=>(l(),i("div",uP,[e("div",mP,[t.questions.length>0?(l(),i("table",hP,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:s[0]||(s[0]=d=>t.loadAndOrder("id"))},"#"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[1]||(s[1]=d=>t.loadAndOrder("text"))},"Текст вопроса"),_P,e("th",{scope:"col",class:"cursor-pointer",onClick:s[2]||(s[2]=d=>t.loadAndOrder("round"))},"Раунд"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[3]||(s[3]=d=>t.loadAndOrder("media_content"))},"Контент"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[4]||(s[4]=d=>t.loadAndOrder("content_type"))},"Тип контента"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[5]||(s[5]=d=>t.loadAndOrder("is_multiply"))},"Множественный"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[6]||(s[6]=d=>t.loadAndOrder("is_open"))},"Открытый"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[7]||(s[7]=d=>t.loadAndOrder("updated_at"))},"Дата изменения"),pP])]),e("tbody",null,[(l(!0),i(f,null,$(t.questions,(d,n)=>(l(),i("tr",{class:g({"border-info":d.deleted_at==null,"border-danger":d.deleted_at!=null})},[e("th",bP,u(d.id),1),e("td",{onClick:a=>t.selectQuizQuestion(d)},u(d.text||"Не указано"),9,fP),e("td",null,u((d.answers||[]).length),1),e("td",null,u(d.round||"Не указано"),1),e("td",null,u(d.media_content||"Не указано"),1),e("td",null,u(d.content_type||"Не указано"),1),e("td",null,[d.is_multiply?(l(),i("i",gP)):(l(),i("i",vP))]),e("td",null,[d.is_open?(l(),i("i",yP)):(l(),i("i",$P))]),e("td",null,u(t.$filters.current(d.updated_at)),1),e("td",null,[d.id?(l(),i("div",kP,[FP,e("ul",wP,[d.deleted_at==null?(l(),i("li",CP,[e("a",{class:"dropdown-item",onClick:a=>t.removeQuizQuestion(d.id),href:"javascript:void(0)"},"Удалить",8,SP)])):r("",!0)])])):r("",!0)])],2))),256))])])):(l(),i("p",jP,"На текущий момент нет ни одного созданного вопроса"))]),e("div",VP,[t.paginate_object?(l(),y(q,{key:0,onPagination_page:t.nextQuizQuestion,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])]))}}),PP={class:"row py-3"},UP={class:"col-12"},OP={class:"row"},AP={class:"col-12 mb-3"},IP={class:"form-label",id:"command-title"},QP=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),TP=e("div",null," Название команды ",-1),MP=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),DP={class:"col-12 mb-3"},RP={class:"form-label",id:"event-on_after_appointment"},BP=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),EP=e("div",null," Текст описания команды ",-1),LP=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),KP={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},NP=e("div",{class:"col-12 mb-3"},[e("button",{type:"button",class:"btn btn-outline-info rounded-5","data-bs-toggle":"modal","data-bs-target":"#select-players"}," Подобрать участников команды ")],-1),JP={key:0,class:"col-12 mb-3"},HP=e("h4",null,"Пользователи в команде",-1),YP={class:"list-group list-group-numbered"},GP={class:"list-group-item d-flex justify-content-between align-items-start"},WP={class:"ms-2 me-auto"},XP={class:"fw-bold"},ZP={class:"dropdown"},xP=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),eU={class:"dropdown-menu"},tU=["onClick"],sU={class:"row"},oU={class:"col-12"},lU={type:"submit",class:"btn btn-outline-success w-100 p-3"},iU={key:0},nU={key:1},aU={class:"modal fade",id:"select-players",tabindex:"-1","aria-labelledby":"select-players-label","aria-hidden":"true"},dU={class:"modal-dialog modal-fullscreen"},rU={class:"modal-content"},cU=e("div",{class:"modal-header"},[e("h1",{class:"modal-title fs-5",id:"select-players-label"},"Подбор участников команды"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),uU={class:"modal-body"},mU=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),hU={props:["quizId","bot","command"],data(){return{step:0,load:!1,commandForm:{id:null,title:null,description:null,players:[]}}},watch:{commandForm:{handler(o){this.need_reset=!0},deep:!0}},mounted(){this.command&&this.$nextTick(()=>{this.commandForm={id:this.command.id||null,title:this.command.title||null,description:this.command.description||null,players:this.command.players||[]}})},methods:{removePlayerFromCommand(o){},selectBotUser(o){if(this.commandForm.players.findIndex(s=>s.id==o.id)>=0){this.$notify("Такой пользователь уже есть в списке");return}this.$notify("Пользователь успешно добавлен"),this.commandForm.players.push(o)},clearCommandForm(){this.commandForm={id:null,title:null,description:null,players:[]}},submitForm(){let o=new FormData;Object.keys(this.commandForm).forEach(t=>{const s=this.commandForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),o.append("bot_id",this.bot.id),o.append("quiz_id",this.quizId),this.$store.dispatch("storeQuizCommand",{quizCommandForm:o}).then(t=>{this.$emit("callback",t.data),this.$notify("Команда успешно создана"),this.clearCommandForm()}).catch(t=>{this.$notify("Ошибка создания команды")})}}},_U=Object.assign(hU,{__name:"QuizCommandForm",setup(o){return(t,s)=>{const d=z("Popper");return l(),i(f,null,[e("div",PP,[e("div",UP,[e("button",{onClick:s[0]||(s[0]=(...n)=>t.clearCommandForm&&t.clearCommandForm(...n)),class:"btn btn-primary"},"Новая команда")])]),e("form",{onSubmit:s[3]||(s[3]=C((...n)=>t.submitForm&&t.submitForm(...n),["prevent"]))},[e("div",OP,[e("div",AP,[e("label",IP,[b(d,null,{content:v(()=>[TP]),default:v(()=>[QP]),_:1}),m(" Название команды "),MP]),c(e("input",{type:"text",class:"form-control",placeholder:"Название команды","aria-label":"Название команды",maxlength:"255","onUpdate:modelValue":s[1]||(s[1]=n=>t.commandForm.title=n),"aria-describedby":"command-title",required:""},null,512),[[_,t.commandForm.title]])]),e("div",DP,[e("label",RP,[b(d,null,{content:v(()=>[EP]),default:v(()=>[BP]),_:1}),m(" Описание команды "),LP,t.commandForm.description?(l(),i("small",KP," Длина текста "+u(t.commandForm.description.length)+"/255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Текст описания","aria-label":"Текст описания","onUpdate:modelValue":s[2]||(s[2]=n=>t.commandForm.description=n),maxlength:"255","aria-describedby":"command-text",required:""},`
                    `,512),[[_,t.commandForm.description]])]),NP,t.commandForm.players.length>0?(l(),i("div",JP,[HP,e("ol",YP,[(l(!0),i(f,null,$(t.commandForm.players,n=>(l(),i("li",GP,[e("div",WP,[e("div",XP,"#"+u(n.id),1),m(" "+u(n.fio_from_telegram||n.telegram_chat_id),1)]),e("div",ZP,[xP,e("ul",eU,[e("li",null,[e("a",{class:"dropdown-item",onClick:a=>t.removePlayerFromCommand(n.id),href:"javascript:void(0)"},"Удалить",8,tU)])])])]))),256))])])):r("",!0)]),e("div",sU,[e("div",oU,[e("button",lU,[t.commandForm.id==null?(l(),i("span",iU,"Сохранить команду")):(l(),i("span",nU,"Обновить команду"))])])])],32),e("div",aU,[e("div",dU,[e("div",rU,[cU,e("div",uU,[b(J,{simple:!0,onSelect:t.selectBotUser},null,8,["onSelect"])]),mU])])])],64)}}}),pU={class:"row"},bU={class:"col-12"},fU={key:0,class:"table"},gU=e("th",{scope:"col"},"Число участников",-1),vU=e("th",{scope:"col"},"Действие",-1),yU={scope:"row"},$U=["onClick"],kU={key:0,class:"dropdown"},FU=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),wU={class:"dropdown-menu"},CU={key:0},SU=["onClick"],jU={key:1},VU={class:"col-12"},qU={props:["bot","quizId"],data(){return{direction:"desc",order:"updated_at",show:!0,is_group:!1,loading:!0,commands:[],search:null,paginate_object:null}},computed:{...S(["getQuizCommands","getQuizCommandsPaginateObject"])},mounted(){this.loadQuizCommands()},methods:{nextQuizCommand(o){this.loadQuizCommands(o)},selectQuizCommand(o){this.$emit("select",o),this.$notify("Вопрос успешно выбран")},removeQuizCommand(o){this.loading=!0,this.$store.dispatch("removeQuizCommand",{quizCommandId:o}).then(t=>{this.loading=!1,this.loadQuizCommands(0),this.$notify("Вопрос успешно удален")}).catch(()=>{this.loading=!1,this.$notify("Вопрос удаления сервиса")})},loadAndOrder(o){this.order=o,this.direction=this.direction==="desc"?"asc":"desc",this.loadQuizCommands(0)},loadQuizCommands(o=0){this.loading=!0,this.$store.dispatch("loadQuizCommands",{dataObject:{quiz_id:this.quizId,bot_id:this.bot.id||null,search:this.search,order:this.order,direction:this.direction},page:o,size:100}).then(t=>{this.loading=!1,this.commands=this.getQuizCommands,this.paginate_object=this.getQuizCommandsPaginateObject}).catch(()=>{this.loading=!1})}}},zU=Object.assign(qU,{__name:"QuizCommandTable",setup(o){return(t,s)=>(l(),i("div",pU,[e("div",bU,[t.commands.length>0?(l(),i("table",fU,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:s[0]||(s[0]=d=>t.loadAndOrder("id"))},"#"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[1]||(s[1]=d=>t.loadAndOrder("title"))},"Название"),gU,e("th",{scope:"col",class:"cursor-pointer",onClick:s[2]||(s[2]=d=>t.loadAndOrder("description"))},"Описание"),vU])]),e("tbody",null,[(l(!0),i(f,null,$(t.commands,(d,n)=>(l(),i("tr",{class:g({"border-info":d.deleted_at==null,"border-danger":d.deleted_at!=null})},[e("th",yU,u(d.id),1),e("td",{onClick:a=>t.selectQuizCommand(d)},u(d.title||"Не указано"),9,$U),e("td",null,u((d.players||[]).length),1),e("td",null,u(d.description||"Не указано"),1),e("td",null,[d.id?(l(),i("div",kU,[FU,e("ul",wU,[d.deleted_at==null?(l(),i("li",CU,[e("a",{class:"dropdown-item",onClick:a=>t.removeQuizCommand(d.id),href:"javascript:void(0)"},"Удалить",8,SU)])):r("",!0)])])):r("",!0)])],2))),256))])])):(l(),i("p",jU,"На текущий момент нет ни одной созданной команды"))]),e("div",VU,[t.paginate_object?(l(),y(q,{key:0,onPagination_page:t.nextQuizCommand,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])]))}}),PU={class:"row"},UU={class:"col-12"},OU={key:0,class:"table"},AU=e("th",{scope:"col"},"Название квиза",-1),IU=e("th",{scope:"col"},"Название команды",-1),QU=e("th",{scope:"col"},"Число участников",-1),TU=e("th",{scope:"col"},"Результат",-1),MU=e("th",{scope:"col"},"Действие",-1),DU={scope:"row"},RU=["onClick"],BU={key:0},EU=e("td",null,"-",-1),LU={key:0,class:"dropdown"},KU=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),NU={class:"dropdown-menu"},JU={key:0},HU=["onClick"],YU={key:1},GU={class:"col-12"},WU={props:["bot","quizId"],data(){return{direction:"desc",order:"updated_at",show:!0,is_group:!1,loading:!0,results:[],search:null,paginate_object:null}},computed:{...S(["getQuizResults","getQuizResultsPaginateObject"])},mounted(){this.loadQuizResults()},methods:{nextQuizResult(o){this.loadQuizResults(o)},selectQuizResult(o){this.$emit("select",o),this.$notify("Вопрос успешно выбран")},removeQuizResult(o){this.loading=!0,this.$store.dispatch("removeQuizResult",{quizResultId:o}).then(t=>{this.loading=!1,this.loadQuizResults(0),this.$notify("Вопрос успешно удален")}).catch(()=>{this.loading=!1,this.$notify("Вопрос удаления сервиса")})},loadAndOrder(o){this.order=o,this.direction=this.direction==="desc"?"asc":"desc",this.loadQuizResults(0)},loadQuizResults(o=0){this.loading=!0,this.$store.dispatch("loadQuizResults",{dataObject:{quiz_id:this.quizId,bot_id:this.bot.id||null,search:this.search,order:this.order,direction:this.direction},page:o,size:100}).then(t=>{this.loading=!1,this.results=this.getQuizResults,this.paginate_object=this.getQuizResultsPaginateObject}).catch(()=>{this.loading=!1})}}},XU=Object.assign(WU,{__name:"QuizResultTable",setup(o){return(t,s)=>(l(),i("div",PU,[e("div",UU,[t.results.length>0?(l(),i("table",OU,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:s[0]||(s[0]=d=>t.loadAndOrder("id"))},"#"),AU,IU,QU,e("th",{scope:"col",class:"cursor-pointer",onClick:s[1]||(s[1]=d=>t.loadAndOrder("points"))},"Баллы"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[2]||(s[2]=d=>t.loadAndOrder("times"))},"Время"),TU,MU])]),e("tbody",null,[(l(!0),i(f,null,$(t.results,(d,n)=>(l(),i("tr",{class:g({"border-info":d.deleted_at==null,"border-danger":d.deleted_at!=null})},[e("th",DU,u(d.id),1),e("td",{onClick:a=>t.selectQuizResult(d)},u(d.quiz.title||"Не указано"),9,RU),e("td",null,[d.command?(l(),i("span",BU,u(d.command.title||"Не указано"),1)):r("",!0)]),e("td",null,u((d.command.players||[]).length),1),e("td",null,u(d.points||"Не указано"),1),e("td",null,u(d.times||"Не указано"),1),EU,e("td",null,[d.id?(l(),i("div",LU,[KU,e("ul",NU,[d.deleted_at==null?(l(),i("li",JU,[e("a",{class:"dropdown-item",onClick:a=>t.removeQuizResult(d.id),href:"javascript:void(0)"},"Удалить",8,HU)])):r("",!0)])])):r("",!0)])],2))),256))])])):(l(),i("p",YU,"На текущий момент нет ни одного созданного вопроса"))]),e("div",GU,[t.paginate_object?(l(),y(q,{key:0,onPagination_page:t.nextQuizResult,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])]))}}),ZU={key:0,class:"py-2"},xU={class:"row"},eO={class:"col-12"},tO={key:1,class:"py-2"},sO={class:"row"},oO={class:"col-12"},lO={key:2,class:"py-2"},iO={class:"row"},nO={class:"col-12"},aO={class:"nav nav-tabs justify-content-center"},dO={key:0,class:"row py-3"},rO={class:"col-12"},cO={key:1,class:"row py-3"},uO={class:"col-12"},mO={class:"col-12 py-3"},hO=e("h4",null,"Доступные вопросы",-1),_O={key:2,class:"row"},pO={class:"col-12"},bO={class:"col-12 py-3"},fO=e("h4",null,"Команды участники квиза",-1),gO={key:3,class:"row"},vO={class:"col-12 py-3"},yO=e("h4",null,"Статистика",-1),$O={key:4,class:"row"},kO=e("div",{class:"col-12"},null,-1),FO=e("div",{class:"col-12 py-3"},[e("h4",null,"Отзывы к событию")],-1),wO=[kO,FO],CO={props:["bot"],data(){return{part:0,tab:0,loadTable:!1,loadQuizCommand:!1,loadQuizQuestion:!1,loadQuizQuestionTable:!1,loadQuizCommandTable:!1,loadQuizResult:!1,loadForm:!1,selectedQuiz:null,selectedQuizQuestion:null,selectedQuizCommand:null,selectedQuizResult:null}},mounted(){},methods:{callbackCommandForm(){this.loadQuizCommandTable=!0,this.$nextTick(()=>{this.loadQuizCommandTable=!1})},callbackQuestionForm(){this.loadQuizQuestionTable=!0,this.$nextTick(()=>{this.loadQuizQuestionTable=!1})},callbackForm(){this.loadTable=!0,this.part=0,this.$nextTick(()=>{this.loadTable=!1})},createQuiz(){this.part=2},selectQuizResult(o){this.loadQuizResult=!0,this.$nextTick(()=>{this.loadQuizResult=!1,this.selectedQuizResult=o})},selectQuizCommand(o){this.loadQuizCommand=!0,this.$nextTick(()=>{this.loadQuizCommand=!1,this.selectedQuizCommand=o})},selectQuizQuestion(o){this.loadQuizQuestion=!0,this.$nextTick(()=>{this.loadQuizQuestion=!1,this.selectedQuizQuestion=o})},selectQuiz(o){this.loadForm=!0,this.$nextTick(()=>{this.loadForm=!1,this.selectedQuiz=o,this.part=1,this.tab=0})}}},SO=Object.assign(CO,{__name:"Quizzes",setup(o){return(t,s)=>(l(),i(f,null,[t.part===0?(l(),i("div",ZU,[e("div",xU,[e("div",eO,[e("button",{type:"button",onClick:s[0]||(s[0]=(...d)=>t.createQuiz&&t.createQuiz(...d)),class:"btn btn-primary"}," Создать новый квиз ")])]),t.loadTable?r("",!0):(l(),y(sq,{key:0,onCreate:t.createQuiz,onSelect:t.selectQuiz,bot:o.bot},null,8,["onCreate","onSelect","bot"]))])):r("",!0),t.part===2?(l(),i("div",tO,[e("div",sO,[e("div",oO,[e("button",{type:"button",onClick:s[1]||(s[1]=d=>t.part=0),class:"btn btn-outline-primary"}," Назад ")])]),t.loadForm?r("",!0):(l(),y(ne,{key:0,onCallback:t.callbackForm,bot:o.bot},null,8,["onCallback","bot"]))])):r("",!0),t.part===1?(l(),i("div",lO,[e("div",iO,[e("div",nO,[e("button",{type:"button",onClick:s[2]||(s[2]=d=>t.part=0),class:"btn btn-outline-primary"}," Назад ")])]),e("ul",aO,[e("li",{class:"nav-item",onClick:s[3]||(s[3]=d=>t.tab=0)},[e("a",{class:g(["nav-link",{active:t.tab===0}]),"aria-current":"page",href:"javascript:void(0)"},"Информация о квизе",2)]),e("li",{class:"nav-item",onClick:s[4]||(s[4]=d=>t.tab=1)},[e("a",{class:g(["nav-link",{active:t.tab===1}]),href:"javascript:void(0)"},"Вопросы квиза",2)]),e("li",{class:"nav-item",onClick:s[5]||(s[5]=d=>t.tab=2)},[e("a",{class:g(["nav-link",{active:t.tab===2}]),href:"javascript:void(0)"},"Команды на квизе",2)]),e("li",{class:"nav-item",onClick:s[6]||(s[6]=d=>t.tab=3)},[e("a",{class:g(["nav-link",{active:t.tab===3}]),href:"javascript:void(0)"},"Командная статистика",2)])]),t.tab===0?(l(),i("div",dO,[e("div",rO,[t.loadForm?r("",!0):(l(),y(ne,{key:0,onCallback:t.callbackForm,quiz:t.selectedQuiz,bot:o.bot},null,8,["onCallback","quiz","bot"]))])])):r("",!0),t.tab===1?(l(),i("div",cO,[e("div",uO,[t.loadQuizQuestion?r("",!0):(l(),y(cP,{key:0,question:t.selectedQuizQuestion,"quiz-id":t.selectedQuiz.id,onCallback:t.callbackQuestionForm,bot:o.bot},null,8,["question","quiz-id","onCallback","bot"]))]),e("div",mO,[hO,t.loadQuizQuestionTable?r("",!0):(l(),y(zP,{key:0,"quiz-id":t.selectedQuiz.id,onSelect:t.selectQuizQuestion,bot:o.bot},null,8,["quiz-id","onSelect","bot"]))])])):r("",!0),t.tab===2?(l(),i("div",_O,[e("div",pO,[t.loadQuizCommand?r("",!0):(l(),y(_U,{key:0,command:t.selectedQuizCommand,"quiz-id":t.selectedQuiz.id,onCallback:t.callbackCommandForm,bot:o.bot},null,8,["command","quiz-id","onCallback","bot"]))]),e("div",bO,[fO,t.loadQuizCommandTable?r("",!0):(l(),y(zU,{key:0,"quiz-id":t.selectedQuiz.id,onSelect:t.selectQuizCommand,bot:o.bot},null,8,["quiz-id","onSelect","bot"]))])])):r("",!0),t.tab===3?(l(),i("div",gO,[e("div",vO,[yO,b(XU,{"quiz-id":t.selectedQuiz.id,onSelect:t.selectQuizResult,bot:o.bot},null,8,["quiz-id","onSelect","bot"])])])):r("",!0),t.tab===4?(l(),i("div",$O,wO)):r("",!0)])):r("",!0)],64))}}),jO={class:"row"},VO={class:"col-12 mb-3 d-flex align-items-center"},qO={class:"dropdown mr-2"},zO={class:"btn btn-info dropdown-toggle",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},PO={key:0},UO={key:1},OO={class:"dropdown-menu"},AO=["onClick"],IO={class:"dropdown-item",href:"#"},QO=e("p",{class:"mb-0"}," - тип пункта меню",-1),TO={class:"col-12 col-md-12 mb-3"},MO={class:"form-label",id:"service-title"},DO=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),RO=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),BO={class:"col-12 mb-3"},EO={class:"form-label",id:"service-description"},LO=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),KO=e("div",null," Краткая информация о команде ",-1),NO=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),JO={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},HO={class:"col-12 mb-3"},YO={class:"form-label",id:"service-input_message_content"},GO=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),WO=e("div",null," Текст, который будет в сообщении после выбора данного пункта меню ",-1),XO=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),ZO={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},xO={class:"col-12 mb-3"},eA={class:"form-check"},tA=e("label",{class:"form-check-label",for:"need_keyboard"}," Нужна клавиатура к тексту ",-1),sA={key:0,class:"col-12 mb-3"},oA={class:"card"},lA={class:"card-body"},iA={class:"form-check"},nA=e("label",{class:"form-check-label",for:"need_show_inline_template_selector"}," Выбрать клавиатуру из шаблона ",-1),aA={class:"col-12 mb-3"},dA={class:"form-check"},rA=e("label",{class:"form-check-label",for:"need_custom_settings"}," Нужны дополнительные настройки ",-1),cA={class:"col-12"},uA={key:0,class:"card mb-2"},mA={class:"card-header d-flex justify-content-between align-items-center"},hA=e("h6",null,"Дополнительная конфигурация",-1),_A={class:"card-body"},pA={class:"row mb-2"},bA={class:"col-5"},fA={class:"form-label",id:"service-title"},gA=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),vA=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),yA=["onUpdate:modelValue"],$A={class:"col-5"},kA={class:"form-label",id:"service-title"},FA=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),wA=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),CA=["onUpdate:modelValue"],SA={class:"col-2 d-flex flex-column justify-content-end align-items-center"},jA=["onClick"],VA={key:1,class:"row mb-2"},qA=e("div",{class:"col-12"},[e("div",{class:"alert alert-info",role:"alert"}," Вы еще не добавили ни одной дополнительной настройки ")],-1),zA=[qA],PA=e("div",{class:"row"},[e("div",{class:"col-12"},[e("button",{type:"submit",class:"btn btn-outline-primary w-100"},"Сохранить пункт меню ")])],-1),UA={props:["item"],data(){return{need_custom_settings:!1,need_keyboard:!1,need_show_inline_template_selector:!1,types:[{title:"Текст",value:0},{title:"Фото",value:1}],itemForm:{id:null,type:0,title:null,description:null,input_message_content:null,inline_keyboard_id:null,inline_keyboard:{menu:null},custom_settings:[]}}},computed:{preparedTypeTile(){return this.types.filter(o=>o.value==this.itemForm.type)[0]||null},uuid(){return Ue()}},watch:{itemForm:{handler(o){this.need_reset=!0},deep:!0}},mounted(){this.item&&this.$nextTick(()=>{console.log("menu",this.item.inline_keyboard),this.itemForm={id:this.item.id||uuid,type:this.item.type||0,title:this.item.title||null,description:this.item.description||null,input_message_content:this.item.input_message_content||null,need_keyboard:this.item.title||!1,inline_keyboard_id:this.item.inline_keyboard_id||null,inline_keyboard:this.item.inline_keyboard?this.item.inline_keyboard:{menu:null},custom_settings:this.item.custom_settings||[]},this.itemForm.inline_keyboard&&(this.need_keyboard=!0),this.itemForm.custom_settings&&(this.need_custom_settings=!0)})},methods:{submitForm(){this.$emit("callback",this.itemForm),this.itemForm={id:null,type:0,title:null,description:null,input_message_content:null,inline_keyboard_id:null,inline_keyboard:{menu:null},custom_settings:[]},this.need_keyboard=!1,this.need_custom_settings=!1,this.need_show_inline_template_selector=!1},addCustomSettings(){this.itemForm.custom_settings.push({key:null,value:null})},removeCustomSetting(o){this.itemForm.custom_settings.splice(o,1)},selectInlineKeyboard(o){this.itemForm.inline_keyboard={id:null,menu:o,slug:null},this.need_show_inline_template_selector=!1}}},OA=Object.assign(UA,{__name:"InlineQueryItemForm",setup(o){return(t,s)=>{const d=z("Popper");return l(),i("form",{onSubmit:s[8]||(s[8]=C((...n)=>t.submitForm&&t.submitForm(...n),["prevent"])),class:"mb-2"},[e("div",jO,[e("div",VO,[e("div",qO,[e("button",zO,[t.itemForm.type?(l(),i("span",PO,u(t.preparedTypeTile.title),1)):(l(),i("span",UO,"Тип поля"))]),e("ul",OO,[(l(!0),i(f,null,$(t.types,n=>(l(),i("li",{onClick:a=>t.itemForm.type=n.value},[e("a",IO,u(n.title||"Не указан"),1)],8,AO))),256))])]),QO]),e("div",TO,[e("label",MO,[b(d,{content:"Заголовок"},{default:v(()=>[DO]),_:1}),m(" Заголовок "),RO]),c(e("input",{type:"text",class:"form-control",placeholder:"Заголовок","aria-label":"Заголовок","onUpdate:modelValue":s[0]||(s[0]=n=>t.itemForm.title=n),"aria-describedby":"title",required:""},null,512),[[_,t.itemForm.title]])]),e("div",BO,[e("label",EO,[b(d,null,{content:v(()=>[KO]),default:v(()=>[LO]),_:1}),m(" Описание команду "),NO,t.itemForm.description?(l(),i("small",JO," Длина текста "+u(t.itemForm.description.length)+" / 255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Описание команды","aria-label":"Описание команды",maxlength:"255","onUpdate:modelValue":s[1]||(s[1]=n=>t.itemForm.description=n),"aria-describedby":"service-description",required:""},`
                    `,512),[[_,t.itemForm.description]])]),e("div",HO,[e("label",YO,[b(d,null,{content:v(()=>[WO]),default:v(()=>[GO]),_:1}),m(" Текст после выбора "),XO,t.itemForm.input_message_content?(l(),i("small",ZO," Длина текста "+u(t.itemForm.input_message_content.length)+" / 255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Текст поста","aria-label":"Текст поста",maxlength:"255","onUpdate:modelValue":s[2]||(s[2]=n=>t.itemForm.input_message_content=n),"aria-describedby":"service-input_message_content",required:""},`
                    `,512),[[_,t.itemForm.input_message_content]])]),e("div",xO,[e("div",eA,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[3]||(s[3]=n=>t.need_keyboard=n),type:"checkbox",id:"need_keyboard"},null,512),[[k,t.need_keyboard]]),tA])]),t.need_keyboard?(l(),i("div",sA,[e("div",oA,[e("div",lA,[e("div",iA,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[4]||(s[4]=n=>t.need_show_inline_template_selector=n),type:"checkbox",id:"need_show_inline_template_selector"},null,512),[[k,t.need_show_inline_template_selector]]),nA]),t.need_show_inline_template_selector?(l(),y(R,{key:0,class:"mb-2",type:"inline",onSelect:t.selectInlineKeyboard,"select-mode":!0},null,8,["onSelect"])):(l(),y(A,{key:1,type:"inline",modelValue:t.itemForm.inline_keyboard.menu,"onUpdate:modelValue":s[5]||(s[5]=n=>t.itemForm.inline_keyboard.menu=n)},null,8,["modelValue"]))])])])):r("",!0),e("div",aA,[e("div",dA,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[6]||(s[6]=n=>t.need_custom_settings=n),type:"checkbox",id:"need_custom_settings"},null,512),[[k,t.need_custom_settings]]),rA])]),e("div",cA,[t.need_custom_settings?(l(),i("div",uA,[e("div",mA,[hA,e("button",{type:"button",onClick:s[7]||(s[7]=(...n)=>t.addCustomSettings&&t.addCustomSettings(...n)),class:"btn btn-outline-primary"},"Добавить настройку ")]),e("div",_A,[t.itemForm.custom_settings.length>0?(l(!0),i(f,{key:0},$(t.itemForm.custom_settings,(n,a)=>(l(),i("div",pA,[e("div",bA,[e("label",fA,[b(d,{content:"Ключ"},{default:v(()=>[gA]),_:1}),m(" Ключ "),vA]),c(e("input",{type:"text",class:"form-control",placeholder:"Ключ","aria-label":"Ключ",min:"0","onUpdate:modelValue":h=>t.itemForm.custom_settings[a].key=h,"aria-describedby":"price",required:""},null,8,yA),[[_,t.itemForm.custom_settings[a].key]])]),e("div",$A,[e("label",kA,[b(d,{content:"Значение"},{default:v(()=>[FA]),_:1}),m(" Значение "),wA]),c(e("input",{type:"text",class:"form-control",placeholder:"Значение","aria-label":"Значение",min:"0","onUpdate:modelValue":h=>t.itemForm.custom_settings[a].value=h,"aria-describedby":"price",required:""},null,8,CA),[[_,t.itemForm.custom_settings[a].value]])]),e("div",SA,[e("button",{onClick:h=>t.removeCustomSetting(a),class:"btn btn-outline-danger"},"Удалить ",8,jA)])]))),256)):(l(),i("div",VA,zA))])])):r("",!0)])]),PA],32)}}}),AA={class:"row"},IA={class:"col-12 mb-3"},QA={class:"form-label",id:"service-title"},TA=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),MA=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),DA={class:"col-12 mb-3"},RA={class:"form-label",id:"service-description"},BA=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),EA=e("div",null," Краткая информация о команде ",-1),LA=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),KA={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},NA={class:"col-12 mb-2"},JA={key:0},HA={class:"table-responsive"},YA={class:"table"},GA=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"Название"),e("th",{scope:"col"},"Описание"),e("th",{scope:"col"},"Текст"),e("th",{scope:"col"},"Есть клавиатура"),e("th",{scope:"col"},"Есть доп настройки"),e("th",{scope:"col"},"Действие")])],-1),WA=["onClick"],XA=["onClick"],ZA=["onClick"],xA={key:0,class:"fa-solid fa-check text-success"},eI={key:1,class:"fa-solid fa-xmark text-danger"},tI={key:0,class:"fa-solid fa-check text-success"},sI={key:1,class:"fa-solid fa-xmark text-danger"},oI={class:"dropdown"},lI=e("button",{class:"btn btn-link",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-bars"})],-1),iI={class:"dropdown-menu"},nI=["onClick"],aI={class:"row"},dI={class:"col-12"},rI={type:"submit",class:"btn btn-outline-success w-100 p-3"},cI={key:0},uI={key:1},mI={class:"modal fade",id:"inline-query-item-editor",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},hI={class:"modal-dialog modal-lg"},_I={class:"modal-content"},pI={class:"modal-body"},bI={props:["bot","inlineQuery"],data(){return{load:!1,selectedInlineQueryItem:null,inlineQueryModal:null,inlineQueryForm:{id:null,command:null,description:null,items:[]}}},watch:{inlineQueryForm:{handler(o){this.need_reset=!0},deep:!0}},mounted(){this.inlineQueryModal=new bootstrap.Modal(document.getElementById("inline-query-item-editor"),{}),this.inlineQuery&&this.$nextTick(()=>{this.inlineQueryForm={id:this.inlineQuery.id||null,command:this.inlineQuery.command||null,description:this.inlineQuery.description||null,items:this.inlineQuery.items||[]}})},methods:{removeInlineQueryItem(o){const t=this.inlineQueryForm.items[o];this.inlineQueryForm.items.splice(o,1),this.$store.dispatch("removeInlineQueryItem",{queryItemId:t.id}).then(s=>{this.$notify("Команда успешно удалена")}).catch(s=>{this.$notify("Ошибка удаления команды")})},openModal(){this.load=!0,this.$nextTick(()=>{this.selectedInlineQueryItem=null,this.load=!1,this.inlineQueryModal.show()})},addInlineQueryItem(o){let t=this.inlineQueryForm.items.findIndex(s=>s.id===o.id);t===-1?this.inlineQueryForm.items.push(o):this.inlineQueryForm.items[t]=o},selectInlineQueryItem(o){this.load=!0,this.$nextTick(()=>{this.selectedInlineQueryItem=o,this.load=!1,this.inlineQueryModal.show()})},submitForm(){let o=new FormData;Object.keys(this.inlineQueryForm).forEach(t=>{const s=this.inlineQueryForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),o.append("bot_id",this.bot.id),this.$store.dispatch("storeInlineQuery",{inlineQueryForm:o}).then(t=>{this.inlineQueryForm={id:null,command:null,description:null,items:[]},this.$emit("callback",t.data),this.$notify("Команда успешно создана")}).catch(t=>{this.$notify("Ошибка создания команды"),this.$emit("callback",response.data)})}}},fI=Object.assign(bI,{__name:"InlineQueryForm",setup(o){return(t,s)=>{const d=z("Popper");return l(),i(f,null,[e("form",{onSubmit:s[3]||(s[3]=C((...n)=>t.submitForm&&t.submitForm(...n),["prevent"]))},[e("div",AA,[e("div",IA,[e("label",QA,[b(d,{content:"Название оказываемой услуги"},{default:v(()=>[TA]),_:1}),m(" Название команды "),MA]),c(e("input",{type:"text",class:"form-control",placeholder:"Команда","aria-label":"Команда","onUpdate:modelValue":s[0]||(s[0]=n=>t.inlineQueryForm.command=n),maxlength:"255","aria-describedby":"service-title",required:""},null,512),[[_,t.inlineQueryForm.command]])]),e("div",DA,[e("label",RA,[b(d,null,{content:v(()=>[EA]),default:v(()=>[BA]),_:1}),m(" Описание команду "),LA,t.inlineQueryForm.description?(l(),i("small",KA," Длина текста "+u(t.inlineQueryForm.description.length)+" / 255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Описание команды","aria-label":"Описание команды",maxlength:"255","onUpdate:modelValue":s[1]||(s[1]=n=>t.inlineQueryForm.description=n),"aria-describedby":"service-description",required:""},`
                    `,512),[[_,t.inlineQueryForm.description]])]),e("div",NA,[e("button",{type:"button",class:"btn btn-outline-primary",onClick:s[2]||(s[2]=(...n)=>t.openModal&&t.openModal(...n))}," Добавление пункта меню ")]),t.inlineQueryForm.items.length>0?(l(),i("div",JA,[e("div",HA,[e("table",YA,[GA,e("tbody",null,[(l(!0),i(f,null,$(t.inlineQueryForm.items,(n,a)=>(l(),i("tr",null,[e("td",{onClick:h=>t.selectInlineQueryItem(n)},u(n.title||"-"),9,WA),e("td",{onClick:h=>t.selectInlineQueryItem(n)},u(n.description||"-"),9,XA),e("td",{onClick:h=>t.selectInlineQueryItem(n)},u(n.input_message_content||"-"),9,ZA),e("td",null,[n.inline_keyboard?(l(),i("i",xA)):(l(),i("i",eI))]),e("td",null,[(n.custom_settings||[]).length>0?(l(),i("i",tI)):(l(),i("i",sI))]),e("td",null,[e("div",oI,[lI,e("ul",iI,[e("li",null,[e("a",{class:"dropdown-item",onClick:h=>t.removeInlineQueryItem(a),href:"#"},"Удалить",8,nI)])])])])]))),256))])])])])):r("",!0)]),e("div",aI,[e("div",dI,[e("button",rI,[t.inlineQueryForm.id===null?(l(),i("span",cI,"Создать встроенное меню")):(l(),i("span",uI,"Обновить встроенное меню"))])])])],32),e("div",mI,[e("div",hI,[e("div",_I,[e("div",pI,[t.load?r("",!0):(l(),y(OA,{key:0,item:t.selectedInlineQueryItem,onCallback:t.addInlineQueryItem},null,8,["item","onCallback"]))])])])])],64)}}}),gI={class:"row"},vI={class:"col-12"},yI={key:0,class:"table"},$I=e("th",{scope:"col",class:"cursor-pointer"},"Кол-во пунктов меню",-1),kI=e("th",{scope:"col"},"Действие",-1),FI={scope:"row"},wI=["onClick"],CI={key:0,class:"dropdown"},SI=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),jI={class:"dropdown-menu"},VI={key:0},qI=["onClick"],zI={key:1},PI={class:"col-12"},UI={props:["bot"],data(){return{direction:"desc",order:"updated_at",show:!0,loading:!0,queries:[],search:null,paginate_object:null}},computed:{...S(["getInlineQueries","getInlineQueriesPaginateObject"])},mounted(){this.loadInlineQueries()},methods:{nextInlineQuery(o){this.loadInlineQueries(o)},selectInlineQuery(o){this.$emit("select",o),this.$notify("Встроенное меню успешно выбрано")},removeInlineQuery(o){this.loading=!0,this.$store.dispatch("removeInlineQuery",{queryId:o}).then(t=>{this.loading=!1,this.loadInlineQueries(0),this.$notify("Встроенное меню успешно удалено")}).catch(()=>{this.loading=!1,this.$notify("Ошибка удаления встроенного меню")})},loadAndOrder(o){this.order=o,this.direction=this.direction==="desc"?"asc":"desc",this.loadInlineQueries(0)},loadInlineQueries(o=0){this.loading=!0,this.$store.dispatch("loadInlineQueries",{dataObject:{bot_id:this.bot.id||null,search:this.search,order:this.order,direction:this.direction},page:o,size:100}).then(t=>{this.loading=!1,this.queries=this.getInlineQueries,this.paginate_object=this.getInlineQueriesPaginateObject}).catch(()=>{this.loading=!1})}}},OI=Object.assign(UI,{__name:"InlineQueryTable",setup(o){return(t,s)=>(l(),i("div",gI,[e("div",vI,[t.queries.length>0?(l(),i("table",yI,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:s[0]||(s[0]=d=>t.loadAndOrder("id"))},"#"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[1]||(s[1]=d=>t.loadAndOrder("command"))},"Команда"),$I,e("th",{scope:"col",class:"cursor-pointer",onClick:s[2]||(s[2]=d=>t.loadAndOrder("description"))},"Описание"),kI])]),e("tbody",null,[(l(!0),i(f,null,$(t.queries,(d,n)=>(l(),i("tr",{class:g({"border-info":d.deleted_at==null,"border-danger":d.deleted_at!=null})},[e("th",FI,u(d.id),1),e("td",{onClick:a=>t.selectInlineQuery(d)},u(d.command||"Не указано"),9,wI),e("td",null,u(d.items.length),1),e("td",null,u(d.description||"Не указано"),1),e("td",null,[d.id?(l(),i("div",CI,[SI,e("ul",jI,[d.deleted_at==null?(l(),i("li",VI,[e("a",{class:"dropdown-item",onClick:a=>t.removeInlineQuery(d.id),href:"javascript:void(0)"},"Удалить",8,qI)])):r("",!0)])])):r("",!0)])],2))),256))])])):(l(),i("p",zI,"На текущий момент нет ни одной созданной команды"))]),e("div",PI,[t.paginate_object?(l(),y(q,{key:0,onPagination_page:t.nextInlineQuery,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])]))}}),AI={class:"my-2"},II={key:0,class:"row mb-2"},QI={class:"col-12"},TI={key:3,class:"spinner-border",role:"status"},MI=e("span",{class:"visually-hidden"},"Loading...",-1),DI=[MI],RI={props:["bot"],data(){return{load:!1,selectedInlineQuery:null}},mounted(){},methods:{selectInlineQuery(o){this.load=!0,this.$nextTick(()=>{this.selectedInlineQuery=o,this.load=!1})},reloadTable(){this.load=!0,this.$nextTick(()=>{this.load=!1})}}},BI=Object.assign(RI,{__name:"InlineQuery",setup(o){return(t,s)=>(l(),i("div",AI,[t.selectedInlineQuery!=null?(l(),i("div",II,[e("div",QI,[e("button",{type:"button",onClick:s[0]||(s[0]=d=>t.selectInlineQuery(null)),class:"btn btn-primary"}," Добавить новое встроенное меню")])])):r("",!0),t.load?r("",!0):(l(),y(fI,{key:1,bot:o.bot,onCallback:t.reloadTable,"inline-query":t.selectedInlineQuery},null,8,["bot","onCallback","inline-query"])),t.load?r("",!0):(l(),y(OI,{key:2,bot:o.bot,onSelect:t.selectInlineQuery},null,8,["bot","onSelect"])),t.load?(l(),i("div",TI,DI)):r("",!0)]))}}),EI={class:"row"},LI={class:"col-12 mb-3"},KI={class:"form-label",id:"quiz-title"},NI=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),JI=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),HI={class:"col-12 mb-3"},YI={class:"form-label",id:"quiz-description"},GI=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),WI=e("div",null," Краткая информация о назначении промокода ",-1),XI=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),ZI={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},xI={class:"col-12 mb-3"},eQ={class:"form-check"},tQ=e("label",{class:"form-check-label",for:"is_active"}," Доступен для активации ",-1),sQ={class:"col-12 mb-3"},oQ={class:"form-label",id:"promoCodeForm-max_activation_count"},lQ=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),iQ=e("div",null," Максимальное число активация кода ",-1),nQ=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),aQ={class:"col-12 mb-3"},dQ={class:"form-check"},rQ=e("label",{class:"form-check-label",for:"promoCodeForm-cashback_amount"}," Нужно начислить CashBack по промокоду ",-1),cQ={key:0,class:"col-12 mb-3"},uQ={class:"form-label",id:"quiz-time_limit"},mQ=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),hQ=e("div",null," Сколько % нужно ответить чтоб пройти ",-1),_Q=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),pQ={key:1,class:"col-12 mb-3"},bQ={class:"form-check"},fQ=e("label",{class:"form-check-label",for:"promoCodeForm-need_slots"}," Нужны слоты для активации ",-1),gQ={key:2,class:"col-12 mb-3"},vQ={class:"form-label",id:"promoCodeForm-slot_amount"},yQ=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),$Q=e("div",null," Укажите количество слотов, которые получит пользователь при активации (внимание, доступно только для администраторов) ",-1),kQ=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),FQ={key:0,class:"col-12 mb-3"},wQ={class:"form-check"},CQ=e("label",{class:"form-check-label",for:"promoCodeForm-need_attach_scripts"}," Нужно добавить скрипты ",-1),SQ={key:1,class:"col-12 mb-3"},jQ=["onClick"],VQ={class:"row"},qQ={class:"col-12"},zQ={type:"submit",class:"btn btn-outline-success w-100 p-3"},PQ={key:0},UQ={key:1},OQ={props:["code","bot"],data(){return{step:0,load:!1,need_reset:!1,need_cashback:!1,need_slots:!1,need_attach_scripts:!1,promoCodeForm:{id:null,code:null,description:null,slot_amount:0,cashback_amount:0,max_activation_count:1,is_active:!1,scripts:[]}}},computed:{getSelf(){return window.profile}},watch:{promoCodeForm:{handler(o){this.need_reset=!0},deep:!0}},mounted(){this.code&&this.$nextTick(()=>{this.promoCodeForm={id:this.code.id||null,description:this.code.description||null,code:this.code.code||null,slot_amount:this.code.slot_amount||0,cashback_amount:this.code.cashback_amount||0,max_activation_count:this.code.max_activation_count||1,is_active:this.code.is_active||!1,scripts:this.code.scripts||[]},this.promoCodeForm.slot_amount>0&&(this.need_slots=!0),this.promoCodeForm.cashback_amount>0&&(this.need_cashback=!0),this.promoCodeForm.scripts.length>0&&(this.need_attach_scripts=!0)})},methods:{removeSlug(o){this.promoCodeForm.scripts.splice(o,1)},selectSlugsCallback(o){this.promoCodeForm.scripts.findIndex(s=>s.id===o.id)===-1&&this.promoCodeForm.scripts.push(o)},submitForm(){let o=new FormData;Object.keys(this.promoCodeForm).forEach(t=>{const s=this.promoCodeForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),o.append("bot_id",this.bot.id),this.$store.dispatch("storePromoCodes",{promoCodeForm:o}).then(t=>{this.promoCodeForm={id:null,code:null,description:null,slot_amount:0,cashback_amount:0,max_activation_count:1,scripts:[],is_active:!1},this.$emit("callback",t.data),this.$notify("Промокод успешно создан")}).catch(t=>{this.$notify("Ошибка создания промокода")})}}},ae=Object.assign(OQ,{__name:"PromoCodesForm",setup(o){return(t,s)=>{const d=z("Popper");return l(),i("form",{onSubmit:s[9]||(s[9]=C((...n)=>t.submitForm&&t.submitForm(...n),["prevent"])),class:"py-3"},[e("div",EI,[e("div",LI,[e("label",KI,[b(d,{content:"Название вашего квиза"},{default:v(()=>[NI]),_:1}),m(" Промокод (вписать или сгенерировать) "),JI]),c(e("input",{type:"text",class:"form-control",placeholder:"Название","aria-label":"Название","onUpdate:modelValue":s[0]||(s[0]=n=>t.promoCodeForm.code=n),maxlength:"255","aria-describedby":"quiz-title",required:""},null,512),[[_,t.promoCodeForm.code]])]),e("div",HI,[e("label",YI,[b(d,null,{content:v(()=>[WI]),default:v(()=>[GI]),_:1}),m(" Назначение промокода "),XI,t.promoCodeForm.description?(l(),i("small",ZI," Длина текста "+u(t.promoCodeForm.description.length)+"/255",1)):r("",!0)]),c(e("textarea",{class:"form-control",placeholder:"Описание промокода","aria-label":"Описание промокода",maxlength:"255","onUpdate:modelValue":s[1]||(s[1]=n=>t.promoCodeForm.description=n),"aria-describedby":"quiz-description",required:""},`
                    `,512),[[_,t.promoCodeForm.description]])]),e("div",xI,[e("div",eQ,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[2]||(s[2]=n=>t.promoCodeForm.is_active=n),type:"checkbox",id:"is_active"},null,512),[[k,t.promoCodeForm.is_active]]),tQ])]),e("div",sQ,[e("label",oQ,[b(d,null,{content:v(()=>[iQ]),default:v(()=>[lQ]),_:1}),m(" Количество активация кода "),nQ]),c(e("input",{type:"number",class:"form-control",placeholder:"Число попыток","aria-label":"Число попыток",step:"1",min:"1","onUpdate:modelValue":s[3]||(s[3]=n=>t.promoCodeForm.max_activation_count=n),"aria-describedby":"promoCodeForm-max_activation_count",required:""},null,512),[[_,t.promoCodeForm.max_activation_count]])]),e("div",aQ,[e("div",dQ,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[4]||(s[4]=n=>t.need_cashback=n),type:"checkbox",id:"promoCodeForm-cashback_amount"},null,512),[[k,t.need_cashback]]),rQ])]),t.need_cashback?(l(),i("div",cQ,[e("label",uQ,[b(d,null,{content:v(()=>[hQ]),default:v(()=>[mQ]),_:1}),m(" Сколько CashBack начислить по промокоду? "),_Q]),c(e("input",{type:"number",class:"form-control",placeholder:"Процент для победы","aria-label":"Процент для победы",step:"1",min:"0","onUpdate:modelValue":s[5]||(s[5]=n=>t.promoCodeForm.cashback_amount=n),"aria-describedby":"promoCodeForm-cashback_amount",required:""},null,512),[[_,t.promoCodeForm.cashback_amount]])])):r("",!0),t.getSelf.is_admin?(l(),i("div",pQ,[e("div",bQ,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[6]||(s[6]=n=>t.need_slots=n),type:"checkbox",id:"promoCodeForm-need_slots"},null,512),[[k,t.need_slots]]),fQ])])):r("",!0),t.need_slots?(l(),i("div",gQ,[e("label",vQ,[b(d,null,{content:v(()=>[$Q]),default:v(()=>[yQ]),_:1}),m(" Сколько нужно добавить слотов? "),kQ]),c(e("input",{type:"number",class:"form-control",placeholder:"Количество слотов","aria-label":"Количество слотов",step:"1",min:"0","onUpdate:modelValue":s[7]||(s[7]=n=>t.promoCodeForm.slot_amount=n),"aria-describedby":"promoCodeForm-slot_amount",required:""},null,512),[[_,t.promoCodeForm.slot_amount]])])):r("",!0)]),t.getSelf.is_admin?(l(),i("div",FQ,[e("div",wQ,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[8]||(s[8]=n=>t.need_attach_scripts=n),type:"checkbox",id:"promoCodeForm-need_attach_scripts"},null,512),[[k,t.need_attach_scripts]]),CQ])])):r("",!0),t.need_attach_scripts?(l(),i("div",SQ,[e("p",null,[(l(!0),i(f,null,$(t.promoCodeForm.scripts,(n,a)=>(l(),i("span",{class:"badge bg-primary mr-2 mb-2 cursor-pointer",onClick:h=>t.removeSlug(a)},u(n.command||"-"),9,jQ))),256))]),o.bot?(l(),y(x,{key:0,"can-add":!0,bot:o.bot,"hide-add-modal":!0,onSelect:t.selectSlugsCallback},null,8,["bot","onSelect"])):r("",!0)])):r("",!0),e("div",VQ,[e("div",qQ,[e("button",zQ,[t.promoCodeForm.id==null?(l(),i("span",PQ,"Создать промокод")):(l(),i("span",UQ,"Обновить промокод"))])])])],32)}}}),AQ={class:"row py-2"},IQ={class:"col-12"},QQ={class:"input-group mb-3"},TQ={class:"col-12"},MQ={key:0,class:"table"},DQ=e("th",{scope:"col",class:"cursor-pointer"},"Число активаций",-1),RQ=e("th",{scope:"col"},"Действие",-1),BQ={scope:"row"},EQ=["onClick"],LQ={key:0},KQ={key:0,class:"fa-solid fa-chevron-down text-success"},NQ={key:1,class:"fa-solid fa-xmark text-danger"},JQ={key:0,class:"dropdown"},HQ=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),YQ={class:"dropdown-menu"},GQ={key:0},WQ=["onClick"],XQ={key:1},ZQ=e("div",{class:"alert alert-warning alert-dismissible fade show",role:"alert"},[e("strong",null,"Внимание!"),m(" Вы еще не добавили ни одного промокода! "),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"alert","aria-label":"Close"})],-1),xQ={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},eT={class:"d-flex justify-content-center mb-3"},tT={alt:"",width:"100",height:"100"},sT=e("h1",{class:"text-body-emphasis"},"Создание промокода",-1),oT=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"}," Промокод - это инструмент мотивации пользователей пользоваться вашим сервисом. Он позволяет клиентам получать некоторые бонусы за активацию кода, а вы в свою очередь будете видеть статистику активация прмокода. ",-1),lT={class:"d-inline-flex gap-2 mb-5"},iT=e("a",{href:"#",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),nT={key:0,class:"col-12"},aT={props:["bot"],data(){return{direction:"desc",order:"updated_at",show:!0,loading:!0,codes:[],search:null,paginate_object:null}},computed:{...S(["getPromoCodes","getPromoCodesPaginateObject"]),getSelf(){return window.profile}},mounted(){this.loadPromoCodes()},methods:{removeQuiz(o){this.loading=!0,this.$store.dispatch("removePromoCodes",{promoCodeId:o}).then(t=>{this.loading=!1,this.loadPromoCodes(0),this.$notify("Промокод успешно удален")}).catch(()=>{this.loading=!1,this.$notify("Ошибка удаления промокода")})},createPromoCode(){this.$emit("create")},nextPromoCodes(o){this.loadPromoCodes(o)},selectEvent(o){this.$emit("select",o)},loadAndOrder(o){this.order=o,this.direction=this.direction==="desc"?"asc":"desc",this.loadPromoCodes(0)},loadPromoCodes(o=0){this.loading=!0,this.$store.dispatch("loadPromoCodes",{dataObject:{bot_id:this.bot.id||null,search:this.search,order:this.order,direction:this.direction},page:o,size:20}).then(t=>{this.loading=!1,this.codes=this.getPromoCodes,this.paginate_object=this.getPromoCodesPaginateObject}).catch(()=>{this.loading=!1})}}},dT=Object.assign(aT,{__name:"PromoCodesTable",setup(o){return(t,s)=>{const d=Q("lazy");return l(),i("div",AQ,[e("div",IQ,[e("div",QQ,[c(e("input",{type:"search",class:"form-control",placeholder:"Поиск кода","aria-label":"Поиск кода","onUpdate:modelValue":s[0]||(s[0]=n=>t.search=n),"aria-describedby":"promocode-search-and-filter"},null,512),[[_,t.search]]),e("button",{class:"btn btn-outline-secondary",onClick:s[1]||(s[1]=n=>t.loadPromoCodes(0)),type:"button",id:"promocode-search-and-filter"},"Найти ")])]),e("div",TQ,[t.codes.length>0?(l(),i("table",MQ,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:s[2]||(s[2]=n=>t.loadAndOrder("id"))},"#"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[3]||(s[3]=n=>t.loadAndOrder("code"))},"Код"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[4]||(s[4]=n=>t.loadAndOrder("description"))},"Описание"),t.getSelf.is_admin?(l(),i("th",{key:0,scope:"col",class:"cursor-pointer",onClick:s[5]||(s[5]=n=>t.loadAndOrder("slot_amount"))},"Число слотов ")):r("",!0),e("th",{scope:"col",class:"cursor-pointer",onClick:s[6]||(s[6]=n=>t.loadAndOrder("cashback_amount"))},"Величина CashBack-а, руб "),e("th",{scope:"col",class:"cursor-pointer",onClick:s[7]||(s[7]=n=>t.loadAndOrder("max_activation_count"))},"Максимальное число активаций "),DQ,e("th",{scope:"col",class:"cursor-pointer",onClick:s[8]||(s[8]=n=>t.loadAndOrder("is_active"))},"Активный"),RQ])]),e("tbody",null,[(l(!0),i(f,null,$(t.codes,(n,a)=>(l(),i("tr",{class:g({"border-info":n.deleted_at==null,"border-danger":n.deleted_at!=null})},[e("th",BQ,u(n.id),1),e("td",{onClick:h=>t.selectEvent(n)},u(n.code||"Не указано"),9,EQ),e("td",null,u(n.description||"Не указано"),1),t.getSelf.is_admin?(l(),i("td",LQ,u(n.slot_amount),1)):r("",!0),e("td",null,u(n.cashback_amount),1),e("td",null,u(n.max_activation_count),1),e("td",null,u(n.current_activation_count||0),1),e("td",null,[n.is_active?(l(),i("i",KQ)):(l(),i("i",NQ))]),e("td",null,[n.id?(l(),i("div",JQ,[HQ,e("ul",YQ,[n.deleted_at==null?(l(),i("li",GQ,[e("a",{class:"dropdown-item",onClick:h=>t.removeQuiz(n.id),href:"javascript:void(0)"},"Удалить",8,WQ)])):r("",!0)])])):r("",!0)])],2))),256))])])):(l(),i("div",XQ,[ZQ,e("div",xQ,[e("div",eT,[c(e("img",tT,null,512),[[d,"../images/icon.png"]])]),sT,oT,e("div",lT,[e("button",{onClick:s[9]||(s[9]=(...n)=>t.createPromoCode&&t.createPromoCode(...n)),class:"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill btn-primary",type:"button"}," Добавить "),iT])])]))]),t.codes.length>0?(l(),i("div",nT,[t.paginate_object?(l(),y(q,{key:0,onPagination_page:t.nextPromoCodes,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])):r("",!0)])}}}),rT={key:0,class:"py-2"},cT={class:"row"},uT={class:"col-12"},mT={key:1,class:"py-2"},hT={class:"row"},_T={class:"col-12"},pT={key:2,class:"py-2"},bT={class:"row"},fT={class:"col-12"},gT={class:"nav nav-tabs justify-content-center"},vT={key:0,class:"row py-3"},yT={class:"col-12"},$T={key:1,class:"row py-3"},kT=e("div",{class:"col-12 py-3"},[e("h4",null,"Статистика")],-1),FT=[kT],wT={props:["bot"],data(){return{part:0,tab:0,selectedPromoCode:null,loadForm:!1,loadTable:!1}},methods:{callbackForm(){this.loadTable=!0,this.selectedPromoCode=null,this.part=0,this.$nextTick(()=>{this.loadTable=!1})},createPromoCode(){this.part=2},selectPromoCode(o){this.loadForm=!0,this.$nextTick(()=>{this.loadForm=!1,this.selectedPromoCode=o,this.part=1,this.tab=0})}}},CT=Object.assign(wT,{__name:"PromoCodes",setup(o){return(t,s)=>(l(),i(f,null,[t.part===0?(l(),i("div",rT,[e("div",cT,[e("div",uT,[e("button",{type:"button",onClick:s[0]||(s[0]=(...d)=>t.createPromoCode&&t.createPromoCode(...d)),class:"btn btn-primary"}," Создать новый промокод ")])]),t.loadTable?r("",!0):(l(),y(dT,{key:0,onCreate:t.createPromoCode,onSelect:t.selectPromoCode,bot:o.bot},null,8,["onCreate","onSelect","bot"]))])):r("",!0),t.part===2?(l(),i("div",mT,[e("div",hT,[e("div",_T,[e("button",{type:"button",onClick:s[1]||(s[1]=d=>t.part=0),class:"btn btn-outline-primary"}," Назад ")])]),t.loadForm?r("",!0):(l(),y(ae,{key:0,onCallback:t.callbackForm,bot:o.bot},null,8,["onCallback","bot"]))])):r("",!0),t.part===1?(l(),i("div",pT,[e("div",bT,[e("div",fT,[e("button",{type:"button",onClick:s[2]||(s[2]=d=>t.part=0),class:"btn btn-outline-primary"}," Назад ")])]),e("ul",gT,[e("li",{class:"nav-item",onClick:s[3]||(s[3]=d=>t.tab=0)},[e("a",{class:g(["nav-link",{active:t.tab===0}]),"aria-current":"page",href:"javascript:void(0)"},"Информация о Промокоде",2)]),e("li",{class:"nav-item",onClick:s[4]||(s[4]=d=>t.tab=1)},[e("a",{class:g(["nav-link",{active:t.tab===1}]),href:"javascript:void(0)"},"Статистика использования",2)])]),t.tab===0?(l(),i("div",vT,[e("div",yT,[t.loadForm?r("",!0):(l(),y(ae,{key:0,onCallback:t.callbackForm,code:t.selectedPromoCode,bot:o.bot},null,8,["onCallback","code","bot"]))])])):r("",!0),t.tab===1?(l(),i("div",$T,FT)):r("",!0)])):r("",!0)],64))}}),ST={props:["data"],data(){return{hasConnect:!1,bot:null,frontPadForm:{hook_url:null,channel:null,affiliate:null,point:null,token:null,statuses:[{value:null,key:"new",title:"Новый"}],bot_id:null,pays:[{value:null,key:"cash",title:"Наличные"},{value:null,key:"card",title:"Перевод на карту"}]}}},computed:{...S(["getCurrentBot"])},mounted(){this.bot=this.getCurrentBot,this.data?this.$nextTick(()=>{this.frontPadForm.hook_url=this.data.hook_url||null,this.frontPadForm.channel=this.data.channel||null,this.frontPadForm.affiliate=this.data.affiliate||null,this.frontPadForm.point=this.data.point||null,this.frontPadForm.token=this.data.token||null,this.frontPadForm.bot_id=this.data.bot_id||this.bot.id||null,this.data.pays!=null&&(this.frontPadForm.pays=this.data.pays),this.data.statuses!=null&&(this.frontPadForm.statuses=this.data.statuses)}):this.frontPadForm.bot_id=this.bot.id||null},methods:{submit(){let o=new FormData;Object.keys(this.frontPadForm).forEach(t=>{const s=this.frontPadForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),this.$store.dispatch("saveFrontPad",{frontPadForm:o}).then(t=>{this.$notify("Данные CRM успешно сохранены")}).catch(t=>{})}}},jT={class:"col-md-6 col-12 mb-2"},VT={class:"form-label",id:"token"},qT=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),zT=e("div",null,"Токен интеграции",-1),PT=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),UT={class:"col-md-6 col-12 mb-2"},OT={class:"form-label",id:"channel"},AT=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),IT=e("div",null,'Данные брать из справочника FrontPad "Каналы продаж". Создать канал. Telegram. Указать значение для API',-1),QT={class:"col-md-6 col-12 mb-2"},TT={class:"form-label",id:"affiliate"},MT=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),DT=e("div",null,"Филиал",-1),RT={class:"col-md-6 col-12 mb-2"},BT={class:"form-label",id:"point"},ET=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),LT=e("div",null,"Филиал",-1),KT={class:"col-12"},NT=e("div",{class:"alert alert-info",role:"alert"},' Данные брать из справочника FrontPad "Статусы". Указать значение для API ',-1),JT={key:0,class:"card mb-2 p-0"},HT=e("div",{class:"card-header"},[e("h6",null,"Статусы")],-1),YT={class:"card-body"},GT={class:"table"},WT=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"Название"),e("th",{scope:"col"},"Ключ"),e("th",{scope:"col"},"Значение")])],-1),XT=["onUpdate:modelValue"],ZT={class:"col-12"},xT=e("div",{class:"alert alert-info",role:"alert"},' Данные брать из справочника FrontPad "Варианты оплат". Указать значение для API ',-1),eM={key:0,class:"card mb-2 p-0"},tM=e("div",{class:"card-header"},[e("h6",null,"Типы оплаты")],-1),sM={class:"card-body"},oM={class:"table"},lM=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"Название"),e("th",{scope:"col"},"Ключ"),e("th",{scope:"col"},"Значение")])],-1),iM=["onUpdate:modelValue"],nM=e("div",{class:"col-md-12 col-12"},[e("button",{type:"submit",class:"btn btn-outline-primary p-3 w-100"},[e("i",{class:"fa-solid fa-cloud-arrow-down mr-1"}),m(" Сохранить настройку ")])],-1);function aM(o,t,s,d,n,a){const h=z("Popper");return l(),i("form",{onSubmit:t[4]||(t[4]=C((...p)=>a.submit&&a.submit(...p),["prevent"])),class:"row"},[e("div",jT,[e("label",VT,[b(h,null,{content:v(()=>[zT]),default:v(()=>[qT]),_:1}),m(" Токен интеграции "),PT]),c(e("input",{type:"text",class:"form-control",placeholder:"Токен","aria-label":"Токен","onUpdate:modelValue":t[0]||(t[0]=p=>n.frontPadForm.token=p),"aria-describedby":"token"},null,512),[[_,n.frontPadForm.token]])]),e("div",UT,[e("label",OT,[b(h,null,{content:v(()=>[IT]),default:v(()=>[AT]),_:1}),m(" Канал продаж ")]),c(e("input",{type:"text",class:"form-control",placeholder:"channel","aria-label":"channel","onUpdate:modelValue":t[1]||(t[1]=p=>n.frontPadForm.channel=p),"aria-describedby":"channel"},null,512),[[_,n.frontPadForm.channel]])]),e("div",QT,[e("label",TT,[b(h,null,{content:v(()=>[DT]),default:v(()=>[MT]),_:1}),m(" Филиал ")]),c(e("input",{type:"text",class:"form-control",placeholder:"Филиал","aria-label":"Филиал","onUpdate:modelValue":t[2]||(t[2]=p=>n.frontPadForm.affiliate=p),"aria-describedby":"Филиал"},null,512),[[_,n.frontPadForm.affiliate]])]),e("div",RT,[e("label",BT,[b(h,null,{content:v(()=>[LT]),default:v(()=>[ET]),_:1}),m(" Точка продаж ")]),c(e("input",{type:"text",class:"form-control",placeholder:"Точка продаж","aria-label":"Точка продаж","onUpdate:modelValue":t[3]||(t[3]=p=>n.frontPadForm.point=p),"aria-describedby":"Точка продаж"},null,512),[[_,n.frontPadForm.point]])]),e("div",KT,[NT,n.frontPadForm.statuses?(l(),i("div",JT,[HT,e("div",YT,[e("table",GT,[WT,e("tbody",null,[(l(!0),i(f,null,$(n.frontPadForm.statuses,(p,F)=>(l(),i("tr",null,[e("td",null,u(p.title||"-"),1),e("td",null,u(p.key||"-"),1),e("td",null,[c(e("input",{type:"text",class:"form-control",placeholder:"Статус","aria-label":"Статус","onUpdate:modelValue":w=>n.frontPadForm.statuses[F].value=w,"aria-describedby":"Статус"},null,8,XT),[[_,n.frontPadForm.statuses[F].value]])])]))),256))])])])])):r("",!0)]),e("div",ZT,[xT,n.frontPadForm.pays?(l(),i("div",eM,[tM,e("div",sM,[e("table",oM,[lM,e("tbody",null,[(l(!0),i(f,null,$(n.frontPadForm.pays,(p,F)=>(l(),i("tr",null,[e("td",null,u(p.title||"-"),1),e("td",null,u(p.key||"-"),1),e("td",null,[c(e("input",{type:"text",class:"form-control",placeholder:"Статус","aria-label":"Статус","onUpdate:modelValue":w=>n.frontPadForm.pays[F].value=w,"aria-describedby":"Статус"},null,8,iM),[[_,n.frontPadForm.pays[F].value]])])]))),256))])])])])):r("",!0)]),nM],32)}const dM=U(ST,[["render",aM]]),rM={props:["bot","date"],data(){return{traffics:[],sort:{key:"created_at",direction:"asc"}}},mounted(){this.prepareStatistic()},methods:{changeSort(o){this.sort.key=o,this.sort.direction=this.sort.direction==="asc"?"desc":"asc"},prepareStatistic(){return this.loadedChart=!1,this.$store.dispatch("trafficLoad",{bot_id:this.bot.id,date:this.date,need_all:!this.need_date_range,sort:this.sort}).then(o=>{this.traffics=o.traffics})}}},cM={key:0,class:"table"},uM={scope:"col"},mM={key:0,class:"fa-solid fa-arrow-up-wide-short"},hM={key:1,class:"fa-solid fa-arrow-up-short-wide"},_M={scope:"col"},pM={key:0,class:"fa-solid fa-arrow-up-wide-short"},bM={key:1,class:"fa-solid fa-arrow-up-short-wide"},fM={scope:"col"},gM={key:0,class:"fa-solid fa-arrow-up-wide-short"},vM={key:1,class:"fa-solid fa-arrow-up-short-wide"},yM={scope:"row"},$M={key:1,class:"text-danger my-3"};function kM(o,t,s,d,n,a){return(n.traffics||[]).length>0?(l(),i("table",cM,[e("thead",null,[e("tr",null,[e("th",uM,[e("a",{href:"javascript:void(0)",onClick:t[0]||(t[0]=h=>a.changeSort("id"))},[n.sort.key==="id"?(l(),i(f,{key:0},[n.sort.direction==="asc"?(l(),i("i",mM)):(l(),i("i",hM))],64)):r("",!0),m(" # ")])]),e("th",_M,[e("a",{href:"javascript:void(0)",onClick:t[1]||(t[1]=h=>a.changeSort("source"))},[n.sort.key==="source"?(l(),i(f,{key:0},[n.sort.direction==="asc"?(l(),i("i",pM)):(l(),i("i",bM))],64)):r("",!0),m(" Источник ")])]),e("th",fM,[e("a",{href:"javascript:void(0)",onClick:t[2]||(t[2]=h=>a.changeSort("count"))},[n.sort.key==="count"?(l(),i(f,{key:0},[n.sort.direction==="asc"?(l(),i("i",gM)):(l(),i("i",vM))],64)):r("",!0),m(" Число переходов ")])])])]),e("tbody",null,[(l(!0),i(f,null,$(n.traffics,(h,p)=>(l(),i("tr",null,[e("th",yM,u(p+1),1),e("td",null,u(h.source),1),e("td",null,u(h.count),1)]))),256))])])):(l(),i("p",$M,"Нет данных по продажам за выбранный период:("))}const FM=U(rM,[["render",kM]]);const wM={class:"container"},CM={class:"row my-3"},SM={key:0,class:"col-md-4"},jM={class:"row"},VM={class:"col-12"},qM={class:"form-check form-switch"},zM=e("label",{class:"form-check-label",for:"flexSwitchCheckDefault"}," Использовать временной период ",-1),PM={class:"row"},UM={class:"col-6"},OM=e("h6",{class:"my-3 fw-bold"},"Основная статистика",-1),AM=e("p",{class:"fst-italic"}," Сводка всех показателей эффективности работы системы ",-1),IM={key:0,class:"table"},QM=e("thead",null,[e("tr",{class:"bg-light"},[e("th",{scope:"col",style:{width:"200px"}},"Ключ"),e("th",{scope:"col"},"Значение")])],-1),TM=e("th",{scope:"row"},"Всего пользователей в БД",-1),MM={class:"font-weight-bold"},DM=e("th",{scope:"row"},"Всего VIP",-1),RM={class:"font-weight-bold"},BM=e("th",{scope:"row"},"Администраторы в БД",-1),EM={class:"font-weight-bold"},LM=e("th",{scope:"row"},"Администраторы за работой",-1),KM={class:"font-weight-bold"},NM=e("th",{scope:"row"},"Всего кэшбэка на счету у пользователей, руб",-1),JM={class:"font-weight-bold"},HM={key:0},YM=e("th",{scope:"row"},"Всего кэшбэка начислено пользователям, руб",-1),GM={class:"font-weight-bold"},WM={key:0},XM=e("th",{scope:"row"},"Всего кэшбэка списано у пользователей, руб",-1),ZM={class:"font-weight-bold"},xM={key:0},eD=e("th",{scope:"row"},"Всего начислено кэшбэка первого уровня, руб",-1),tD={class:"font-weight-bold"},sD={key:0},oD=e("th",{scope:"row"},"Всего начислено кэшбэка второго уровня, руб",-1),lD={class:"font-weight-bold"},iD={key:0},nD=e("th",{scope:"row"},"Всего начислено кэшбэка третьего уровня, руб",-1),aD={class:"font-weight-bold"},dD={key:0},rD=e("i",{class:"fa-regular fa-file-excel mr-2"},null,-1),cD={class:"col-6"},uD={class:"form-check form-switch my-3"},mD=e("label",{class:"form-check-label",for:"flexSwitchCheckDefault"},"Отобразить графики",-1),hD={class:"row my-3 sticky-charts"},_D={class:"col-12"},pD={class:"nav nav-tabs"},bD={class:"nav-item"},fD={class:"nav-item"},gD={class:"nav-item"},vD={class:"nav-item"},yD={key:0,class:"col-12"},$D={key:0,class:"d-flex justify-content-center mb-3"},kD={key:1,class:"text-danger my-2"},FD={key:1,class:"w-100 overflow-x-scroll"},wD={class:"table"},CD=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"#"),e("th",{scope:"col"},"Год"),e("th",{scope:"col"},"Месяц"),e("th",{scope:"col"},"Число пользователей")])],-1),SD={scope:"row"},jD={key:1,class:"col-12"},VD=e("h6",{class:"my-2"},"Начисления",-1),qD={class:"d-flex justify-content-center mb-3"},zD={key:1,class:"text-danger my-3"},PD=e("h6",{class:"my-2"},"Списания",-1),UD={class:"d-flex justify-content-center mb-3"},OD={key:1,class:"text-danger my-3"},AD={key:1,class:"w-100 overflow-x-scroll"},ID={class:"table"},QD=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"#"),e("th",{scope:"col"},"Год"),e("th",{scope:"col"},"Месяц"),e("th",{scope:"col"},"Начислено"),e("th",{scope:"col"},"Списано")])],-1),TD={scope:"row"},MD={key:2,class:"col-12"},DD={key:0,class:"d-flex justify-content-center mb-3"},RD={key:1,class:"text-danger my-3"},BD={key:2,class:"table"},ED=e("th",{scope:"col"},"#",-1),LD={scope:"col"},KD={key:0,class:"fa-solid fa-arrow-up-wide-short"},ND={key:1,class:"fa-solid fa-arrow-up-short-wide"},JD={scope:"col"},HD={key:0,class:"fa-solid fa-arrow-up-wide-short"},YD={key:1,class:"fa-solid fa-arrow-up-short-wide"},GD={scope:"col"},WD={key:0,class:"fa-solid fa-arrow-up-wide-short"},XD={key:1,class:"fa-solid fa-arrow-up-short-wide"},ZD={scope:"col"},xD={key:0,class:"fa-solid fa-arrow-up-wide-short"},eR={key:1,class:"fa-solid fa-arrow-up-short-wide"},tR={scope:"col"},sR={key:0,class:"fa-solid fa-arrow-up-wide-short"},oR={key:1,class:"fa-solid fa-arrow-up-short-wide"},lR={scope:"row"},iR={key:3,class:"text-danger my-3"},nR={key:3,class:"col-12"},aR={props:["bot"],components:{Chart:D,Grid:E,Line:Oe,Bar:L,Tooltip:M,Responsive:me,Pie:he,VueDatePicker:H},data(){return{sort:{key:"price",direction:"asc"},need_charts:!1,need_date_range:!1,date:null,tab:0,botUser:null,loadedChart:!1,statistic:null,loading:!1,tooltipConfig:{sump:{label:"Сумма продаж",color:"#5d1010"},m:{label:"Месяц",color:"#54a375"},y:{label:"Год",color:"#0ea9cb"}},products:[{title:"1",count:1,price:2020},{title:"2",count:2,price:2020},{title:"3",count:3,price:2020},{title:"4",count:4,price:2020},{title:"5",count:5,price:2020}],orders:[{sump:0,m:1,y:2020},{sump:111,m:2,y:2020},{sump:222,m:3,y:2020},{sump:333,m:4,y:2020},{sump:444,m:5,y:2020}],users:[{count:0,m:1,y:2020},{count:111,m:2,y:2020},{count:222,m:3,y:2020},{count:333,m:4,y:2020},{count:444,m:5,y:2020}],cashback_up:[{sum:0,m:1,y:2020},{sum:111,m:2,y:2020},{sum:222,m:3,y:2020},{sum:333,m:4,y:2020},{sum:444,m:5,y:2020}],cashback_down:[{sum:0,m:1,y:2020},{sum:111,m:2,y:2020},{sum:222,m:3,y:2020},{sum:333,m:4,y:2020},{sum:444,m:5,y:2020}],direction:"horizontal",margin:{left:0,top:20,right:20,bottom:0},axis:{primary:{type:"band"},secondary:{domain:["dataMin","dataMax + 100"],type:"linear",ticks:11}}}},computed:{preparedCashback(){if(this.cashback_up.length===0&&this.cashback_down.length===0)return[];let o=[];for(let t=0;t<this.cashback_up.length;t++){let s=null;for(let d=0;d<this.cashback_down.length;d++){let n=this.cashback_down[d],a=this.cashback_up[t];if(a.m===n.m&&a.y===n.y){s=this.cashback_down[d];break}}o.push({y:this.cashback_up[t].y||0,m:this.cashback_up[t].m||0,up:this.cashback_up[t].sum||0,down:s===null?0:s.sum})}return o}},watch:{sort:{handler:function(o){this.prepareStatistic()},deep:!0},need_date_range:function(){this.prepareStatistic()},date:function(){this.prepareStatistic()}},mounted(){const o=new Date,t=new Date(new Date().setDate(o.getDate()+7));this.date=[o,t],this.prepareStatistic()},methods:{changeSort(o){this.sort.key=o,this.sort.direction=this.sort.direction==="asc"?"desc":"asc"},prepareStatistic(){return this.loadedChart=!1,this.$store.dispatch("statisticLoad",{bot_id:this.bot.id,date:this.date,need_all:!this.need_date_range,sort:this.sort}).then(o=>{this.statistic=o.statistic,this.orders=this.statistic.orders.sum,this.products=this.statistic.orders.products,this.users=this.statistic.users.sum,this.cashback_up=this.statistic.cashback_up.sum,this.cashback_down=this.statistic.cashback_down.sum,this.loadedChart=!0})},downloadBotStatistic(){this.$notify({title:"Внимание!",text:"Начался формироваться документ статистики!"}),this.$store.dispatch("downloadBotStatistic").then(o=>{this.$notify({title:"Отлично!",text:"Документ успешно сформирован",type:"success"})}).catch(()=>{this.$notify({title:"Упс!",text:"Что-то пошло не так...",type:"error"})})}}},dR=Object.assign(aR,{__name:"Statistic",setup(o){return(t,s)=>{const d=z("Marker"),n=z("divs");return l(),i("div",wM,[e("div",CM,[t.need_date_range?(l(),i("div",SM,[b(j(H),{modelValue:t.date,"onUpdate:modelValue":s[0]||(s[0]=a=>t.date=a),locale:"ru",range:""},null,8,["modelValue"])])):r("",!0)]),e("div",jM,[e("div",VM,[e("div",qM,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[1]||(s[1]=a=>t.need_date_range=a),type:"checkbox",role:"switch",id:"flexSwitchCheckDefault"},null,512),[[k,t.need_date_range]]),zM])])]),e("div",PM,[e("div",UM,[OM,AM,t.statistic?(l(),i("table",IM,[QM,e("tbody",null,[e("tr",null,[TM,e("td",MM,u(t.statistic.users_in_bd||0),1)]),e("tr",null,[DM,e("td",RM,u(t.statistic.vip_in_bd||0),1)]),e("tr",null,[BM,e("td",EM,u(t.statistic.admin_in_bd||0),1)]),e("tr",null,[LM,e("td",KM,u(t.statistic.work_admin_in_bd||0),1)]),e("tr",null,[NM,e("td",JM,[m(u((t.statistic.summary_cashback||0).toFixed(2))+" ",1),t.statistic.summary_cashback_people_count?(l(),i("strong",HM,"("+u(t.statistic.summary_cashback_people_count)+" чел)",1)):r("",!0)])]),e("tr",null,[YM,e("td",GM,[m(u((t.statistic.cashback_summary_up||0).toFixed(2))+" ",1),t.statistic.cashback_summary_up_people_count?(l(),i("strong",WM,"("+u(t.statistic.cashback_summary_up_people_count)+" чел)",1)):r("",!0)])]),e("tr",null,[XM,e("td",ZM,[m(u((t.statistic.cashback_summary_down||0).toFixed(2))+" ",1),t.statistic.cashback_summary_down_people_count?(l(),i("strong",xM,"("+u(t.statistic.cashback_summary_down_people_count)+" чел)",1)):r("",!0)])]),e("tr",null,[eD,e("td",tD,[m(u((t.statistic.cashback_up_level_1||0).toFixed(2))+" ",1),t.statistic.cashback_up_level_1_people_count?(l(),i("strong",sD,"("+u(t.statistic.cashback_up_level_1_people_count)+" чел)",1)):r("",!0)])]),e("tr",null,[oD,e("td",lD,[m(u((t.statistic.cashback_up_level_2||0).toFixed(2))+" ",1),t.statistic.cashback_up_level_2_people_count?(l(),i("strong",iD,"("+u(t.statistic.cashback_up_level_2_people_count)+" чел)",1)):r("",!0)])]),e("tr",null,[nD,e("td",aD,[m(u((t.statistic.cashback_up_level_3||0).toFixed(2))+" ",1),t.statistic.cashback_up_level_3_people_count?(l(),i("strong",dD,"("+u(t.statistic.cashback_up_level_3_people_count)+" чел)",1)):r("",!0)])])])])):r("",!0),e("a",{href:"javascript:void(0)",onClick:s[2]||(s[2]=(...a)=>t.downloadBotStatistic&&t.downloadBotStatistic(...a)),class:"btn w-100 btn-outline-info p-3"},[rD,m(" Скачать статистику ")])]),e("div",cD,[e("div",uD,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[3]||(s[3]=a=>t.need_charts=a),type:"checkbox",role:"switch",id:"flexSwitchCheckDefault"},null,512),[[k,t.need_charts]]),mD]),e("div",hD,[e("div",_D,[e("ul",pD,[e("li",bD,[e("a",{class:g(["nav-link",{active:t.tab===0}]),onClick:s[4]||(s[4]=a=>t.tab=0),"aria-current":"page",href:"#"},"Пользователи",2)]),e("li",fD,[e("a",{class:g(["nav-link",{active:t.tab===1}]),onClick:s[5]||(s[5]=a=>t.tab=1),"aria-current":"page",href:"#"},"Бонусы",2)]),e("li",gD,[e("a",{class:g(["nav-link",{active:t.tab===2}]),onClick:s[6]||(s[6]=a=>t.tab=2),"aria-current":"page",href:"#"},"Продажи",2)]),e("li",vD,[e("a",{class:g(["nav-link",{active:t.tab===3}]),onClick:s[7]||(s[7]=a=>t.tab=3),"aria-current":"page",href:"#"},"Переходы",2)])])]),t.tab===0?(l(),i("div",yD,[t.need_charts?(l(),i("div",$D,[t.loadedChart&&(t.users||[]).length>0?(l(),y(j(D),{key:0,size:{width:500,height:320},data:t.users,margin:t.margin,direction:t.direction,axis:t.axis},{layers:v(()=>[b(j(E),{strokeDasharray:"2,2"}),b(j(L),{dataKeys:["m","count"],barStyle:{fill:"#ffe775"}}),b(d,{value:1e3,label:"Avg.",color:"#e76f51",strokeWidth:"2",strokeDasharray:"6 6"})]),widgets:v(()=>[b(j(M),{borderColor:"#48CAE4",config:t.tooltipConfig},null,8,["config"])]),_:1},8,["data","margin","direction","axis"])):(l(),i("p",kD,"Статистика еще не загружена или её нет"))])):r("",!0),(t.users||[]).length>0?(l(),i("div",FD,[e("table",wD,[CD,e("tbody",null,[(l(!0),i(f,null,$(t.users,(a,h)=>(l(),i("tr",null,[e("th",SD,u(h+1),1),e("td",null,u(a.y),1),e("td",null,u(a.m),1),e("td",null,u(a.count),1)]))),256))])])])):r("",!0)])):r("",!0),t.tab===1?(l(),i("div",jD,[t.need_charts?(l(),i(f,{key:0},[VD,e("div",qD,[t.loadedChart&&(t.cashback_up||[]).length>0?(l(),y(j(D),{key:0,size:{width:500,height:320},data:t.cashback_up,margin:t.margin,direction:t.direction,axis:t.axis},{layers:v(()=>[b(j(E),{strokeDasharray:"2,2"}),b(j(L),{dataKeys:["m","sum"],barStyle:{fill:"#ffe775"}}),b(d,{value:1e3,label:"Avg.",color:"#e76f51",strokeWidth:"2",strokeDasharray:"6 6"})]),widgets:v(()=>[b(j(M),{borderColor:"#48CAE4",config:t.tooltipConfig},null,8,["config"])]),_:1},8,["data","margin","direction","axis"])):(l(),i("p",zD,"Статистика еще не загружена или её нет"))]),PD,e("div",UD,[t.loadedChart&&(t.cashback_down||[]).length>0?(l(),y(j(D),{key:0,size:{width:500,height:320},data:t.cashback_down,margin:t.margin,direction:t.direction,axis:t.axis},{layers:v(()=>[b(j(E),{strokeDasharray:"2,2"}),b(j(L),{dataKeys:["m","sum"],barStyle:{fill:"#ffe775"}}),b(d,{value:1e3,label:"Avg.",color:"#e76f51",strokeWidth:"2",strokeDasharray:"6 6"})]),widgets:v(()=>[b(j(M),{borderColor:"#48CAE4",config:t.tooltipConfig},null,8,["config"])]),_:1},8,["data","margin","direction","axis"])):(l(),i("p",OD,"Статистика еще не загружена или её нет"))])],64)):r("",!0),(t.preparedCashback||[]).length>0?(l(),i("div",AD,[e("table",ID,[QD,e("tbody",null,[(l(!0),i(f,null,$(t.preparedCashback,(a,h)=>(l(),i("tr",null,[e("th",TD,u(h+1),1),e("td",null,u(a.y),1),e("td",null,u(a.m),1),e("td",null,u(a.up),1),e("td",null,u(a.down),1)]))),256))])])])):r("",!0)])):r("",!0),t.tab===2?(l(),i("div",MD,[t.need_charts?(l(),i("div",DD,[t.loadedChart&&(t.orders||[]).length>0?(l(),y(j(D),{key:0,size:{width:500,height:320},data:t.orders,margin:t.margin,direction:t.direction,axis:t.axis},{layers:v(()=>[b(j(E),{strokeDasharray:"2,2"}),b(j(L),{dataKeys:["m","sump"],barStyle:{fill:"#ffe775"}}),b(d,{value:1e3,label:"Avg.",color:"#e76f51",strokeWidth:"2",strokeDasharray:"6 6"})]),widgets:v(()=>[b(j(M),{borderColor:"#48CAE4",config:t.tooltipConfig},null,8,["config"])]),_:1},8,["data","margin","direction","axis"])):(l(),i("p",RD,"Статистика еще не загружена или её нет"))])):r("",!0),t.need_charts?(l(),y(n,{key:1,class:"d-flex"},{default:v(()=>[b(j(me),{class:"w-full"},{main:v(({width:a})=>[b(j(D),{direction:"circular",size:{width:a,height:400},data:t.products,margin:{left:Math.round((a-360)/2),top:50,right:0,bottom:0},axis:t.axis,config:{controlHover:!1}},{layers:v(()=>[b(j(he),{dataKeys:["title","count","price"],"pie-style":{innerRadius:100,padAngle:.05}},null,8,["pie-style"])]),widgets:v(()=>[b(j(M),{config:{title:{label:"Название"},price:{label:"Выручено средств"},count:{label:"Кол-во"},volume_count_ratio:{hide:!0},volume_price_ratio:{hide:!0}},hideLine:""})]),_:2},1032,["size","data","margin","axis"])]),_:1})]),_:1})):r("",!0),(t.products||[]).length>0?(l(),i("table",BD,[e("thead",null,[e("tr",null,[ED,e("th",LD,[e("a",{href:"javascript:void(0)",onClick:s[8]||(s[8]=a=>t.changeSort("title"))},[t.sort.key==="title"?(l(),i(f,{key:0},[t.sort.direction==="asc"?(l(),i("i",KD)):(l(),i("i",ND))],64)):r("",!0),m(" Название ")])]),e("th",JD,[e("a",{href:"javascript:void(0)",onClick:s[9]||(s[9]=a=>t.changeSort("price"))},[t.sort.key==="price"?(l(),i(f,{key:0},[t.sort.direction==="asc"?(l(),i("i",HD)):(l(),i("i",YD))],64)):r("",!0),m(" Объем продаж ")])]),e("th",GD,[e("a",{href:"javascript:void(0)",onClick:s[10]||(s[10]=a=>t.changeSort("count"))},[t.sort.key==="count"?(l(),i(f,{key:0},[t.sort.direction==="asc"?(l(),i("i",WD)):(l(),i("i",XD))],64)):r("",!0),m(" Продано ед. ")])]),e("th",ZD,[e("a",{href:"javascript:void(0)",onClick:s[11]||(s[11]=a=>t.changeSort("volume_count_ratio"))},[t.sort.key==="volume_count_ratio"?(l(),i(f,{key:0},[t.sort.direction==="asc"?(l(),i("i",xD)):(l(),i("i",eR))],64)):r("",!0),m(" % от объема ")])]),e("th",tR,[e("a",{href:"javascript:void(0)",onClick:s[12]||(s[12]=a=>t.changeSort("volume_price_ratio"))},[t.sort.key==="volume_price_ratio"?(l(),i(f,{key:0},[t.sort.direction==="asc"?(l(),i("i",sR)):(l(),i("i",oR))],64)):r("",!0),m(" % от числа ")])])])]),e("tbody",null,[(l(!0),i(f,null,$(t.products,(a,h)=>(l(),i("tr",null,[e("th",lR,u(h+1),1),e("td",null,u(a.title),1),e("td",null,u(a.price),1),e("td",null,u(a.count),1),e("td",null,u(a.volume_count_ratio),1),e("td",null,u(a.volume_price_ratio),1)]))),256))])])):(l(),i("p",iR,"Нет данных по продажам за выбранный период:("))])):r("",!0),t.tab===3?(l(),i("div",nR,[b(FM,{date:t.date,bot:o.bot},null,8,["date","bot"])])):r("",!0)])])])])}}}),rR={data(){return{bot:null,search:null,load:!1,messages:[],message_dictionary:[],modal:null,selected:{key:null,value:null}}},computed:{...S(["getCurrentBot","getMessages","getMessageDictionary"])},mounted(){this.modal=new bootstrap.Modal(document.getElementById("edit-table-message"),{}),this.loadCurrentBot().then(()=>{this.loadMessages()})},methods:{useTemplate(o){let t="#message-editor-textarea",s=document.querySelector(t);s=s.selectionStart||0;let d=this.selected.value||"",n=d.slice(0,s),a=d.slice(s);this.selected.value=n+"{{"+o+"}}"+a},loadMessages(o=0){return this.load=!0,this.$store.dispatch("loadMessages",{dataObject:{botId:this.bot.id,search:this.search||null},page:o}).then(t=>{this.messages=this.getMessages,this.message_dictionary=this.getMessageDictionary,this.load=!1}).catch(()=>{this.load=!1})},loadCurrentBot(o=null){return this.$store.dispatch("updateCurrentBot",{bot:o}).then(()=>{this.bot=this.getCurrentBot})},submit(){let o=new FormData;o.append("key",this.selected.key),o.append("value",this.selected.value),o.append("bot_id",this.bot.id),this.$store.dispatch("updateMessage",{messageForm:o}).then(t=>{this.loadMessages(),this.modal.hide(),this.$notify({title:"Редактор сообщений",text:"Данные успешно обновлены",type:"success"})}).catch(()=>{this.$notify({title:"Редактор сообщений",text:"Ошибка обновления данных",type:"error"})})},selectMessage(o){this.load=!0,this.$nextTick(()=>{this.selected.key=o,this.selected.value=this.messages[o]||"",this.load=!1,this.modal.show()}),this.$emit("select",item)}}},cR={key:0,class:"row"},uR=e("div",{class:"col-12"},[e("h3",{class:"my-3"},"Редактор сообщений в боте")],-1),mR={key:0,class:"mb-3 col-12 col-sm-12"},hR={class:"table"},_R=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"Параметр"),e("th",{scope:"col"},"Текст"),e("th",{scope:"col"},"Действия")])],-1),pR=["innerHTML"],bR=["onClick"],fR={class:"modal fade",id:"edit-table-message",tabindex:"-1"},gR={class:"modal-dialog"},vR={key:0,class:"modal-content"},yR=e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"exampleModalLabel"},"Редактирование сообщения "),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),$R={class:"modal-body"},kR={class:"col-12"},FR={class:"dropdown"},wR=e("button",{class:"btn btn-outline-primary dropdown-toggle mb-2 w-100",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"}," Выбрать параметр автоподстановки ",-1),CR={class:"dropdown-menu"},SR=["onClick"],jR={class:"col-12"},VR={class:"form-floating"},qR=e("label",{for:"floatingTextarea2"},"Текст сообщения",-1),zR=e("div",{class:"col-12"},[e("button",{type:"submit",class:"btn btn-primary w-100 p-3 mt-2"},"Сохранить")],-1),PR=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1);function UR(o,t,s,d,n,a){return l(),i(f,null,[n.bot?(l(),i("div",cR,[uR,n.messages&&!n.load?(l(),i("div",mR,[e("table",hR,[_R,e("tbody",null,[(l(!0),i(f,null,$(n.messages,(h,p)=>(l(),i("tr",null,[e("td",null,u(p||"ключа нет"),1),e("td",null,[e("p",{innerHTML:h},null,8,pR)]),e("td",null,[e("a",{onClick:F=>a.selectMessage(p),title:"Выбрать сообщение",class:"btn btn-link"}," Редактировать ",8,bR)])]))),256))])])])):r("",!0)])):r("",!0),e("div",fR,[e("div",gR,[n.selected&&!n.load?(l(),i("div",vR,[yR,e("div",$R,[e("form",{class:"row",onSubmit:t[1]||(t[1]=C((...h)=>a.submit&&a.submit(...h),["prevent"]))},[e("div",kR,[e("div",FR,[wR,e("ul",CR,[(l(!0),i(f,null,$(n.message_dictionary,(h,p)=>(l(),i("li",null,[e("a",{class:"dropdown-item",onClick:F=>a.useTemplate(p),href:"javascript:void(0)"},[e("strong",null,u(p||"-"),1),m(" - "+u(h||"-"),1)],8,SR)]))),256))])])]),e("div",jR,[e("div",VR,[c(e("textarea",{"onUpdate:modelValue":t[0]||(t[0]=h=>n.selected.value=h),class:"form-control",placeholder:"Leave a comment here",id:"message-editor-textarea",style:{"min-height":"100px"},required:""},null,512),[[_,n.selected.value]]),qR])]),zR],32)]),PR])):r("",!0)])])],64)}const OR=U(rR,[["render",UR]]);const AR={key:0,class:"pb-5 mb-5"},IR={key:1,class:"pb-5 mb-5"},QR={key:2,class:"pb-5 mb-5"},TR={key:3,class:"pb-5 mb-5"},MR={key:4,class:"pb-5 mb-5"},DR={key:5,class:"pb-5 mb-5"},RR={key:6,class:"pb-5 mb-5"},BR={key:7,class:"pb-5 mb-5"},ER={key:8,class:"pb-5 mb-5"},LR={key:9,class:"pb-5 mb-5"},KR={key:10,class:"pb-5 pt-2 mb-5"},NR={key:11,class:"pb-5 mb-5"},JR={key:12,class:"pb-5 mb-5 pt-2"},HR={key:13,class:"pb-5 mb-5"},YR={key:14,class:"pb-5 mb-5 pt-2"},GR={key:15,class:"pb-5 mb-5 pt-2"},WR={key:16,class:"pb-5 mb-5 pt-2"},XR={key:17,class:"pb-5 mb-5 pt-2"},ZR={key:18,class:"row pb-5 mb-5"},xR={key:0,class:"col-12 col-md-12"},eB={key:19,class:"pb-5 mb-5"},tB={class:"offcanvas offcanvas-end","data-bs-scroll":"true","data-bs-backdrop":"false",tabindex:"-1",id:"bot-section-menu","aria-labelledby":"staticBackdropLabel"},sB=e("div",{class:"offcanvas-header"},[e("h5",{class:"offcanvas-title",id:"staticBackdropLabel"},"Меню управления ботом"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"offcanvas","aria-label":"Close"})],-1),oB={class:"offcanvas-body"},lB={class:"nav nav-tabs"},iB={class:"nav-item"},nB={class:"nav-item"},aB={key:0,class:"list-group list-group-flush"},dB={class:"list-group-item"},rB=e("strong",null,"ID:",-1),cB={class:"list-group-item"},uB=e("strong",null,"Краткое описание:",-1),mB={class:"list-group-item"},hB=e("strong",null,"Описание:",-1),_B={class:"list-group-item"},pB=e("strong",null,"Домен бота:",-1),bB={class:"list-group-item"},fB=e("strong",null,"Приветственное сообщение:",-1),gB={class:"list-group-item"},vB=e("strong",null,"Основной канал:",-1),yB={class:"list-group-item"},$B=e("strong",null,"Канал заказов:",-1),kB={class:"list-group-item"},FB=e("strong",null,"Тип бота:",-1),wB={class:"list-group-item"},CB=e("strong",null,"Уровень 1:",-1),SB={class:"list-group-item"},jB=e("strong",null,"Уровень 2:",-1),VB={class:"list-group-item"},qB=e("strong",null,"Уровень 3:",-1),zB={class:"list-group-item"},PB=e("strong",null,"Автокешбэк:",-1),UB={class:"list-group-item"},OB=e("strong",null,"Компания:",-1),AB={class:"list-group-item"},IB=e("strong",null,"Адрес компании:",-1),QB={class:"list-group-item"},TB=e("strong",null,"Телефоны компании:",-1),MB={key:1,class:"list-group list-group-flush bot-section-menu-group py-3"},DB=e("h6",null,"Основная информация",-1),RB=e("i",{class:"fa-solid fa-info mr-2"},null,-1),BB=e("i",{class:"fa-solid fa-file mr-2"},null,-1),EB=e("i",{class:"fa-solid fa-file mr-2"},null,-1),LB=e("h6",null,"Рассылки и события",-1),KB=e("i",{class:"fa-regular fa-newspaper mr-2"},null,-1),NB=e("i",{class:"fa-regular fa-calendar-days mr-2"},null,-1),JB=e("h6",null,"Квизы и промокоды",-1),HB=e("i",{class:"fa-solid fa-q mr-2"},null,-1),YB=e("i",{class:"fa-solid fa-q mr-2"},null,-1),GB=e("h6",null,"Настройки и запросы",-1),WB=e("i",{class:"fa-solid fa-clipboard-list mr-2"},null,-1),XB=e("i",{class:"fa-solid fa-code mr-2"},null,-1),ZB=e("h6",null,"Элементы бота",-1),xB=e("i",{class:"fa-solid fa-keyboard mr-2"},null,-1),eE=e("i",{class:"fa-solid fa-scroll mr-2"},null,-1),tE=e("i",{class:"fa-solid fa-comment-dots mr-2"},null,-1),sE=e("i",{class:"fa-solid fa-users mr-2"},null,-1),oE=e("i",{class:"fa-solid fa-users mr-2"},null,-1),lE=e("h6",null,"Интеграции",-1),iE=e("i",{class:"fa-solid fa-list-check mr-2"},null,-1),nE=e("i",{class:"fa-solid fa-list-check mr-2"},null,-1),aE=e("i",{class:"fa-solid fa-list-check mr-2"},null,-1),dE=e("i",{class:"fa-solid fa-list-check mr-2"},null,-1),rE=e("h6",null,"Магазин и медиа",-1),cE=e("i",{class:"fa-brands fa-shopify mr-2"},null,-1),uE=e("i",{class:"fa-brands fa-shopify mr-2"},null,-1),mE={props:["bot"],data(){return{page:null,step:-1,tab:1,load:!1,loadPage:!1}},mounted(){this.setStep(localStorage.getItem("cashman_set_botform_step_index")||0),window.addEventListener("open-base-bot-params-event",o=>{this.$nextTick(()=>{this.setStep(0)})})},methods:{botCallbackUpdate(o){this.$store.dispatch("updateCurrentBot",{bot:o}).then(()=>{}),this.$emit("callback")},hasRole(o){return window.hasRole(o)||!1},setStep(o){this.step=parseInt(o),localStorage.setItem("cashman_set_botform_step_index",o)},pageListCallback(o){this.loadPage=!0,this.page=o,this.$nextTick(()=>{this.loadPage=!1})},botSettingsCallback(){this.step=0,document.documentElement.scrollTop=200,this.$nextTick(()=>{window.dispatchEvent(new CustomEvent("add-payment-system-event"))})},pageCallback(o){this.page=o,this.loadPageList=!0,this.$nextTick(()=>{this.loadPageList=!1})},loadCurrentCompany(o=null){this.$store.dispatch("updateCurrentCompany",{company:o}).then(()=>{this.company=this.getCurrentCompany})},companyListCallback(o){this.load=!0,this.loadCurrentCompany(o),this.$nextTick(()=>{this.load=!1})}}},PE=Object.assign(mE,{__name:"BotSection",setup(o){return(t,s)=>(l(),i(f,null,[t.step===19?(l(),i("div",AR,[t.load?r("",!0):(l(),y(tF,{key:0,data:o.bot.cdek||null},null,8,["data"]))])):r("",!0),t.step===18?(l(),i("div",IR,[t.load?r("",!0):(l(),y(dR,{key:0,bot:o.bot},null,8,["bot"]))])):r("",!0),t.step===14?(l(),i("div",QR,[t.load?r("",!0):(l(),y(SO,{key:0,bot:o.bot},null,8,["bot"]))])):r("",!0),t.step===16?(l(),i("div",TR,[t.load?r("",!0):(l(),y(CT,{key:0,bot:o.bot},null,8,["bot"]))])):r("",!0),t.step===13?(l(),i("div",MR,[t.load?r("",!0):(l(),y(uS,{key:0,bot:o.bot},null,8,["bot"]))])):r("",!0),t.step===0?(l(),i("div",DR,[t.load?r("",!0):(l(),y(ze,{key:0,onCallback:t.botCallbackUpdate,bot:o.bot},null,8,["onCallback","bot"]))])):r("",!0),t.step===15?(l(),i("div",RR,[t.load?r("",!0):(l(),y(BI,{key:0,bot:o.bot},null,8,["bot"]))])):r("",!0),t.step===7?(l(),i("div",BR,[t.load?r("",!0):(l(),y(R5,{key:0,data:o.bot.amo},null,8,["data"]))])):r("",!0),t.step===17?(l(),i("div",ER,[t.load?r("",!0):(l(),y(dM,{key:0,data:o.bot.frontPad},null,8,["data"]))])):r("",!0),t.step===12?(l(),i("div",LR,[t.load?r("",!0):(l(),y(bF,{key:0,data:o.bot.y_clients},null,8,["data"]))])):r("",!0),t.step===11?(l(),i("div",KR,[t.load?r("",!0):(l(),y(Hw,{key:0}))])):r("",!0),t.step===8?(l(),i("div",NR,[t.load?r("",!0):(l(),y(p5,{key:0}))])):r("",!0),t.step===10?(l(),i("div",JR,[t.load?r("",!0):(l(),y(pw,{key:0}))])):r("",!0),t.step===1?(l(),i("div",HR,[t.load?r("",!0):(l(),y(R,{key:0,"select-mode":!1}))])):r("",!0),t.step===6?(l(),i("div",YR,[t.load?r("",!0):(l(),y(pe,{key:0}))])):r("",!0),t.step===2?(l(),i("div",GR,[t.load?r("",!0):(l(),y(Ql,{key:0}))])):r("",!0),t.step===3?(l(),i("div",WR,[t.load?r("",!0):(l(),y(J,{key:0}))])):r("",!0),t.step===20?(l(),i("div",XR,[t.load?r("",!0):(l(),y(OR,{key:0}))])):r("",!0),t.step===4?(l(),i("div",ZR,[t.load?r("",!0):(l(),i("div",xR,[t.loadPage?r("",!0):(l(),y(j2,{key:0,page:t.page,onBotSettings:t.botSettingsCallback,onCallback:t.pageCallback},null,8,["page","onBotSettings","onCallback"]))]))])):r("",!0),t.step===9?(l(),i("div",eB,[b(jF,{bot:o.bot},null,8,["bot"])])):r("",!0),e("div",tB,[sB,e("div",oB,[e("ul",lB,[e("li",iB,[e("a",{class:g([{active:t.tab===0},"nav-link"]),onClick:s[0]||(s[0]=d=>t.tab=0),"aria-current":"page",href:"javascript:void(0)"},"Информация о боте",2)]),e("li",nB,[e("a",{class:g(["nav-link",{active:t.tab===1}]),onClick:s[1]||(s[1]=d=>t.tab=1),href:"javascript:void(0)"},"Управление ботом",2)])]),t.tab===0?(l(),i("ul",aB,[e("li",dB,[rB,m(" "+u(o.bot.id),1)]),e("li",cB,[uB,m(" "+u(o.bot.short_description),1)]),e("li",mB,[hB,m(" "+u(o.bot.description),1)]),e("li",_B,[pB,m(" "+u(o.bot.bot_domain),1)]),e("li",bB,[fB,m(" "+u(o.bot.welcome_message),1)]),e("li",gB,[vB,m(" "+u(o.bot.main_channel),1)]),e("li",yB,[$B,m(" "+u(o.bot.order_channel),1)]),e("li",kB,[FB,m(" "+u(o.bot.bot_type_id),1)]),e("li",wB,[CB,m(" "+u(o.bot.level_1),1)]),e("li",SB,[jB,m(" "+u(o.bot.level_2),1)]),e("li",VB,[qB,m(" "+u(o.bot.level_3),1)]),e("li",zB,[PB,m(" "+u(o.bot.auto_cashback_on_payments?"Да":"Нет"),1)]),e("li",UB,[OB,m(" "+u(o.bot.company.title),1)]),e("li",AB,[IB,m(" "+u(o.bot.company.address),1)]),e("li",QB,[TB,m(" "+u((o.bot.company.phones||[]).join(", ")),1)])])):r("",!0),t.tab===1?(l(),i("ul",MB,[DB,e("li",null,[e("a",{class:"bg-primary text-white list-group-item list-group-item-action",href:"javascript:void(0)",onClick:s[2]||(s[2]=d=>t.setStep(0))},[RB,m("Базовые настройки бота")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"javascript:void(0)",onClick:s[3]||(s[3]=d=>t.setStep(4))},[BB,m("Страницы")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"javascript:void(0)",onClick:s[4]||(s[4]=d=>t.setStep(18))},[EB,m("Статистика")])]),LB,e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"javascript:void(0)",onClick:s[5]||(s[5]=d=>t.setStep(9))},[KB,m(" Рассылки")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"javascript:void(0)",onClick:s[6]||(s[6]=d=>t.setStep(13))},[NB,m("Запись на событие (прием)")])]),JB,e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"javascript:void(0)",onClick:s[7]||(s[7]=d=>t.setStep(14))},[HB,m("Квизы")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"javascript:void(0)",onClick:s[8]||(s[8]=d=>t.setStep(16))},[YB,m("Промокоды")])]),GB,e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"javascript:void(0)",onClick:s[9]||(s[9]=d=>t.setStep(15))},[WB,m("Встраиваемые запросы")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"javascript:void(0)",onClick:s[10]||(s[10]=d=>t.setStep(10))},[XB,m("Настраиваемые поля")])]),ZB,e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"javascript:void(0)",onClick:s[11]||(s[11]=d=>t.setStep(1))},[xB,m("Все клавиатуры в боте")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"javascript:void(0)",onClick:s[12]||(s[12]=d=>t.setStep(2))},[eE,m("Все скрипты в боте")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"javascript:void(0)",onClick:s[13]||(s[13]=d=>t.setStep(6))},[tE,m("Все диалоги в боте")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"javascript:void(0)",onClick:s[14]||(s[14]=d=>t.setStep(3))},[sE,m("Все пользователи в боте")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"javascript:void(0)",onClick:s[15]||(s[15]=d=>t.setStep(20))},[oE,m("Настройка системных сообщений")])]),lE,e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"javascript:void(0)",onClick:s[16]||(s[16]=d=>t.setStep(7))},[iE,m(" AMO CRM")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"javascript:void(0)",onClick:s[17]||(s[17]=d=>t.setStep(19))},[nE,m(" CDEK")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"javascript:void(0)",onClick:s[18]||(s[18]=d=>t.setStep(17))},[aE,m(" FrontPad")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"javascript:void(0)",onClick:s[19]||(s[19]=d=>t.setStep(12))},[dE,m(" YClients")])]),rE,e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"javascript:void(0)",onClick:s[20]||(s[20]=d=>t.setStep(8))},[cE,m(" Магазин")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"javascript:void(0)",onClick:s[21]||(s[21]=d=>t.setStep(11))},[uE,m(" Медиа файлы бота")])])])):r("",!0)])])],64))}});export{PE as _,j2 as a,pe as b};
