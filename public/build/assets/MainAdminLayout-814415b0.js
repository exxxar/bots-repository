import{M as f}from"./ManagerProfile-e4b03a3f.js";import{G as p,R as _,q as n,t as i,B as h,O as v,u as g,a6 as y,v as t,D as r,y as c,A as l,x as d,N as C,F as m,C as k,K as w}from"./index.es-94f59699.js";/* empty css                                                 */const x=t("title",null,"Кабинет администратора",-1),$=t("meta",{name:"description",content:"Кабинет администратора<"},null,-1),B={key:0,class:"navbar navbar-dark sticky-top bg-dark flex-md-nowrap p-0 shadow"},E={class:"navbar-brand col-md-3 col-lg-2 me-0 px-3 fs-6 cursor-pointer align-items-center d-flex","data-bs-toggle":"modal","data-bs-target":"#selected-company-bot-info"},L={key:0,style:{"font-size":"12px","margin-left":"10px"}},T=["href"],A=t("button",{class:"navbar-toggler position-absolute d-md-none collapsed",type:"button","data-bs-toggle":"collapse","data-bs-target":"#sidebarMenu","aria-controls":"sidebarMenu","aria-expanded":"false","aria-label":"Toggle navigation"},[t("span",{class:"navbar-toggler-icon"})],-1),M={class:"navbar-nav d-flex justify-content-center align-items-center flex-row"},S={class:"nav-item text-nowrap"},j=t("i",{class:"fa-solid fa-mug-hot"},null,-1),I=t("div",{class:"nav-item text-nowrap"},[t("a",{class:"nav-link px-3","data-bs-toggle":"offcanvas",role:"button",href:"#profile-sidebar"},[t("i",{class:"fa-solid fa-user"}),r(" Профиль")])],-1),N={class:"nav-item text-nowrap"},D=t("i",{class:"fa-solid fa-mug-hot"},null,-1),O={class:"nav-item text-nowrap"},R=t("i",{class:"fa-solid fa-robot"},null,-1),V={key:0,class:"nav-item text-nowrap"},q=t("i",{class:"fa-solid fa-scroll"},null,-1),z=t("div",{class:"navbar-nav d-none d-md-block"},[t("div",{class:"nav-item text-nowrap"},[t("a",{class:"nav-link px-3",href:"/logout"},"Выход")])],-1),F={class:"container-fluid"},G={class:"row"},K={class:"col-md-12 ms-sm-auto col-lg-12 px-md-4 px-0"},P={class:"pt-md-3 pt-0 pb-md-2 pb-0 mb-3"},W={class:"modal fade",id:"selected-company-bot-info",tabindex:"-1","aria-labelledby":"open-construct-label","aria-hidden":"true"},X={class:"modal-dialog"},H={class:"modal-content"},J=t("div",{class:"modal-header"},[t("h1",{class:"modal-title fs-5",id:"open-construct-label"},"У вас выбрано"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Q={class:"modal-body"},U={key:0,class:"card border-info mb-2"},Y={class:"card-body"},Z=t("p",null,"У Вас выбран клиент:",-1),tt={class:"d-flex justify-content-between w-100"},et=t("i",{class:"fa-solid fa-xmark"},null,-1),st=[et],at={key:1,class:"card border-info"},ot={class:"card-body"},nt=t("p",null,"У Вас выбран бот:",-1),it={class:"d-flex justify-content-between w-100"},lt=["href"],rt=t("i",{class:"fa-solid fa-xmark"},null,-1),dt=[rt],ct=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),ht={class:"theme-switcher d-none d-md-flex flex-column"},mt=t("button",{id:"switch-theme","data-bs-toggle":"modal","data-bs-target":"#theme-switch-modal",class:"btn btn-primary"},[t("i",{class:"fa-solid fa-palette"})],-1),bt=t("i",{class:"fa-solid fa-moon"},null,-1),ut=[bt],ft={class:"modal",id:"theme-switch-modal",tabindex:"-1"},pt={class:"modal-dialog"},_t={class:"modal-content"},vt=t("div",{class:"modal-header"},[t("h5",{class:"modal-title"},"Выбор темы оформления"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),gt={class:"modal-body"},yt={class:"list-group"},Ct=["onClick"],kt=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),wt={class:"offcanvas offcanvas-start",tabindex:"-1",id:"profile-sidebar","aria-labelledby":"offcanvasExampleLabel"},xt=t("div",{class:"offcanvas-header"},[t("h5",{class:"offcanvas-title",id:"offcanvasExampleLabel"},"Ваш профиль"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"offcanvas","aria-label":"Закрыть"})],-1),$t={class:"offcanvas-body"},Bt={props:["active","needMenu"],data(){return{load:!1,bot:null,is_chat_open:!1,currentTheme:"",company:null,themes:[{title:"Тема 1",href:"/theme1.bootstrap.min.css"},{title:"Тема 2",href:"/theme2.bootstrap.min.css"},{title:"Тема 3",href:"/theme3.bootstrap.min.css"},{title:"Тема 4",href:"/theme4.bootstrap.min.css"},{title:"Тема 5",href:"/theme5.bootstrap.min.css"},{title:"Тема 6",href:"/theme6.bootstrap.min.css"},{title:"Тема 7",href:"/theme7.bootstrap.min.css"},{title:"Тема 8",href:"/theme8.bootstrap.min.css"},{title:"Тема 9",href:"/theme9.bootstrap.min.css"},{title:"Тема 10",href:"/theme10.bootstrap.min.css"},{title:"Тема 11",href:"/theme11.bootstrap.min.css"},{title:"Тема 12",href:"/theme12.bootstrap.min.css"},{title:"Тема 13",href:"/theme13.bootstrap.min.css"},{title:"Тема 14",href:"/theme14.bootstrap.min.css"},{title:"Тема 15",href:"/theme15.bootstrap.min.css"},{title:"Тема 16",href:"/theme16.bootstrap.min.css"}]}},computed:{...p(["getErrors","getCurrentBot","getCurrentCompany"])},watch:{getErrors:function(s,e){Object.keys(s).forEach(a=>{this.$notify({title:"Конструктор ботов",text:s[a],type:"warn"})})}},mounted(){this.loadCurrentCompany(),this.loadCurrentBot();let s=localStorage.getItem("cashman_global_admin_theme")||null,e=localStorage.getItem("cashman_global_admin_light")||null;s&&this.$nextTick(()=>{this.currentTheme=s}),e&&this.changeLight(e),window.addEventListener("store_current_bot-change-event",a=>{this.bot=this.getCurrentBot}),window.addEventListener("store_current_company-change-event",a=>{this.company=this.getCurrentCompany})},methods:{changeLight(s=null){let e=document.querySelector("html");if(s!=null&&(s==="light"||s==="dark")){e.setAttribute("data-bs-theme",s),localStorage.setItem("cashman_global_admin_light",s);return}if(e.hasAttribute("data-bs-theme")){let a=e.getAttribute("data-bs-theme");e.setAttribute("data-bs-theme",a==="dark"?"light":"dark")}else e.setAttribute("data-bs-theme","dark");localStorage.setItem("cashman_global_admin_light",e.getAttribute("data-bs-theme")||"light")},hasRole(s){return window.hasRole(s)||!1},switchTheme(s){let e=document.querySelector("#theme");e.href=this.themes[s].href,localStorage.setItem("cashman_global_admin_theme",e.href),this.$nextTick(()=>{this.currentTheme=e.href})},loadCurrentCompany(s=null){this.$store.dispatch("updateCurrentCompany",{company:s}).then(()=>{this.company=this.getCurrentCompany})},loadCurrentBot(s=null){this.$store.dispatch("updateCurrentBot",{bot:s}).then(()=>{this.bot=this.getCurrentBot})},resetCompany(){this.$store.dispatch("resetCurrentCompany").then(()=>{this.company=null,window.dispatchEvent(new CustomEvent("store_current_company-change-event"))})},resetBot(){this.$store.dispatch("resetCurrentBot").then(()=>{this.bot=null,window.dispatchEvent(new CustomEvent("store_current_bot-change-event"))})},stopAllDialogs(){this.$store.dispatch("stopDialogs").then(s=>{this.$notify({title:"Конструктор ботов",text:"Все диалоги остановлены",type:"success"})}).catch(s=>{})},reloadWebhooks(){this.load=!0,this.$notify({title:"Конструктор ботов",text:"Процедура обновления зависимостей началась"}),axios.get("/bot/register-webhooks").then(()=>{this.load=!1,this.$notify({title:"Конструктор ботов",text:"Зависимости успешно обновлены!",type:"success"})}).catch(()=>{this.load=!1,this.$notify({title:"Конструктор ботов",text:"Неудалось обновить зависимости",type:"error"})})}}},Mt=Object.assign(Bt,{__name:"MainAdminLayout",setup(s){return(e,a)=>{const b=_("notifications");return n(),i(m,null,[h(g(y),null,{default:v(()=>[x,$]),_:1}),h(b,{position:"top right"}),s.needMenu?(n(),i("header",B,[t("a",E,[r("CashMan: "),e.bot?(n(),i("span",L,[t("a",{href:"https://t.me/"+(e.bot.bot_domain||"botfather"),target:"_blank"},c(e.bot.bot_domain||"Без имени"),9,T)])):l("",!0)]),A,t("div",M,[t("div",S,[t("a",{class:d(["nav-link px-3",{"border-bottom-active active":s.active==0}]),onClick:a[0]||(a[0]=o=>s.active=0),href:"/manager-page"},[j,r(" Стартовая страница")],2)]),I,t("div",N,[t("a",{class:d(["nav-link px-3",{"border-bottom-active active":s.active==1}]),onClick:a[1]||(a[1]=o=>s.active=1),href:"/company-page"},[D,r(" Клиенты")],2)]),t("div",O,[t("a",{class:d(["nav-link px-3",{"border-bottom-active active":s.active==2}]),onClick:a[2]||(a[2]=o=>s.active=2),href:"/bot-page"},[R,r(" Боты")],2)]),e.hasRole("admin")?(n(),i("div",V,[t("a",{class:d(["nav-link px-3",{"border-bottom-active active":s.active==6}]),onClick:a[3]||(a[3]=o=>s.active=6),href:"/script-page"},[q,r(" Скрипты")],2)])):l("",!0)]),z])):l("",!0),t("div",F,[t("div",G,[t("main",K,[t("div",P,[C(e.$slots,"default")])])])]),t("div",W,[t("div",X,[t("div",H,[J,t("div",Q,[e.company?(n(),i("div",U,[t("div",Y,[Z,t("div",tt,[t("span",null,c(e.company.title||"Без имени"),1),t("span",{onClick:a[4]||(a[4]=(...o)=>e.resetCompany&&e.resetCompany(...o))},st)])])])):l("",!0),e.bot?(n(),i("div",at,[t("div",ot,[nt,t("div",it,[t("span",null,[t("a",{href:"https://t.me/"+(e.bot.bot_domain||"botfather"),target:"_blank"},c(e.bot.bot_domain||"Без имени"),9,lt)]),t("span",{onClick:a[5]||(a[5]=(...o)=>e.resetBot&&e.resetBot(...o))},dt)])])])):l("",!0)]),ct])])]),t("div",ht,[mt,t("button",{onClick:a[6]||(a[6]=(...o)=>e.changeLight&&e.changeLight(...o)),class:"btn btn-primary mt-2"},ut)]),t("div",ft,[t("div",pt,[t("div",_t,[vt,t("div",gt,[t("div",yt,[(n(!0),i(m,null,k(e.themes,(o,u)=>(n(),i("button",{type:"button",onClick:Et=>e.switchTheme(u),class:d([{active:e.currentTheme.indexOf(o.href)!=-1},"list-group-item list-group-item-action"]),"aria-current":"true"},c(o.title||"-"),11,Ct))),256))])]),kt])])]),t("div",wt,[xt,t("div",$t,[t("div",null,[e.bot?(n(),w(f,{key:0,bot:e.bot},null,8,["bot"])):l("",!0)])])])],64)}}});export{Mt as _};
