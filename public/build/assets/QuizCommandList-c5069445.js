import{_ as H}from"./_plugin-vue_export-helper-c27b6911.js";import{o as i,j as n,M as Q,L as d,l as o,K as u,n as m,N as F,g as $,F as f,J as g,G as z,t as R,x as w,B as A,f as N,$ as q,bB as V,W as D,k as I,w as U,u as G}from"./index.es-db843bab.js";import{P as J}from"./Pagination-ccc8cfc8.js";import{B as M}from"./BotMediaObject-d5bf9d83.js";/* empty css                                                   */const K={props:["quiz","needReturn"],data(){return{types:["По порядку","Перемешать всё","Перемешать ответы","Перемешать вопросы"]}},mounted(){},computed:{isCompleted(){return!1}},methods:{returnBack(){this.$emit("return")},selectQuiz(t){this.$store.dispatch("startQuiz",{quiz_id:this.quiz.id}).then(e=>{}).catch(()=>{}),this.$emit("select",t)},openLinkModal(){let t=window.currentScript||null;this.$cashback.qr("005000000"+t)}}},W={class:"px-1"},x={key:0,class:"card w-100 shadow-xl rounded-sm"},X={key:0,class:"card-img-top rounded-m p-2",alt:"..."},Y={class:"card-body"},Z={class:"card-title"},ee={class:"card-text"},te={class:"list-group list-group-flush"},se={key:0,class:"list-group-item text-center text-danger"},ie={class:"list-group-item"},ne=o("i",{class:"fa-solid fa-shuffle"},null,-1),oe={key:1,class:"list-group-item"},ae=o("i",{class:"fa-solid fa-stopwatch-20"},null,-1),le={key:2,class:"list-group-item"},re={key:3,class:"list-group-item"},de={key:4,class:"list-group-item"},ue=o("i",{class:"fa-regular fa-circle-question"},null,-1),ce={key:5,class:"list-group-item"},he=o("i",{class:"fa-solid fa-person-circle-question"},null,-1),me={key:6,class:"list-group-item"},_e=o("i",{class:"fa-solid fa-link"},null,-1),fe={key:1,class:"card-body"},ge=["disabled"],pe={key:1,class:"alert alert-warning"},ze={key:2,class:"divider divider-small my-3 bg-highlight"},be={key:2,class:"card-body"},ye={class:"card card-style bg-28","data-card-height":"130",style:{height:"130px"}},ve={class:"card-center"},ke={class:"color-white font-700 text-center mb-0"},we={class:"color-white text-center opacity-60 mt-n1 mb-0"},qe={key:0,class:"color-white text-center opacity-60 mt-n1 mb-0"},Qe=o("div",{class:"card-overlay bg-highlight opacity-90"},null,-1),$e={key:0,class:"divider divider-small my-3 bg-highlight"};function Ce(t,e,s,l,a,r){const c=F("lazy");return i(),n("div",W,[s.quiz?(i(),n("div",x,[s.quiz.image?Q((i(),n("img",X,null,512)),[[c,"/file-by-file-id/"+s.quiz.image]]):d("",!0),o("div",Y,[o("h5",Z,u(s.quiz.title||"нет заголовка"),1),o("p",ee,u(s.quiz.description||"нет заголовка"),1)]),o("ul",te,[s.quiz.is_active?d("",!0):(i(),n("li",se,"Квиз недоступен")),o("li",ie,[ne,m(" "+u(a.types[s.quiz.display_type]),1)]),s.quiz.round_mode?(i(),n("li",oe,[ae,m(" на вопрос "+u(s.quiz.time_limit)+" сек ",1)])):d("",!0),s.quiz.round_mode?(i(),n("li",le,"Режим викторины (квиза) ")):d("",!0),s.quiz.polling_mode?(i(),n("li",re,"Режим опроса ")):d("",!0),(s.quiz.questions||[]).length>0?(i(),n("li",de,[ue,m(" Число вопросов "+u((s.quiz.questions||[]).length),1)])):d("",!0),!s.quiz.polling_mode&&(s.quiz.commands||[]).length>0?(i(),n("li",ce,[he,m(" Число команд "+u((s.quiz.commands||[]).length),1)])):d("",!0),s.quiz.polling_mode?d("",!0):(i(),n("li",me,[_e,o("a",{href:"javascript:void(0)",onClick:e[0]||(e[0]=(...h)=>r.openLinkModal&&r.openLinkModal(...h))},"Поделиться ссылкой")]))]),r.isCompleted?(i(),n("div",be,[o("div",ye,[o("div",ve,[o("h3",ke," Баллов "+u(s.quiz.personal_info.result_points||0),1),o("p",we," Попытки "+u(s.quiz.personal_info.current_attempts||0)+" / "+u(s.quiz.personal_info.max_attempts||0),1),s.quiz.personal_info.completed_at!=null?(i(),n("p",qe,u(t.$filters.currentFull(s.quiz.personal_info.completed_at)),1)):d("",!0)]),Qe]),s.needReturn?(i(),n("div",$e)):d("",!0),s.needReturn?(i(),n("a",{key:1,href:"javascript:void(0)",onClick:e[3]||(e[3]=(...h)=>r.returnBack&&r.returnBack(...h)),class:"btn btn-m btn-full mb-3 rounded-l text-uppercase font-900 shadow-s bg-red1-dark"},"Вернуться назад")):d("",!0)])):(i(),n("div",fe,[(s.quiz.questions||[]).length>0?(i(),n("button",{key:0,type:"button",onClick:e[1]||(e[1]=h=>r.selectQuiz(s.quiz)),disabled:!s.quiz.is_active,class:"btn btn-m w-100 btn-full mb-3 rounded-xl text-uppercase font-900 shadow-s bg-blue1-dark"},"Начать ",8,ge)):(i(),n("div",pe,"Вы не можете сейчас начать квиз! В нём нет вопросов!")),s.needReturn?(i(),n("div",ze)):d("",!0),s.needReturn?(i(),n("a",{key:3,href:"javascript:void(0)",onClick:e[2]||(e[2]=(...h)=>r.returnBack&&r.returnBack(...h)),class:"btn btn-m btn-full mb-3 rounded-l text-uppercase font-900 shadow-s bg-red1-dark"},"Вернуться назад")):d("",!0)]))])):d("",!0)])}const Rt=H(K,[["render",Ce]]),je={props:["quiz"],data(){return{types:["По порядку","Перемешать всё","Перемешать ответы","Перемешать вопросы"]}},computed:{isCompleted(){return!1}},methods:{selectQuiz(t){this.$store.dispatch("startQuiz",{quiz_id:this.quiz.id}).then(e=>{}).catch(()=>{}),this.$emit("select",t)},openLinkModal(t){this.$cashback.qr("007quiz"+t)}}},Oe={key:0,class:"card card-style bg-1",style:{height:"200px"}},Ae={class:"card-center"},Me={class:"color-white font-700 text-center mb-0"},Se={class:"color-white text-center opacity-60 mt-n1 mb-3"},He=o("div",{class:"card-overlay bg-black opacity-70"},null,-1);function Le(t,e,s,l,a,r){return s.quiz?(i(),n("div",Oe,[o("div",Ae,[o("h2",Me,u(s.quiz.title||"нет заголовка"),1),o("p",Se,u(s.quiz.description||"нет заголовка"),1),o("a",{href:"javascript:void(0)",class:"btn btn-m rounded-l font-900 text-uppercase bg-highlight btn-center-xl",onClick:e[0]||(e[0]=c=>r.selectQuiz(s.quiz))},"Детальнее о квизе")]),He])):d("",!0)}const Te=H(je,[["render",Le]]),Be={class:"row mb-0"},Pe=o("div",{class:"col-12"},[o("h5",{class:"text-center"},"Квизы для вас")],-1),Ee={key:0,class:"col-12 py-2"},Fe={key:1,class:"col-12"},Re={data(){return{direction:"desc",order:"updated_at",show:!0,loading:!0,quizzes:[],search:null,paginate_object:null}},computed:{...$(["getQuizzes","getQuizzesPaginateObject"])},mounted(){this.loadQuizzes()},methods:{openQuiz(t){this.$emit("open",t)},removeQuiz(t){this.loading=!0,this.$store.dispatch("removeQuiz",{quizId:t}).then(e=>{this.loading=!1,this.loadQuizzes(0),this.$notify("Событие успешно удалено")}).catch(()=>{this.loading=!1,this.$notify("Ошибка удаления события")})},createQuiz(){this.$emit("create")},nextQuizzes(t){this.loadQuizzes(t)},selectEvent(t){this.$emit("select",t)},loadAndOrder(t){this.order=t,this.direction=this.direction==="desc"?"asc":"desc",this.loadQuizzes(0)},loadQuizzes(t=0){this.loading=!0,this.$store.dispatch("loadQuizzes",{dataObject:{search:this.search,order:this.order,direction:this.direction},page:t,size:20}).then(e=>{this.loading=!1,this.quizzes=this.getQuizzes,this.paginate_object=this.getQuizzesPaginateObject}).catch(()=>{this.loading=!1})}}},Nt=Object.assign(Re,{__name:"QuizList",setup(t){return(e,s)=>(i(),n("div",Be,[Pe,e.quizzes.length>0?(i(),n("div",Ee,[(i(!0),n(f,null,g(e.quizzes,(l,a)=>(i(),z(Te,{onSelect:e.openQuiz,quiz:l},null,8,["onSelect","quiz"]))),256))])):d("",!0),e.quizzes.length>0?(i(),n("div",Fe,[e.paginate_object?(i(),z(J,{key:0,onPagination_page:e.nextQuizzes,pagination:e.paginate_object},null,8,["onPagination_page","pagination"])):d("",!0)])):d("",!0)]))}}),Ne=[{symbol:"D",value:24*60*60*1e3},{symbol:"H",value:60*60*1e3},{symbol:"m",value:60*1e3},{symbol:"s",value:1e3},{symbol:"S",value:100}];function L(t,e,s){const l="~"+e;return t.indexOf(l)>-1?t.split(l).map(a=>L(a,e,s)).join(l):t.replace(new RegExp(e,"g"),String(s))}function p(t,e="HH:mm:ss"){const s={};e.indexOf("~")>-1&&(e=e.replace(/~[DHmsS]/g,""));const l=Ne.filter(a=>e.indexOf(a.symbol)>-1);for(let a=0,r=l.length;a<r;a++){const{symbol:c,value:h}=l[a],_=r===1?Math.ceil(t/h):Math.floor(t/h);s[c]=_,s[c+c]=_<10?`0${_}`:_,t%=h}return s}function S(t,e="HH:mm:ss"){const s=typeof t=="number"?p(t,e):t,l=Object.keys(s).sort((r,c)=>c.length-r.length);let a=e;return l.forEach(r=>{a=L(a,r,s[r])}),a.indexOf("~")>-1&&(a=a.replace(/~([DHmsS])/g,"$1")),a}var T=R({name:"Countdown",emits:["change","finish"],props:{time:{type:Number,default:0},format:{type:String,default:"HH:mm:ss"},autoStart:{type:Boolean,default:!0}},setup(t,{emit:e}){const s=w(t.time),l=w(p(s.value,t.format)),a=w(!1),r={restTime:t.time,now:0,timer:0},c=A(()=>/s/i.test(t.format)?30:1e3),h=A(()=>S(l.value,t.format)),_=()=>{a.value||(r.now=Date.now(),r.restTime=s.value,window.clearInterval(r.timer),r.timer=window.setInterval(B,c.value),a.value=!0)},B=()=>{const{restTime:b,now:E}=r,y=Date.now()-E,v=b>y?b-y:0,k=p(v,t.format),O=S(k,t.format);O!==h.value&&(e("change",{currentTime:v,resolved:k,formatted:O}),l.value=k),s.value=v,b<=y&&C()},C=()=>{j(),e("finish")},j=()=>{a.value=!1,window.clearInterval(r.timer)},P=()=>{s.value=r.restTime=t.time,l.value=p(t.time,t.format),j()};return t.autoStart&&_(),{currentTime:s,resolved:l,formatted:h,inCountdown:a,start:_,stop:C,reset:P}},render(){const{currentTime:t,resolved:e,formatted:s}=this;return N("div",null,this.$slots.default&&this.$slots.default({currentTime:t,resolved:e,formatted:s})||this.formatted)}});const Ve={key:0,class:"card card-style"},De=o("div",{class:"content d-flex justify-content-center align-items-center flex-wrap",style:{"min-height":"300px"}},[o("div",null,[o("p",{class:"text-center w-100 font-weight-bold"},"Мы загружаем квиз!"),o("div",{class:"loader"})])],-1),Ie=[De],Ue={key:1,class:"card card-style"},Ge={class:"content"},Je={key:0},Ke={href:"javascript:void(0)",class:"chip chip-small bg-gray1-dark"},We=o("i",{class:"fa fa-check bg-green1-dark"},null,-1),xe={class:"color-black font-400"},Xe={class:"mb-0"},Ye={key:1},Ze={key:0,class:"mb-0 font-weight-bold text-center"},et={key:1},tt=["for"],st=["onUpdate:modelValue","id","value"],it=["onClick"],nt={key:2},ot=o("p",{class:"mb-0"},[o("small",null,"Открытый вопрос")],-1),at={class:"form-field form-name"},lt={class:"contactNameField color-theme d-flex justify-content-between",for:"command-title"},rt=["onClick"],dt=["onUpdate:modelValue"],ut=["onClick"],ct=o("div",{class:"divider divider-small my-3 bg-highlight"},null,-1),ht={key:2},mt={class:"d-flex justify-content-center font-24"},_t={class:"countdown-item"},ft={class:"countdown-item"},gt=o("small",{class:"text-center w-100 d-block"},"У вас осталось времени",-1),pt=o("div",{class:"divider divider-small my-3 bg-highlight"},null,-1),zt=["onClick"],bt={key:1},yt=o("h6",{class:"text-center my-2"}," А вот и результат ",-1),vt={key:0},kt={key:1,class:"text-center my-3"},wt=["innerHTML"],qt={key:2,class:"card card-style"},Qt={class:"content"},$t=o("p",null,"Поздравляю! Вы прошли данный квиз! Ваш результат:",-1),Ct={key:0,class:"list-group list-group-numbered"},jt={class:"list-group-item d-flex justify-content-between align-items-start"},Ot={class:"ms-2 me-auto"},At={class:"fw-bold"},Mt={class:"my-2"},St=["innerHTML"],Ht=["innerHTML"],Lt={props:["quiz"],components:{Countdown:T},data(){return{points:[],direction:"asc",order:"round",show:!0,step:0,is_finish:!1,is_group:!1,loading:!0,questions:[],answers:[],search:null,paginate_object:null,prepare:!1}},computed:{...$(["getQuizQuestions","getQuizQuestionsPaginateObject"]),successPercentCount(){if(this.points.length===0)return 0;let t=0;return this.points.forEach(e=>{e.is_right&&t++}),t/this.points.length},summaryPoints(){if(this.points.length===0)return 0;let t=0;return this.points.forEach(e=>{t+=e.points||0}),t}},mounted(){this.loadQuizQuestions()},methods:{isQuestionComplete(t){if(t>=this.answers.length||this.answers[t]===null)return!1;if(Array.isArray(this.answers)){let e=!1;return this.answers.forEach(s=>{s!=null&&(e=!0)}),e}return this.answers[t]!=null},completeAndExit(){this.$store.dispatch("completeQuiz",{quiz_id:this.quiz.id}).then(t=>{}).catch(()=>{}),this.$emit("complete")},finish(){this.step++,this.step>=this.questions.length&&(this.is_finish=!0)},next(){this.prepare=!1,this.step++},removeOpenAnswer(t,e){this.answers[t].splice(e,1)},addMoreOpenAnswer(t){this.answers[t].push(null)},checkAnswer(t,e){this.loading=!0,this.prepare=!0,this.$store.dispatch("checkQuizQuestionAnswer",{quiz_question_id:t,quiz_id:this.quiz.id,answers:JSON.stringify(this.answers[e])}).then(s=>{this.loading=!1,this.points.push(s)}).catch(()=>{this.loading=!1})},toggleAnswer(t,e){let s=this.answers[t].indexOf(e);s==-1?this.answers[t].push(e):this.answers[t].splice(s,1)},nextQuizQuestion(t){this.loadQuizQuestions(t)},selectQuizQuestion(t){this.$emit("select",t),this.$notify("Вопрос успешно выбран")},removeQuizQuestion(t){this.loading=!0,this.$store.dispatch("removeQuizQuestion",{quizQuestionId:t}).then(e=>{this.loading=!1,this.loadQuizQuestions(0),this.$notify("Вопрос успешно удален")}).catch(()=>{this.loading=!1,this.$notify("Вопрос удаления сервиса")})},loadAndOrder(t){this.order=t,this.direction=this.direction==="desc"?"asc":"desc",this.loadQuizQuestions(0)},loadQuizQuestions(t=0){this.loading=!0,this.$store.dispatch("loadQuizQuestions",{dataObject:{quiz_id:this.quiz.id,search:this.search,order:this.order,direction:this.direction},page:t,size:-1}).then(e=>{this.loading=!1,this.questions=this.getQuizQuestions,this.answers=[],this.questions.forEach(s=>{let l=null;s.is_multiply?(l=[],s.answers.forEach(a=>{l.push(null)})):l=null,s.is_open&&(l=[null]),this.answers.push(l)}),this.paginate_object=this.getQuizQuestionsPaginateObject}).catch(()=>{this.loading=!1})}}},Vt=Object.assign(Lt,{__name:"QuizRoundQuestionList",setup(t){return(e,s)=>(i(),n(f,null,[e.questions.length===0?(i(),n("div",Ve,Ie)):d("",!0),e.questions.length>0&&e.step<e.questions.length?(i(),n("div",Ue,[o("div",Ge,[(i(!0),n(f,null,g(e.questions,(l,a)=>(i(),n("div",null,[!e.prepare&&e.step==a?(i(),n("div",Je,[o("a",Ke,[We,o("strong",xe,"Раунд "+u(l.round||1),1)]),o("p",Xe,u(l.text||"не указан"),1),l.media_content?(i(),z(M,{key:0,class:"mb-2",type:l.content_type,content:l.media_content},null,8,["type","content"])):d("",!0),l.answers?(i(),n("div",Ye,[l.is_multiply?(i(),n("p",Ze,"Вы можете выбрать несколько ответов")):d("",!0),l.is_open?(i(),n("div",nt,[ot,(i(!0),n(f,null,g(e.answers[a],(r,c)=>(i(),n("div",at,[o("label",lt,[m(" Ответ #"+u(c+1)+" ",1),e.answers[a].length>1?(i(),n("a",{key:0,href:"javascript:void(0)",onClick:h=>e.removeOpenAnswer(a,c)},"удалить",8,rt)):d("",!0)]),Q(o("input",{type:"text",name:"contactNameField",maxlength:"255","onUpdate:modelValue":h=>e.answers[a][c]=h,placeholder:"Например 'Новые люди'",class:"contactField round-small requiredField",id:"command-title",required:""},null,8,dt),[[D,e.answers[a][c]]])]))),256)),o("a",{href:"javascript:void(0)",class:"text-center w-100 d-block",onClick:r=>e.addMoreOpenAnswer(a)},"Добавить еще ответ",8,ut)])):(i(),n("div",et,[l.is_multiply?d("",!0):(i(!0),n(f,{key:0},g(l.answers,(r,c)=>(i(),n("label",{class:q([{"bg-green2-dark border-green2-dark color-white":e.answers.indexOf(r.id)!=-1},"btn btn-border btn-m btn-full rounded-l mb-1 text-uppercase font-900 border-green2-dark d-flex justify-content-center align-items-center"]),for:"question-"+a+"-answer-"+c},[m(u(r.text)+" ",1),Q(o("input",{type:"radio",name:"quiz",class:"d-none","onUpdate:modelValue":h=>e.answers[a]=h,id:"question-"+a+"-answer-"+c,value:r.id},null,8,st),[[V,e.answers[a]]])],10,tt))),256)),l.is_multiply?(i(!0),n(f,{key:1},g(l.answers,(r,c)=>(i(),n("button",{class:q([{"bg-red1-dark color-white":e.answers[a].indexOf(r.id)!=-1},"btn btn-border btn-m btn-full mb-1 rounded-l text-uppercase font-900 border-red2-dark w-100 d-flex justify-content-center align-items-center"]),onClick:h=>e.toggleAnswer(a,r.id),type:"button"},u(r.text),11,it))),256)):d("",!0)]))])):d("",!0),ct,t.quiz.polling_mode?d("",!0):(i(),n("div",ht,[o("div",mt,[I(G(T),{time:(t.quiz.time_limit||30)*1e3,onFinish:e.finish,format:"mm:ss"},{default:U(({resolved:r})=>[o("span",_t,u(r.mm),1),m(" : "),o("span",ft,u(r.ss),1)]),_:1},8,["time","onFinish"])]),gt])),pt,e.isQuestionComplete(a)?(i(),n("a",{key:3,href:"javascript:void(0)",onClick:r=>e.checkAnswer(l.id,a),class:"btn btn-m btn-full mb-2 rounded-m text-uppercase font-900 shadow-s bg-blue2-dark"}," Проверить ",8,zt)):d("",!0)])):d("",!0),e.prepare&&e.step==a?(i(),n("div",bt,[yt,e.points[a]?(i(),n("div",vt,[e.points[a].question.content?(i(),z(M,{key:0,class:"mb-2",type:e.points[a].question.type,content:e.points[a].question.content},null,8,["type","content"])):d("",!0)])):d("",!0),(e.points[a]||{}).question?(i(),n("p",kt,[o("strong",{innerHTML:e.points[a].question.message||"Отлично! Идем дальше"},null,8,wt)])):d("",!0),e.step<e.questions.length-1?(i(),n("a",{key:2,href:"javascript:void(0)",onClick:s[0]||(s[0]=(...r)=>e.next&&e.next(...r)),class:"btn btn-m btn-full mb-2 rounded-m text-uppercase font-900 shadow-s bg-green2-dark"}," Следующий вопрос ")):(i(),n("a",{key:3,href:"javascript:void(0)",onClick:s[1]||(s[1]=(...r)=>e.finish&&e.finish(...r)),class:"btn btn-m btn-full mb-2 rounded-m text-uppercase font-900 shadow-s bg-green2-dark"}," Перейти к баллам "))])):d("",!0)]))),256))])])):d("",!0),e.is_finish?(i(),n("div",qt,[o("div",Qt,[$t,e.points.length>0?(i(),n("ol",Ct,[(i(!0),n(f,null,g(e.points,(l,a)=>(i(),n("li",jt,[o("div",Ot,[o("div",At,u(l.question.text||"Текст не указан"),1),m(" "+u(l.question.message||"-"),1)]),o("span",{class:q(["badge rounded-pill text-white p-2",{"bg-success":l.is_right,"bg-danger":!l.is_right}])},u(l.points||0)+" баллов",3)]))),256))])):d("",!0),o("h6",Mt,"Вы набрали "+u(e.summaryPoints)+" баллов",1),e.successPercentCount>=t.quiz.success_percent?(i(),n("p",{key:1,innerHTML:t.quiz.success_message},null,8,St)):(i(),n("p",{key:2,innerHTML:t.quiz.failure_message},null,8,Ht)),o("a",{href:"javascript:void(0)",onClick:s[2]||(s[2]=(...l)=>e.completeAndExit&&e.completeAndExit(...l)),class:"btn btn-m btn-full mt-3 rounded-s text-uppercase font-900 shadow-s bg-red1-light w-100"},"Завершить и выйти")])])):d("",!0)],64))}});({...$(["getQuizCommands","getQuizCommandsPaginateObject"])});export{T as C,Rt as Q,Nt as _,Vt as a};
