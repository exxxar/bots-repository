import{j as b,O as g,o,k as d,n as i,N as m,p as r,L as c,q as C,F as p,M as a,a0 as l,a3 as P,Y as k}from"./index.es-c4852431.js";const v={key:0,class:"card border-0 mb-3"},_={class:"card-body p-0"},w={class:"d-flex mb-2"},$={style:{"object-fit":"cover",height:"100%"},class:"rounded-2",width:"110"},T={class:"w-100 px-2 d-flex flex-column justify-content-between"},A={class:"pb-0 mb-0 fw-bold",style:{"font-size":"14px"}},j={class:"py-2 mb-0 d-flex justify-content-between",style:{"font-size":"12px"}},z={key:0},I={class:"text-decoration-line-through"},R={class:"text-danger fw-bold"},M={key:1},N={class:"text-decoration-line-through"},V={class:"text-danger fw-bold"},B={key:2},E={key:3},S={class:"d-flex w-100"},D=["disabled"],L=i("sup",{class:"font-10 opacity-50"},".00",-1),O={key:1,class:"btn-group w-100"},F=["disabled"],Q={key:0},U=["disabled"],q={class:"form-check form-switch mb-2"},G=["id"],Y=["for"],H={key:0,class:"form-floating"},J=i("label",{for:"floatingInput"},"Комментарий",-1),K={key:1,class:"p-2 alert alert-warning mt-2 mb-0"},W=i("p",{class:"mb-0 fw-bold"},"Особенности доставки данного товара",-1),X={key:0,class:"d-flex justify-content-between mb-3"},Z={key:1,class:"mb-0"},x={props:["item","comment","config"],data(){return{form:{id:null,comment:null,need_comment:!1},sending:!1,is_online:!0}},computed:{...b(["inCart"]),canProductAction(){return this.is_online&&!this.sending},checkInCart(){return this.inCart(this.item.id)},currentPrice(){var e,t;return(e=this.config)!=null&&e.discount_price?((t=this.config)==null?void 0:t.discount_price)||0:this.item.current_price||0},oldPrice(){return this.item.old_price/100}},mounted(){window.addEventListener("online",()=>{this.is_online=!0}),window.addEventListener("offline",()=>{this.is_online=!1}),this.comment&&(console.log("COMMENT",this.comment,this.form.need_comment),this.form.need_comment=!0,this.form.comment=this.comment)},methods:{addToCart(){this.$cart.add(this.item)},addCommentToProduct(){this.sending=!0,this.form.id=this.item.id,this.$store.dispatch("addCommentToProduct",this.form).then(()=>{this.sending=!1,this.$notify({title:"Товар",text:"Комментарий к товару успешно добавлен",type:"success"}),this.comment&&(this.form.need_comment=!0,this.form.comment=this.comment)}).catch(()=>{this.sending=!1,this.$notify({title:"Товар",text:"Ошибка добавления комментария к товару!",type:"error"})})},incProductCart(){this.sending=!0,(this.checkInCart===0?this.$store.dispatch("addProductToCart",this.item):this.$store.dispatch("incQuantity",this.item.id)).then(()=>{this.sending=!1,this.$notify({title:"Добавление товара",text:"Товар успешно добавлен",type:"success"})}).catch(()=>{this.sending=!1,this.$notify({title:"Добавление товара",text:"Ошибка добавления товара!",type:"error"})})},decProductCart(){this.sending=!0,(this.checkInCart<=1?this.$store.dispatch("removeProduct",this.item.id):this.$store.dispatch("decQuantity",this.item.id)).then(()=>{this.sending=!1,this.$notify({title:"Удаление товара",text:"Товар успешно удален",type:"success"})}).catch(()=>{this.sending=!1,this.$notify({title:"Удаление товара",text:"Ошибка удаления товара!",type:"error"})})}}},et=Object.assign(x,{__name:"ProductCardSimple",setup(e){return(t,s)=>{var u,h,f;const y=g("lazy");return e.item?(o(),d("div",v,[i("div",_,[i("div",w,[i("div",{class:"mr-auto",onClick:s[0]||(s[0]=(...n)=>t.addToCart&&t.addToCart(...n)),style:{"max-height":"100px"}},[m(i("img",$,null,512),[[y,e.item.images[0]]])]),i("div",T,[i("h6",A,[r(c(e.item.title||"не указано")+" ",1),C(t.$slots,"partner")]),i("h6",j,[e.config.discount_price?(o(),d("span",M,[r(c(e.config.discount_price)+"₽ ",1),i("span",N,c(e.item.current_price||0)+"₽",1),r(" ("),i("span",V,"-"+c(e.config.discount_amount||0)+"₽",1),r(") ")])):(o(),d("span",z,[r(c(t.currentPrice)+"₽ ",1),e.item.old_price>0?(o(),d(p,{key:0},[i("span",I,c(e.item.old_price||0)+"₽",1),i("span",R," -"+c((e.item.old_price||0)-(e.item.current_price||0))+"₽",1)],64)):a("",!0)])),(u=e.item)!=null&&u.is_weight_product?(o(),d("span",E,c(t.currentPrice*t.inCart(e.item.id)/(((h=e.item.weight_config)==null?void 0:h.step)||100))+"₽",1)):(o(),d("span",B,"="+c(t.currentPrice*t.inCart(e.item.id))+"₽",1))]),i("div",S,[t.inCart(e.item.id)===0?(o(),d("button",{key:0,type:"button",class:l([{"btn-secondary":!t.canProductAction},"btn btn-sm btn-primary w-100 rounded-3"]),disabled:e.item.in_stop_list_at!=null||!t.canProductAction,onClick:s[1]||(s[1]=(...n)=>t.incProductCart&&t.incProductCart(...n))},[r(c(t.currentPrice),1),L,r("₽ ")],10,D)):a("",!0),t.inCart(e.item.id)>0?(o(),d("div",O,[i("button",{type:"button",class:l([{"btn-secondary":!t.canProductAction},"btn btn-sm btn-primary"]),disabled:e.item.in_stop_list_at!=null||!t.canProductAction,onClick:s[2]||(s[2]=(...n)=>t.decProductCart&&t.decProductCart(...n))},"- ",10,F),i("button",{type:"button",class:l([{"btn-secondary":!t.canProductAction},"btn btn-sm"])},[r(c(t.checkInCart)+" ",1),(f=e.item)!=null&&f.is_weight_product?(o(),d("span",Q,"г.")):a("",!0)],2),i("button",{type:"button",class:l([{"btn-secondary":!t.canProductAction},"btn btn-sm btn-primary"]),disabled:e.item.in_stop_list_at!=null||!t.canProductAction,onClick:s[3]||(s[3]=(...n)=>t.incProductCart&&t.incProductCart(...n))},"+ ",10,U)])):a("",!0)])])]),i("div",q,[m(i("input",{"onUpdate:modelValue":s[4]||(s[4]=n=>t.form.need_comment=n),class:"form-check-input",type:"checkbox",value:"",id:"item-comment-"+e.item.id,switch:""},null,8,G),[[P,t.form.need_comment]]),i("label",{class:"form-check-label",style:{"font-size":"12px"},for:"item-comment-"+e.item.id}," Добавить комментарий к товару ",8,Y)]),t.form.need_comment?(o(),d("div",H,[m(i("input",{type:"text",onBlur:s[5]||(s[5]=(...n)=>t.addCommentToProduct&&t.addCommentToProduct(...n)),"onUpdate:modelValue":s[6]||(s[6]=n=>t.form.comment=n),class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,544),[[k,t.form.comment]]),J])):a("",!0),e.item.delivery_terms?(o(),d("div",K,[W,e.item.delivery_terms?(o(),d("h6",X,c(e.item.delivery_terms),1)):(o(),d("p",Z,"Дополнительных условий доставки нет"))])):a("",!0)])])):a("",!0)}}});export{et as _};
