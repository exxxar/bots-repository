import{t as j,O as U,o as n,k as a,n as t,N as r,L as p,p as m,a3 as k,M as u,l as c,w as i,Y as b,F as v,K as x,a1 as V,j as C,a0 as B,H as F}from"./index.es-c4852431.js";import{P as I}from"./Pagination-b758f7ed.js";import{_ as q}from"./_plugin-vue_export-helper-c27b6911.js";import{_ as P}from"./CompanyList-ca6d009e.js";const S={props:["botId"],data(){return{bot:null,load:!1,need_payments:!1,need_shop:!1,need_demo:!1,botForm:{id:null,is_template:!1,auto_cashback_on_payments:!1,template_description:null,bot_domain:null,bot_token:null,bot_token_dev:null,order_channel:null,main_channel:null,vk_shop_link:null,balance:null,tax_per_day:null,welcome_message:null,image:null,description:null,info_link:null,social_links:[],maintenance_message:null,payment_provider_token:null,level_1:10,level_2:0,level_3:0,photos:[],selected_bot_template_id:null,pages:[],amo:null,is_active:!1}}},watch:{need_payments:function(l,e){this.need_payments||(this.botForm.auto_cashback_on_payments=!1)}},mounted(){this.loadBotAdminConfig(),window.addEventListener("select-telegram-channel-id",l=>{this.botForm[l.detail.param]=l.detail.channel})},methods:{loadBotAdminConfig(){this.$store.dispatch("loadBotManagerConfig",{botId:this.botId}).then(l=>{this.bot=l.data,this.botForm={id:this.bot.id||null,is_template:this.bot.is_template||!1,auto_cashback_on_payments:this.bot.auto_cashback_on_payments||!1,template_description:this.bot.template_description||null,bot_domain:this.bot.bot_domain||null,bot_token:this.bot.bot_token||null,bot_token_dev:this.bot.bot_token_dev||null,order_channel:this.bot.order_channel||null,main_channel:this.bot.main_channel||null,balance:this.bot.balance||null,tax_per_day:this.bot.tax_per_day||null,vk_shop_link:this.bot.vk_shop_link||null,image:this.bot.image||null,description:this.bot.description||null,info_link:this.bot.info_link||null,social_links:this.bot.social_links||[],maintenance_message:this.bot.maintenance_message||null,welcome_message:this.bot.welcome_message||null,payment_provider_token:this.bot.payment_provider_token||null,level_1:this.bot.level_1||10,level_2:this.bot.level_2||0,level_3:this.bot.level_3||0,photos:this.bot.photos||[],amo:this.bot.amo||null,is_active:this.bot.is_active||!1},this.botForm.payment_provider_token&&(this.need_payments=!0),this.botForm.vk_shop_link&&(this.need_shop=!0)})},getPhoto(l){return{imageUrl:URL.createObjectURL(l)}},onChangePhotos(l){const e=l.target.files;this.botForm.image=null;for(let h=0;h<e.length;h++)this.botForm.photos.push(e[h])},addItem(l){this.botForm[l].push("")},addSocialLinks(){this.botForm.social_links.push({title:null,url:null})},removeItem(l,e){this.botForm[l].splice(e,1)},removePhoto(l){l?this.botForm.photos.splice(l,1):this.botForm.image=null},switchStatus(){this.$store.dispatch("switchBotStatusManager",{botId:this.bot.id}).then(()=>{this.$botNotification.success("Конструктор ботов","Статус бота успешно изменен!")})},removeBot(){this.$store.dispatch("removeBotByManager",{botId:this.bot.id}).then(l=>{this.$emit("remove"),this.$botNotification.success("Конструктор ботов","Бот успешно удален!")}).catch(l=>{this.$botNotification.warning("Конструктор ботов","Ошибка удаления бота!")})},addBot(){let l=new FormData;Object.keys(this.botForm).forEach(e=>{const h=this.botForm[e]||"";typeof h=="object"?l.append(e,JSON.stringify(h)):l.append(e,h)}),this.company&&l.append("company_id",this.company.id);for(let e=0;e<this.botForm.photos.length;e++)l.append("images[]",this.botForm.photos[e]);l.delete("photos"),this.$store.dispatch("updateBotByManager",{botForm:l}).then(e=>{this.$emit("callback",e.data),this.$botNotification.success("Конструктор ботов","Бот успешно обновлен!")}).catch(e=>{this.$botNotification.warning("Конструктор ботов","Ошибка обновления бота!")})},requestChannelId(l){this.$botPages.telegramChannelHelper(l)},openUrl(l){this.tg.openLink(l)}}},N={class:"card card-style bg-1",style:{height:"390px"}},O={key:0,class:"card-center"},L={class:"w-100 d-flex justify-content-center p-3"},M={class:"object-cover",style:{width:"100px","border-radius":"50%"},alt:""},z={class:"color-white font-700 text-center mb-2"},E={key:0},D={key:1},R={class:"color-white text-center opacity-60 mt-n1 my-1"},T={href:"#",class:"color-white"},A=t("i",{class:"fa-solid fa-sack-dollar"},null,-1),H={class:"color-white text-center opacity-60 mt-n1 my-1"},G=t("i",{class:"fa-solid fa-hand-holding-dollar"},null,-1),J={class:"color-white text-center opacity-60 mt-n1 my-1"},K=t("i",{class:"fa-regular fa-calendar-days"},null,-1),Y={class:"w-100 d-flex justify-content-center py-4"},Q={class:"custom-control ios-switch"},W=t("label",{class:"custom-control-label",for:"toggle-id-1"},null,-1),X={key:0,class:"ml-5 text-white"},Z={key:1,class:"ml-5 text-white"},$={key:1,class:"card-center"},tt=t("p",null,"Загружаем данные бота",-1),et=t("div",{class:"d-flex justify-content-center w-100"},[t("div",{class:"spinner-border color-orange-dark",role:"status"},[t("span",{class:"sr-only"},"Загрузка...")])],-1),ot=[tt,et],st=t("div",{class:"card-overlay bg-black opacity-70"},null,-1),lt={key:0,class:"w-100 d-flex justify-content-center align-items-center flex-column"},nt=t("h2",null,"Демонстрация работы бота",-1),it={href:"#"},at={class:"mb-0"},rt={class:"mobile mb-2 p-0"},dt=["src"],ct={key:0,class:"alert alert-small rounded-s shadow-xl bg-red2-dark w-100",role:"alert"},_t=t("span",null,[t("i",{class:"fa-solid fa-triangle-exclamation"})],-1),mt=t("strong",null,"Тоукен не указан!",-1),bt=t("button",{type:"button",class:"close color-white opacity-60 font-16","data-dismiss":"alert","aria-label":"Close"},"× ",-1),ht=[_t,mt,bt],ut={key:0},pt={key:0,class:"d-flex w-100"},ft={class:"pt-1"},gt={"data-activate":"toggle-id-2",class:"font-500 font-13"},vt={key:0},yt={key:1},kt={class:"ml-auto mr-4 pr-2"},wt={class:"custom-control ios-switch ios-switch-icon"},xt=t("label",{class:"custom-control-label",for:"toggle-demo-bot"},null,-1),Ft=t("i",{class:"fa fa-check font-11 color-white"},null,-1),Bt=t("i",{class:"fa fa-times font-11 color-white"},null,-1),Ct={class:"mb-2"},jt={class:"form-label d-flex justify-content-between align-items-center mt-2",id:"bot-domain"},Ut=t("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Vt=t("div",null,'Строго взять из BotFather! ТО что при создании с окончанием на "bot"',-1),It=t("i",{class:"fa-solid font-10 fa-star color-red2-dark"},null,-1),qt=t("div",null,"Нужно ",-1),Pt={key:0},St={class:"mb-2"},Nt={class:"form-label d-flex justify-content-between mt-2 d-flex align-items-center flex-wrap",id:"bot-token"},Ot=t("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Lt=t("div",null,"Взять из BotFater при создании бота! Длинная нечитаемая подсвеченная строка! ",-1),Mt=t("i",{class:"fa-solid font-10 fa-star color-red2-dark"},null,-1),zt=t("div",null,"Нужно ",-1),Et={class:"mb-2"},Dt=t("label",{class:"form-label d-flex justify-content-between mt-2",id:"bot-token-dev"},"Токен бота (для тестирования)",-1),Rt={class:"mb-2"},Tt={class:"d-flex justify-content-between align-items-center flex-wrap"},At={class:"form-label d-flex justify-content-between mt-2 d-flex align-items-center w-100",id:"bot-order-channel"},Ht=t("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Gt=t("div",null,"Ввести адрес ссылки на канал в форму после добавления тоукена ",-1),Jt=t("i",{class:"fa-brands fa-telegram ml-2 color-blue2-dark"},null,-1),Kt=[Jt],Yt=t("i",{class:"fa-solid font-10 fa-star color-red2-dark"},null,-1),Qt=t("div",null,"Нужно ",-1),Wt={class:"mb-2"},Xt={class:"d-flex justify-content-between"},Zt={class:"form-label d-flex justify-content-between mt-2",id:"bot-main-channel"},$t=t("i",{class:"fa-brands fa-telegram ml-2 color-blue2-dark"},null,-1),te=[$t],ee={key:1,class:"mb-0"},oe={class:"mb-2"},se={class:"d-flex justify-content-between flex-wrap"},le={class:"form-label d-flex justify-content-between align-items-center mb-0 flex-wrap w-100",id:"bot-description"},ne=t("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),ie=t("div",null,"Отобразится пользователю при первом запуске",-1),ae=t("i",{class:"fa-solid font-10 fa-star color-red2-dark"},null,-1),re=t("div",null,"Нужно ",-1),de={key:0,class:"text-gray-400 w-100",style:{"font-size":"10px"}},ce={class:"mb-2"},_e={class:"d-flex justify-content-between flex-wrap"},me={class:"form-label d-flex justify-content-between align-items-center w-100 mb-0",id:"bot-description"},be=t("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),he=t("div",null,'Для меню "О Боте"',-1),ue=t("i",{class:"fa-solid font-10 fa-star color-red2-dark"},null,-1),pe=t("div",null,"Нужно ",-1),fe={key:0,class:"text-gray-400 w-100",style:{"font-size":"10px"}},ge={class:"mb-2"},ve={class:"d-flex justify-content-between flex-wrap"},ye={class:"form-label d-flex justify-content-between align-items-center w-100 mb-0",id:"bot-maintenance-message"},ke=t("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),we=t("div",null,'Для меню "О Боте"',-1),xe=t("i",{class:"fa-solid font-10 fa-star color-red2-dark"},null,-1),Fe=t("div",null,"Нужно ",-1),Be={key:0,class:"text-gray-400 w-100",style:{"font-size":"10px"}},Ce={class:"mb-2"},je={class:"form-label d-flex justify-content-between align-items-center mt-2",id:"bot-level-1"},Ue=t("i",{class:"fa-solid font-10 fa-star color-red2-dark"},null,-1),Ve=t("div",null,"Нужно ",-1),Ie={class:"mb-2"},qe=t("label",{class:"form-label d-flex justify-content-between mt-2",id:"bot-level-2"},"Уровень 2 CashBack, %",-1),Pe={class:"mb-2"},Se=t("label",{class:"form-label d-flex justify-content-between mt-2",id:"bot-level-3"},"Уровень 3 CashBack, %",-1),Ne={class:"mb-2"},Oe={class:"form-check"},Le=t("label",{class:"form-check-label",for:"need-payments"}," Необходимо подключить платежную систему ",-1),Me={key:0,class:"mb-2"},ze={class:"form-check"},Ee=["value"],De=t("label",{class:"form-check-label",for:"bot-auto-cashback-on-payments"}," Начислять CashBack автоматически после успешной оплаты ",-1),Re={class:"mb-2"},Te={class:"form-label d-flex justify-content-between mt-2",id:"bot-level-3"},Ae=t("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),He=t("div",null,"Если в боте планируется оплата, то необходимо через BotFather привязать нужную платежную систему и указать в данном поле полученный токен ",-1),Ge=t("a",{href:"https://t.me/botfather",target:"_blank"},"Подключить",-1),Je={class:"mb-2"},Ke={class:"form-check"},Ye=t("label",{class:"form-check-label",for:"need-shop"}," Необходимо интегрировать магазин в бота ",-1),Qe={key:1,class:"mb-2"},We={class:"form-label d-flex justify-content-between mt-2",id:"bot-level-3"},Xe=t("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Ze=t("div",null,"Ссылка на страницу ВК с товарами для вашего магазина в боте ",-1),$e=t("a",{href:"https://vk.com/groups?w=groups_create",target:"_blank"},"Создать",-1),to=t("div",{class:"divider divider-small my-3 bg-highlight"},null,-1),eo={class:"mb-2"},oo={class:"form-label d-flex justify-content-between mt-2",id:"bot-level-3"},so=t("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),lo=t("div",null,"Ссылка на страницу ВК с товарами для вашего магазина в боте ",-1),no=t("a",{target:"_blank",href:"https://telegra.ph"},"Создать",-1),io=t("div",{class:"divider divider-small my-3 bg-highlight"},null,-1),ao=t("h6",null,"Ссылки на соц. сети",-1),ro={class:"d-flex justify-content-between align-items-center w-100"},co=t("small",null,"Ссылка",-1),_o=["onClick"],mo=t("i",{class:"fa-regular fa-trash-can"},null,-1),bo=[mo],ho=["onUpdate:modelValue","aria-describedby"],uo=["onUpdate:modelValue"],po=t("div",{class:"divider divider-small my-3 bg-highlight"},null,-1),fo={class:"d-flex justify-content-between align-items-center"},go=t("i",{class:"fa-solid font-10 fa-star color-red2-dark"},null,-1),vo=t("div",null,"Нужно ",-1),yo={class:"photo-preview d-flex justify-content-center flex-wrap w-100"},ko={for:"bot-photos",style:{"margin-right":"10px"},class:"photo-loader ml-2"},wo=t("span",null,"+",-1),xo={class:"mb-2 img-preview",style:{"margin-right":"10px"}},Fo={class:"remove"},Bo=["onClick"],Co=t("i",{class:"fa-regular fa-trash-can"},null,-1),jo=[Co],Uo={key:1,class:"mb-2 img-preview",style:{"margin-right":"10px"}},Vo={class:"remove"},Io=t("i",{class:"fa-regular fa-trash-can"},null,-1),qo=[Io],Po=["disabled"],So={key:1,class:"content"},No=t("p",null,"Загружаем данные бота",-1),Oo=t("div",{class:"d-flex justify-content-center w-100"},[t("div",{class:"spinner-border color-orange-dark",role:"status"},[t("span",{class:"sr-only"},"Загрузка...")])],-1),Lo=[No,Oo];function Mo(l,e,h,f,o,d){const _=j("Popper"),w=U("lazy");return n(),a(v,null,[t("div",N,[o.bot?(n(),a("div",O,[t("div",L,[r(t("img",M,null,512),[[w,"/images-by-company-id/"+o.bot.company_id+"/"+o.bot.image]])]),t("h2",z,[o.bot.bot_domain?(n(),a("span",E,p(o.bot.bot_domain.length>20?o.bot.bot_domain.substring(0,20)+"...":o.bot.bot_domain),1)):(n(),a("span",D,"Нет домена"))]),t("p",R,[t("a",T,[A,m(" Баланс "+p(o.bot.balance||"0")+" ₽",1)])]),t("p",H,[G,m(" Тариф "+p(o.bot.tax_per_day||"0")+" ₽/день ",1)]),t("p",J,[K,m(" Дней "+p(Math.round(o.bot.balance/o.bot.tax_per_day))+" осталось ",1)]),t("div",Y,[t("div",Q,[r(t("input",{type:"checkbox",onChange:e[0]||(e[0]=(...s)=>d.switchStatus&&d.switchStatus(...s)),"onUpdate:modelValue":e[1]||(e[1]=s=>o.botForm.is_active=s),class:"ios-input",id:"toggle-id-1"},null,544),[[k,o.botForm.is_active]]),W]),o.botForm.is_active?(n(),a("span",X,"Вкл")):(n(),a("span",Z,"Выкл"))]),t("a",{href:"javascript:void(0)",onClick:e[2]||(e[2]=(...s)=>d.removeBot&&d.removeBot(...s)),class:"btn btn-m btn-full mb-3 rounded-xl text-uppercase font-900 shadow-s color-red2-light"},"Удалить бота")])):(n(),a("div",$,ot)),st]),o.need_demo?(n(),a("div",lt,[nt,t("h6",null,[t("a",it,p(o.botForm.bot_domain),1)]),t("p",at,[t("small",null,p(o.botForm.name||"Не указано имя"),1)]),t("div",rt,[t("iframe",{style:{border:"none"},src:"/web/"+o.botForm.bot_domain},null,8,dt)]),o.botForm.token?u("",!0):(n(),a("div",ct,ht))])):u("",!0),t("form",{onSubmit:e[28]||(e[28]=V((...s)=>d.addBot&&d.addBot(...s),["prevent"]))},[o.bot?(n(),a("div",ut,[o.botForm.bot_domain?(n(),a("div",pt,[t("div",ft,[t("h5",gt,[o.need_demo?(n(),a("strong",vt,"Отобразить демо бота")):u("",!0),o.need_demo?u("",!0):(n(),a("strong",yt,"Не отображать демо бота"))])]),t("div",kt,[t("div",wt,[r(t("input",{type:"checkbox","onUpdate:modelValue":e[3]||(e[3]=s=>o.need_demo=s),class:"ios-input",id:"toggle-demo-bot"},null,512),[[k,o.need_demo]]),xt,Ft,Bt])])])):u("",!0),t("div",Ct,[t("label",jt,[t("div",null,[c(_,null,{content:i(()=>[Vt]),default:i(()=>[Ut]),_:1}),m(" Доменное имя бота из BotFather ")]),c(_,null,{content:i(()=>[qt]),default:i(()=>[It]),_:1})]),r(t("input",{type:"text",class:"form-control",placeholder:"Имя бота","aria-label":"Имя бота","onUpdate:modelValue":e[4]||(e[4]=s=>o.botForm.bot_domain=s),maxlength:"255","aria-describedby":"bot-domain",required:""},null,512),[[b,o.botForm.bot_domain]]),o.botForm.bot_domain?(n(),a("p",Pt,[m("Проверить работу бота "),t("a",{href:"javascript:void(0)",onClick:e[5]||(e[5]=s=>d.openUrl("https://t.me/"+o.botForm.bot_domain))},"@"+p(o.botForm.bot_domain),1)])):u("",!0)]),t("div",St,[t("label",Nt,[t("div",null,[c(_,null,{content:i(()=>[Lt]),default:i(()=>[Ot]),_:1}),m(" Токен бота ")]),c(_,null,{content:i(()=>[zt]),default:i(()=>[Mt]),_:1}),t("a",{href:"javascript:void(0)",onClick:e[6]||(e[6]=s=>d.openUrl("https://t.me/botfather")),class:"w-100",target:"_blank"},"Создать нового бота в ТГ")]),r(t("input",{type:"text",class:"form-control",placeholder:"Токен","aria-label":"Токен","onUpdate:modelValue":e[7]||(e[7]=s=>o.botForm.bot_token=s),maxlength:"255","aria-describedby":"bot-token",required:""},null,512),[[b,o.botForm.bot_token]])]),t("div",Et,[Dt,r(t("input",{type:"text",class:"form-control",placeholder:"Токен","aria-label":"Токен","onUpdate:modelValue":e[8]||(e[8]=s=>o.botForm.bot_token_dev=s),maxlength:"255","aria-describedby":"bot-token-dev"},null,512),[[b,o.botForm.bot_token_dev]])]),t("div",Rt,[t("div",Tt,[t("label",At,[t("div",null,[c(_,null,{content:i(()=>[Gt]),default:i(()=>[Ht]),_:1}),m(" Канал для заказов (id) "),t("span",{onClick:e[9]||(e[9]=s=>d.requestChannelId("order_channel"))},Kt)]),c(_,null,{content:i(()=>[Qt]),default:i(()=>[Yt]),_:1})])]),r(t("input",{type:"text",class:"form-control",placeholder:"id канала","aria-label":"id канала","onUpdate:modelValue":e[10]||(e[10]=s=>o.botForm.order_channel=s),maxlength:"255","aria-describedby":"bot-order-channel"},null,512),[[b,o.botForm.order_channel]])]),t("div",Wt,[t("div",Xt,[t("label",Zt,[m("Канал для постов (id,рекламный) "),t("span",{onClick:e[11]||(e[11]=s=>d.requestChannelId("main_channel"))},te)])]),r(t("input",{type:"text",class:"form-control",placeholder:"id канала","aria-label":"id канала","onUpdate:modelValue":e[12]||(e[12]=s=>o.botForm.main_channel=s),maxlength:"255","aria-describedby":"bot-main-channel"},null,512),[[b,o.botForm.main_channel]])]),o.botForm.bot_token?(n(),a("div",ee,[t("div",oe,[t("div",se,[t("label",le,[t("div",null,[c(_,null,{content:i(()=>[ie]),default:i(()=>[ne]),_:1}),m(" Приветственное сообщение ")]),c(_,null,{content:i(()=>[re]),default:i(()=>[ae]),_:1})]),o.botForm.welcome_message?(n(),a("small",de," Длина текста "+p(o.botForm.welcome_message.length),1)):u("",!0)]),r(t("textarea",{class:"form-control font-12",placeholder:"Текстовое приветствие при запуске бота","aria-label":"Текстовое приветствие при запуске бота","onUpdate:modelValue":e[13]||(e[13]=s=>o.botForm.welcome_message=s),style:{"min-height":"200px"},"aria-describedby":"bot-description",required:""},`
                    `,512),[[b,o.botForm.welcome_message]])]),t("div",ce,[t("div",_e,[t("label",me,[t("div",null,[c(_,null,{content:i(()=>[he]),default:i(()=>[be]),_:1}),m(" Описание бота ")]),c(_,null,{content:i(()=>[pe]),default:i(()=>[ue]),_:1})]),o.botForm.description?(n(),a("small",fe," Длина текста "+p(o.botForm.description.length)+" / 255",1)):u("",!0)]),r(t("textarea",{class:"form-control font-12",placeholder:"Текстовое описание бота","aria-label":"Текстовое описание бота","onUpdate:modelValue":e[14]||(e[14]=s=>o.botForm.description=s),style:{"min-height":"200px"},"aria-describedby":"bot-description",required:""},`
                    `,512),[[b,o.botForm.description]])]),t("div",ge,[t("div",ve,[t("label",ye,[t("div",null,[c(_,null,{content:i(()=>[we]),default:i(()=>[ke]),_:1}),m(" Режим тех. работ ")]),c(_,null,{content:i(()=>[Fe]),default:i(()=>[xe]),_:1})]),o.botForm.maintenance_message?(n(),a("small",Be," Длина текста "+p(o.botForm.maintenance_message.length)+" / 255 ",1)):u("",!0)]),r(t("textarea",{class:"form-control font-12",placeholder:"Текстовое сообщение","aria-label":"Текстовое сообщение","onUpdate:modelValue":e[15]||(e[15]=s=>o.botForm.maintenance_message=s),maxlength:"255",style:{"min-height":"200px"},"aria-describedby":"bot-maintenance-message",required:""},`
                    `,512),[[b,o.botForm.maintenance_message]])]),t("div",Ce,[t("label",je,[m(" Уровень 1 CashBack, % "),c(_,null,{content:i(()=>[Ve]),default:i(()=>[Ue]),_:1})]),r(t("input",{type:"number",class:"form-control",placeholder:"%","aria-label":"уровень CashBack","onUpdate:modelValue":e[16]||(e[16]=s=>o.botForm.level_1=s),max:"50",min:"0","aria-describedby":"bot-level-1",required:""},null,512),[[b,o.botForm.level_1]])]),t("div",Ie,[qe,r(t("input",{type:"number",class:"form-control",placeholder:"%","aria-label":"уровень CashBack","onUpdate:modelValue":e[17]||(e[17]=s=>o.botForm.level_2=s),max:"50",min:"0","aria-describedby":"bot-level-2"},null,512),[[b,o.botForm.level_2]])]),t("div",Pe,[Se,r(t("input",{type:"number",class:"form-control",placeholder:"%","aria-label":"уровень CashBack","onUpdate:modelValue":e[18]||(e[18]=s=>o.botForm.level_3=s),max:"50",min:"0","aria-describedby":"bot-level-3"},null,512),[[b,o.botForm.level_3]])]),t("div",Ne,[t("div",Oe,[r(t("input",{class:"form-check-input","onUpdate:modelValue":e[19]||(e[19]=s=>o.need_payments=s),type:"checkbox",id:"need-payments"},null,512),[[k,o.need_payments]]),Le])]),o.need_payments?(n(),a("div",Me,[t("div",ze,[r(t("input",{class:"form-check-input",type:"checkbox",value:o.botForm.auto_cashback_on_payments,"onUpdate:modelValue":e[20]||(e[20]=s=>o.botForm.auto_cashback_on_payments=s),id:"bot-auto-cashback-on-payments"},null,8,Ee),[[k,o.botForm.auto_cashback_on_payments]]),De]),t("div",Re,[t("label",Te,[t("div",null,[c(_,null,{content:i(()=>[He]),default:i(()=>[Ae]),_:1}),m(" Токен платежной системы ")]),Ge]),r(t("input",{type:"text",class:"form-control",placeholder:"Токен","aria-label":"уровень CashBack","onUpdate:modelValue":e[21]||(e[21]=s=>o.botForm.payment_provider_token=s),"aria-describedby":"bot-level-3"},null,512),[[b,o.botForm.payment_provider_token]])])])):u("",!0),t("div",Je,[t("div",Ke,[r(t("input",{class:"form-check-input","onUpdate:modelValue":e[22]||(e[22]=s=>o.need_shop=s),type:"checkbox",id:"need-shop"},null,512),[[k,o.need_shop]]),Ye])]),o.need_shop?(n(),a("div",Qe,[t("label",We,[t("div",null,[c(_,null,{content:i(()=>[Ze]),default:i(()=>[Xe]),_:1}),m(" ВК-группа ")]),$e]),r(t("input",{type:"url",class:"form-control",placeholder:"Ссылка на группу ВК","aria-label":"ссылка на группу ВК","onUpdate:modelValue":e[23]||(e[23]=s=>o.botForm.vk_shop_link=s),"aria-describedby":"vk_shop_link"},null,512),[[b,o.botForm.vk_shop_link]])])):u("",!0),to,t("div",eo,[t("label",oo,[t("div",null,[c(_,null,{content:i(()=>[lo]),default:i(()=>[so]),_:1}),m(" Информационная ссылка ")]),no]),r(t("input",{type:"text",class:"form-control",placeholder:"Ссылка ресурс telegraph","aria-label":"Ссылка ресурс telegraph",maxlength:"255","onUpdate:modelValue":e[24]||(e[24]=s=>o.botForm.info_link=s),"aria-describedby":"bot-info-link"},null,512),[[b,o.botForm.info_link]])]),io,ao,(n(!0),a(v,null,x(o.botForm.social_links,(s,g)=>(n(),a("div",{class:"d-flex justify-content-between mb-2 flex-wrap",key:"social-link"+g},[t("div",ro,[co,t("button",{type:"button",onClick:y=>d.removeItem("social_links",g),class:"btn btn-link text-danger"},bo,8,_o)]),r(t("input",{type:"text",class:"form-control mb-2 w-100",placeholder:"Название ссылки","aria-label":"Название ссылки",maxlength:"255","onUpdate:modelValue":y=>o.botForm.social_links[g].title=y,"aria-describedby":"bot-social-link-"+g,required:""},null,8,ho),[[b,o.botForm.social_links[g].title]]),r(t("input",{type:"text",class:"form-control mb-2",placeholder:"Ссылка на соц.сеть","aria-label":"Ссылка на соц.сеть",maxlength:"255","onUpdate:modelValue":y=>o.botForm.social_links[g].url=y},null,8,uo),[[b,o.botForm.social_links[g].url]])]))),128)),t("button",{type:"button",onClick:e[25]||(e[25]=s=>d.addSocialLinks()),class:"btn btn-border btn-m btn-full mb-2 rounded-sm text-uppercase font-900 border-green1-dark color-green1-dark bg-theme w-100"}," Добавить еще ссылку "),po,t("h6",fo,[m("Аватар для бота "),c(_,null,{content:i(()=>[vo]),default:i(()=>[go]),_:1})]),t("div",yo,[t("label",ko,[wo,t("input",{type:"file",id:"bot-photos",multiple:"",accept:"image/*",onChange:e[26]||(e[26]=(...s)=>d.onChangePhotos&&d.onChangePhotos(...s)),style:{display:"none"}},null,32)]),o.botForm.photos?(n(!0),a(v,{key:0},x(o.botForm.photos,(s,g)=>(n(),a("div",xo,[r(t("img",null,null,512),[[w,d.getPhoto(s).imageUrl]]),t("div",Fo,[t("a",{onClick:y=>d.removePhoto(g)},jo,8,Bo)])]))),256)):(n(),a("div",Uo,[r(t("img",null,null,512),[[w,"/images-by-bot-id/"+o.bot.id+"/"+o.botForm.image]]),t("div",Vo,[t("a",{onClick:e[27]||(e[27]=s=>d.removePhoto())},qo)])]))]),t("button",{disabled:!o.botForm.bot_token,type:"submit",class:"btn btn-m btn-full mb-3 rounded-s text-uppercase font-900 shadow-s bg-red1-light w-100"}," Сохранить настройки ",8,Po)])):u("",!0)])):(n(),a("div",So,Lo))],32)],64)}const zo=q(S,[["render",Mo]]),Eo={key:0},Do={class:"d-flex flex-column mt-2"},Ro={key:0},To=t("div",{class:"divider divider-small my-3 bg-highlight"},null,-1),Ao=["onClick"],Ho=t("a",{href:"#",class:"btn btn-m btn-full rounded-xl text-uppercase font-900 shadow-s bg-red1-light"},[t("i",{class:"fa-solid fa-arrow-right"})],-1),Go={key:1},Jo=t("div",{class:"alert alert-warning mt-2",role:"alert"}," К сожалению мы не нашли нужных ботов... ",-1),Ko=[Jo],Yo={props:{companyId:null,selectedBot:null},data(){return{selectedBotId:null,need_self_bots:!1,filters:[{name:"Активные",icon:"fa-brands fa-telegram",slug:"active"},{name:"Архивные",icon:"fa-solid fa-box-archive",slug:"archive"}],selectedFilters:[],show:!0,loading:!0,bots:[],search:null,bots_paginate_object:null}},watch:{need_self_bots:function(){this.loadBots()}},computed:{...C(["getBots","getBotsPaginateObject","getCurrentCompany"]),filteredBots(){return this.bots?this.bots.filter(l=>l.deleted_at==null):[]}},mounted(){this.loadBots()},methods:{removeBotCallback(){this.loadBots(),this.selectedBotId=null},duplicate(l){if(!this.getCurrentCompany){this.$notify("У Вас не выбран клиент!");return}this.$store.dispatch("duplicateBot",{dataObject:{bot_id:l,company_id:this.getCurrentCompany.id}}).then(e=>{let h=this.bots_paginate_object.meta.current_page||0;this.loadBots(h),this.$notify("Указанный бот успешно продублирован")})},selectBot(l){this.loading=!0,this.selectedBotId=l.id,this.$nextTick(()=>{this.loading=!1}),this.$notify("Вы выбрали бота из списка! Все остальные действия будут производится для этого бота.")},nextBots(l){this.loadBots(l)},loadBots(l=0){this.loading=!0,this.$store.dispatch("loadSimpleBots",{dataObject:{companyId:this.companyId||null,needSelfBots:!0,search:this.search},size:5,page:l}).then(e=>{this.loading=!1,this.bots=this.getBots,this.bots_paginate_object=this.getBotsPaginateObject}).catch(()=>{this.loading=!1})}}},Qo=Object.assign(Yo,{__name:"BotListSelf",setup(l){return(e,h)=>(n(),a(v,null,[e.show?(n(),a("div",Eo,[t("div",Do,[r(t("input",{type:"search",class:"form-control mb-2",placeholder:"Поиск бота","aria-label":"Поиск бота","onUpdate:modelValue":h[0]||(h[0]=f=>e.search=f),"aria-describedby":"button-addon2"},null,512),[[b,e.search]]),t("button",{class:"btn btn-m btn-full mb-0 rounded-xs text-uppercase font-900 shadow-s bg-blue2-dark",onClick:h[1]||(h[1]=f=>e.loadBots(0)),type:"button",id:"button-addon2"},"Найти ")]),e.bots.length>0?(n(),a("div",Ro,[To,(n(!0),a(v,null,x(e.filteredBots,(f,o)=>(n(),a("a",{href:"javascript:void(0)",class:B(["d-flex justify-content-between align-items-center btn btn-border px-2 py-1 btn-full mb-2 rounded-xl text-uppercase font-900 bg-theme",{" border-blue2-dark color-blue2-dark":e.selectedBotId!=f.id," border-green2-dark color-green2-dark":e.selectedBotId===f.id}])},[t("strong",{onClick:d=>e.selectBot(f),class:"font-12 w-100 text-center",style:{"word-wrap":"break-word"}},[t("i",{class:B([{"text-danger":f.deleted_at!=null},"fa-solid fa-robot mr-2"])},null,2),m(p(f.bot_domain||"Не указано"),1)],8,Ao),Ho],2))),256)),e.bots_paginate_object?(n(),F(I,{key:0,onPagination_page:e.nextBots,pagination:e.bots_paginate_object},null,8,["onPagination_page","pagination"])):u("",!0)])):(n(),a("div",Go,Ko))])):u("",!0),e.selectedBotId&&!e.loading?(n(),F(zo,{key:1,onRemove:e.removeBotCallback,"bot-id":e.selectedBotId},null,8,["onRemove","bot-id"])):u("",!0)],64))}}),Wo=t("div",{class:"divider divider-small my-3 bg-highlight"},null,-1),Xo={data(){return{selectedCompanyId:!1,botUser:null,loading:!1}},computed:{...C(["getSelf"]),currentBot(){return window.currentBot}},watch:{getSelf:function(){this.botUser=this.getSelf}},mounted(){this.getSelf&&(this.botUser=this.getSelf)},methods:{selectCompany(l){this.loading=!0,this.selectedCompanyId=l.id,this.$nextTick(()=>{this.loading=!1}),this.$botNotification.notification("Информация","Вы успешно выбрали за основу данного клиента!")},selectBot(l){this.form.selected_bot_id=l.id,this.$botNotification.notification("Информация","Вы успешно выбрали за основу данного бота!")}}},os=Object.assign(Xo,{__name:"Clients",setup(l){return(e,h)=>(n(),a(v,null,[c(P,{"visual-mode":"true",onCallback:e.selectCompany},null,8,["onCallback"]),Wo,e.selectedCompanyId!=null&&!e.loading?(n(),F(Qo,{key:0,"company-id":e.selectedCompanyId},null,8,["company-id"])):u("",!0)],64))}});export{os as _};
