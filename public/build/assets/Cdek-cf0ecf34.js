import{o as l,j as n,l as e,n as h,K as r,a0 as v,M as c,W as f,F as u,J as b,$ as k,L as p,a8 as w,a2 as F,k as _,N as S,G as T}from"./index.es-db843bab.js";import{S as y}from"./SelectOffice-d6883d54.js";import{_ as C}from"./_plugin-vue_export-helper-c27b6911.js";import{P as $}from"./PreloaderV1-97f38083.js";import"./v4-4a60fe23.js";/* empty css                                                    */const I={props:["shopMode"],data(){return{selectedIndex:0,loaded:!0,calcSizeModal:null,formSize:{width:null,height:null,weight:null,length:null,items:[{name:"",ware_key:"",price:0,amount:1,weight:0}]}}},computed:{summaryWeight(){let i=0;return this.formSize.items.forEach(o=>i+=o.weight),i},emptyCalc(){return this.formSize.width==null&&this.formSize.height==null&&this.formSize.length==null&&this.formSize.weight==null}},mounted(){this.calcSizeModal=new bootstrap.Modal(document.getElementById("calc-size-modal"),{})},methods:{selectProduct(i){this.selectedIndex=i,this.loaded=!1,this.$nextTick(()=>{this.loaded=!0})},openCalcSizeModal(){this.calcSizeModal.show()},removeProduct(i){this.formSize.items.splice(i,1),this.selectedIndex=0},addProduct(){this.formSize.items.push({name:"",ware_key:"",price:0,amount:1,weight:0}),this.selectProduct(this.formSize.items.length-1)},submitSizeForm(){this.shopMode&&(this.formSize.weight=this.summaryWeight),this.$emit("callback",this.formSize),this.calcSizeModal.toggle(),this.$nextTick(()=>{this.formSize.weight=null,this.formSize.height=null,this.formSize.width=null,this.formSize.length=null})}}},z={key:0},M=e("i",{class:"fa-solid fa-dolly text-primary"},null,-1),x={key:1},V={class:"modal fade",id:"calc-size-modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},O={class:"modal-dialog modal-fullscreen"},U=e("div",{class:"modal-header"},[e("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"Расчёт размеров"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),D={class:"modal-body"},j=e("div",{class:"divider my-3"},"Габариты",-1),P={class:"form-floating mb-3"},q=e("label",{for:"floatingInput"},"Ширина, см",-1),E={class:"form-floating mb-3"},N=e("label",{for:"floatingInput"},"Высота, см",-1),L={class:"form-floating mb-3"},B=e("label",{for:"floatingInput"},"Длина, см",-1),A={key:0,class:"form-floating mb-3"},J=e("label",{for:"floatingInput"},"Вес, кг",-1),K={key:1,class:"alert alert-light"},R=e("div",{class:"divider my-3"},"Товары в упаковке",-1),W={class:"row row-cols-4 mb-3"},G=["onClick"],H={class:"col mb-2"},Q={class:"form-floating mb-3"},X=e("label",{for:"floatingInput"},"Название",-1),Y={class:"form-floating mb-3"},Z=e("label",{for:"floatingInput"},"Артикул товара",-1),ee={class:"form-floating mb-3"},oe=e("label",{for:"floatingInput"},"Вес, кг",-1),te={class:"form-floating mb-3"},se=e("label",{for:"floatingInput"},"Объявленная стоимость товара, руб",-1),ie={class:"form-floating mb-3"},le=e("label",{for:"floatingInput"},"Кол-во товара, ед.",-1),ne={class:"modal-footer"},ae={type:"submit",class:"btn btn-primary w-100"},re={key:0},de=e("i",{class:"fa-solid fa-dolly"},null,-1),ce={key:1};function me(i,o,s,a,t,m){return l(),n(u,null,[e("button",{type:"button",onClick:o[0]||(o[0]=(...d)=>m.openCalcSizeModal&&m.openCalcSizeModal(...d)),class:"btn btn-light w-100 p-3 my-2"},[m.emptyCalc?(l(),n("span",z,[M,h(" Размер посылки")])):(l(),n("span",x,r(t.formSize.width||0)+"x"+r(t.formSize.height||0)+"x"+r(t.formSize.length||0)+" см, до "+r(t.formSize.weight||0)+"кг ",1))]),e("div",V,[e("div",O,[e("form",{class:"modal-content",onSubmit:o[12]||(o[12]=v((...d)=>m.submitSizeForm&&m.submitSizeForm(...d),["prevent"]))},[U,e("div",D,[j,e("div",P,[c(e("input",{type:"number",min:"0","onUpdate:modelValue":o[1]||(o[1]=d=>t.formSize.width=d),required:"",class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,512),[[f,t.formSize.width]]),q]),e("div",E,[c(e("input",{type:"number",min:"0","onUpdate:modelValue":o[2]||(o[2]=d=>t.formSize.height=d),required:"",class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,512),[[f,t.formSize.height]]),N]),e("div",L,[c(e("input",{type:"number",min:"0","onUpdate:modelValue":o[3]||(o[3]=d=>t.formSize.length=d),required:"",class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,512),[[f,t.formSize.length]]),B]),s.shopMode?(l(),n("div",K,r(m.summaryWeight)+", кг ",1)):(l(),n("div",A,[c(e("input",{type:"number",min:"0","onUpdate:modelValue":o[4]||(o[4]=d=>t.formSize.weight=d),required:"",class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,512),[[f,t.formSize.weight]]),J])),s.shopMode?(l(),n(u,{key:2},[R,e("div",W,[(l(!0),n(u,null,b(t.formSize.items.length,(d,g)=>(l(),n("div",{key:g,class:"col mb-2"},[e("button",{type:"button",class:k([{"btn-primary":t.selectedIndex===g,"btn-light":t.selectedIndex!==g},"btn mr-2 w-100"]),onClick:Gt=>m.selectProduct(g)},r(g+1),11,G)]))),128)),e("div",H,[e("button",{type:"button",onClick:o[5]||(o[5]=(...d)=>m.addProduct&&m.addProduct(...d)),class:"btn btn-primary mr-2 w-100"},"+ ")])]),t.loaded?(l(),n(u,{key:0},[e("div",Q,[c(e("input",{type:"text","onUpdate:modelValue":o[6]||(o[6]=d=>t.formSize.items[t.selectedIndex].name=d),required:"",class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,512),[[f,t.formSize.items[t.selectedIndex].name]]),X]),e("div",Y,[c(e("input",{type:"text",maxlength:"255","onUpdate:modelValue":o[7]||(o[7]=d=>t.formSize.items[t.selectedIndex].ware_key=d),required:"",class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,512),[[f,t.formSize.items[t.selectedIndex].ware_key]]),Z]),e("div",ee,[c(e("input",{type:"number",min:"0","onUpdate:modelValue":o[8]||(o[8]=d=>t.formSize.items[t.selectedIndex].weight=d),required:"",class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,512),[[f,t.formSize.items[t.selectedIndex].weight]]),oe]),e("div",te,[c(e("input",{type:"number",min:"0","onUpdate:modelValue":o[9]||(o[9]=d=>t.formSize.items[t.selectedIndex].price=d),required:"",class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,512),[[f,t.formSize.items[t.selectedIndex].price]]),se]),e("div",ie,[c(e("input",{type:"number",min:"0","onUpdate:modelValue":o[10]||(o[10]=d=>t.formSize.items[t.selectedIndex].amount=d),required:"",class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,512),[[f,t.formSize.items[t.selectedIndex].amount]]),le]),t.selectedIndex>0?(l(),n("a",{key:0,href:"javascript:void(0)",onClick:o[11]||(o[11]=d=>m.removeProduct(t.selectedIndex)),class:"btn btn-link text-danger w-100 text-center"},"Удалить товар")):p("",!0)],64)):p("",!0)],64)):p("",!0)]),e("div",ne,[e("button",ae,[m.emptyCalc?(l(),n("span",re,[de,h(" Добавить")])):(l(),n("span",ce,r(t.formSize.width||0)+"x"+r(t.formSize.height||0)+"x"+r(t.formSize.length||0)+" см, до "+r(t.formSize.weight||m.summaryWeight||0)+"кг ",1))])])],32)])])],64)}const fe=C(I,[["render",me]]),he=e("h3",null,"Настройка CDEK",-1),ue={class:"col-md-6 col-12 mb-2"},pe={class:"form-floating"},be=e("label",{class:"form-label",id:"phone"}," Номер телефона отправителя ",-1),_e={class:"col-md-6 col-12 mb-2"},ge={class:"form-floating"},ke=e("label",{class:"form-label",id:"account"}," Аккаунт ",-1),ye={class:"col-md-6 col-12 mb-2"},ve={class:"form-floating"},Fe=e("label",{class:"form-label",id:"secure_password"}," Пароль приложения ",-1),we={class:"col-md-6 mb-2"},Se={class:"form-floating"},Te=["value"],Ce=e("label",{for:"floatingSelect"},"Тариф перевозки товаров по умолчанию",-1),$e={class:"col-md-6 mb-2"},Ie={class:"dropdown"},ze={class:"btn btn-outline-light text-primary dropdown-toggle w-100 p-3",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},Me={key:0,class:"badge bg-primary"},xe={class:"dropdown-menu w-100"},Ve=["onClick"],Oe={class:"col-md-6 mb-2"},Ue={class:"form-check form-switch"},De={class:"form-check-label",for:"is_active"},je={key:0,class:"fw-bold text-primary"},Pe={key:1,class:"fw-bold text-primary"},qe={key:0,class:"col-md-12"},Ee=e("h6",null,"Настройка офиса отправления",-1),Ne={class:"col-md-12"},Le=e("p",{class:"my-2"},"Размер посылки по умолчанию",-1),Be={key:0},Ae=e("i",{class:"fa-solid fa-dolly text-primary"},null,-1),Je={key:1},Ke=e("nav",{class:"navbar navbar-expand-sm fixed-bottom p-3 bg-transparent border-0",style:{"border-radius":"10px 10px 0px 0px"}},[e("button",{type:"submit",class:"btn btn-primary p-3 w-100"},[e("i",{class:"fa-solid fa-cloud-arrow-down mr-1"}),h(" Сохранить настройку ")])],-1),Re={class:"modal fade",id:"dimension-modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},We={class:"modal-dialog modal-fullscreen"},Ge={class:"modal-content"},He=e("div",{class:"modal-header"},[e("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"Расчёт размеров"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Qe={class:"modal-body"},Xe=e("div",{class:"divider my-3"},"Габариты",-1),Ye={class:"form-floating mb-3"},Ze=e("label",{for:"floatingInput"},"Ширина, см",-1),eo={class:"form-floating mb-3"},oo=e("label",{for:"floatingInput"},"Высота, см",-1),to={class:"form-floating mb-3"},so=e("label",{for:"floatingInput"},"Длина, см",-1),io={class:"form-floating mb-3"},lo=e("label",{for:"floatingInput"},"Вес, кг",-1),no={class:"modal-footer"},ao={"data-bs-dismiss":"modal",type:"button",class:"btn btn-primary w-100"},ro={key:0},co=e("i",{class:"fa-solid fa-dolly"},null,-1),mo={key:1},fo={props:["bot"],data(){return{load:!1,dimensionModal:null,tariffs:[{code:136,title:"Посылка склад-склад (до 50 кг)"},{code:234,title:"Экономичная посылка склад-склад (до 50 кг)"},{code:368,title:"Посылка склад-постамат (до 30 кг)"},{code:378,title:"Экономичная посылка склад-постамат (до 50 кг)"},{code:2536,title:"Один офис (ИМ, до 30 кг)"}],services:[{code:"INSURANCE",title:"Страхование"},{code:"PART_DELIV",title:"Частичная доставка"},{code:"DANGER_CARGO",title:"Опасный груз"},{code:"SMS",title:"СМС-уведомление(+10р)"},{code:"ADULT_GOODS",title:"Товары 18+"}],cdekForm:{account:null,secure_password:null,is_active:!0,bot_id:null,phone:null,config:{tariff_code:null,region:null,city:null,office:null,services:[],base_dimensions:{length:0,width:0,height:0,weight:0}}}}},computed:{emptyDimensions(){return this.cdekForm.config.base_dimensions.width==0&&this.cdekForm.config.base_dimensions.height==0&&this.cdekForm.config.base_dimensions.length==0&&this.cdekForm.config.base_dimensions.weight==0}},mounted(){this.dimensionModal=new bootstrap.Modal(document.getElementById("dimension-modal"),{}),this.bot.cdek&&this.$nextTick(()=>{var i,o;this.load=!1,this.cdekForm.account=this.bot.cdek.account||null,this.cdekForm.secure_password=this.bot.cdek.secure_password||null,this.cdekForm.is_active=this.bot.cdek.is_active||!0,this.cdekForm.bot_id=this.bot.cdek.bot_id||this.bot.id||null,this.cdekForm.phone=((i=this.bot.company)==null?void 0:i.phones[0])||null,(o=this.bot.cdek)!=null&&o.config&&(this.cdekForm.config.tariff_code=this.bot.cdek.config.tariff_code||null,this.cdekForm.config.region=this.bot.cdek.config.region||null,this.cdekForm.config.city=this.bot.cdek.config.city||null,this.cdekForm.config.office=this.bot.cdek.config.office||null,this.bot.cdek.config.base_dimensions&&(this.cdekForm.config.base_dimensions.length=this.bot.cdek.config.base_dimensions.length||0,this.cdekForm.config.base_dimensions.width=this.bot.cdek.config.base_dimensions.width||0,this.cdekForm.config.base_dimensions.height=this.bot.cdek.config.base_dimensions.height||0,this.cdekForm.config.base_dimensions.weight=this.bot.cdek.config.base_dimensions.weight||0)),this.load=!0})},methods:{openDimensionModal(){this.dimensionModal.show()},selectOffice(i){this.cdekForm.config.region=i.region,this.cdekForm.config.city=i.city,this.cdekForm.config.office=i.office},toggleService(i){let o=this.services[i],s=this.cdekForm.config.services.findIndex(a=>a===o.code);s===-1?this.cdekForm.config.services.push(o.code):this.cdekForm.config.services.splice(s,1)},submitCdek(){let i=new FormData;Object.keys(this.cdekForm).forEach(o=>{const s=this.cdekForm[o]||"";typeof s=="object"?i.append(o,JSON.stringify(s)):i.append(o,s)}),this.$store.dispatch("storeCdek",{cdekForm:i}).then(o=>{this.$notify({title:"Работа с CDEK",text:"Данные успешно сохранены",type:"success"}),window.location.reload()}).catch(o=>{this.$notify({title:"Работа с CDEK",text:"Ошибка работы",type:"error"})})}}},ho=Object.assign(fo,{__name:"CdekForm",setup(i){return(o,s)=>(l(),n(u,null,[he,e("form",{onSubmit:s[6]||(s[6]=v((...a)=>o.submitCdek&&o.submitCdek(...a),["prevent"])),class:"row py-3"},[e("div",ue,[e("div",pe,[c(e("input",{type:"text",class:"form-control",placeholder:"phone","aria-label":"phone","onUpdate:modelValue":s[0]||(s[0]=a=>o.cdekForm.phone=a),required:"","aria-describedby":"phone"},null,512),[[f,o.cdekForm.phone]]),be])]),e("div",_e,[e("div",ge,[c(e("input",{type:"text",class:"form-control",placeholder:"account","aria-label":"account","onUpdate:modelValue":s[1]||(s[1]=a=>o.cdekForm.account=a),required:"","aria-describedby":"account"},null,512),[[f,o.cdekForm.account]]),ke])]),e("div",ye,[e("div",ve,[c(e("input",{type:"text",class:"form-control",placeholder:"secure_password","aria-label":"secure_password","onUpdate:modelValue":s[2]||(s[2]=a=>o.cdekForm.secure_password=a),required:"","aria-describedby":"secure_password"},null,512),[[f,o.cdekForm.secure_password]]),Fe])]),e("div",we,[e("div",Se,[c(e("select",{"onUpdate:modelValue":s[3]||(s[3]=a=>o.cdekForm.config.tariff_code=a),class:"form-select",id:"floatingSelect","aria-label":"Floating label select example"},[(l(!0),n(u,null,b(o.tariffs,a=>(l(),n("option",{value:a.code},r(a.title||"-"),9,Te))),256))],512),[[w,o.cdekForm.config.tariff_code]]),Ce])]),e("div",$e,[e("div",Ie,[e("button",ze,[h(" Выбрать доп. сервисы "),o.cdekForm.config.services.length>0?(l(),n("span",Me,r(o.cdekForm.config.services.length),1)):p("",!0)]),e("ul",xe,[(l(!0),n(u,null,b(o.services,(a,t)=>(l(),n("li",null,[e("a",{onClick:m=>o.toggleService(t),class:k([{"bg-primary":o.cdekForm.config.services.indexOf(a.code)!==-1},"dropdown-item"]),href:"javascript:void(0)"},r(a.title||"-"),11,Ve)]))),256))])])]),e("div",Oe,[e("div",Ue,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[4]||(s[4]=a=>o.cdekForm.is_active=a),type:"checkbox",role:"switch",id:"is_active"},null,512),[[F,o.cdekForm.is_active]]),e("label",De,[h("Статус "),o.cdekForm.is_active?(l(),n("span",je,"вкл")):(l(),n("span",Pe,"выкл"))])])]),o.load?(l(),n("div",qe,[Ee,_(y,{config:o.cdekForm.config,onCallback:o.selectOffice},null,8,["config","onCallback"])])):p("",!0),e("div",Ne,[Le,e("button",{type:"button",onClick:s[5]||(s[5]=(...a)=>o.openDimensionModal&&o.openDimensionModal(...a)),class:"btn btn-light w-100 p-3"},[o.emptyDimensions?(l(),n("span",Be,[Ae,h(" Укажите размер")])):(l(),n("span",Je,r(o.cdekForm.config.base_dimensions.width||0)+"x"+r(o.cdekForm.config.base_dimensions.height||0)+"x"+r(o.cdekForm.config.base_dimensions.length||0)+" см, до "+r(o.cdekForm.config.base_dimensions.weight||0)+"кг ",1))])]),Ke],32),e("div",Re,[e("div",We,[e("form",Ge,[He,e("div",Qe,[Xe,e("div",Ye,[c(e("input",{type:"number",min:"0","onUpdate:modelValue":s[7]||(s[7]=a=>o.cdekForm.config.base_dimensions.width=a),required:"",class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,512),[[f,o.cdekForm.config.base_dimensions.width]]),Ze]),e("div",eo,[c(e("input",{type:"number",min:"0","onUpdate:modelValue":s[8]||(s[8]=a=>o.cdekForm.config.base_dimensions.height=a),required:"",class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,512),[[f,o.cdekForm.config.base_dimensions.height]]),oo]),e("div",to,[c(e("input",{type:"number",min:"0","onUpdate:modelValue":s[9]||(s[9]=a=>o.cdekForm.config.base_dimensions.length=a),required:"",class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,512),[[f,o.cdekForm.config.base_dimensions.length]]),so]),e("div",io,[c(e("input",{type:"number",min:"0",step:"0.1","onUpdate:modelValue":s[10]||(s[10]=a=>o.cdekForm.config.base_dimensions.weight=a),required:"",class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,512),[[f,o.cdekForm.config.base_dimensions.weight]]),lo])]),e("div",no,[e("button",ao,[o.emptyDimensions?(l(),n("span",ro,[co,h(" Добавить")])):(l(),n("span",mo,r(o.cdekForm.config.base_dimensions.width||0)+"x"+r(o.cdekForm.config.base_dimensions.height||0)+"x"+r(o.cdekForm.config.base_dimensions.length||0)+" см, до "+r(o.cdekForm.config.base_dimensions.weight||0)+"кг ",1))])])])])])],64))}}),uo=e("h3",null,"Расчёт цены CDEK",-1),po=e("h6",null,"Офис отправления",-1),bo=e("h6",null,"Офис получения",-1),_o={class:"form-check form-switch mt-3 mb-2"},go=e("label",{class:"form-check-label",for:"flexSwitchCheckDefault"},"Режим интернет-магазина",-1),ko=e("h6",{class:"my-2"},"Ваши посылки",-1),yo={class:"list-group my-2"},vo={class:"list-group-item d-flex justify-content-between"},Fo=["onClick"],wo=e("i",{class:"fa-regular fa-trash-can"},null,-1),So=[wo],To={key:1,class:"alert alert-light"},Co={key:2,class:"alert alert-light"},$o={class:"d-flex justify-content-between"},Io={class:"fw-bold"},zo={class:"badge bg-primary"},Mo=e("i",{class:"fa-regular fa-trash-can"},null,-1),xo=[Mo],Vo={class:"mb-0"},Oo={class:"fw-bold text-primary"},Uo={class:"fw-bold text-primary"},Do={class:"mb-0"},jo={class:"fw-bold text-primary"},Po={class:"navbar navbar-expand-sm fixed-bottom p-3 bg-transparent border-0",style:{"border-radius":"10px 10px 0px 0px"}},qo=["disabled"],Eo=["disabled"],No={class:"modal fade",id:"choose-tariff-modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},Lo={class:"modal-dialog modal-fullscreen"},Bo={class:"modal-content"},Ao=e("div",{class:"modal-header"},[e("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"Выбор тарифа"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Jo={key:0,class:"modal-body"},Ko={class:"list-group list-group-numbered"},Ro={class:"list-group-item d-flex justify-content-between align-items-start"},Wo={class:"ms-2 me-auto"},Go={class:"fw-bold"},Ho={class:"mb-0"},Qo={class:"fw-bold text-primary"},Xo={class:"fw-bold text-primary"},Yo={class:"mb-0"},Zo={class:"fw-bold text-primary"},et=["onClick"],ot={class:"badge text-bg-primary rounded-pill"},tt={key:1,class:"modal-body"},st={class:"modal fade",id:"make-order-modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},it={class:"modal-dialog modal-fullscreen"},lt=e("div",{class:"modal-header"},[e("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"Оформление заказа"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),nt={class:"modal-body"},at=e("div",{class:"divider my-3"},"Данные отправителя",-1),rt={class:"form-floating mb-2"},dt=e("label",{for:"floatingInput"},"Ф.И.О. отправителя",-1),ct={class:"input-group mb-2"},mt={class:"form-floating"},ft=["onUpdate:modelValue"],ht=e("label",{for:"floatingInput"},"+7(000)000-00-00",-1),ut=["onClick"],pt=e("i",{class:"fas fa-trash"},null,-1),bt=[pt],_t=e("div",{class:"divider my-3"},"Данные получателя",-1),gt={class:"form-floating mb-2"},kt=e("label",{for:"floatingInput"},"Ф.И.О. получателя",-1),yt={class:"input-group mb-2"},vt={class:"form-floating"},Ft=["onUpdate:modelValue"],wt=e("label",{for:"floatingInput"},"+7(000)000-00-00",-1),St=["onClick"],Tt=e("i",{class:"fas fa-trash"},null,-1),Ct=[Tt],$t={class:"form-floating my-2"},It=e("label",{for:"floatingInput"},"Адрес получателя",-1),zt=e("div",{class:"divider my-3"},"Комментарий к заказу",-1),Mt={class:"form-floating"},xt=e("label",{for:"floatingTextarea2"},"Комментарий к заказу",-1),Vt=e("div",{class:"modal-footer"},[e("button",{class:"btn btn-primary w-100 p-3"},"Зарегистрировать заказ")],-1),Ot={data(){return{tariffs:[],chooseTariffModal:null,makeOrderModal:null,calcTariffForm:{is_shop_mode:!0,comment:null,tariff:null,from:{region:null,city:null,office:null,address:null},to:{region:null,city:null,office:null,address:null},packages:[],sender_name:null,sender_phones:[],recipient_name:null,recipient_phones:[""]}}},watch:{"calcTariffForm.packages":{handler:function(i){this.calcTariffForm.tariff=null},deep:!0}},computed:{canCalcTariff(){return this.calcTariffForm.packages.length>0&&this.calcTariffForm.from.region!=null&&this.calcTariffForm.from.city!=null&&this.calcTariffForm.to.region!=null&&this.calcTariffForm.to.city!=null}},mounted(){if(this.chooseTariffModal=new bootstrap.Modal(document.getElementById("choose-tariff-modal"),{}),this.makeOrderModal=new bootstrap.Modal(document.getElementById("make-order-modal"),{}),localStorage.getItem("cashman_calc-tariff-form-from")!=null){let i=JSON.parse(localStorage.getItem("cashman_calc-tariff-form-from"));this.calcTariffForm.to.region=(i==null?void 0:i.region)||null,this.calcTariffForm.to.city=(i==null?void 0:i.city)||null,this.calcTariffForm.to.office=(i==null?void 0:i.office)||null}if(localStorage.getItem("cashman_calc-tariff-form-to")!=null){let i=JSON.parse(localStorage.getItem("cashman_calc-tariff-form-to"));this.calcTariffForm.to.region=(i==null?void 0:i.region)||null,this.calcTariffForm.to.city=(i==null?void 0:i.city)||null,this.calcTariffForm.to.office=(i==null?void 0:i.office)||null}},methods:{addSenderPhone(){this.calcTariffForm.sender_phones.push("")},addRecipientPhone(){this.calcTariffForm.recipient_phones.push("")},removeRecipientPhone(i){this.calcTariffForm.recipient_phones.splice(i,1)},removeSenderPhone(i){this.calcTariffForm.sender_phones.splice(i,1)},openOrderModal(){this.makeOrderModal.toggle()},selectTariff(i){this.calcTariffForm.tariff=i,this.chooseTariffModal.hide()},selectOffice(i,o){let s=o===0?"from":"to";this.calcTariffForm[s].region=i.region,this.calcTariffForm[s].city=i.city,this.calcTariffForm[s].office=i.office,this.calcTariffForm.tariff=null},selectSize(i){this.calcTariffForm.packages.push({width:i.width||0,height:i.height||0,length:i.length||0,weight:i.weight||0,items:i.items||[]})},removeItem(i){this.calcTariffForm.packages.splice(i,1)},submitCdek(){let i=new FormData;Object.keys(this.calcTariffForm).forEach(o=>{const s=this.calcTariffForm[o]||"";typeof s=="object"?i.append(o,JSON.stringify(s)):i.append(o,s)}),this.$store.dispatch("storeCdekOrder",{cdekForm:i}).then(o=>{localStorage.setItem("cashman_calc-tariff-form-tariff",JSON.stringify(this.calcTariffForm.tariff)),localStorage.setItem("cashman_calc-tariff-form-from",JSON.stringify(this.calcTariffForm.from)),localStorage.setItem("cashman_calc-tariff-form-to",JSON.stringify(this.calcTariffForm.to)),this.$notify({title:"Работа с CDEK",text:"Данные успешно сохранены",type:"success"})}).catch(o=>{this.$notify({title:"Работа с CDEK",text:"Ошибка работы",type:"error"})})},submitTariffCalcCdek(){this.chooseTariffModal.show(),this.tariffs=[];let i=new FormData;Object.keys(this.calcTariffForm).forEach(o=>{const s=this.calcTariffForm[o]||"";typeof s=="object"?i.append(o,JSON.stringify(s)):i.append(o,s)}),this.$store.dispatch("calcCdekTariff",{cdekForm:i}).then(o=>{this.tariffs=o,this.$notify({title:"Работа с CDEK",text:"Данные успешно сохранены",type:"success"})}).catch(o=>{this.$notify({title:"Работа с CDEK",text:"Ошибка работы",type:"error"})})}}},Ut=Object.assign(Ot,{__name:"CdekAdminCalcForm",setup(i){return(o,s)=>{const a=S("mask");return l(),n(u,null,[uo,po,_(y,{onCallback:s[0]||(s[0]=t=>o.selectOffice(t,0))}),bo,_(y,{onCallback:s[1]||(s[1]=t=>o.selectOffice(t,1))}),e("div",_o,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[2]||(s[2]=t=>o.calcTariffForm.is_shop_mode=t),type:"checkbox",role:"switch",id:"flexSwitchCheckDefault"},null,512),[[F,o.calcTariffForm.is_shop_mode]]),go]),_(fe,{"shop-mode":o.calcTariffForm.is_shop_mode,onCallback:o.selectSize},null,8,["shop-mode","onCallback"]),o.calcTariffForm.packages.length>0?(l(),n(u,{key:0},[ko,e("ul",yo,[(l(!0),n(u,null,b(o.calcTariffForm.packages,(t,m)=>(l(),n("li",vo,[e("span",null,r(t.width||0)+"x"+r(t.height||0)+"x"+r(t.length||0)+" см, до "+r(t.weight||0)+"кг ",1),e("span",{onClick:d=>o.removeItem(m),class:"text-danger"},So,8,Fo)]))),256))])],64)):p("",!0),o.calcTariffForm.tariff?(l(),n("div",Co,[e("div",$o,[e("p",Io,[h(r(o.calcTariffForm.tariff.tariff_name)+" ",1),e("span",zo,"#"+r(o.calcTariffForm.tariff.tariff_code),1)]),e("span",{onClick:s[3]||(s[3]=t=>o.calcTariffForm.tariff=null),class:"text-danger"},xo)]),e("p",Vo,[h("Доставка от "),e("span",Oo,r(o.calcTariffForm.tariff.period_min),1),h(" до "),e("span",Uo,r(o.calcTariffForm.tariff.period_max),1),h(" рабочих дней")]),e("p",Do,[h("Стоимость доставки "),e("span",jo,r(o.calcTariffForm.tariff.delivery_sum),1),h(" руб.")])])):(l(),n("div",To," Тариф еще не выбран! ")),e("nav",Po,[o.calcTariffForm.tariff==null?(l(),n("button",{key:0,disabled:!o.canCalcTariff,style:{"box-shadow":"1px 1px 6px 0px #0000004a"},onClick:s[4]||(s[4]=(...t)=>o.submitTariffCalcCdek&&o.submitTariffCalcCdek(...t)),class:"btn btn-primary w-100 p-3 rounded-3 shadow-lg d-flex justify-content-center"}," Рассчитать тариф ",8,qo)):p("",!0),o.calcTariffForm.tariff!=null?(l(),n("button",{key:1,disabled:!o.canCalcTariff,style:{"box-shadow":"1px 1px 6px 0px #0000004a"},onClick:s[5]||(s[5]=(...t)=>o.openOrderModal&&o.openOrderModal(...t)),class:"btn btn-primary w-100 p-3 rounded-3 shadow-lg d-flex justify-content-center"}," Оформить заказ ",8,Eo)):p("",!0)]),e("div",No,[e("div",Lo,[e("div",Bo,[Ao,o.tariffs.length>0?(l(),n("div",Jo,[e("ol",Ko,[(l(!0),n(u,null,b(o.tariffs,t=>(l(),n("li",Ro,[e("div",Wo,[e("div",Go,r(t.tariff_name),1),e("p",Ho,[h("Доставка от "),e("span",Qo,r(t.period_min),1),h(" до "),e("span",Xo,r(t.period_max),1),h(" рабочих дней")]),e("p",Yo,[h("Стоимость доставки "),e("span",Zo,r(t.delivery_sum),1),h(" руб.")]),e("button",{type:"button",class:"btn btn-primary w-100 mt-3",onClick:m=>o.selectTariff(t)},"Выбрать тариф ",8,et)]),e("span",ot,"#"+r(t.tariff_code),1)]))),256))])])):(l(),n("div",tt,[_($)]))])])]),e("div",st,[e("div",it,[e("form",{class:"modal-content",onSubmit:s[12]||(s[12]=v((...t)=>o.submitCdek&&o.submitCdek(...t),["prevent"]))},[lt,e("div",nt,[at,e("div",rt,[c(e("input",{type:"text","onUpdate:modelValue":s[6]||(s[6]=t=>o.calcTariffForm.sender_name=t),class:"form-control",id:"floatingInput",placeholder:"name@example.com",required:""},null,512),[[f,o.calcTariffForm.sender_name]]),dt]),(l(!0),n(u,null,b(o.calcTariffForm.sender_phones,(t,m)=>(l(),n("div",ct,[e("div",mt,[c(e("input",{type:"text","onUpdate:modelValue":d=>o.calcTariffForm.sender_phones[m]=d,class:"form-control",id:"floatingInput",required:"",placeholder:"name@example.com"},null,8,ft),[[a,"+7(###)###-##-##"],[f,o.calcTariffForm.sender_phones[m]]]),ht]),e("span",{onClick:d=>o.removeSenderPhone(m),class:"input-group-text",id:"basic-addon1"},bt,8,ut)]))),256)),e("a",{onClick:s[7]||(s[7]=(...t)=>o.addSenderPhone&&o.addSenderPhone(...t)),href:"javascript:void(0)"},"+ Ещё номер телефона"),_t,e("div",gt,[c(e("input",{type:"text","onUpdate:modelValue":s[8]||(s[8]=t=>o.calcTariffForm.recipient_name=t),class:"form-control",id:"floatingInput",placeholder:"name@example.com",required:""},null,512),[[f,o.calcTariffForm.recipient_name]]),kt]),(l(!0),n(u,null,b(o.calcTariffForm.recipient_phones,(t,m)=>(l(),n("div",yt,[e("div",vt,[c(e("input",{type:"text","onUpdate:modelValue":d=>o.calcTariffForm.recipient_phones[m]=d,class:"form-control",id:"floatingInput",placeholder:"name@example.com",required:""},null,8,Ft),[[a,"+7(###)###-##-##"],[f,o.calcTariffForm.recipient_phones[m]]]),wt]),o.calcTariffForm.recipient_phones.length>1?(l(),n("span",{key:0,onClick:d=>o.removeRecipientPhone(m),class:"input-group-text",id:"basic-addon1"},Ct,8,St)):p("",!0)]))),256)),e("a",{onClick:s[9]||(s[9]=(...t)=>o.addRecipientPhone&&o.addRecipientPhone(...t)),href:"javascript:void(0)"},"+ Ещё номер телефона"),e("div",$t,[c(e("input",{type:"text","onUpdate:modelValue":s[10]||(s[10]=t=>o.calcTariffForm.to.address=t),class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,512),[[f,o.calcTariffForm.to.address]]),It]),zt,e("div",Mt,[c(e("textarea",{"onUpdate:modelValue":s[11]||(s[11]=t=>o.calcTariffForm.comment=t),class:"form-control",placeholder:"Leave a comment here",id:"floatingTextarea2",style:{height:"100px"}},null,512),[[f,o.calcTariffForm.comment]]),xt])]),Vt],32)])])],64)}}}),Dt={class:"container my-3"},jt={class:"row"},Pt={class:"col-12"},qt={class:"nav justify-content-center nav-tabs my-2"},Et={class:"nav-item"},Nt={class:"nav-item"},Lt={key:0,class:"col-12"},Bt={key:1,class:"alert alert-light"},At=e("p",{class:"text-center"},"Загружаем данные...",-1),Jt=e("div",{class:"d-flex justify-content-center w-100"},[e("div",{class:"spinner-border color-orange-dark",role:"status"},[e("span",{class:"sr-only"},"Загрузка...")])],-1),Kt=[At,Jt],Rt={key:1,class:"col-12"},Wt={data(){return{tab:0,load:!1,bot:null}},mounted(){this.loadBotAdminConfig()},methods:{loadBotAdminConfig(){this.$store.dispatch("loadBotAdminConfig").then(i=>{this.bot=i.data,this.cdek=this.bot.cdek||null})}}},os=Object.assign(Wt,{__name:"Cdek",setup(i){return(o,s)=>(l(),n("div",Dt,[e("div",jt,[e("div",Pt,[e("ul",qt,[e("li",Et,[e("a",{class:k(["nav-link",{active:o.tab===0}]),onClick:s[0]||(s[0]=a=>o.tab=0),"aria-current":"page",href:"javascript:void(0)"},"Настройка",2)]),e("li",Nt,[e("a",{class:k(["nav-link",{active:o.tab===1}]),onClick:s[1]||(s[1]=a=>o.tab=1),href:"javascript:void(0)"},"Калькулятор",2)])])]),o.tab===0?(l(),n("div",Lt,[!o.load&&o.bot?(l(),T(ho,{key:0,bot:o.bot},null,8,["bot"])):(l(),n("div",Bt,Kt))])):p("",!0),o.tab===1?(l(),n("div",Rt,[_(Ut)])):p("",!0)])]))}});export{os as default};
