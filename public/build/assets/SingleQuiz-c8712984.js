import{C as v,Q as z,a as k}from"./QuizCommandList-307f1e6e.js";import{j as w,o as s,k as t,M as a,n as o,F as h,K as m,L as d,H as _,a0 as g,p as f,N as b,bB as q,Y as Q,l as j}from"./index.es-c4852431.js";import{B as y}from"./BotMediaObject-1bb9a6cd.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./Pagination-b758f7ed.js";/* empty css                                                   */const C={key:0,class:"card card-style"},$=o("div",{class:"content d-flex justify-content-center align-items-center flex-wrap",style:{"min-height":"300px"}},[o("div",null,[o("p",{class:"text-center w-100 font-weight-bold"},"Мы загружаем квиз!"),o("div",{class:"loader"})])],-1),O=[$],A={key:1,class:"card card-style"},M={class:"content"},L={class:"mb-5"},F={href:"javascript:void(0)",class:"chip chip-small bg-gray1-dark"},N=o("i",{class:"fa fa-check bg-green1-dark"},null,-1),T={class:"color-black font-400"},V={class:"mb-0"},B={key:1},E={key:0,class:"mb-0 font-weight-bold text-center"},H={key:1},P=["for"],S=["onUpdate:modelValue","id","value"],U=["onClick"],D={key:2},G=o("p",{class:"mb-0"},[o("small",null,"Открытый вопрос")],-1),J={class:"form-field form-name"},K={class:"contactNameField color-theme d-flex justify-content-between",for:"command-title"},R=["onClick"],Y=["onUpdate:modelValue"],W=["onClick"],X={key:2},Z=o("h6",{class:"text-center my-2"}," А вот и результат ",-1),I={key:0},x={key:1,class:"text-center my-3"},ee=["innerHTML"],se={key:2,class:"card card-style"},te={class:"content"},ie=o("p",null,"Поздравляю! Вы прошли данный квиз! Ваш результат:",-1),ne={key:0,class:"list-group list-group-numbered"},oe={class:"list-group-item d-flex justify-content-between align-items-start"},le={class:"ms-2 me-auto"},ae={class:"fw-bold"},re={class:"my-2"},ue=["innerHTML"],de=["innerHTML"],ce={props:["quiz"],components:{Countdown:v},data(){return{points:[],direction:"asc",order:"round",show:!0,step:0,is_finish:!1,is_group:!1,loading:!0,questions:[],answers:[],search:null,paginate_object:null,prepare:!1}},computed:{...w(["getQuizQuestions","getQuizQuestionsPaginateObject"]),successPercentCount(){if(this.points.length===0)return 0;let i=0;return this.points.forEach(e=>{e.is_right&&i++}),i/this.points.length},summaryPoints(){if(this.points.length===0)return 0;let i=0;return this.points.forEach(e=>{i+=e.points||0}),i}},mounted(){this.loadQuizQuestions()},methods:{completeAndExit(){this.$store.dispatch("completeQuiz",{quiz_id:this.quiz.id}).then(i=>{}).catch(()=>{}),this.$emit("complete")},finish(){this.is_finish=!0,this.$store.dispatch("checkAndCompleteFullQuiz",{quiz_id:this.quiz.id,answers:JSON.stringify(this.answers)}).then(i=>{this.points=i}).catch(i=>{})},removeOpenAnswer(i,e){this.answers[i].splice(e,1)},addMoreOpenAnswer(i){this.answers[i].push(null)},toggleAnswer(i,e){let r=this.answers[i].value.indexOf(e);r==-1?this.answers[i].value.push(e):this.answers[i].value.splice(r,1)},loadAndOrder(i){this.order=i,this.direction=this.direction==="desc"?"asc":"desc",this.loadQuizQuestions(0)},loadQuizQuestions(i=0){this.loading=!0,this.$store.dispatch("loadQuizQuestions",{dataObject:{quiz_id:this.quiz.id,search:this.search,order:this.order,direction:this.direction},page:i,size:-1}).then(e=>{this.loading=!1,this.questions=this.getQuizQuestions,this.answers=[],this.questions.forEach(r=>{let n=null;r.is_multiply?n={id:r.id,value:[]}:n={id:r.id,value:null},r.is_open&&(n=[{id:r.id,value:null}]),this.answers.push(n)}),this.paginate_object=this.getQuizQuestionsPaginateObject}).catch(()=>{this.loading=!1})}}},he=Object.assign(ce,{__name:"QuizFullQuestionList",setup(i){return(e,r)=>(s(),t(h,null,[e.questions.length===0?(s(),t("div",C,O)):a("",!0),e.questions.length>0&&e.step<e.questions.length?(s(),t("div",A,[o("div",M,[(s(!0),t(h,null,m(e.questions,(n,l)=>(s(),t("div",L,[o("a",F,[N,o("strong",T,"Раунд "+d(n.round||1),1)]),o("p",V,d(n.text||"не указан"),1),n.media_content?(s(),_(y,{key:0,class:"mb-2",type:n.content_type,content:n.media_content},null,8,["type","content"])):a("",!0),n.answers?(s(),t("div",B,[n.is_multiply?(s(),t("p",E,"Вы можете выбрать несколько ответов")):a("",!0),n.is_open?(s(),t("div",D,[G,(s(!0),t(h,null,m(e.answers[l],(u,c)=>(s(),t("div",J,[o("label",K,[f(" Ответ #"+d(c+1)+" ",1),e.answers[l].length>1?(s(),t("a",{key:0,href:"javascript:void(0)",onClick:p=>e.removeOpenAnswer(l,c)},"удалить",8,R)):a("",!0)]),b(o("input",{type:"text",name:"contactNameField",maxlength:"255","onUpdate:modelValue":p=>e.answers[l][c]=p,placeholder:"Например 'Новые люди'",class:"contactField round-small requiredField",id:"command-title",required:""},null,8,Y),[[Q,e.answers[l][c]]])]))),256)),o("a",{href:"javascript:void(0)",class:"text-center w-100 d-block",onClick:u=>e.addMoreOpenAnswer(l)},"Добавить еще ответ",8,W)])):(s(),t("div",H,[n.is_multiply?a("",!0):(s(!0),t(h,{key:0},m(n.answers,(u,c)=>(s(),t("label",{class:g([{"bg-green2-dark border-green2-dark color-white":e.answers[l].value==u.id},"btn btn-border btn-m btn-full rounded-l mb-1 text-uppercase font-900 border-green2-dark d-flex justify-content-center align-items-center"]),for:"question-"+l+"-answer-"+c},[f(d(u.text)+" ",1),b(o("input",{type:"radio",name:"quiz",class:"d-none","onUpdate:modelValue":p=>e.answers[l].value=p,id:"question-"+l+"-answer-"+c,value:u.id},null,8,S),[[q,e.answers[l].value]])],10,P))),256)),n.is_multiply?(s(!0),t(h,{key:1},m(n.answers,(u,c)=>(s(),t("button",{class:g([{"bg-red1-dark color-white":e.answers[l].value.indexOf(u.id)!=-1},"btn btn-border btn-m btn-full mb-1 rounded-l text-uppercase font-900 border-red2-dark w-100 d-flex justify-content-center align-items-center"]),onClick:p=>e.toggleAnswer(l,u.id),type:"button"},d(u.text),11,U))),256)):a("",!0)]))])):a("",!0),e.points[l]?(s(),t("div",X,[Z,e.points[l]?(s(),t("div",I,[e.points[l].question.content?(s(),_(y,{key:0,class:"mb-2",type:e.points[l].question.type,content:e.points[l].question.content},null,8,["type","content"])):a("",!0)])):a("",!0),(e.points[l]||{}).question?(s(),t("p",x,[o("strong",{innerHTML:e.points[l].question.message||"Отлично! Идем дальше"},null,8,ee)])):a("",!0)])):a("",!0)]))),256)),e.is_finish?a("",!0):(s(),t("a",{key:0,href:"javascript:void(0)",onClick:r[0]||(r[0]=(...n)=>e.finish&&e.finish(...n)),class:"btn btn-m btn-full mb-2 rounded-m text-uppercase font-900 shadow-s bg-green2-dark"}," Завершить опрос и посмотреть результат "))])])):a("",!0),e.is_finish?(s(),t("div",se,[o("div",te,[ie,e.points.length>0?(s(),t("ol",ne,[(s(!0),t(h,null,m(e.points,(n,l)=>(s(),t("li",oe,[o("div",le,[o("div",ae,d(n.question.text||"Текст не указан"),1),f(" "+d(n.question.message||"-"),1)]),o("span",{class:g(["badge rounded-pill text-white p-2",{"bg-success":n.is_right,"bg-danger":!n.is_right}])},d(n.points||0)+" баллов",3)]))),256))])):a("",!0),o("h6",re,"Вы набрали "+d(e.summaryPoints)+" баллов",1),e.successPercentCount>=i.quiz.success_percent?(s(),t("p",{key:1,innerHTML:i.quiz.success_message},null,8,ue)):(s(),t("p",{key:2,innerHTML:i.quiz.failure_message},null,8,de)),o("a",{href:"javascript:void(0)",onClick:r[1]||(r[1]=(...n)=>e.completeAndExit&&e.completeAndExit(...n)),class:"btn btn-m btn-full mt-3 rounded-s text-uppercase font-900 shadow-s bg-red1-light w-100"},"Завершить и выйти")])])):a("",!0)],64))}}),pe={key:0},me={key:1},_e={name:"App",data(){return{step:0,loading:!1,quiz:null}},mounted(){this.loadQuiz()},methods:{completeQuiz(){this.loadQuiz(),this.step=0},loadQuiz(){this.loading=!0,this.$store.dispatch("loadSingleQuiz",{quiz_id:this.$route.params.quizId}).then(i=>{this.loading=!1,this.quiz=i.data}).catch(()=>{this.loading=!1})}}},ke=Object.assign(_e,{setup(i){return(e,r)=>(s(),t(h,null,[e.quiz&&e.step===0?(s(),t("div",pe,[j(z,{class:"p-1",quiz:e.quiz,onSelect:r[0]||(r[0]=n=>e.step++)},null,8,["quiz"])])):a("",!0),e.quiz&&e.step===1?(s(),t("div",me,[e.quiz.round_mode?(s(),_(k,{key:0,onComplete:e.completeQuiz,quiz:e.quiz},null,8,["onComplete","quiz"])):a("",!0),e.quiz.round_mode?a("",!0):(s(),_(he,{key:1,onComplete:e.completeQuiz,quiz:e.quiz},null,8,["onComplete","quiz"]))])):a("",!0)],64))}});export{ke as default};
