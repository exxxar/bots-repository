import{j as b,o as l,k as o,F as r,K as g,n as e,L as d,M as n,a1 as S,N as m,Y as f,H as c,p as u,a3 as $,l as k}from"./index.es-c4852431.js";import{P as _}from"./Pagination-b758f7ed.js";import{_ as w}from"./SlugForm-e32e52a8.js";/* empty css                                                   */import"./_plugin-vue_export-helper-c27b6911.js";import"./BotMediaList-9b4db56f.js";import"./vue3-json-editor.esm.prod-a2876a2f.js";const y={key:0,class:"list-group"},v={class:"w-100 list-group-item"},F=["onClick"],C=e("i",{class:"fa-solid fa-scroll text-primary"},null,-1),j={class:"mb-2"},O=e("div",{class:"alert alert-light mb-2"}," Вы можете добавить данный скрипт изменив сразу название команды на нужное непосредственно ВАМ! Меняется только название. ",-1),L={class:"form-floating"},A=e("label",{for:""},"Команда",-1),M=["disabled"],T={key:2,class:"mb-2"},P=e("div",{class:"alert alert-warning",role:"alert"}," К сожалению еще нет глобальных скриптов ",-1),G=[P],V={props:["canAdd","bot"],data(){return{search:null,slugs:[],slugs_paginate_object:null,slugForm:{command:null,comment:null,slug:null,config:[],is_global:!0,bot_id:null}}},computed:{...b(["getGlobalSlugs","getGlobalSlugsPaginateObject"]),filteredAllSlugs(){return this.slugs.length===0?[]:this.search==null?this.slugs:this.slugs.filter(s=>{let t=s.slug||"",i=s.command||"",a=s.comment||"";return i.toLowerCase().indexOf(this.search.toLowerCase())!==-1||a.toLowerCase().indexOf(this.search.toLowerCase())!==-1||t.toLowerCase().indexOf(this.search.toLowerCase())!==-1})}},mounted(){this.loadAllSlugs()},methods:{loadAllSlugs(s=0){this.$store.dispatch("loadGlobalSlugs",{dataObject:{search:this.search||null,needGlobal:!0},page:s}).then(t=>{this.slugs=this.getGlobalSlugs,this.slugs_paginate_object=this.getGlobalSlugsPaginateObject})},removeSlug(s){this.$store.dispatch("removeSlug",{dataObject:{slugId:s.id}}).then(t=>{this.$notify({title:"Конструктор команд",text:"Команда успешно удалена!",type:"success"}),this.loadAllSlugs()}).catch(t=>{this.loadAllSlugs()})},nextSlugs(s){this.loadAllSlugs(s)},selectSlug(s){if(this.slugForm.id===s.id){this.slugForm.id=null,this.slugForm.slug=null,this.slugForm.comment=null,this.slugForm.command=null,this.slugForm.config=[],this.slugForm.is_global=!1;return}this.slugForm.id=s.id||null,this.slugForm.slug=s.slug,this.slugForm.comment=s.comment,this.slugForm.command=this.command||s.command,this.slugForm.config=s.config||[],this.slugForm.is_global=s.is_global||!1,this.$emit("select",s)},addSlug(){let s=new FormData;Object.keys(this.slugForm).forEach(t=>{const i=this.slugForm[t]||"";typeof i=="object"?s.append(t,JSON.stringify(i)):s.append(t,i)}),this.bot&&s.append("bot_id",this.bot.id),this.$store.dispatch("createSlug",{slugForm:s}).then(t=>{this.$notify({title:"Конструктор команд",text:"Команда успешно обновлена!",type:"success"}),this.slugForm.id=null,this.slugForm.command=null,this.slugForm.comment=null,this.slugForm.bot_id=null,this.slugForm.slug=null,this.slugForm.config=[],this.slugForm.is_global=!0,this.$emit("callback")}).catch(t=>{})}}},x=Object.assign(V,{__name:"GlobalSlugList",setup(s){return(t,i)=>(l(),o(r,null,[t.filteredAllSlugs.length>0?(l(),o("ul",y,[(l(!0),o(r,null,g(t.filteredAllSlugs,(a,p)=>(l(),o("li",v,[a?(l(),o("p",{key:0,onClick:h=>t.selectSlug(a),class:"mb-2"},[C,e("span",null,d(a.command||"Не указана"),1)],8,F)):n("",!0),t.slugForm.id==a.id&&t.filteredAllSlugs.length>0?(l(),o("form",{key:1,onSubmit:i[1]||(i[1]=S((...h)=>t.addSlug&&t.addSlug(...h),["prevent"])),class:"mb-0 d-flex flex-wrap"},[e("div",j,[O,e("div",L,[m(e("input",{type:"text",class:"form-control",placeholder:"Команда","aria-label":"Команда","onUpdate:modelValue":i[0]||(i[0]=h=>t.slugForm.command=h),maxlength:"255","aria-describedby":"bot-domain",required:""},null,512),[[f,t.slugForm.command]]),A])]),e("button",{disabled:t.slugForm.slug==null,class:"btn btn-primary w-100 p-3"},"Добавить скрипт в бота ",8,M)],32)):n("",!0)]))),256))])):n("",!0),t.slugs_paginate_object?(l(),c(_,{key:1,onPagination_page:t.nextSlugs,pagination:t.slugs_paginate_object},null,8,["onPagination_page","pagination"])):(l(),o("div",T,G))],64))}});const B={class:"alert alert-light w-100 mb-1",type:"button"},N={key:0,class:"fa-solid fa-chevron-up"},I={key:1,class:"fa-solid fa-chevron-down"},q=["data-bs-target"],D={key:0,class:"fa-regular fa-pen-to-square"},E={key:1,class:"fa-solid fa-xmark"},U={key:0,class:"fa-solid fa-arrow-up-short-wide"},H={key:1,class:"fa-solid fa-arrow-down-short-wide"},J=e("i",{class:"fa-solid fa-clone"},null,-1),K=[J],Y=e("i",{class:"fa-regular fa-trash-can color-white"},null,-1),z=[Y],Q={key:1,class:"list-group my-2 p-0"},R={class:"list-group-item d-flex justify-content-between align-items-start"},W={class:"ms-2 me-auto"},X=e("div",{class:"fw-bold"},"Идентификатор",-1),Z={class:"list-group-item d-flex justify-content-between align-items-start"},tt={class:"ms-2 me-auto"},st=e("div",{class:"fw-bold"},"Команда",-1),et={class:"list-group-item d-flex justify-content-between align-items-start"},lt={class:"ms-2 me-auto"},ot=e("div",{class:"fw-bold"},"Мнемоническое имя",-1),it={class:"list-group-item d-flex justify-content-between align-items-start"},at={class:"ms-2 me-auto"},nt=e("div",{class:"fw-bold"},"Пояснение",-1),dt={key:0,class:"list-group-item d-flex justify-content-between align-items-start"},ut={class:"ms-2 me-auto"},rt=e("div",{class:"fw-bold"},"Набор параметров скрипта",-1),ct={key:1,class:"list-group-item d-flex justify-content-between align-items-start"},ht=e("div",{class:"ms-2 me-auto"},[e("div",{class:"fw-bold"},"Привязана страница")],-1),mt=[ht],gt={key:2,class:"list-group-item d-flex justify-content-between align-items-start"},bt=e("div",{class:"ms-2 me-auto"},[e("div",{class:"fw-bold"},"Глобальный скрипт")],-1),ft=[bt],_t=["id"],pt={class:"modal-dialog modal-fullscreen"},St={class:"modal-content"},$t=e("div",{class:"modal-header"},[e("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"Редактор"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),kt={class:"modal-body py-3"},wt={props:["item","bot","selectMode"],data(){return{showMenu:!1,edit:!1,load:!1,simple:!0}},mounted(){},methods:{toggleMenu(){this.showMenu=!this.showMenu,this.simple=!0,this.edit=!1},switchEditor(){this.simple=!0,this.edit=!this.edit},switchSimple(){this.simple=!this.simple,this.edit=!1},selectCard(){this.$emit("select",this.item)},slugFormCallback(){this.load=!0,this.$emit("callback"),this.$nextTick(()=>{this.load=!1})},editSlug(){this.load=!0,this.$nextTick(()=>{this.load=!1})},selectSlug(){this.load=!0,this.$emit("select",this.item),this.$nextTick(()=>{this.load=!1})},duplicateSlug(){this.load=!0,this.$store.dispatch("duplicateSlug",{dataObject:{slugId:this.item.id}}).then(s=>{this.$notify({title:"Конструктор команд",text:"Команда успешно продублирована!",type:"success"}),this.$nextTick(()=>{this.load=!1})}).catch(s=>{this.$emit("callback"),this.$nextTick(()=>{this.load=!1})}),this.$emit("callback"),this.$nextTick(()=>{this.load=!1})},removeSlug(){this.load=!0,this.$store.dispatch("removeSlug",{dataObject:{slugId:this.item.id}}).then(s=>{this.$notify({title:"Конструктор команд",text:"Команда успешно удалена!",type:"success"}),this.$emit("callback"),this.$nextTick(()=>{this.load=!1})}).catch(s=>{this.$emit("callback"),this.$nextTick(()=>{this.load=!1})})}}},yt=Object.assign(wt,{__name:"Slug",setup(s){return(t,i)=>(l(),o(r,null,[e("div",B,[e("p",{onClick:i[0]||(i[0]=(...a)=>t.toggleMenu&&t.toggleMenu(...a)),class:"w-100 mb-0"},[t.showMenu?(l(),o("i",N)):(l(),o("i",I)),u(" "+d(s.item.command||"Нет команды"),1)]),t.showMenu?(l(),o(r,{key:0},[e("a",{"data-bs-toggle":"modal","data-bs-target":"#slug-modal-editor-"+s.item.id,href:"javascript:void(0)",title:"Редактировать команду",style:{width:"auto"},class:"btn btn-outline-light text-primary mr-2"},[t.edit?(l(),o("i",E)):(l(),o("i",D))],8,q),e("a",{href:"javascript:void(0)",onClick:i[1]||(i[1]=(...a)=>t.switchSimple&&t.switchSimple(...a)),class:"btn btn-outline-light text-primary mr-2"},[t.simple?(l(),o("i",U)):(l(),o("i",H))]),e("a",{href:"javascript:void(0)",title:"Дублировать команду",class:"btn btn-outline-light text-primary mr-2",onClick:i[2]||(i[2]=(...a)=>t.duplicateSlug&&t.duplicateSlug(...a))},K),e("a",{href:"javascript:void(0)",title:"Дублировать команду",class:"btn btn-outline-light text-primary mr-2",onClick:i[3]||(i[3]=(...a)=>t.removeSlug&&t.removeSlug(...a))},z)],64)):n("",!0),t.simple?n("",!0):(l(),o("ol",Q,[e("li",R,[e("div",W,[X,u(" №"+d(s.item.id||"Нет идентификатора"),1)])]),e("li",Z,[e("div",tt,[st,u(" "+d(s.item.command||"Нет команды"),1)])]),e("li",et,[e("div",lt,[ot,u(" "+d(s.item.slug||"Slug"),1)])]),e("li",it,[e("div",at,[nt,u(" "+d(s.item.comment||"Пояснение не указано"),1)])]),s.item.config?(l(),o("li",dt,[e("div",ut,[rt,s.item.config?(l(!0),o(r,{key:0},g(s.item.config,a=>(l(),o("p",null,[e("strong",null,d(a.key||"Ключ не найден")+":",1),u(d(a.value||"Не указано"),1)]))),256)):n("",!0)])])):n("",!0),s.item.page?(l(),o("li",ct,mt)):n("",!0),s.item.is_global?(l(),o("li",gt,ft)):n("",!0)]))]),e("div",{class:"modal fade",id:"slug-modal-editor-"+s.item.id,tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},[e("div",pt,[e("div",St,[$t,e("div",kt,[t.load?n("",!0):(l(),c(w,{key:0,item:s.item,onCallback:t.slugFormCallback},null,8,["item","onCallback"]))])])])],8,_t)],64))}}),vt={key:0},Ft=e("i",{class:"fa-solid fa-scroll"},null,-1),Ct={key:1},jt=e("i",{class:"fa-regular fa-square-minus"},null,-1),Ot={key:0,class:"mb-2"},Lt={class:"form-floating mb-2"},At=e("label",{for:"floatingInput"},"Быстрый поиск команды",-1),Mt={class:"form-check"},Tt={class:"form-check-label",for:"need_global"},Pt={key:0},Gt={key:1},Vt={class:"mb-0"},xt={class:"mb-3"},Bt={key:2,class:"mb-3"},Nt=e("div",{class:"alert alert-light",role:"alert"}," У Вас еще нет добавленных скриптов! ",-1),It=[Nt],qt={props:["command","bot"],data(){return{need_global:!0,show:!1,slugs:[],paginate:null,ownSearch:null,slugForm:{command:null,comment:null,slug:null}}},watch:{need_global:function(s,t){this.loadSlugs()}},computed:{...b(["getSlugs","getSlugsPaginateObject"]),filteredSlugs(){return this.slugs.length===0?[]:this.ownSearch==null?this.slugs:this.slugs.filter(s=>{let t=s.slug||"",i=s.command||"",a=s.comment||"";return i.toLowerCase().indexOf(this.ownSearch.toLowerCase())!==-1||a.toLowerCase().indexOf(this.ownSearch.toLowerCase())!==-1||t.toLowerCase().indexOf(this.ownSearch.toLowerCase())!==-1})}},mounted(){this.loadSlugs(),this.command&&this.$nextTick(()=>{this.slugForm.command=this.command})},methods:{nextSlugs(s){this.loadSlugs(s)},loadSlugs(s){this.$store.dispatch("loadSlugs",{dataObject:{needGlobal:this.need_global},page:s}).then(t=>{this.slugs=this.getSlugs,this.paginate=this.getSlugsPaginateObject})},callbackSlugs(){this.loadSlugs()},selectSlug(s){this.$emit("select",s)},loadAllSlugs(){this.$store.dispatch("loadAllSlugs").then(s=>{this.allSlugs=s.data})},addSlug(s){}}},Dt=Object.assign(qt,{__name:"BotSlugList",setup(s){return(t,i)=>(l(),o(r,null,[e("button",{type:"button",onClick:i[0]||(i[0]=a=>t.show=!t.show),class:"btn btn-outline-light text-primary mb-2 w-100"},[t.show?(l(),o("span",Ct,[jt,u(" Свернуть форму добавления")])):(l(),o("span",vt,[Ft,u(" Добавить глобальный скрипт")]))]),t.show?(l(),o("div",Ot,[s.bot?(l(),c(x,{key:0,"can-add":!0,bot:s.bot,onCallback:t.loadSlugs},null,8,["bot","onCallback"])):n("",!0)])):n("",!0),e("div",Lt,[At,m(e("input",{type:"search","onUpdate:modelValue":i[1]||(i[1]=a=>t.ownSearch=a),class:"form-control",id:"floatingInput",placeholder:"Название команды"},null,512),[[f,t.ownSearch]])]),e("div",Mt,[m(e("input",{class:"form-check-input","onUpdate:modelValue":i[2]||(i[2]=a=>t.need_global=a),type:"checkbox",id:"need_global"},null,512),[[$,t.need_global]]),e("label",Tt,[t.need_global?(l(),o("span",Pt,"Глобальные")):(l(),o("span",Gt,"Локальные"))])]),t.slugs&&s.bot?(l(!0),o(r,{key:1},g(t.filteredSlugs,(a,p)=>(l(),o("div",Vt,[k(yt,{item:a,bot:s.bot,onCallback:t.callbackSlugs,onSelect:t.selectSlug},null,8,["item","bot","onCallback","onSelect"])]))),256)):n("",!0),e("div",xt,[t.paginate?(l(),c(_,{key:0,simple:!0,onPagination_page:t.nextSlugs,pagination:t.paginate},null,8,["onPagination_page","pagination"])):n("",!0)]),t.filteredSlugs.length===0?(l(),o("div",Bt,It)):n("",!0)],64))}}),Et={class:"container py-3"},Ut={class:"row"},Ht={class:"col-12"},Jt={data(){return{load:!1,bot:null}},mounted(){this.loadBotAdminConfig()},methods:{loadBotAdminConfig(){this.$store.dispatch("loadBotAdminConfig").then(s=>{this.bot=s.data})}}},Zt=Object.assign(Jt,{__name:"Slugs",setup(s){return(t,i)=>(l(),o("div",Et,[e("div",Ut,[e("div",Ht,[t.load?n("",!0):(l(),c(Dt,{key:0,bot:t.bot},null,8,["bot"]))])])]))}});export{Zt as default};
