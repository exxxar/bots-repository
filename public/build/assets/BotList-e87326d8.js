import{_ as W,a as I,b as ce,c as E,d as Ye,e as We,f as Ze}from"./MailingTable-51b593a7.js";import{R as P,q as l,t as i,v as e,B as b,O as y,D as m,H as c,J as _,F as g,C as $,y as u,A as r,T as k,P as S,M as H,G as C,x as p,K as v,L as T,z as Fe,u as j,Y as B,S as q,k as Xe,g as se,o as xe,a8 as et,Z as tt,a9 as st,aa as ue,a7 as ot}from"./index.es-eef44641.js";import"./SlugForm-30aab417.js";import{V as we,T as Ce}from"./TelegramChannelHelper-2f9bd8d0.js";import{_ as U,B as le}from"./BotMediaList-1f0d9b99.js";import{P as V}from"./Pagination-b98a644c.js";import{_ as ae}from"./GlobalSlugList-a59b42dc.js";import{_ as X,g as Se,a as K,c as N,d as M,s as R,e as je,f as Ve,b as lt}from"./vue3-charts.esm-246c76d8.js";import{_ as it}from"./BotForm-32b5fd44.js";import{_ as A}from"./_plugin-vue_export-helper-c27b6911.js";/* empty css                                                 */import{K as x}from"./main-b405d532.js";import{v as nt}from"./v4-4a60fe23.js";const at={class:"row"},dt={class:"col-12 mb-3"},rt={class:"form-label",id:"service-title"},ct=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),ut=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),mt={class:"col-12 mb-3"},ht={key:0},_t=["onClick"],pt={class:"form-label",id:"service-category"},bt=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),ft=e("div",null,"Категория услуги (используется для группировки) ",-1),gt=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),yt={class:"col-12 mb-3"},vt={class:"form-label",id:"service-description"},$t=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),kt=e("div",null," Краткая информация об оказываемой услуге ",-1),Ft=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),wt={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},Ct={class:"col-12 col-md-6 mb-3"},St={class:"form-label",id:"service-title"},jt=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Vt=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),qt={class:"col-12 col-md-6 mb-3"},zt={class:"form-label",id:"service-title"},Pt=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Ut=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),At={class:"col-12 mb-3"},Ot={class:"form-check"},It=e("label",{class:"form-check-label",for:"need_images"}," Необходимо добавить изображения к сервиус ",-1),Qt={key:0,class:"col-12 mb-3"},Tt={class:"form-label",id:"service-images"},Bt=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Mt=e("div",null," Изображение, которое видит пользователь при выборе услуги ",-1),Rt=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Dt={class:"col-12 mb-3"},Et={class:"form-check"},Lt=e("label",{class:"form-check-label",for:"need_prepayment"}," Необходима предоплата ",-1),Kt={class:"row"},Nt={class:"col-12"},Jt={type:"submit",class:"btn btn-outline-success w-100 p-3"},Ht={key:0},Gt={key:1},Yt={props:["eventId","bot","service"],data(){return{load:!1,need_reset:!1,need_images:!1,categories:[],serviceForm:{id:null,title:null,appointment_event_id:null,description:null,category:null,images:[],need_prepayment:!1,price:0,discount_price:0}}},watch:{serviceForm:{handler(s){this.need_reset=!0},deep:!0}},mounted(){this.loadAppointmentServiceCategories(),console.log("Service form",this.service),this.service&&this.$nextTick(()=>{this.serviceForm={id:this.service.id||null,appointment_event_id:this.service.appointment_event_id||null,title:this.service.title||null,category:this.service.category||null,description:this.service.description||null,images:this.service.images||[],need_prepayment:this.service.need_prepayment||!1,price:this.service.price||0,discount_price:this.service.discount_price||0}})},methods:{loadAppointmentServiceCategories(){this.$store.dispatch("loadAppointmentServiceCategories",{dataObject:{bot_id:this.bot.id||null,event_id:this.eventId||null}}).then(s=>{this.categories=s})},selectPhotos(s){this.serviceForm.images||(this.serviceForm.images=[]);let t=this.serviceForm.images.indexOf(s.file_id);t!==-1?this.serviceForm.images.splice(t,1):this.serviceForm.images.push(s.file_id)},resetForm(){},submitForm(){let s=new FormData;Object.keys(this.serviceForm).forEach(t=>{const o=this.serviceForm[t]||"";typeof o=="object"?s.append(t,JSON.stringify(o)):s.append(t,o)}),s.append("bot_id",this.bot.id),s.append("appointment_event_id",this.eventId),this.$store.dispatch(this.serviceForm.id===null?"addAppointmentService":"updateAppointmentService",{appointmentServiceForm:s}).then(t=>{this.$emit("callback",t.data),this.$notify("Услуги успешно создано")}).catch(t=>{this.$notify("Услуги создания события")})}}},Wt=Object.assign(Yt,{__name:"AppointmentServiceForm",setup(s){return(t,o)=>{const a=P("Popper");return l(),i("form",{onSubmit:o[7]||(o[7]=S((...n)=>t.submitForm&&t.submitForm(...n),["prevent"]))},[e("div",at,[e("div",dt,[e("label",rt,[b(a,{content:"Название оказываемой услуги"},{default:y(()=>[ct]),_:1}),m(" Название услуги "),ut]),c(e("input",{type:"text",class:"form-control",placeholder:"Название","aria-label":"Название","onUpdate:modelValue":o[0]||(o[0]=n=>t.serviceForm.title=n),maxlength:"255","aria-describedby":"service-title",required:""},null,512),[[_,t.serviceForm.title]])]),e("div",mt,[t.categories?(l(),i("p",ht,[m(" Ранее созданные категории: "),(l(!0),i(g,null,$(t.categories,n=>(l(),i("span",{onClick:d=>t.serviceForm.category=n,class:"badge bg-primary mr-1 cursor-pointer"},u(n),9,_t))),256))])):r("",!0),e("label",pt,[b(a,null,{content:y(()=>[ft]),default:y(()=>[bt]),_:1}),m(" Категория услуги "),gt]),c(e("input",{type:"text",class:"form-control",placeholder:"Категория услуги","aria-label":"Категория услуги","onUpdate:modelValue":o[1]||(o[1]=n=>t.serviceForm.category=n),maxlength:"255","aria-describedby":"service-category",required:""},null,512),[[_,t.serviceForm.category]])]),e("div",yt,[e("label",vt,[b(a,null,{content:y(()=>[kt]),default:y(()=>[$t]),_:1}),m(" Описание услуги "),Ft,t.serviceForm.description?(l(),i("small",wt," Длина текста "+u(t.serviceForm.description.length)+" / 255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Описание услуги","aria-label":"Описание услуги",maxlength:"255","onUpdate:modelValue":o[2]||(o[2]=n=>t.serviceForm.description=n),"aria-describedby":"service-description",required:""},`
                    `,512),[[_,t.serviceForm.description]])]),e("div",Ct,[e("label",St,[b(a,{content:"Цена оказываемой услуги"},{default:y(()=>[jt]),_:1}),m(" Цена услуги, руб "),Vt]),c(e("input",{type:"number",class:"form-control",placeholder:"Цена","aria-label":"Цена",min:"0","onUpdate:modelValue":o[3]||(o[3]=n=>t.serviceForm.price=n),"aria-describedby":"price",required:""},null,512),[[_,t.serviceForm.price]])]),e("div",qt,[e("label",zt,[b(a,{content:"Цена скидки на оказываемую услугу"},{default:y(()=>[Pt]),_:1}),m(" Цена скидки на услугу, руб "),Ut]),c(e("input",{type:"number",class:"form-control",placeholder:"Цена","aria-label":"Цена",min:"0","onUpdate:modelValue":o[4]||(o[4]=n=>t.serviceForm.discount_price=n),"aria-describedby":"price",required:""},null,512),[[_,t.serviceForm.discount_price]])]),e("div",At,[e("div",Ot,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[5]||(o[5]=n=>t.need_images=n),type:"checkbox",id:"need_images"},null,512),[[k,t.need_images]]),It])]),t.need_images?(l(),i("div",Qt,[e("label",Tt,[b(a,null,{content:y(()=>[Mt]),default:y(()=>[Bt]),_:1}),m(" Изображение к услуге "),Rt]),b(U,{"need-photo":!0,selected:t.serviceForm.images,onSelect:t.selectPhotos},null,8,["selected","onSelect"])])):r("",!0),e("div",Dt,[e("div",Et,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[6]||(o[6]=n=>t.serviceForm.need_prepayment=n),type:"checkbox",id:"need_prepayment"},null,512),[[k,t.serviceForm.need_prepayment]]),Lt])])]),e("div",Kt,[e("div",Nt,[e("button",Jt,[t.serviceForm.id===null?(l(),i("span",Ht,"Создать услугу")):(l(),i("span",Gt,"Обновить услугу"))])])])],32)}}}),Zt={props:["modelValue","fieldId"],data(){return{link:null,linkModal:null,fontModal:null,relinkModal:null,reLinkForm:{url:null,text:null},expressions:[{expression:"{{userName}}",description:'<i class="fa-solid fa-signature mr-2"></i>Имя пользователя'},{expression:"{{level_1_percent}}",description:'<i class="fa-solid fa-1 mr-2"></i>Процент кэшбэка 1 уровня'},{expression:"{{level_2_percent}}",description:'<i class="fa-solid fa-2 mr-2"></i>Процент кэшбэка 2 уровня'},{expression:"{{level_3_percent}}",description:'<i class="fa-solid fa-3 mr-2"></i>Процент кэшбэка 3 уровня'},{expression:"{{cashback_fire_percent}}",description:'<i class="fa-solid fa-fire mr-2"></i>Процент сжигания кэшбэка'},{expression:"{{is_admin}}",description:'<i class="fa-solid fa-user-tie mr-2"></i>Статус администратора'},{expression:"{{is_work}}",description:'<i class="fa-solid fa-building mr-2"></i>Статус работника'},{expression:"{{is_vip}}",description:'<i class="fa-solid fa-crown mr-2"></i>Статус VIP'},{expression:"{{is_manager}}",description:'<i class="fa-solid fa-people-roof mr-2"></i>Статус менеджера'},{expression:"{{is_deliveryman}}",description:'<i class="fa-solid fa-truck-ramp-box mr-2"></i>Статус доставщика'},{expression:"{{sex}}",description:'<i class="fa-solid fa-venus-mars mr-2"></i>Пол клиента'},{expression:"{{friendsCount}}",description:'<i class="fa-solid fa-user-group mr-2"></i>Число друзей пользователя'},{expression:"{{cashback}}",description:'<i class="fa-solid fa-coins mr-2"></i>Сумма КэшБэк пользователя'},{expression:"{{telegramChatId}}",description:'<i class="fa-brands fa-telegram mr-2"></i>Идентификатор чата'},{expression:"{{referralLink}}",description:'<i class="fa-solid fa-link mr-2"></i>Реферальная ссылка'},{expression:"{{referralQr}}",description:'<i class="fa-solid fa-qrcode mr-2"></i>Реферальный QR-код'}]}},mounted(){[...document.querySelectorAll('[data-bs-toggle="tooltip"]')].map(t=>new bootstrap.Tooltip(t)),this.linkModal=new bootstrap.Modal(document.getElementById("link-enter-modal"),{}),this.fontModal=new bootstrap.Modal(document.getElementById("font-choose-modal"),{}),this.relinkModal=new bootstrap.Modal(document.getElementById("relink-modal"),{})},methods:{openReLinkModal(){this.relinkModal.show()},openFontModal(){this.fontModal.show()},reLinkSubmit(){this.$emit("submit-relink",this.reLinkForm),this.relinkModal.hide()},getFieldSelection(){let s=document.querySelector(this.fieldId).selectionStart||0,t=document.querySelector(this.fieldId).selectionEnd||0;return{start:s,end:t}},useTemplate(s,t){let o=this.getFieldSelection(),a=this.modelValue||"",n=a.slice(0,o.start);if(o.end-o.start>0&&o.end>0){let d=a.slice(o.start,o.end),h=a.slice(o.end);a=n+s+d+t+h,this.$emit("update:modelValue",a)}},boldTag(){this.useTemplate("<b>","</b>")},italic(){this.useTemplate("<i>","</i>")},underline(){this.useTemplate("<u>","</u>")},strike(){this.useTemplate("<s>","</s>")},code(){this.useTemplate("<code>","</code>")},spoiler(){this.useTemplate("<span class='tg-spoiler'>","</span>")},pre(){this.useTemplate("<pre>","</pre>")},blockquote(){this.useTemplate("<blockquote>","</blockquote>")},openLinkModal(){this.linkModal.show()},linkTag(){this.linkModal.hide();const s=this.link;this.useTemplate("<a href='"+s+"'>","</a>"),this.link=null},expressionsSelect(s){let t=this.getFieldSelection(),o=this.modelValue||"";o=o.slice(0,t.start)+s.expression+o.slice(t.start),this.$emit("update:modelValue",o)}}},Xt={class:"d-inline-flex"},xt=e("i",{class:"fa-solid fa-arrow-up-right-from-square"},null,-1),es=[xt],ts=e("i",{class:"fa-solid fa-font"},null,-1),ss=[ts],os=e("i",{class:"fa-solid fa-bold"},null,-1),ls=[os],is=e("i",{class:"fa-solid fa-italic"},null,-1),ns=[is],as=e("i",{class:"fa-solid fa-underline"},null,-1),ds=[as],rs=e("i",{class:"fa-solid fa-hand-dots"},null,-1),cs=[rs],us=e("i",{class:"fa-solid fa-strikethrough"},null,-1),ms=[us],hs=e("i",{class:"fa-solid fa-code"},null,-1),_s=[hs],ps=e("i",{class:"fa-solid fa-quote-left"},null,-1),bs=[ps],fs=e("i",{class:"fa-solid fa-link"},null,-1),gs=[fs],ys={class:"dropdown"},vs=e("button",{class:"btn btn-link dropdown-toggle",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-brands fa-hire-a-helper"})],-1),$s={class:"dropdown-menu item-with-text cursor-pointer text-muted p-2"},ks=["onClick"],Fs=["innerHTML"],ws=H('<div class="modal fade" id="font-choose-modal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-centered"><div class="modal-content"><div class="modal-body"><h6 class="fw-bold"><strong class="text-primary">Внимание!</strong> Откройте ссылку с генератором шрифтов, выберите шрифт, введите текст, а затем скопируйте полученный результат в поле ниже - текст с этим шрифтом будет отображен пользователю!</h6><a href="https://textgenerator.ru/" class="btn btn-link w-100 text-center" target="_blank"><i class="fa-solid fa-arrow-up-right-from-square"></i> Открыть генератор шрифтов</a></div></div></div></div>',1),Cs={class:"modal fade",id:"link-enter-modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},Ss={class:"modal-dialog modal-dialog-centered"},js={class:"modal-body"},Vs=e("div",{class:"alert alert-light mb-2"},[e("strong",{class:"fw-bold"},"Внимание!"),m(" Добавьте ссылку, на которую должен перейти пользователь! ")],-1),qs={class:"form-floating mb-2"},zs=e("label",{for:"floatingInput"},"Ссылка",-1),Ps=H('<div class="d-flex justify-content-center"><div class="p-2 w-100"><button type="button" class="btn btn-secondary w-100" data-bs-dismiss="modal">Отмена </button></div><div class="p-2 w-100"><button type="submit" class="btn btn-primary w-100">Сохранить </button></div></div>',1),Us={class:"modal fade",id:"relink-modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},As={class:"modal-dialog modal-dialog-centered"},Os={class:"modal-body"},Is=e("div",{class:"alert alert-light mb-2"},[e("strong",{class:"fw-bold"},"Внимание!"),m(" Вы создаете кнопку к тексту, по которой пользователь сможет поделиться ссылкой и текстом к ней! ")],-1),Qs={class:"form-floating mb-2"},Ts=e("label",{for:"floatingInput"},"Ссылка,url",-1),Bs={class:"form-floating"},Ms=e("label",{for:"floatingTextarea2"},"Текст к ссылке",-1),Rs=H('<div class="d-flex justify-content-center"><div class="p-2 w-100"><button type="button" class="btn btn-secondary w-100" data-bs-dismiss="modal">Отмена </button></div><div class="p-2 w-100"><button type="submit" class="btn btn-primary w-100">Сохранить </button></div></div>',1);function Ds(s,t,o,a,n,d){return l(),i(g,null,[e("div",Xt,[e("button",{type:"button",onClick:t[0]||(t[0]=(...h)=>d.openReLinkModal&&d.openReLinkModal(...h)),"data-bs-toggle":"tooltip","data-bs-title":"Добавить кнопку с пересылкой ссылки друзьям",class:"btn btn-link"},es),e("button",{type:"button",onClick:t[1]||(t[1]=(...h)=>d.openFontModal&&d.openFontModal(...h)),"data-bs-toggle":"tooltip","data-bs-title":"Настройка шрифта",class:"btn btn-link"},ss),e("button",{type:"button",onClick:t[2]||(t[2]=(...h)=>d.boldTag&&d.boldTag(...h)),"data-bs-toggle":"tooltip","data-bs-title":"Жирный текст",class:"btn btn-link"},ls),e("button",{type:"button",onClick:t[3]||(t[3]=(...h)=>d.italic&&d.italic(...h)),"data-bs-toggle":"tooltip","data-bs-title":"Курсив",class:"btn btn-link"},ns),e("button",{type:"button",onClick:t[4]||(t[4]=(...h)=>d.underline&&d.underline(...h)),"data-bs-toggle":"tooltip","data-bs-title":"Подчеркнутый текст",class:"btn btn-link"},ds),e("button",{type:"button",onClick:t[5]||(t[5]=(...h)=>d.spoiler&&d.spoiler(...h)),"data-bs-toggle":"tooltip","data-bs-title":"Скрытый текст",class:"btn btn-link"},cs),e("button",{type:"button",onClick:t[6]||(t[6]=(...h)=>d.strike&&d.strike(...h)),"data-bs-toggle":"tooltip","data-bs-title":"Зачеркнутый текст",class:"btn btn-link"},ms),e("button",{type:"button",onClick:t[7]||(t[7]=(...h)=>d.code&&d.code(...h)),"data-bs-toggle":"tooltip","data-bs-title":"Фрагмент кода",class:"btn btn-link"},_s),e("button",{type:"button",onClick:t[8]||(t[8]=(...h)=>d.blockquote&&d.blockquote(...h)),"data-bs-toggle":"tooltip","data-bs-title":"Цитата",class:"btn btn-link"},bs),e("button",{type:"button",onClick:t[9]||(t[9]=(...h)=>d.openLinkModal&&d.openLinkModal(...h)),"data-bs-toggle":"tooltip","data-bs-title":"Ссылка",class:"btn btn-link"},gs),e("div",ys,[vs,e("div",$s,[(l(!0),i(g,null,$(n.expressions,h=>(l(),i("li",{onClick:f=>d.expressionsSelect(h)},[e("a",{class:"dropdown-item",href:"javascript:void(0)",innerHTML:h.description},null,8,Fs)],8,ks))),256))])])]),ws,e("div",Cs,[e("div",Ss,[e("form",{class:"modal-content",onSubmit:t[11]||(t[11]=S((...h)=>d.linkTag&&d.linkTag(...h),["prevent"]))},[e("div",js,[Vs,e("div",qs,[c(e("input",{type:"text","onUpdate:modelValue":t[10]||(t[10]=h=>n.link=h),class:"form-control",id:"floatingInput",placeholder:"name@example.com",required:""},null,512),[[_,n.link]]),zs]),Ps])],32)])]),e("div",Us,[e("div",As,[e("form",{class:"modal-content",onSubmit:t[14]||(t[14]=S((...h)=>d.reLinkSubmit&&d.reLinkSubmit(...h),["prevent"]))},[e("div",Os,[Is,e("div",Qs,[c(e("input",{type:"url","onUpdate:modelValue":t[12]||(t[12]=h=>n.reLinkForm.url=h),class:"form-control",id:"floatingInput",placeholder:"name@example.com",required:""},null,512),[[_,n.reLinkForm.url]]),Ts]),e("div",Bs,[c(e("textarea",{class:"form-control","onUpdate:modelValue":t[13]||(t[13]=h=>n.reLinkForm.text=h),placeholder:"Leave a comment here",id:"floatingTextarea2",style:{"min-height":"100px"},required:""},null,512),[[_,n.reLinkForm.text]]),Ms]),Rs])],32)])])],64)}const Es=A(Zt,[["render",Ds]]),Ls={key:0,class:"row"},Ks={class:"col-12"},Ns={class:"form-floating mb-3"},Js=e("label",{for:"floatingInput"},"Быстрый поиск команды",-1),Hs={class:"col-12 mb-2"},Gs={class:"form-check"},Ys={class:"form-check-label",for:"need_global"},Ws={key:0},Zs={key:1},Xs={class:"form-check"},xs=e("label",{class:"form-check-label",for:"need_show_deleted"}," Удаленные ",-1),eo={key:0,class:"mb-3 col-12 col-sm-12"},to={class:"table"},so=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"#"),e("th",{scope:"col"},"Команда"),e("th",{scope:"col"},"Пояснение")])],-1),oo=["onClick"],lo={key:2,class:"mb-3 col-md-12"},io=e("div",{class:"alert alert-danger",role:"alert"}," У Вас еще нет добавленных скриптов! ",-1),no=[io],ao={props:["command","canSelect"],data(){return{bot:null,load:!1,need_global:!0,need_show_deleted:!0,slugs:[],ownSearch:null,paginate:[]}},watch:{ownSearch:function(s,t){this.loadSlugs()},need_global:function(s,t){this.loadSlugs()},need_show_deleted:function(s,t){this.loadSlugs()}},computed:{...C(["getCurrentBot","getSlugs","getSlugsPaginateObject"])},mounted(){this.loadCurrentBot().then(()=>{this.loadSlugs()})},methods:{nextSlugs(s){this.loadSlugs(s)},loadSlugs(s=0){return this.$store.dispatch("loadSlugs",{dataObject:{botId:this.bot.id,needGlobal:this.need_global,needDeleted:this.need_show_deleted,search:this.ownSearch},page:s}).then(t=>{this.slugs=this.getSlugs,this.paginate=this.getSlugsPaginateObject})},loadCurrentBot(s=null){return this.$store.dispatch("updateCurrentBot",{bot:s}).then(()=>{this.bot=this.getCurrentBot})},callbackSlugs(){this.loadSlugs()},selectSlug(s){this.$emit("select",s)}}},ro=Object.assign(ao,{__name:"BotSlugSimpleTableList",setup(s){return(t,o)=>t.bot?(l(),i("div",Ls,[e("div",Ks,[e("div",Ns,[c(e("input",{type:"search","onUpdate:modelValue":o[0]||(o[0]=a=>t.ownSearch=a),class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,512),[[_,t.ownSearch]]),Js])]),e("div",Hs,[e("div",Gs,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[1]||(o[1]=a=>t.need_global=a),type:"checkbox",id:"need_global"},null,512),[[k,t.need_global]]),e("label",Ys,[t.need_global?(l(),i("span",Ws,"Глобальные")):(l(),i("span",Zs,"Локальные"))])]),e("div",Xs,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[2]||(o[2]=a=>t.need_show_deleted=a),type:"checkbox",id:"need_show_deleted"},null,512),[[k,t.need_show_deleted]]),xs])]),t.slugs?(l(),i("div",eo,[e("table",to,[so,e("tbody",null,[(l(!0),i(g,null,$(t.slugs,(a,n)=>(l(),i("tr",{class:p({"border-info":a.deleted_at==null,"border-danger":a.deleted_at!=null})},[e("th",{scope:"row",class:p({"text-danger":a.deleted_at!=null})},u(a.id||"Нет идентификатора"),3),e("td",{onClick:d=>t.selectSlug(a),class:p({"text-danger":a.deleted_at!=null})},u(a.command||"Нет команды"),11,oo),e("td",{class:p({"text-danger":a.deleted_at!=null})},u(a.comment||"Пояснение не указано"),3)],2))),256))])])])):r("",!0),t.paginate?(l(),v(V,{key:1,onPagination_page:t.nextSlugs,pagination:t.paginate},null,8,["onPagination_page","pagination"])):r("",!0),t.slugs.length===0?(l(),i("div",lo,no)):r("",!0)])):r("",!0)}}),co={class:"form-floating mb-3"},uo=e("label",{for:"floatingInput"},"Команда",-1),mo={class:"form-floating mb-3"},ho=e("label",{for:"floatingInput"},"Мнемоническое имя",-1),_o={class:"form-floating mb-3"},po=e("label",{for:"floatingInput"},"Описание скрипта",-1),bo=e("h6",null," Параметры скрипта ",-1),fo=e("div",{class:"alert alert-info",role:"alert"}," Данные параметры используются для настройки скриптов на стороне сервера ",-1),go={class:"dropdown"},yo=e("button",{class:"btn btn-outline-info w-100 dropdown-toggle mb-2",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"}," Добавить ",-1),vo={class:"dropdown-menu w-100"},$o=["onClick"],ko={class:"row"},Fo={class:"col-12"},wo=["onClick"],Co=e("p",null,"Вы можете подгрузить отсутствующие параметры конфигурации",-1),So=e("i",{class:"fa-solid fa-rotate mr-2"},null,-1),jo={key:0,class:"row"},Vo={class:"col-12"},qo={class:"table"},zo=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"Ключ"),e("th",{scope:"col"},"Значение")])],-1),Po={colspan:"2"},Uo={class:"w-100 d-flex align-items-center justify-content-between"},Ao={class:"dropdown mr-2"},Oo=e("button",{class:"btn btn-outline-primary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-bars"})],-1),Io={class:"dropdown-menu"},Qo=["onClick"],To=e("i",{class:"fa-solid fa-trash-can"},null,-1),Bo=["onClick"],Mo=e("i",{class:"fa-solid fa-caret-left"},null,-1),Ro=["onClick"],Do=e("i",{class:"fa-solid fa-caret-right"},null,-1),Eo=["innerHTML"],Lo={key:1,class:"mb-0 font-bold"},Ko={class:"dropdown"},No={class:"btn btn-outline-primary dropdown-toggle w-100 d-flex justify-content-between align-items-center",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},Jo={class:"dropdown-menu"},Ho=["onClick"],Go={style:{width:"300px"}},Yo={class:"form-floating"},Wo=["onUpdate:modelValue","id"],Zo=["for"],Xo={key:0,class:"form-floating"},xo=["id","onUpdate:modelValue"],el=["for"],tl={key:1,class:"form-check"},sl=["onUpdate:modelValue","id"],ol=["for"],ll={key:2,class:"form-floating"},il=["onUpdate:modelValue","id"],nl=["for"],al=["onClick"],dl={key:0,class:"fa-solid fa-eye mr-2"},rl={key:1,class:"fa-solid fa-eye-slash mr-2"},cl={key:2},ul={key:3},ml=["onClick"],hl={key:0,class:"fa-solid fa-eye mr-2"},_l={key:1,class:"fa-solid fa-eye-slash mr-2"},pl={key:2},bl={key:3},fl={key:5,class:"form-floating"},gl=["onUpdate:modelValue","id"],yl=["for"],vl=["onClick"],$l={key:0,class:"fa-solid fa-eye mr-2"},kl={key:1,class:"fa-solid fa-eye-slash mr-2"},Fl={key:2},wl={key:3},Cl={key:7,class:"form-check"},Sl=["onUpdate:modelValue","id"],jl=["for"],Vl={key:8,class:"form-floating"},ql=["id","onUpdate:modelValue"],zl=["for"],Pl=["onClick"],Ul={key:0,class:"fa-solid fa-eye mr-2"},Al={key:1,class:"fa-solid fa-eye-slash mr-2"},Ol={key:2},Il={key:3},Ql={colspan:"2"},Tl={key:0,class:"form-floating mb-3"},Bl=["id","onUpdate:modelValue"],Ml=["for"],Rl={key:1,class:"form-floating"},Dl=e("label",{class:"form-label",id:"bot-domain"},"JSON-код",-1),El={key:2,class:"form-floating"},Ll=["onUpdate:modelValue","id"],Kl=["for"],Nl={key:3,class:"form-floating"},Jl=["onUpdate:modelValue","id"],Hl=["for"],Gl={key:1,class:"row"},Yl=e("div",{class:"col-12"},[e("p",null,"Параметры скрипта еще не добавлены")],-1),Wl=[Yl],Zl={class:"btn btn-primary text-white w-100 mt-2 p-3"},Xl={key:0},xl={key:1},ei={props:["item"],components:{Vue3JsonEditor:we},data(){return{filters:[],simple:!0,configTypes:[{title:"Текстовый или числовой параметр",type:"text"},{title:"Большое текстовое поле",type:"large-text"},{title:"Канал обратной связи",type:"channel"},{title:"Логический оператор",type:"boolean"},{title:"Ссылка на изображение",type:"image"},{title:"Цвет",type:"color"},{title:"Geo",type:"geo"},{title:"Номер телефона",type:"phone"},{title:"ID скрипта",type:"script"},{title:"ID страницы",type:"page"},{title:"JSON",type:"json"}],bot:null,photos:[],slugForm:{bot_id:null,id:null,command:null,comment:null,slug:null,parent_id:null,config:[],is_global:!0}}},computed:{...C(["getCurrentBot"]),filteredConfigs(){return this.filters.length==0?this.slugForm.config:this.slugForm.config.filter(s=>this.filters.indexOf(s.type)>=0)}},mounted(){this.loadCurrentBot(),this.item&&(this.slugForm.id=this.item.id||null,this.slugForm.command=this.item.command,this.slugForm.comment=this.item.comment,this.slugForm.bot_id=this.item.bot_id,this.slugForm.slug=this.item.slug,this.slugForm.parent_id=this.item.parent_id||null,this.slugForm.config=this.item.config||[],this.slugForm.is_global=this.item.is_global||!1)},methods:{loadSlugParentParams(){this.$store.dispatch("loadSlugParams",{parentSlugId:this.slugForm.parent_id?this.slugForm.parent_id:this.slugForm.id}).then(s=>{let t=s.config,o=0;t.forEach(a=>{this.slugForm.config.findIndex(d=>d.key===a.key)===-1&&(o++,this.slugForm.config.unshift(a))}),this.$notify({title:"Конструктор команд",text:`Параметры успешно подгружены: Обновлено ${o} параметров`,type:"success"})})},toggleFilter(s){let t=this.filters.indexOf(s);t>=0?this.filters.splice(t,1):this.filters.push(s)},addTextTo(s,t={text:null}){this.slugForm.config[s].value=t.text},loadCurrentBot(s=null){return this.$store.dispatch("updateCurrentBot",{bot:s}).then(()=>{this.bot=this.getCurrentBot})},submit(){let s=new FormData;Object.keys(this.slugForm).forEach(t=>{const o=this.slugForm[t]||"";typeof o=="object"?s.append(t,JSON.stringify(o)):s.append(t,o)}),this.$store.dispatch(this.slugForm.id===null?"createSlug":"updateSlug",{slugForm:s}).then(t=>{this.$notify({title:"Конструктор команд",text:"Команда успешно обновлена",type:"success"}),this.slugForm.id===null&&(this.slugForm.id=null,this.slugForm.command=null,this.slugForm.comment=null,this.slugForm.bot_id=null,this.slugForm.slug=null,this.slugForm.config=[],this.slugForm.is_global=!0),this.$emit("callback")}).catch(t=>{})},onJsonChange(s,t){this.filteredConfigs[t].value=s},addConfig(s){this.slugForm.config.splice(0,0,{key:null,value:null,type:s||"text"})},move(s,t=0){let o=this.slugForm.config[s],a=this.slugForm.config.length||0,n=t===0?s-1>=0?s-1:a-1:s<a-1?s+1:0;this.slugForm.config[s]=this.slugForm.config[n],this.slugForm.config[n]=o},removeConfigItem(s){try{this.slugForm.config.splice(s,1)}catch{this.slugForm.config=[]}},selectSlug(s,t){this.filteredConfigs[t].value=s.id},selectPhoto(s,t){this.filteredConfigs[t].value=s.file_id}}},qe=Object.assign(ei,{__name:"SlugTableForm",setup(s){return(t,o)=>{const a=T("mask");return l(),i("form",{onSubmit:o[4]||(o[4]=S((...n)=>t.submit&&t.submit(...n),["prevent"]))},[e("div",co,[c(e("input",{type:"text","onUpdate:modelValue":o[0]||(o[0]=n=>t.slugForm.command=n),class:"form-control",id:"floatingInput",placeholder:"name@example.com",required:""},null,512),[[_,t.slugForm.command]]),uo]),e("div",mo,[c(e("input",{type:"text","onUpdate:modelValue":o[1]||(o[1]=n=>t.slugForm.slug=n),class:"form-control",id:"floatingInput",placeholder:"name@example.com",required:""},null,512),[[_,t.slugForm.slug]]),ho]),e("div",_o,[c(e("input",{type:"text","onUpdate:modelValue":o[2]||(o[2]=n=>t.slugForm.comment=n),class:"form-control",id:"floatingInput",placeholder:"name@example.com",required:""},null,512),[[_,t.slugForm.comment]]),po]),bo,fo,e("div",go,[yo,e("ul",vo,[(l(!0),i(g,null,$(t.configTypes,(n,d)=>(l(),i("li",null,[e("a",{class:"dropdown-item",onClick:h=>t.addConfig(n.type)},u(n.title||"Не установлен"),9,$o)]))),256))])]),e("div",ko,[e("div",Fo,[e("p",null,[m("Фильтры: "),(l(!0),i(g,null,$(t.configTypes,(n,d)=>(l(),i("span",{class:p(["badge mb-1 bg-gray-100 cursor-pointer mr-1",{"bg-info":t.filters.indexOf(n.type)>=0}]),onClick:h=>t.toggleFilter(n.type)},u(n.type),11,wo))),256))]),Co,e("button",{type:"button",onClick:o[3]||(o[3]=(...n)=>t.loadSlugParentParams&&t.loadSlugParentParams(...n)),class:"btn btn-outline-info"},[So,m("Загрузить ")])])]),t.filteredConfigs.length>0?(l(),i("div",jo,[e("div",Vo,[e("table",qo,[zo,e("tbody",null,[(l(!0),i(g,null,$(t.filteredConfigs,(n,d)=>(l(),i(g,null,[e("tr",{class:p({"table-light":d%2===0})},[e("td",Po,[e("div",Uo,[e("div",Ao,[Oo,e("ul",Io,[e("li",null,[e("a",{class:"dropdown-item",onClick:h=>t.removeConfigItem(d),href:"javascript:void(0)"},[To,m(" Удалить")],8,Qo)]),e("li",null,[e("a",{class:"dropdown-item",onClick:h=>t.move(d,0),href:"javascript:void(0)"},[Mo,m(" Вверх")],8,Bo)]),e("li",null,[e("a",{class:"dropdown-item",onClick:h=>t.move(d,1),href:"javascript:void(0)"},[Do,m(" Вниз")],8,Ro)])])]),t.filteredConfigs[d].description?(l(),i("p",{key:0,class:"mb-0 font-italic font-bold",innerHTML:t.filteredConfigs[d].description},null,8,Eo)):(l(),i("p",Lo,"без описания")),e("div",Ko,[e("button",No,u(t.filteredConfigs[d].type),1),e("ul",Jo,[(l(!0),i(g,null,$(t.configTypes,h=>(l(),i("li",null,[e("a",{class:"dropdown-item",onClick:f=>t.filteredConfigs[d].type=h.type},u(h.title||n.type),9,Ho)]))),256))])])])])],2),e("tr",{class:p({"table-light":d%2===0})},[e("td",Go,[e("div",Yo,[c(e("input",{type:"text",class:"form-control","onUpdate:modelValue":h=>t.filteredConfigs[d].key=h,id:"field-input-key-"+d,placeholder:"name@example.com"},null,8,Wo),[[_,t.filteredConfigs[d].key]]),e("label",{for:"field-input-key-"+d},"Ключ",8,Zo)])]),e("td",null,[t.filteredConfigs[d].type==="text"||t.filteredConfigs[d].type==="channel"?(l(),i("div",Xo,[c(e("input",{type:"text",class:"form-control",id:"field-input-"+d,"onUpdate:modelValue":h=>t.filteredConfigs[d].value=h,placeholder:"name@example.com"},null,8,xo),[[_,t.filteredConfigs[d].value]]),e("label",{for:"field-input-"+d},"Значение",8,el)])):r("",!0),t.filteredConfigs[d].type==="boolean"?(l(),i("div",tl,[c(e("input",{class:"form-check-input","onUpdate:modelValue":h=>t.filteredConfigs[d].value=h,type:"checkbox",value:"false",id:"filtered-config-"+d+"-checkbox"},null,8,sl),[[k,t.filteredConfigs[d].value]]),e("label",{class:"form-check-label",for:"filtered-config-"+d+"-checkbox"},u(t.filteredConfigs[d].value?"Включено":"Выключено"),9,ol)])):r("",!0),t.filteredConfigs[d].type==="geo"?(l(),i("div",ll,[c(e("input",{class:"form-control",placeholder:"##.######,##.######","onUpdate:modelValue":h=>t.filteredConfigs[d].value=h,type:"text",id:"filtered-config-"+d+"-geo"},null,8,il),[[a,"##.######,##.######"],[_,t.filteredConfigs[d].value]]),e("label",{for:"filtered-config-"+d+"-geo"},"Значение",8,nl)])):r("",!0),t.filteredConfigs[d].type==="script"?(l(),i("button",{key:3,type:"button",class:"btn btn-outline-light text-primary w-100 py-3",onClick:h=>n.content_show=!n.content_show},[n.content_show?(l(),i("i",rl)):(l(),i("i",dl)),n.content_show?(l(),i("span",ul,"Скрыть выбор скриптов")):(l(),i("span",cl,"Показать выбор скриптов"))],8,al)):r("",!0),t.filteredConfigs[d].type==="page"?(l(),i("button",{key:4,type:"button",class:"btn btn-outline-light text-primary w-100 py-3",onClick:h=>n.content_show=!n.content_show},[n.content_show?(l(),i("i",_l)):(l(),i("i",hl)),n.content_show?(l(),i("span",bl,"Скрыть выбор страницы")):(l(),i("span",pl,"Показать выбор страницы"))],8,ml)):r("",!0),t.filteredConfigs[d].type==="phone"?(l(),i("div",fl,[c(e("input",{class:"form-control",placeholder:"+7(###)###-##-##","onUpdate:modelValue":h=>t.filteredConfigs[d].value=h,type:"text",id:"filtered-config-"+d+"-phone"},null,8,gl),[[a,"+7(###)###-##-##"],[_,t.filteredConfigs[d].value]]),e("label",{for:"filtered-config-"+d+"-phone"},"Значение",8,yl)])):r("",!0),t.filteredConfigs[d].type==="json"?(l(),i("button",{key:6,type:"button",class:"btn btn-outline-light text-primary w-100 py-3",onClick:h=>n.content_show=!n.content_show},[n.content_show?(l(),i("i",kl)):(l(),i("i",$l)),n.content_show?(l(),i("span",wl,"Скрыть редактор JSON")):(l(),i("span",Fl,"Показать редактор JSON"))],8,vl)):r("",!0),t.filteredConfigs[d].type==="color"?(l(),i("div",Cl,[c(e("input",{class:"form-control","onUpdate:modelValue":h=>t.filteredConfigs[d].value=h,type:"color",id:"filtered-config-"+d+"-color"},null,8,Sl),[[_,t.filteredConfigs[d].value]]),e("label",{for:"filtered-config-"+d+"-color"},[e("p",{style:Fe({color:t.filteredConfigs[d].value})},"Цвет: "+u(t.filteredConfigs[d].value),5)],8,jl)])):r("",!0),t.filteredConfigs[d].type==="large-text"?(l(),i("div",Vl,[c(e("textarea",{class:"form-control",id:"field-input-"+d,"onUpdate:modelValue":h=>t.filteredConfigs[d].value=h,placeholder:"name@example.com"},`
                            `,8,ql),[[_,t.filteredConfigs[d].value]]),e("label",{for:"field-input-"+d},"Значение",8,zl)])):r("",!0),t.filteredConfigs[d].type==="image"?(l(),i("button",{key:9,type:"button",class:"btn btn-outline-light text-primary w-100 py-3",onClick:h=>n.content_show=!n.content_show},[n.content_show?(l(),i("i",Al)):(l(),i("i",Ul)),n.content_show?(l(),i("span",Il,"Скрыть выбор изображений")):(l(),i("span",Ol,"Показать выбор изображений"))],8,Pl)):r("",!0)])],2),n.content_show?(l(),i("tr",{key:0,class:p({"table-light":d%2===0})},[e("td",Ql,[t.filteredConfigs[d].type==="image"?(l(),i("div",Tl,[c(e("input",{class:"form-control mb-2",id:"field-input-"+d,type:"text",disabled:"true","onUpdate:modelValue":h=>t.filteredConfigs[d].value=h,placeholder:"name@example.com"},null,8,Bl),[[_,t.filteredConfigs[d].value]]),e("label",{for:"field-input-"+d},"FileId ссылка на изображение",8,Ml),b(U,{"need-video":!1,"need-photo":!0,selected:[t.filteredConfigs[d].value],onSelect:h=>t.selectPhoto(h,d)},null,8,["selected","onSelect"])])):r("",!0),t.filteredConfigs[d].type==="json"?(l(),i("div",Rl,[Dl,b(j(we),{mode:"form",modelValue:t.filteredConfigs[d].value,"onUpdate:modelValue":h=>t.filteredConfigs[d].value=h,"show-btns":!1,expandedOnStart:!0,onJsonChange:h=>t.onJsonChange(h,d)},null,8,["modelValue","onUpdate:modelValue","onJsonChange"])])):r("",!0),t.filteredConfigs[d].type==="page"?(l(),i("div",El,[c(e("input",{class:"form-control mb-2","onUpdate:modelValue":h=>t.filteredConfigs[d].value=h,type:"text",id:"filtered-config-"+d+"-script"},null,8,Ll),[[_,t.filteredConfigs[d].value]]),e("label",{for:"filtered-config-"+d+"-script"},"Значение",8,Kl),b(W,{selected:[t.filteredConfigs[d].value],onCallback:h=>t.selectSlug(h,d),editor:!1},null,8,["selected","onCallback"])])):r("",!0),t.filteredConfigs[d].type==="script"?(l(),i("div",Nl,[c(e("input",{class:"form-control mb-2","onUpdate:modelValue":h=>t.filteredConfigs[d].value=h,type:"text",id:"filtered-config-"+d+"-script"},null,8,Jl),[[_,t.filteredConfigs[d].value]]),e("label",{for:"filtered-config-"+d+"-script"},"Значение",8,Hl),b(ro,{onSelect:h=>t.selectSlug(h,d)},null,8,["onSelect"])])):r("",!0)])],2)):r("",!0)],64))),256))])])])])):(l(),i("div",Gl,Wl)),e("button",Zl,[t.slugForm.id==null?(l(),i("span",Xl," Сохранить команду ")):(l(),i("span",xl," Обновить команду "))])],32)}}});const ti={class:"card-header d-flex justify-content-between align-items-center"},si={class:"d-flex"},oi=e("i",{class:"fa-solid fa-arrow-left"},null,-1),li=[oi],ii={class:"dropdown"},ni=e("i",{class:"fa-solid fa-ellipsis"},null,-1),ai=[ni],di={class:"dropdown-menu"},ri=["data-bs-target"],ci=e("i",{class:"fa-regular fa-pen-to-square mr-1"},null,-1),ui=e("i",{class:"fa-solid fa-clone mr-1"},null,-1),mi=e("i",{class:"fa-regular fa-trash-can text-danger mr-1"},null,-1),hi={key:0,class:"fa-solid fa-arrow-up-short-wide"},_i={key:1,class:"fa-solid fa-arrow-down-short-wide"},pi={class:"card-body"},bi={class:"row"},fi={class:"col-12"},gi={key:0},yi={key:1,class:"list-group list-group-numbered"},vi={class:"list-group-item d-flex justify-content-between align-items-start"},$i={class:"ms-2 me-auto"},ki=e("div",{class:"fw-bold"},"Идентификатор",-1),Fi={class:"list-group-item d-flex justify-content-between align-items-start"},wi={class:"ms-2 me-auto"},Ci=e("div",{class:"fw-bold"},"Команда",-1),Si={class:"list-group-item d-flex justify-content-between align-items-start"},ji={class:"ms-2 me-auto"},Vi=e("div",{class:"fw-bold"},"Мнемоническое имя",-1),qi={class:"list-group-item d-flex justify-content-between align-items-start"},zi={class:"ms-2 me-auto"},Pi=e("div",{class:"fw-bold"},"Пояснение",-1),Ui={key:0,class:"list-group-item d-flex justify-content-between align-items-start"},Ai={class:"ms-2 me-auto"},Oi=e("div",{class:"fw-bold"},"Набор параметров скрипта",-1),Ii={key:1,class:"list-group-item d-flex justify-content-between align-items-start"},Qi=e("div",{class:"ms-2 me-auto"},[e("div",{class:"fw-bold"},"Привязана страница")],-1),Ti=[Qi],Bi={key:2,class:"list-group-item d-flex justify-content-between align-items-start"},Mi=e("div",{class:"ms-2 me-auto"},[e("div",{class:"fw-bold"},"Глобальный скрипт")],-1),Ri=[Mi],Di={class:"list-group-item d-flex justify-content-between align-items-start"},Ei={class:"ms-2 me-auto w-100"},Li=e("div",{class:"fw-bold"},"Перенести данные из:",-1),Ki=e("option",{value:null},"Не выбрано",-1),Ni=["value"],Ji=e("p",{class:"my-2"},[e("em",null,"Перенос данных затирает текущие данные в данном скрипте")],-1),Hi=["disabled"],Gi=["id"],Yi={class:"modal-dialog modal-fullscreen"},Wi={class:"modal-content"},Zi={class:"modal-header"},Xi={class:"modal-title",id:"exampleModalLabel"},xi=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),en={class:"modal-body"},tn=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),sn={props:["item","bot","selectMode","isActive"],data(){return{selected_slug_id:null,slugs:[],load:!1,simple:!0}},watch:{simple:function(){this.simple||this.loadAllSlugs()}},mounted(){},methods:{selectCard(){this.$emit("select",this.item)},slugFormCallback(){this.load=!0,this.$emit("callback"),this.$nextTick(()=>{this.load=!1})},editSlug(){this.load=!0,this.$nextTick(()=>{this.load=!1})},selectSlug(){this.load=!0,this.$emit("select",this.item),this.$nextTick(()=>{this.load=!1})},duplicateSlug(){this.load=!0,this.$store.dispatch("duplicateSlug",{dataObject:{slugId:this.item.id}}).then(s=>{this.$notify({title:"Конструктор команд",text:"Команда успешно продублирована",type:"success"}),this.$emit("callback"),this.$nextTick(()=>{this.load=!1})}).catch(s=>{this.$emit("callback"),this.$nextTick(()=>{this.load=!1})}),this.$emit("callback"),this.$nextTick(()=>{this.load=!1})},submitRelocateData(){this.$store.dispatch("relocateSlugActionData",{slug_sender_id:this.selected_slug_id,slug_recipient_id:this.item.id,bot_id:this.bot.id}).then(s=>{this.$notify({title:"Конструктор команд",text:"Данные команды успешно перенесены",type:"success"})}).catch(s=>{this.$notify({title:"Конструктор команд",text:"Ошибка переноса данных",type:"error"})})},loadAllSlugs(){this.$store.dispatch("loadAllSlugs",{botId:this.bot.id}).then(s=>{this.slugs=s.data})},removeSlug(){this.load=!0,this.$store.dispatch("removeSlug",{dataObject:{slugId:this.item.id}}).then(s=>{this.$notify({title:"Конструктор команд",text:"Команда успешно удалена",type:"success"}),this.$emit("callback"),this.$nextTick(()=>{this.load=!1})}).catch(s=>{this.$emit("callback"),this.$nextTick(()=>{this.load=!1})})}}},on=Object.assign(sn,{__name:"Slug",setup(s){return(t,o)=>(l(),i(g,null,[e("div",{class:p(["card",{"deprecated-slug":s.item.deprecated_at!=null,"global-slug":s.item.is_global,"bg-success text-white":s.isActive}])},[e("div",ti,[e("div",si,[e("button",{onClick:o[0]||(o[0]=(...a)=>t.selectSlug&&t.selectSlug(...a)),type:"button",title:"Выбрать команду",class:p(["btn btn-outline-primary mr-2",{"text-white":s.isActive}])},li,2),e("div",ii,[e("button",{class:p([{"text-white border-white":s.isActive},"btn btn-outline-secondary"]),type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},ai,2),e("ul",di,[e("li",null,[e("a",{class:"dropdown-item cursor-pointer",onClick:o[1]||(o[1]=(...a)=>t.editSlug&&t.editSlug(...a)),"data-bs-toggle":"modal","data-bs-target":"#edit-slug-"+s.item.id},[ci,m(" Редактировать")],8,ri)]),e("li",null,[e("a",{class:"dropdown-item cursor-pointer",onClick:o[2]||(o[2]=(...a)=>t.duplicateSlug&&t.duplicateSlug(...a))},[ui,m(" Дублировать")])]),e("li",null,[e("a",{class:"dropdown-item cursor-pointer",onClick:o[3]||(o[3]=(...a)=>t.removeSlug&&t.removeSlug(...a))},[mi,m(" Удалить")])])])])]),e("span",null,[e("small",null,[e("strong",null,"#"+u(s.item.id),1)])]),e("button",{type:"button",onClick:o[4]||(o[4]=a=>t.simple=!t.simple),class:p([{"text-white border-white":s.isActive},"btn btn-outline-primary ml-2"])},[t.simple?(l(),i("i",hi)):(l(),i("i",_i))],2)]),e("div",pi,[e("div",bi,[e("div",fi,[t.simple?(l(),i("p",gi,u(s.item.command||"Нет команды"),1)):(l(),i("ol",yi,[e("li",vi,[e("div",$i,[ki,m(" №"+u(s.item.id||"Нет идентификатора"),1)])]),e("li",Fi,[e("div",wi,[Ci,m(" "+u(s.item.command||"Нет команды"),1)])]),e("li",Si,[e("div",ji,[Vi,m(" "+u(s.item.slug||"Slug"),1)])]),e("li",qi,[e("div",zi,[Pi,m(" "+u(s.item.comment||"Пояснение не указано"),1)])]),s.item.config?(l(),i("li",Ui,[e("div",Ai,[Oi,s.item.config?(l(!0),i(g,{key:0},$(s.item.config,a=>(l(),i("p",null,[e("strong",null,u(a.key||"Ключ не найден")+":",1),m(u(a.value||"Не указано"),1)]))),256)):r("",!0)])])):r("",!0),s.item.page?(l(),i("li",Ii,Ti)):r("",!0),s.item.is_global?(l(),i("li",Bi,Ri)):r("",!0),e("li",Di,[e("div",Ei,[e("form",{onSubmit:o[6]||(o[6]=S((...a)=>t.submitRelocateData&&t.submitRelocateData(...a),["prevent"]))},[Li,c(e("select",{class:"form-control w-100","onUpdate:modelValue":o[5]||(o[5]=a=>t.selected_slug_id=a),required:""},[Ki,(l(!0),i(g,null,$(t.slugs,a=>(l(),i("option",{value:a.id},"#"+u(a.id)+" "+u(a.slug||"Не указан"),9,Ni))),256))],512),[[B,t.selected_slug_id]]),Ji,e("button",{disabled:t.selected_slug_id==null,class:"btn btn-outline-warning w-100"}," Выполнить перенос ",8,Hi)],32)])])]))])])])],2),e("div",{class:"modal fade",id:"edit-slug-"+s.item.id,tabindex:"-1"},[e("div",Yi,[e("div",Wi,[e("div",Zi,[e("h5",Xi,[m("Редактирование команды #"),e("span",null,u(s.item.id),1)]),xi]),e("div",en,[t.load?r("",!0):(l(),v(qe,{key:0,item:s.item,onCallback:t.slugFormCallback},null,8,["item","onCallback"]))]),tn])])],8,Gi)],64))}}),ln={key:0,class:"row"},nn={class:"col-12 mb-2"},an={key:0},dn=e("i",{class:"fa-solid fa-scroll"},null,-1),rn={key:1},cn=e("i",{class:"fa-regular fa-square-minus"},null,-1),un={key:0,class:"col-12"},mn={class:"col-12"},hn={class:"form-floating mb-3"},_n=e("label",{for:"floatingInput"},"Быстрый поиск команды",-1),pn={class:"col-12 mb-2"},bn={class:"form-check"},fn={class:"form-check-label",for:"need_global"},gn={key:0},yn={key:1},vn={class:"form-check"},$n=e("label",{class:"form-check-label",for:"need_show_deleted"}," Удаленные ",-1),kn={key:1,class:"mb-3 col-12 col-sm-12"},Fn={class:"table"},wn=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"#"),e("th",{scope:"col"},"Команда"),e("th",{scope:"col"},"Пояснение"),e("th",{scope:"col"},"Глобальный"),e("th",{scope:"col"},"Действия")])],-1),Cn=["onClick"],Sn={key:0},jn=e("i",{class:"fa-solid fa-check text-success"},null,-1),Vn=[jn],qn={key:1},zn=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),Pn=[zn],Un={class:"dropdown"},An=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),On={class:"dropdown-menu"},In={key:0},Qn=["onClick"],Tn=e("i",{class:"fa-solid fa-arrow-left mr-1"},null,-1),Bn={key:1},Mn=["onClick"],Rn=e("a",{class:"dropdown-item cursor-pointer","data-bs-toggle":"modal","data-bs-target":"#edit-table-slug"},[e("i",{class:"fa-regular fa-pen-to-square mr-1"}),m(" Редактировать")],-1),Dn=[Rn],En=["onClick"],Ln=e("i",{class:"fa-solid fa-clone mr-1"},null,-1),Kn=["href"],Nn=e("i",{class:"fa-regular fa-file-excel mr-1"},null,-1),Jn={key:2},Hn=["onClick"],Gn=e("i",{class:"fa-regular fa-trash-can text-danger mr-1"},null,-1),Yn={key:3},Wn=["onClick"],Zn=e("i",{class:"fa-regular fa-trash-can text-danger mr-1"},null,-1),Xn={key:3,class:"mb-3 col-md-12"},xn=e("div",{class:"alert alert-danger",role:"alert"}," У Вас еще нет добавленных скриптов! ",-1),ea=[xn],ta={class:"modal fade",id:"edit-table-slug",tabindex:"-1"},sa={class:"modal-dialog modal-fullscreen"},oa={key:0,class:"modal-content"},la={class:"modal-header"},ia={class:"modal-title",id:"exampleModalLabel"},na=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),aa={class:"modal-body"},da={class:"row"},ra={class:"col-12"},ca=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),ua={props:["selected","command","canSelect"],data(){return{bot:null,relocated_slug_id:null,need_global:!0,need_show_deleted:!0,show:!1,load:!1,slugs:[],paginate:[],selectedSlug:null,ownSearch:null,slugForm:{command:null,comment:null,slug:null}}},watch:{ownSearch:function(s,t){this.loadSlugs()},need_global:function(s,t){this.loadSlugs()},need_show_deleted:function(s,t){this.loadSlugs()}},computed:{...C(["getCurrentBot","getSlugs","getSlugsPaginateObject"])},mounted(){this.loadCurrentBot().then(()=>{this.loadSlugs(),this.command&&this.$nextTick(()=>{this.slugForm.command=this.command})})},methods:{nextSlugs(s){this.loadSlugs(s)},loadSlugs(s=0){return console.log("selected",this.selected),this.$store.dispatch("loadSlugs",{dataObject:{botId:this.bot.id,needGlobal:this.need_global,needDeleted:this.need_show_deleted,search:this.ownSearch||null},page:s}).then(t=>{this.slugs=this.getSlugs,this.paginate=this.getSlugsPaginateObject})},loadCurrentBot(s=null){return this.$store.dispatch("updateCurrentBot",{bot:s}).then(()=>{this.bot=this.getCurrentBot})},callbackSlugs(){this.loadSlugs()},selectSlug(s){this.load=!0,this.$nextTick(()=>{this.selectedSlug=s,this.load=!1}),this.$emit("select",s)},selectCard(){this.$emit("select",this.item)},slugFormCallback(){this.load=!0;const s=this.selectedSlug;this.loadSlugs().then(()=>{let t=this.slugs.find(o=>o.id===s.id);this.selectSlug(t||null)}),this.$emit("callback"),this.$nextTick(()=>{this.load=!1})},editSlug(){this.load=!0,this.$nextTick(()=>{this.load=!1})},duplicateSlug(s){this.load=!0,this.$store.dispatch("duplicateSlug",{dataObject:{slugId:s.id}}).then(t=>{this.$notify({title:"Конструктор команд",text:"Команда успешно продублирована",type:"success"}),this.$emit("callback"),this.$nextTick(()=>{this.load=!1})}).catch(t=>{this.$emit("callback"),this.$nextTick(()=>{this.load=!1})}),this.loadSlugs(),this.$emit("callback"),this.$nextTick(()=>{this.load=!1})},submitRelocateData(){this.$store.dispatch("relocateSlugActionData",{slug_sender_id:this.relocated_slug_id,slug_recipient_id:this.item.id,bot_id:this.bot.id}).then(s=>{this.$notify({title:"Конструктор команд",text:"Данные команды успешно перенесены",type:"success"})}).catch(s=>{this.$notify({title:"Конструктор команд",text:"Ошибка переноса данных",type:"error"})})},restoreSlug(s){this.load=!0,this.$store.dispatch("restoreSlug",{dataObject:{slugId:s.id}}).then(t=>{this.$notify({title:"Конструктор команд",text:"Команда успешно восстановлена",type:"success"}),this.loadSlugs(),this.$nextTick(()=>{this.load=!1})}).catch(t=>{this.$emit("callback"),this.$nextTick(()=>{this.load=!1})})},removeSlug(s){this.load=!0,this.$store.dispatch("removeSlug",{dataObject:{slugId:s.id}}).then(t=>{this.$notify({title:"Конструктор команд",text:"Команда успешно удалена",type:"success"}),this.loadSlugs()}).catch(t=>{this.$emit("callback"),this.$nextTick(()=>{this.load=!1})})}}},ma=Object.assign(ua,{__name:"BotSlugTableList",setup(s){return(t,o)=>(l(),i(g,null,[t.bot?(l(),i("div",ln,[e("div",nn,[e("button",{type:"button",onClick:o[0]||(o[0]=a=>t.show=!t.show),class:"btn btn-outline-success p-3 w-100"},[t.show?(l(),i("span",rn,[cn,m(" Свернуть форму добавления")])):(l(),i("span",an,[dn,m(" Добавить глобальный скрипт")]))])]),t.show?(l(),i("div",un,[t.bot?(l(),v(ae,{key:0,"can-add":!0,bot:t.bot,onCallback:t.loadSlugs},null,8,["bot","onCallback"])):r("",!0)])):r("",!0),e("div",mn,[e("div",hn,[c(e("input",{type:"search","onUpdate:modelValue":o[1]||(o[1]=a=>t.ownSearch=a),class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,512),[[_,t.ownSearch]]),_n])]),e("div",pn,[e("div",bn,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[2]||(o[2]=a=>t.need_global=a),type:"checkbox",id:"need_global"},null,512),[[k,t.need_global]]),e("label",fn,[t.need_global?(l(),i("span",gn,"Глобальные")):(l(),i("span",yn,"Локальные"))])]),e("div",vn,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[3]||(o[3]=a=>t.need_show_deleted=a),type:"checkbox",id:"need_show_deleted"},null,512),[[k,t.need_show_deleted]]),$n])]),t.slugs&&t.bot?(l(),i("div",kn,[e("table",Fn,[wn,e("tbody",null,[(l(!0),i(g,null,$(t.slugs,(a,n)=>(l(),i("tr",{class:p({"border-info":a.deleted_at==null,"border-danger":a.deleted_at!=null})},[e("th",{scope:"row",class:p({"text-danger":a.deleted_at!=null})},u(a.id||"Нет идентификатора"),3),e("td",{onClick:d=>t.selectSlug(a),"data-bs-toggle":"modal","data-bs-target":"#edit-table-slug",class:p({"text-danger":a.deleted_at!=null})},u(a.command||"Нет команды"),11,Cn),e("td",{class:p({"text-danger":a.deleted_at!=null})},u(a.comment||"Пояснение не указано"),3),e("td",null,[a.is_global?(l(),i("span",Sn,Vn)):(l(),i("span",qn,Pn))]),e("td",null,[e("div",Un,[An,e("ul",On,[s.canSelect?(l(),i("li",In,[e("a",{onClick:d=>t.selectSlug(a),title:"Выбрать команду",class:"dropdown-item cursor-pointer"},[Tn,m(" Выбрать команду ")],8,Qn)])):r("",!0),s.canSelect?(l(),i("hr",Bn)):r("",!0),e("li",{onClick:d=>t.selectSlug(a)},Dn,8,Mn),e("li",null,[e("a",{class:"dropdown-item cursor-pointer",onClick:d=>t.duplicateSlug(a)},[Ln,m(" Дублировать")],8,En)]),e("li",null,[e("a",{class:"dropdown-item cursor-pointer",target:"_blank",href:"/admin/slugs/action-data-export/"+a.id},[Nn,m(" Скачать данные участников")],8,Kn)]),a.deleted_at==null?(l(),i("li",Jn,[e("a",{class:"dropdown-item cursor-pointer",onClick:d=>t.removeSlug(a)},[Gn,m(" Удалить")],8,Hn)])):r("",!0),a.deleted_at!=null?(l(),i("li",Yn,[e("a",{class:"dropdown-item cursor-pointer",onClick:d=>t.restoreSlug(a)},[Zn,m(" Восстановить")],8,Wn)])):r("",!0)])])])],2))),256))])])])):r("",!0),t.paginate?(l(),v(V,{key:2,onPagination_page:t.nextSlugs,pagination:t.paginate},null,8,["onPagination_page","pagination"])):r("",!0),t.slugs.length===0?(l(),i("div",Xn,ea)):r("",!0)])):r("",!0),e("div",ta,[e("div",sa,[t.selectedSlug&&!t.load?(l(),i("div",oa,[e("div",la,[e("h5",ia,[m("Редактирование команды #"),e("span",null,u(t.selectedSlug.id),1)]),na]),e("div",aa,[e("div",da,[e("div",ra,[b(qe,{item:t.selectedSlug,onCallback:t.slugFormCallback},null,8,["item","onCallback"])])])]),ca])):r("",!0)])])],64))}}),ha={class:"row"},_a={class:"col-12"},pa=e("h6",null,"Добавление нового скрипта в бота",-1),ba={key:0,class:"row"},fa={class:"col-md-6 col-lg-4 col-sm-6 col-12 mb-2"},ga={key:1,class:"row"},ya=e("div",{class:"col-12"},[e("div",{class:"alert alert-danger",role:"alert"},' У Вас еще нет добавленных скриптов! Воспользуйтесь разделом "Скрипты" для добавления. ')],-1),va=[ya],$a={props:["bot","global","selected"],data(){return{load:!1,search:null,slugs:[],paginate:[]}},computed:{...C(["getSlugs","getSlugsPaginateObject"]),filteredSlugs(){return this.slugs?this.slugs.length===0?[]:this.search==null?this.slugs:this.slugs.filter(s=>{let t=s.slug||"",o=s.command||"",a=s.comment||"";return o.toLowerCase().indexOf(this.search.toLowerCase())!==-1||a.toLowerCase().indexOf(this.search.toLowerCase())!==-1||t.toLowerCase().indexOf(this.search.toLowerCase())!==-1}):[]}},mounted(){this.loadSlugs()},methods:{nextSlugs(s){this.loadSlugs(s)},selectSlug(s){this.$emit("callback",{id:s.id||null,slug:s.slug,comment:s.comment,command:s.command}),this.$notify("Вы выбрали скрипт из списка!")},loadSlugs(s=0){this.$store.dispatch("loadSlugs",{dataObject:{botId:this.bot.id,search:this.search||null,needGlobal:this.global},page:s}).then(t=>{this.slugs=this.getSlugs,this.paginate=this.getSlugsPaginateObject})},callbackSlugs(){}}},ka=Object.assign($a,{__name:"BotSlugListSimple",setup(s){return(t,o)=>(l(),i("div",ha,[e("div",_a,[pa,e("div",null,[c(e("input",{type:"text",class:"form-control mt-1 mb-1","onUpdate:modelValue":o[0]||(o[0]=a=>t.search=a),onKeyup:o[1]||(o[1]=(...a)=>t.loadSlugs&&t.loadSlugs(...a)),placeholder:"Поиск нужного скрипта по описанию"},null,544),[[_,t.search]])]),t.slugs.length>0?(l(),i("div",ba,[(l(!0),i(g,null,$(t.slugs,(a,n)=>(l(),i("div",fa,[b(on,{"is-active":(s.selected||[]).indexOf(a.id)!=-1,item:a,bot:s.bot,onCallback:t.callbackSlugs,onSelect:t.selectSlug},null,8,["is-active","item","bot","onCallback","onSelect"])]))),256)),t.paginate?(l(),v(V,{key:0,onPagination_page:t.nextSlugs,pagination:t.paginate},null,8,["onPagination_page","pagination"])):r("",!0)])):(l(),i("div",ga,va))])]))}});const Fa={props:["param"],data(){return{expressions:[{expression:null,description:"Нет проверки"},{expression:"/([a-z0-9]+)/i",description:"Проверка набора из латинских букв и цифр"},{expression:"/([а-яё0-9]+)/iu",description:"Проверка на кириллицу и цифры"},{expression:"/(?P<digit>\\d+)/",description:"Проверка на число"},{expression:"/^([a-z0-9_-]+.)*[a-z0-9_-]+@[a-z0-9_-]+(.[a-z0-9_-]+)*.[a-z]{2,6}$/",description:"Проверка Email"},{expression:"/^((8|+7)[- ]?)?((?d{3})?[- ]?)?[d- ]{7,10}$/",description:"Проверка номера телефона: +7(982)000-00-00"},{expression:"/^(0[1-9]|[12][0-9]|3[01])[.](0[1-9]|1[012])[.](19|20)dd$/",description:"Проверка даты по формату DD.MM.YYYY"},{expression:"/^[0-9]{4}-(0[1-9]|1[012])-(0[1-9]|1[0-9]|2[0-9]|3[01])$/",description:"Проверка даты по формату YYYY-MM-DD"},{expression:"/^(https?://)?([da-z.-]+).([a-z.]{2,6})([/w .-]*)*/?$/",description:"Проверка доменного имени"}]}},methods:{expressionsSelect(s){this.$emit("callback",{param:this.param,text:s.expression})}}},wa={class:"dropdown"},Ca=e("button",{class:"btn btn-link dropdown-toggle",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-regular fa-registered"})],-1),Sa={class:"dropdown-menu item-with-text cursor-pointer text-muted p-2"},ja=["onClick"];function Va(s,t,o,a,n,d){return l(),i("div",wa,[Ca,e("div",Sa,[e("li",null,[(l(!0),i(g,null,$(n.expressions,h=>(l(),i("a",{class:"dropdown-item",onClick:f=>d.expressionsSelect(h)},u(h.description||"-"),9,ja))),256))])])])}const qa=A(Fa,[["render",Va]]),za={class:"row mt-2"},Pa={class:"col-12 d-flex justify-content-between align-items-center"},Ua=["onClick"],Aa={class:"row mb-2"},Oa={class:"col-3"},Ia={class:"form-floating"},Qa=["onUpdate:modelValue"],Ta=e("label",{for:"floatingInput"},"Значение параметра 1",-1),Ba={class:"col-3"},Ma={class:"form-floating"},Ra=["onUpdate:modelValue"],Da=e("option",{value:null,selected:""},"без действия",-1),Ea=["value"],La=e("label",{for:"floatingSelect"},"Доступные операции",-1),Ka={class:"col-3"},Na={class:"form-floating"},Ja=["onUpdate:modelValue"],Ha=e("label",{for:"floatingInput"},"Значение параметра 2",-1),Ga={class:"col-3"},Ya={class:"form-floating"},Wa=["disabled","onUpdate:modelValue"],Za=e("label",{for:"floatingInput"},"Переменная результата",-1),Xa=e("div",{class:"row"},[e("div",{class:"col-6"},[e("h6",null,"Если условие выполнено")]),e("div",{class:"col-6"},[e("h6",null,[m("Если условие "),e("span",{class:"text-danger"},"не"),m(" выполнено")])])],-1),xa={class:"row"},ed={class:"col-6"},td={class:"form-floating mb-3"},sd=["onUpdate:modelValue"],od=e("label",{for:"floatingInput"},"Текст для пользователя",-1),ld={class:"col-6"},id={class:"form-floating mb-3"},nd=["onUpdate:modelValue"],ad=e("label",{for:"floatingInput"},"Текст для пользователя",-1),dd={class:"row"},rd={class:"col-6"},cd={class:"form-check mb-2"},ud=["onUpdate:modelValue","id"],md=["for"],hd={class:"col-6"},_d={class:"form-check mb-2"},pd=["onUpdate:modelValue","id"],bd=["for"],fd={key:1,class:"alert alert-primary d-flex align-items-center mt-2",role:"alert"},gd=e("i",{class:"fa-solid fa-triangle-exclamation mr-2"},null,-1),yd=e("div",null," Правила не добавлены ",-1),vd=[gd,yd],$d={props:["modelValue"],data(){return{rules:[],operations:[{id:0,title:"Выдать результат без обработки"},{id:1,title:"Больше"},{id:2,title:"Меньше"},{id:3,title:"Равно"},{id:4,title:"Не равно"},{id:5,title:"Сложить"},{id:6,title:"Вычесть"},{id:7,title:"Логическое И"},{id:8,title:"Логическое ИЛИ"}]}},mounted(){this.modelValue&&(this.rules=this.modelValue)},methods:{addRule(){this.rules.push({param1:null,operation:null,param2:null,use_result_as:null,text_if_true:null,text_if_false:null,keyboard_if_true:null,keyboard_if_false:null,need_keyboard_if_true:!1,need_keyboard_if_false:!1}),this.$notify({title:"Конструктор ботов",text:"Успешная создано новое правило",type:"success"}),this.$emit("update:modelValue",this.rules)},testRule(s){let t=this.rules[s];return t.operation===5||t.operation===6},removeRule(s){this.rules.splice(s,1),this.$notify({title:"Конструктор ботов",text:"Успешная удалено выбранное правило",type:"success"})}}},kd=Object.assign($d,{__name:"BotDialogResultRules",setup(s){return(t,o)=>(l(),i(g,null,[e("button",{type:"button",onClick:o[0]||(o[0]=(...a)=>t.addRule&&t.addRule(...a)),class:"btn btn-outline-info"},"Добавить правило "),t.rules.length>0?(l(!0),i(g,{key:0},$(t.rules,(a,n)=>(l(),i(g,null,[e("div",za,[e("div",Pa,[e("h6",null,"Шаг "+u(n+1),1),e("button",{onClick:d=>t.removeRule(n),type:"button",class:"btn btn-link"},"удалить правило ",8,Ua)])]),e("div",Aa,[e("div",Oa,[e("div",Ia,[c(e("input",{type:"text",class:"form-control","onUpdate:modelValue":d=>t.rules[n].param1=d,id:"floatingInput",placeholder:"name@example.com"},null,8,Qa),[[_,t.rules[n].param1]]),Ta])]),e("div",Ba,[e("div",Ma,[c(e("select",{class:"form-select","onUpdate:modelValue":d=>t.rules[n].operation=d,id:"floatingSelect","aria-label":"Floating label select example"},[Da,(l(!0),i(g,null,$(t.operations,d=>(l(),i("option",{value:d.id},u(d.title||"-"),9,Ea))),256))],8,Ra),[[B,t.rules[n].operation]]),La])]),e("div",Ka,[e("div",Na,[c(e("input",{type:"text","onUpdate:modelValue":d=>t.rules[n].param2=d,class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,8,Ja),[[_,t.rules[n].param2]]),Ha])]),e("div",Ga,[e("div",Ya,[c(e("input",{type:"text",disabled:!t.testRule(n),"onUpdate:modelValue":d=>t.rules[n].use_result_as=d,class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,8,Wa),[[_,t.rules[n].use_result_as]]),Za])])]),Xa,e("div",xa,[e("div",ed,[e("div",td,[c(e("input",{type:"text","onUpdate:modelValue":d=>t.rules[n].text_if_true=d,class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,8,sd),[[_,t.rules[n].text_if_true]]),od])]),e("div",ld,[e("div",id,[c(e("input",{type:"text","onUpdate:modelValue":d=>t.rules[n].text_if_false=d,class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,8,nd),[[_,t.rules[n].text_if_false]]),ad])])]),e("div",dd,[e("div",rd,[e("div",cd,[c(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":d=>t.rules[n].need_keyboard_if_true=d,id:"need-keyboard-if-true-"+n},null,8,ud),[[k,t.rules[n].need_keyboard_if_true]]),e("label",{class:"form-check-label",for:"need-keyboard-if-true-"+n}," Нужна клавиатура ",8,md)]),t.rules[n].need_keyboard_if_true?(l(),v(I,{key:0,type:"inline",modelValue:t.rules[n].keyboard_if_true,"onUpdate:modelValue":d=>t.rules[n].keyboard_if_true=d},null,8,["modelValue","onUpdate:modelValue"])):r("",!0)]),e("div",hd,[e("div",_d,[c(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":d=>t.rules[n].need_keyboard_if_false=d,id:"need-keyboard-if-false-"+n},null,8,pd),[[k,t.rules[n].need_keyboard_if_false]]),e("label",{class:"form-check-label",for:"need-keyboard-if-false-"+n}," Нужна клавиатура ",8,bd)]),t.rules[n].need_keyboard_if_false?(l(),v(I,{key:0,type:"inline",modelValue:t.rules[n].keyboard_if_false,"onUpdate:modelValue":d=>t.rules[n].keyboard_if_false=d},null,8,["modelValue","onUpdate:modelValue"])):r("",!0)])])],64))),256)):(l(),i("div",fd,vd))],64))}});const Fd={props:["modelValue","bot"],data(){return{text:null,search:null,variables:[]}},watch:{text:{handler:function(s){this.$emit("update:modelValue",this.text)},deep:!0}},computed:{filteredVariable(){return this.search?this.variables.filter(s=>s.text.indexOf(this.search)!==-1):this.variables}},mounted(){this.text=this.modelValue,this.loadVariables()},methods:{select(s){this.text||(this.text=""),this.text+=s},addAll(){this.filteredVariable.forEach(s=>{this.select(s)})},loadVariables(){this.$store.dispatch("loadDialogVariables",{bot_id:this.bot.id}).then(s=>{this.variables=s.data})}}},wd={class:"dropdown"},Cd=e("button",{class:"btn btn-link dropdown-toggle",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-spell-check"})],-1),Sd={class:"dropdown-menu item-with-text cursor-pointer text-muted p-2"},jd=e("div",{class:"dropdown-divider"},null,-1),Vd=e("div",{class:"dropdown-divider"},null,-1),qd=["onClick"];function zd(s,t,o,a,n,d){return l(),i("div",wd,[Cd,e("div",Sd,[c(e("input",{type:"search",class:"form-control",id:"search-description-text","onUpdate:modelValue":t[0]||(t[0]=h=>n.search=h),placeholder:"Введите текст для поиска"},null,512),[[_,n.search]]),jd,e("button",{type:"button",onClick:t[1]||(t[1]=(...h)=>d.addAll&&d.addAll(...h)),class:"btn-outline-light btn w-100 text-primary"},"Добавить все "),Vd,(l(!0),i(g,null,$(d.filteredVariable,(h,f)=>(l(),i("p",{class:"p-1 text-left w-100 mb-1",onClick:F=>d.select(h)},u(h),9,qd))),256))])])}const me=A(Fd,[["render",zd]]),Pd={class:"mb-2 px-0"},Ud={type:"submit",class:"btn btn-outline-success"},Ad=e("i",{class:"fa-regular fa-floppy-disk mr-2"},null,-1),Od={key:0},Id={key:1},Qd={class:"nav nav-tabs"},Td={class:"nav-item"},Bd=e("i",{class:"fa-regular fa-comment-dots mr-2"},null,-1),Md={class:"nav-item"},Rd=e("i",{class:"fa-solid fa-link mr-2"},null,-1),Dd={key:0,class:"nav-item"},Ed=e("i",{class:"fa-brands fa-uncharted mr-2"},null,-1),Ld={key:1,class:"nav-item"},Kd=e("i",{class:"fa-solid fa-hashtag mr-2"},null,-1),Nd={key:0,class:"py-2 px-0"},Jd={class:"form-check mb-2"},Hd=["id"],Gd=["for"],Yd={key:0,class:"form-check mb-2"},Wd=["id"],Zd=["for"],Xd={key:1,class:"alert alert-info",role:"alert"},xd={class:"form-floating mb-2"},er=["id"],tr=["for"],sr={key:2,class:"card"},or={class:"card-body"},lr=e("div",{class:"alert alert-light"}," Данные блоки настраивают отображение данных администратором ",-1),ir={class:"form-check"},nr=["id"],ar=["for"],dr={class:"alert alert-light"},rr={class:"form-floating mb-2"},cr=["id"],ur=["for"],mr={class:"form-check"},hr=["id"],_r=["for"],pr={class:"form-check"},br=["id"],fr=["for"],gr={key:1,class:"form-floating mb-2"},yr=e("label",{for:"floatingInput"},"Почта для отправки результата",-1),vr={key:3,class:"mb-2"},$r={class:"form-floating"},kr=e("label",{for:"floatingPassword"},"Сохранить ответ пользователя как внутреннюю переменную",-1),Fr={key:4,class:"form-check mb-2"},wr=e("label",{class:"form-check-label",for:"need-custom-stored-value"}," Нужно изменить данные в переменной ",-1),Cr={key:5,class:"mb-2"},Sr={class:"form-floating"},jr=e("label",{for:"custom_stored_value"},"Поместить эти данные в результат",-1),Vr={key:6,class:"form-floating mb-2"},qr=["disabled","id"],zr=["for"],Pr={key:1,class:"py-2 px-0"},Ur={class:"mb-2"},Ar={key:0,class:"row"},Or=e("div",{class:"col-12"},[e("h6",null,"Выбрать следующий диалог:")],-1),Ir={key:0,class:"col-12 mb-2"},Qr=e("i",{class:"fa-solid fa-arrows-rotate"},null,-1),Tr={class:"col-md-12 mb-1"},Br={type:"button",class:"btn btn-outline-primary w-100 d-flex justify-content-between align-items-center",style:{"text-align":"left"}},Mr=["onClick"],Rr={key:1,class:"row"},Dr=e("div",{class:"col-12"},[e("div",{class:"alert alert-danger",role:"alert"}," Диалогов для связывания нет ")],-1),Er=[Dr],Lr={key:2,class:"py-2 px-0"},Kr={class:"form-check mb-2"},Nr=e("label",{class:"form-check-label",for:"need-additional-functions"}," Нужен дополнительный функционал управления ",-1),Jr={key:0,class:"form-floating mb-2"},Hr=["id"],Gr=["for"],Yr={key:1,class:"mb-2"},Wr={class:"d-flex justify-content-between align-items-center"},Zr=e("p",{class:"mb-2"},"Регулярное выражение для валидации данных ",-1),Xr={class:"form-floating"},xr=["id"],ec=["for"],tc={key:2,class:"mb-2"},sc={class:"d-flex justify-content-between align-items-center"},oc=e("p",{class:"mb-2"},"Канал для отправки данных ",-1),lc={class:"form-floating"},ic=["id"],nc=["for"],ac={key:3,class:"mb-2"},dc={class:"form-floating"},rc=e("option",{selected:""},"Не выбрано",-1),cc=["value"],uc=e("label",{for:"store_variants"},"Сохранить в переменную",-1),mc={class:"form-check mb-2"},hc=e("label",{class:"form-check-label",for:"need-dialog-image"}," В диалоге нужно изображение ",-1),_c={key:4,class:"card mb-2"},pc={class:"card-body"},bc=e("h6",null,"Фотографии к диалогу",-1),fc={class:"photo-preview d-flex justify-content-start flex-wrap w-100"},gc={for:"location-photos",style:{"margin-right":"10px"},class:"photo-loader ml-2"},yc=e("span",null,"+",-1),vc={class:"mb-2 img-preview",style:{"margin-right":"10px"}},$c={class:"remove"},kc=["onClick"],Fc={class:"mb-2 img-preview",style:{"margin-right":"10px"}},wc={class:"remove"},Cc=["onClick"],Sc={class:"form-check mb-2"},jc=e("label",{class:"form-check-label",for:"need-dialog-menu-inline"}," В диалоге нужно меню тексту ",-1),Vc={key:5,class:"card mb-2"},qc=e("div",{class:"card-header"},[e("h6",null,"Кнопки к тексту вопроса")],-1),zc={class:"card-body"},Pc={class:"form-check mb-2"},Uc=e("label",{class:"form-check-label",for:"need-dialog-menu-reply"}," В диалоге нужно нижнее меню ",-1),Ac={key:6,class:"card mb-2"},Oc=e("div",{class:"card-header"},[e("h6",null,"Кнопки в виде нижнего меню")],-1),Ic={class:"card-body"},Qc={class:"form-check mb-2"},Tc=e("label",{class:"form-check-label",for:"need-chains"}," Нужны многоуровневые диалоги ",-1),Bc={key:7,class:"mb-2"},Mc={key:0,class:"w-100 my-3",style:{"border-collapse":"separate","border-spacing":"5px 10px"}},Rc=e("tr",{style:{"border-top":"1px #eaeaea solid"}},[e("td"),e("td"),e("td",null,[e("strong",null,"Ответ")]),e("td",null,[e("strong",null,"Следующий диалог")])],-1),Dc={style:{width:"40px"}},Ec=["onClick"],Lc=e("i",{class:"fa-solid fa-toggle-off cursor-pointer text-secondary"},null,-1),Kc=[Lc],Nc=["onClick"],Jc=e("i",{class:"fa-solid fa-toggle-on cursor-pointer text-primary"},null,-1),Hc=[Jc],Gc={scope:"row"},Yc={class:"input-group"},Wc={class:"input-group-text",id:"basic-addon1"},Zc=["onUpdate:modelValue"],Xc={class:"form-floating"},xc=["onUpdate:modelValue"],eu=e("label",{for:"floatingInput"},"Точный текст ответа",-1),tu={class:"input-group"},su={class:"form-floating"},ou=["onUpdate:modelValue"],lu=e("label",{for:"floatingInput"},"Выберите\\введите диалог или введите его номер",-1),iu={class:"dropdown d-flex"},nu=e("button",{class:"btn btn-outline-secondary w-100",style:{"border-radius":"0px 5px 5px 0px"},"data-bs-auto-close":"outside",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-up-right-and-down-left-from-center"})],-1),au={class:"dropdown-menu p-2",style:{width:"400px","max-height":"300px","overflow-y":"auto"}},du={class:"list-group"},ru=["onClick"],cu=["onClick"],uu={class:"px-3 pt-2"},mu={class:"dropdown d-flex justify-content-center align-items-center"},hu=e("button",{class:"btn btn-link",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-bars"})],-1),_u={class:"dropdown-menu"},pu=["onClick"],bu={key:0},fu=e("td",null,null,-1),gu=e("td",null,null,-1),yu={class:"input-group"},vu={class:"form-floating"},$u=["onUpdate:modelValue"],ku=e("label",{for:"floatingInput"},"Шаблон предполагаемого текста",-1),Fu={class:"dropdown d-flex"},wu=e("button",{class:"btn btn-outline-secondary w-100",style:{"border-radius":"0px 5px 5px 0px"},type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-up-right-and-down-left-from-center"})],-1),Cu={class:"dropdown-menu"},Su=["onClick"],ju=["onClick"],Vu={class:"form-floating"},qu=["onUpdate:modelValue","id"],zu=["for"],Pu={key:1,class:"alert alert-primary mt-2",role:"alert"},Uu={class:"form-check mb-2"},Au=e("label",{class:"form-check-label",for:"need-set-flags"}," Установить флаги в соответствующее значение ",-1),Ou={key:8,class:"mb-2"},Iu=e("p",null,"Выбрать флаги",-1),Qu=["onClick"],Tu={key:3,class:"py-2 px-0"},Bu={props:["item","bot"],data(){return{tab:0,patterns:[{title:"Номер телефона РФ",value:"/^\\s?(\\+\\s?7|8)([- ()]*\\d){10}$/"},{title:"Дата в формате ДД/ММ/ГГГГ",value:"/(\\d{2})\\/(\\d{2})\\/(\\d{4})$/"},{title:"Время в формате ЧЧ:ММ[:СС]",value:"#^[01]?[0-9]|2[0-3]):[0-5][0-9](:[0-5][0-9])?$#"}],test:[],loading:!0,dialog_commands:[],dialog_commands_paginate_object:null,need_images:!1,need_inline_keyboard:!1,need_reply_keyboard:!1,need_custom_stored_value:!1,need_additional_functions:!1,need_chains:!1,need_set_flags:!1,flags_variants:[{title:"Является VIP",key:"is_vip",value:null},{title:"Является Админом",key:"is_admin",value:null},{title:"За работой",key:"is_work",value:null},{title:"Является менеджером",key:"is_manager",value:null}],store_variants:[{title:"Имя",key:"name"},{title:"Почта",key:"email"},{title:"Возраст",key:"age"},{title:"Город",key:"city"},{title:"Страна",key:"country"},{title:"Адрес",key:"address"},{title:"Телефон",key:"phone"},{title:"День рождение",key:"birthday"}],commandForm:{id:null,slug:null,pre_text:null,post_text:null,error_text:null,bot_id:null,input_pattern:null,inline_keyboard_id:null,reply_keyboard_id:null,images:null,next_bot_dialog_command_id:null,bot_dialog_group_id:null,is_empty:!1,is_inform:!1,custom_stored_value:null,send_params:{send_by_text:!0,format:null,send_by_file:!1,send_to_mail:!1,mail:null},result_flags:[],store_to:null,use_result_as:null,result_channel:null,inline_keyboard:null,reply_keyboard:null,answers:[],rules:[]},photos:[]}},watch:{"commandForm.is_inform":function(s,t){this.commandForm.is_inform&&(this.commandForm.is_empty=!1,this.commandForm.post_text=null,this.commandForm.answers=[])},need_custom_stored_value:function(s,t){this.need_custom_stored_value||(this.commandForm.custom_stored_value=null)},need_inline_keyboard:function(s,t){this.need_inline_keyboard||(this.commandForm.inline_keyboard_id=null,this.commandForm.inline_keyboard=null)},need_reply_keyboard:function(s,t){this.need_reply_keyboard||(this.commandForm.reply_keyboard_id=null,this.commandForm.reply_keyboard=null)},need_set_flags:function(s,t){this.need_set_flags||(this.commandForm.result_flags=[])},need_images:function(s,t){this.need_images||(this.commandForm.images=null)}},computed:{...C(["getDialogCommands","getDialogCommandsPaginateObject"]),filteredCommands(){return this.dialog_commands?this.dialog_commands.filter(s=>s.id!=this.commandForm.id):[]}},mounted(){this.item&&this.$nextTick(()=>{this.commandForm={id:this.item.id||null,slug:this.item.slug||null,pre_text:this.item.pre_text||null,post_text:this.item.post_text||null,error_text:this.item.error_text||null,custom_stored_value:this.item.custom_stored_value||null,is_empty:this.item.is_empty||!1,is_inform:this.item.is_inform||!1,input_pattern:this.item.input_pattern||null,inline_keyboard_id:this.item.inline_keyboard_id||null,reply_keyboard_id:this.item.reply_keyboard_id||null,images:this.item.images||[],next_bot_dialog_command_id:this.item.next_bot_dialog_command_id||null,bot_dialog_group_id:this.item.bot_dialog_group_id||null,result_channel:this.item.result_channel||null,inline_keyboard:this.item.inline_keyboard||null,reply_keyboard:this.item.reply_keyboard||null,result_flags:this.item.result_flags||[],store_to:this.item.store_to||null,answers:this.item.answers||[],use_result_as:this.item.use_result_as||null,rules:this.item.rules||[],send_params:{send_by_text:!0,format:null,send_by_file:!1,send_to_mail:!1,mail:null}},this.item.send_params&&(this.commandForm.send_params.format=this.item.send_params.format||null,this.commandForm.send_params.send_by_text=this.item.send_params.send_by_text||!0,this.commandForm.send_params.send_by_file=this.item.send_params.send_by_file||!1,this.commandForm.send_params.send_to_mail=this.item.send_params.send_to_mail||!1,this.commandForm.send_params.mail=this.item.send_params.mail||null),this.bot&&(this.commandForm.bot_id=this.bot.id||null),this.commandForm.inline_keyboard_id!=null&&(this.need_inline_keyboard=!0),this.commandForm.reply_keyboard_id!=null&&(this.need_reply_keyboard=!0),this.commandForm.images.length>0&&(this.need_images=!0),this.commandForm.result_flags.length>0&&(this.need_set_flags=!0),this.commandForm.answers.length>0&&(this.need_chains=!0),this.commandForm.custom_stored_value&&(this.need_custom_stored_value=!0)}),this.bot&&this.$nextTick(()=>{this.commandForm.bot_id=this.bot.id}),this.loadDialogs()},methods:{toggleRepeatSelfDialog(){this.commandForm.next_bot_dialog_command_id!=null&&this.commandForm.next_bot_dialog_command_id!==this.commandForm.id?this.commandForm.next_bot_dialog_command_id=this.commandForm.id:this.commandForm.next_bot_dialog_command_id=this.commandForm.next_bot_dialog_command_id===null?this.commandForm.id:null},addAnswer(){this.commandForm.answers.push({id:null,bot_dialog_command_id:null,answer:null,need_print:!0,pattern:null,custom_stored_value:null,next_bot_dialog_command_id:null})},nextDialogs(s){this.loadDialogs(s)},removeDialogAnswer(s,t){if(s.id==null){this.commandForm.answers.splice(t,1);return}this.commandForm.answers.splice(t,1),this.loading=!0,this.$store.dispatch("removeDialogAnswer",{dataObject:{dialogAnswerId:s.id}}).then(o=>{this.loading=!1,this.loadDialogs()}).catch(()=>{this.loading=!1})},loadDialogs(s=0){this.loading=!0,this.$store.dispatch("loadLinkedDialogCommands",{dataObject:{botId:this.bot.id||null,order:"id",direction:"asc"},page:s,size:100}).then(t=>{this.loading=!1;let o=t.data;this.dialog_commands=o.data||[],delete o.data,this.dialog_commands_paginate_object=o}).catch(()=>{this.loading=!1})},doCommandLink(s){this.loading=!0,this.commandForm.next_bot_dialog_command_id=s},submit(){this.loading=!0;let s=new FormData;if(Object.keys(this.commandForm).forEach(t=>{const o=this.commandForm[t]||"";typeof o=="object"?s.append(t,JSON.stringify(o)):s.append(t,o)}),this.photos){for(let t=0;t<this.photos.length;t++)s.append("files[]",this.photos[t]);s.delete("photos")}this.$store.dispatch(this.commandForm.id?"updateDialogCommand":"createDialogCommand",{dialogCommandForm:s}).then(t=>{this.loading=!1,this.$notify({title:"Конструктор ботов",text:"Успешная обработка диалоговой команды",type:"success"}),this.commandForm.id==null&&(this.commandForm={id:null,slug:null,pre_text:null,post_text:null,error_text:null,input_pattern:null,inline_keyboard_id:null,images:null,next_bot_dialog_command_id:null,bot_dialog_group_id:null,result_channel:null,inline_keyboard:null,is_inform:!1,is_empty:!1,result_flags:[],answers:[],store_to:null,custom_stored_value:null,use_result_as:null},this.photos=[]),this.$emit("callback")}).catch(t=>{this.loading=!1})},getPhoto(s){return{imageUrl:URL.createObjectURL(s)}},removePhoto(s,t){this[s].splice(t,1)},onChangePhotos(s){const t=s.target.files;for(let o=0;o<t.length;o++)this.photos.push(t[o])},addTextTo(s={param:null,text:null}){this.commandForm[s.param]=s.text},selectFlag(s){(!this.commandForm.result_flags||!Array.isArray(this.commandForm.result_flags))&&(this.commandForm.result_flags=[]);let t=this.commandForm.result_flags.indexOf(s.key);t===-1?this.commandForm.result_flags.push(s.key):this.commandForm.result_flags.splice(t,1)}}},he=Object.assign(Bu,{__name:"BotDialogCommandForm",setup(s){return(t,o)=>{const a=T("lazy");return l(),i("form",{onSubmit:o[35]||(o[35]=S((...n)=>t.submit&&t.submit(...n),["prevent"]))},[e("div",Pd,[e("button",Ud,[Ad,t.commandForm.id?(l(),i("span",Od,"Обновить диалог #"+u(t.commandForm.id),1)):(l(),i("span",Id,"Добавить диалог"))])]),e("ul",Qd,[e("li",Td,[e("a",{class:p(["nav-link",{active:t.tab===0}]),onClick:o[0]||(o[0]=n=>t.tab=0),"aria-current":"page",href:"javascript:void(0)"},[Bd,m(" Основное")],2)]),e("li",Md,[e("a",{class:p(["nav-link",{active:t.tab===1}]),onClick:o[1]||(o[1]=n=>t.tab=1),href:"javascript:void(0)"},[Rd,m(" Связывание диалогов")],2)]),t.commandForm.is_inform?r("",!0):(l(),i("li",Dd,[e("a",{class:p(["nav-link",{active:t.tab===2}]),onClick:o[2]||(o[2]=n=>t.tab=2),href:"javascript:void(0)"},[Ed,m(" Дополнительное")],2)])),t.commandForm.is_empty?(l(),i("li",Ld,[e("a",{class:p(["nav-link",{active:t.tab===3}]),onClick:o[3]||(o[3]=n=>t.tab=3),href:"javascript:void(0)","aria-disabled":"true"},[Kd,m(" Вычисление результата")],2)])):r("",!0)]),t.tab===0?(l(),i("div",Nd,[e("div",Jd,[c(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":o[4]||(o[4]=n=>t.commandForm.is_inform=n),id:"need-inform-dialog"+(t.commandForm.id||"new"),checked:""},null,8,Hd),[[k,t.commandForm.is_inform]]),e("label",{class:"form-check-label",for:"need-inform-dialog"+(t.commandForm.id||"new")}," Диалог только выводит данные ",8,Gd)]),t.commandForm.is_inform?r("",!0):(l(),i("div",Yd,[c(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":o[5]||(o[5]=n=>t.commandForm.is_empty=n),id:"need-empty-dialog"+(t.commandForm.id||"new"),checked:""},null,8,Wd),[[k,t.commandForm.is_empty]]),e("label",{class:"form-check-label",for:"need-empty-dialog"+(t.commandForm.id||"new")}," Диалог завершает цепочку (только вывод информации) ",8,Zd)])),t.commandForm.is_inform?(l(),i("div",Xd," Данный диалог позволит вам сразу вызвать связанный с ним другой диалог без ожидания ввод данных от пользователя! ")):r("",!0),b(me,{modelValue:t.commandForm.pre_text,"onUpdate:modelValue":o[6]||(o[6]=n=>t.commandForm.pre_text=n),bot:s.bot},null,8,["modelValue","bot"]),e("div",xd,[c(e("textarea",{class:"form-control",id:"commandForm-pre-text-"+t.commandForm.id,placeholder:"Начни с малого...","onUpdate:modelValue":o[7]||(o[7]=n=>t.commandForm.pre_text=n),required:""},`
                `,8,er),[[_,t.commandForm.pre_text]]),e("label",{for:"commandForm-pre-text-"+t.commandForm.id},"Текст диалога",8,tr)]),t.commandForm.is_empty?(l(),i("div",sr,[e("div",or,[lr,e("div",ir,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[8]||(o[8]=n=>t.commandForm.send_params.send_by_text=n),type:"checkbox",role:"switch",id:"send-result-by-text"+(t.commandForm.id||"new")},null,8,nr),[[k,t.commandForm.send_params.send_by_text]]),e("label",{class:"form-check-label",for:"send-result-by-text"+(t.commandForm.id||"new")},"Отправить текстом",8,ar)]),t.commandForm.send_params.send_by_text?(l(),i(g,{key:0},[e("div",dr,[m(" Выберите шаблон из списка "),b(me,{class:"d-inline",modelValue:t.commandForm.send_params.format,"onUpdate:modelValue":o[9]||(o[9]=n=>t.commandForm.send_params.format=n),bot:s.bot},null,8,["modelValue","bot"]),m(" для форматирования результата или оставьте поле пустым, тогда будут выданы все полученные данные. Если каких-то полей не будет в результате - они будут проигнорированы. ")]),e("div",rr,[c(e("textarea",{class:"form-control",id:"commandForm-send-params-format-"+(t.commandForm.id||"new"),placeholder:"Начни с малого...","onUpdate:modelValue":o[10]||(o[10]=n=>t.commandForm.send_params.format=n)},`
                                `,8,cr),[[_,t.commandForm.send_params.format]]),e("label",{for:"commandForm-send-params-format-"+(t.commandForm.id||"new")},"Шаблон результата",8,ur)])],64)):r("",!0),e("div",mr,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[11]||(o[11]=n=>t.commandForm.send_params.send_by_file=n),type:"checkbox",role:"switch",id:"send-result-by-file"+(t.commandForm.id||"new")},null,8,hr),[[k,t.commandForm.send_params.send_by_file]]),e("label",{class:"form-check-label",for:"send-result-by-file"+(t.commandForm.id||"new")},"Отправить файлом",8,_r)]),e("div",pr,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[12]||(o[12]=n=>t.commandForm.send_params.send_to_mail=n),type:"checkbox",role:"switch",id:"send-result-to-mail"+(t.commandForm.id||"new")},null,8,br),[[k,t.commandForm.send_params.send_to_mail]]),e("label",{class:"form-check-label",for:"send-result-to-mail"+(t.commandForm.id||"new")},"Отправить на почту",8,fr)]),t.commandForm.send_params.send_to_mail?(l(),i("div",gr,[c(e("input",{type:"email","onUpdate:modelValue":o[13]||(o[13]=n=>t.commandForm.send_params.mail=n),class:"form-control",id:"floatingInput",placeholder:"name@example.com",required:""},null,512),[[_,t.commandForm.send_params.mail]]),yr])):r("",!0)])])):r("",!0),t.commandForm.is_empty?r("",!0):(l(),i("div",vr,[e("div",$r,[c(e("input",{type:"text",class:"form-control",id:"floatingPassword","onUpdate:modelValue":o[14]||(o[14]=n=>t.commandForm.use_result_as=n),placeholder:"Password"},null,512),[[_,t.commandForm.use_result_as]]),kr])])),t.commandForm.is_empty?r("",!0):(l(),i("div",Fr,[c(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":o[15]||(o[15]=n=>t.need_custom_stored_value=n),id:"need-custom-stored-value"},null,512),[[k,t.need_custom_stored_value]]),wr])),!t.commandForm.is_empty&&t.need_custom_stored_value?(l(),i("div",Cr,[e("div",Sr,[c(e("input",{type:"text",class:"form-control",id:"custom_stored_value","onUpdate:modelValue":o[16]||(o[16]=n=>t.commandForm.custom_stored_value=n),placeholder:"Password"},null,512),[[_,t.commandForm.custom_stored_value]]),jr])])):r("",!0),!t.commandForm.is_empty&&!t.commandForm.is_inform?(l(),i("div",Vr,[c(e("textarea",{class:"form-control",disabled:t.commandForm.is_inform,id:"commandForm-post-text-"+t.commandForm.id,placeholder:"Начни с малого...","onUpdate:modelValue":o[17]||(o[17]=n=>t.commandForm.post_text=n)},`
            `,8,qr),[[_,t.commandForm.post_text]]),e("label",{for:"commandForm-post-text-"+t.commandForm.id},"Текст после успешного завершения диалога",8,zr)])):r("",!0)])):r("",!0),t.tab===1?(l(),i("div",Pr,[e("div",Ur,[t.filteredCommands.length>0?(l(),i("div",Ar,[Or,t.commandForm.id?(l(),i("div",Ir,[e("button",{type:"button",onClick:o[18]||(o[18]=(...n)=>t.toggleRepeatSelfDialog&&t.toggleRepeatSelfDialog(...n)),class:p([{"btn-outline-primary":t.commandForm.next_bot_dialog_command_id!==t.commandForm.id,"btn-primary":t.commandForm.next_bot_dialog_command_id===t.commandForm.id},"btn"])},[Qr,m(" Зациклить диалог на себе в случае ошибки ")],2)])):r("",!0),(l(!0),i(g,null,$(t.filteredCommands,(n,d)=>(l(),i("div",Tr,[e("button",Br,[e("span",null,[t.commandForm.next_bot_dialog_command_id==n.id?(l(),i("i",{key:0,class:"fa-solid fa-unlink text-danger mr-2",onClick:o[19]||(o[19]=h=>t.doCommandLink(null))})):(l(),i("i",{key:1,onClick:h=>t.doCommandLink(n.id),class:"fa-solid fa-link mr-2 text-success"},null,8,Mr)),m(" [#"+u(n.id)+"] Текст диалога: "+u(n.pre_text||"Без текста"),1)])])]))),256)),t.dialog_commands_paginate_object?(l(),v(V,{key:1,onPagination_page:t.nextDialogs,pagination:t.dialog_commands_paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])):(l(),i("div",Rr,Er))])])):r("",!0),t.tab===2?(l(),i("div",Lr,[e("div",Kr,[c(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":o[20]||(o[20]=n=>t.need_additional_functions=n),id:"need-additional-functions"},null,512),[[k,t.need_additional_functions]]),Nr]),!t.commandForm.is_empty&&t.need_additional_functions?(l(),i("div",Jr,[c(e("textarea",{type:"text",class:"form-control",id:"commandForm-error-text-"+t.commandForm.id,placeholder:"Начни с малого...","onUpdate:modelValue":o[21]||(o[21]=n=>t.commandForm.error_text=n)},`
            `,8,Hr),[[_,t.commandForm.error_text]]),e("label",{for:"commandForm-error-text-"+t.commandForm.id},"Текст на случай ошибки корректности данных",8,Gr)])):r("",!0),!t.commandForm.is_empty&&t.need_additional_functions?(l(),i("div",Yr,[e("div",Wr,[Zr,b(qa,{param:"input_pattern",onCallback:t.addTextTo},null,8,["onCallback"])]),e("div",Xr,[c(e("input",{type:"text","onUpdate:modelValue":o[22]||(o[22]=n=>t.commandForm.input_pattern=n),maxlength:"255",class:"form-control",id:"commandForm-input-pattern-"+t.commandForm.id,placeholder:"Регулярное выражение"},null,8,xr),[[_,t.commandForm.input_pattern]]),e("label",{for:"commandForm-result-channel-"+t.commandForm.id},"Регулярное выражение",8,ec)])])):r("",!0),t.need_additional_functions?(l(),i("div",tc,[e("div",sc,[oc,s.bot?(l(),v(Ce,{key:0,token:s.bot.bot_token,param:"result_channel",onCallback:t.addTextTo},null,8,["token","onCallback"])):r("",!0)]),e("div",lc,[c(e("input",{type:"number","onUpdate:modelValue":o[23]||(o[23]=n=>t.commandForm.result_channel=n),class:"form-control",id:"commandForm-result-channel-"+t.commandForm.id,placeholder:"id канала"},null,8,ic),[[_,t.commandForm.result_channel]]),e("label",{for:"commandForm-result-channel-"+t.commandForm.id},"id канала",8,nc)])])):r("",!0),t.need_additional_functions?(l(),i("div",ac,[e("div",dc,[c(e("select",{class:"form-select","onUpdate:modelValue":o[24]||(o[24]=n=>t.commandForm.store_to=n),id:"store_variants","aria-label":"Floating label select example"},[rc,(l(!0),i(g,null,$(t.store_variants,n=>(l(),i("option",{value:n.key},u(n.title||"Не указано"),9,cc))),256))],512),[[B,t.commandForm.store_to]]),uc])])):r("",!0),e("div",mc,[c(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":o[25]||(o[25]=n=>t.need_images=n),id:"need-dialog-image",checked:""},null,512),[[k,t.need_images]]),hc]),t.need_images?(l(),i("div",_c,[e("div",pc,[bc,e("div",fc,[e("label",gc,[yc,e("input",{type:"file",id:"location-photos",multiple:"",accept:"image/*",onChange:o[26]||(o[26]=(...n)=>t.onChangePhotos&&t.onChangePhotos(...n)),style:{display:"none"}},null,32)]),t.photos.length>0?(l(!0),i(g,{key:0},$(t.photos,(n,d)=>(l(),i("div",vc,[c(e("img",null,null,512),[[a,t.getPhoto(n).imageUrl]]),e("div",$c,[e("a",{onClick:h=>t.removePhoto("photos",d)},"Удалить",8,kc)])]))),256)):r("",!0),t.commandForm.images&&s.bot?(l(!0),i(g,{key:1},$(t.commandForm.images,(n,d)=>(l(),i("div",Fc,[c(e("img",null,null,512),[[a,"/images-by-bot-id/"+s.bot.id+"/"+n]]),e("div",wc,[e("a",{onClick:h=>t.removePhoto("images",d)},"Удалить",8,Cc)])]))),256)):r("",!0)])])])):r("",!0),e("div",Sc,[c(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":o[27]||(o[27]=n=>t.need_inline_keyboard=n),id:"need-dialog-menu-inline",checked:""},null,512),[[k,t.need_inline_keyboard]]),jc]),t.need_inline_keyboard?(l(),i("div",Vc,[qc,e("div",zc,[b(I,{type:"inline",modelValue:t.commandForm.inline_keyboard,"onUpdate:modelValue":o[28]||(o[28]=n=>t.commandForm.inline_keyboard=n)},null,8,["modelValue"])])])):r("",!0),e("div",Pc,[c(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":o[29]||(o[29]=n=>t.need_reply_keyboard=n),id:"need-dialog-menu-reply",checked:""},null,512),[[k,t.need_reply_keyboard]]),Uc]),t.need_reply_keyboard?(l(),i("div",Ac,[Oc,e("div",Ic,[b(I,{type:"reply",modelValue:t.commandForm.reply_keyboard,"onUpdate:modelValue":o[30]||(o[30]=n=>t.commandForm.reply_keyboard=n)},null,8,["modelValue"])])])):r("",!0),e("div",Qc,[c(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":o[31]||(o[31]=n=>t.need_chains=n),id:"need-chains",checked:""},null,512),[[k,t.need_chains]]),Tc]),t.need_chains?(l(),i("div",Bc,[e("button",{type:"button",class:"btn btn-outline-primary",onClick:o[32]||(o[32]=(...n)=>t.addAnswer&&t.addAnswer(...n))},"Добавить вариант ответа "),t.commandForm.answers.length>0?(l(),i("table",Mc,[e("tbody",null,[(l(!0),i(g,null,$(t.commandForm.answers,(n,d)=>(l(),i(g,null,[Rc,e("tr",null,[e("td",Dc,[t.commandForm.answers[d].in_edit_mode?(l(),i("span",{key:1,onClick:h=>t.commandForm.answers[d].in_edit_mode=!1},Hc,8,Nc)):(l(),i("span",{key:0,onClick:h=>t.commandForm.answers[d].in_edit_mode=!0},Kc,8,Ec))]),e("th",Gc,u(d+1),1),e("td",null,[e("div",Yc,[e("span",Wc,[c(e("input",{class:"form-check-input","onUpdate:modelValue":h=>t.commandForm.answers[d].need_print=h,type:"checkbox",value:"",id:"flexCheckDefault"},null,8,Zc),[[k,t.commandForm.answers[d].need_print]])]),e("div",Xc,[c(e("input",{type:"text","onUpdate:modelValue":h=>t.commandForm.answers[d].answer=h,class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,8,xc),[[_,t.commandForm.answers[d].answer]]),eu])])]),e("td",null,[e("div",tu,[e("div",su,[c(e("input",{type:"text",class:"form-control","onUpdate:modelValue":h=>t.commandForm.answers[d].next_bot_dialog_command_id=h,id:"floatingInput",placeholder:"name@example.com",required:""},null,8,ou),[[_,t.commandForm.answers[d].next_bot_dialog_command_id]]),lu]),e("div",iu,[nu,e("div",au,[e("ul",du,[e("li",{class:"list-group-item cursor-pointer font-12",onClick:h=>t.commandForm.answers[d].next_bot_dialog_command_id=null}," Не выбран ",8,ru),(l(!0),i(g,null,$(t.getDialogCommands,h=>(l(),i("li",{class:"list-group-item cursor-pointer font-12",style:{"line-height":"100%","text-align":"left"},onClick:f=>t.commandForm.answers[d].next_bot_dialog_command_id=h.id}," #"+u(h.id||"-")+" "+u(h.pre_text||"-"),9,cu))),256))]),e("div",uu,[t.dialog_commands_paginate_object?(l(),v(V,{key:0,onPagination_page:t.nextDialogs,pagination:t.dialog_commands_paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])])])])]),e("td",null,[e("div",mu,[hu,e("ul",_u,[e("li",null,[e("a",{class:"dropdown-item",onClick:h=>t.removeDialogAnswer(n,d),href:"javascript:void(0)"},"Удалить",8,pu)])])])])]),t.commandForm.answers[d].in_edit_mode?(l(),i("tr",bu,[fu,gu,e("td",null,[e("div",yu,[e("div",vu,[c(e("input",{type:"text","onUpdate:modelValue":h=>t.commandForm.answers[d].pattern=h,class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,8,$u),[[_,t.commandForm.answers[d].pattern]]),ku]),e("div",Fu,[wu,e("ul",Cu,[e("li",null,[e("a",{class:"dropdown-item",onClick:h=>t.commandForm.answers[d].pattern=null,href:"javascript:void(0)"},"Не выбран",8,Su)]),e("li",null,[(l(!0),i(g,null,$(t.patterns,h=>(l(),i("a",{class:"dropdown-item",onClick:f=>t.commandForm.answers[d].pattern=h.value,href:"javascript:void(0)"},u(h.title||"-"),9,ju))),256))])])])])]),e("td",null,[e("div",Vu,[c(e("input",{type:"text","onUpdate:modelValue":h=>t.commandForm.answers[d].custom_stored_value=h,class:"form-control",id:"custom_stored_value-"+d,placeholder:"name@example.com"},null,8,qu),[[_,t.commandForm.answers[d].custom_stored_value]]),e("label",{for:"custom_stored_value-"+d},"Поместить данный текст в переменную",8,zu)])])])):r("",!0)],64))),256))])])):(l(),i("div",Pu," Добавьте один или несколько вариантов ответов "))])):r("",!0),e("div",Uu,[c(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":o[33]||(o[33]=n=>t.need_set_flags=n),id:"need-set-flags",checked:""},null,512),[[k,t.need_set_flags]]),Au]),t.need_set_flags?(l(),i("div",Ou,[Iu,(l(!0),i(g,null,$(t.flags_variants,n=>(l(),i("span",{class:p(["badge text-info mr-2",{"bg-info text-white":t.commandForm.result_flags.indexOf(n.key)!=-1}]),onClick:d=>t.selectFlag(n)},u(n.title),11,Qu))),256))])):r("",!0)])):r("",!0),t.tab===3?(l(),i("div",Tu,[b(kd,{modelValue:t.commandForm.rules,"onUpdate:modelValue":o[34]||(o[34]=n=>t.commandForm.rules=n)},null,8,["modelValue"])])):r("",!0)],32)}}});const Mu={class:"row"},Ru={class:"col-md-2 col-12"},Du=e("i",{class:"fa-regular fa-comment-dots",style:{"margin-right":"10px"}},null,-1),Eu={class:"col-md-10 col-12"},Lu={class:"input-group mb-3"},Ku={style:{width:"200px !important"}},Nu=H('<option value="25">25</option><option value="50">50</option><option value="100">100</option><option value="500">500</option><option value="1000">1000</option>',5),Ju=[Nu],Hu={key:0,class:"row"},Gu={class:"col-md-12"},Yu={class:"table"},Wu=e("th",{class:"text-left",scope:"col",style:{width:"40px"}},null,-1),Zu=e("th",{class:"text-center",scope:"col",style:{width:"40px"}},"Команды",-1),Xu=["id"],xu={style:{width:"40px"}},em=["onClick"],tm=e("i",{class:"fa-solid fa-toggle-off cursor-pointer text-secondary"},null,-1),sm=[tm],om=["onClick"],lm=e("i",{class:"fa-solid fa-toggle-on cursor-pointer text-primary"},null,-1),im=[lm],nm={scope:"row",class:"text-left",style:{width:"80px"}},am={class:"d-flex justify-content-start align-items-center"},dm={key:0,class:"fa-solid fa-flag-checkered ml-2"},rm={key:1,class:"fa-solid fa-sitemap ml-2"},cm={key:2,class:"fa-solid fa-arrows-rotate ml-2"},um={class:"text-left",style:{"min-width":"400px"}},mm={key:0,class:"dropdown"},hm={style:{"line-height":"100%","font-size":"14px","text-align":"left"},class:"btn btn-link m-0 p-0 text-decoration-none",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},_m={class:"dropdown-menu p-2"},pm=["onSubmit"],bm=e("p",{class:"mb-0"},"Значение",-1),fm=["onUpdate:modelValue"],gm=e("button",{class:"btn btn-outline-primary mt-2 w-100 text-center"}," Сохранить ",-1),ym={class:"dropdown my-2"},vm={style:{"text-align":"left !important"},class:"text-decoration-none fst-italic color-black w-100 d-flex justify-content-between align-items-center",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},$m={class:"dropdown-menu p-4 text-body-secondary",style:{"max-width":"400px","min-width":"400px",height:"200px","overflow-y":"scroll"}},km=e("h6",null,"Основные параметры диалога",-1),Fm={class:"table"},wm=e("td",null,"Есть ответы",-1),Cm={key:0},Sm={key:1},jm=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),Vm=[jm],qm=e("td",null,"Цепочки",-1),zm={key:0,class:"badge bg-primary"},Pm={key:1},Um=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),Am=[Um],Om=e("td",null,"Текст успеха",-1),Im={key:0},Qm={key:1},Tm=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),Bm=[Tm],Mm=e("td",null,"Текст ошибки",-1),Rm={key:0},Dm={key:1},Em=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),Lm=[Em],Km=e("td",null,"Канал результата",-1),Nm={key:0},Jm={key:1},Hm=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),Gm=[Hm],Ym=e("td",null,"Флаги",-1),Wm={key:0},Zm={class:"badge bg-primary"},Xm={key:1},xm=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),eh=[xm],th=e("td",null,"Сохранить в",-1),sh={key:0},oh={key:1},lh=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),ih=[lh],nh=e("td",null,"Есть изображения",-1),ah={key:0,class:"fa-solid fa-check text-success"},dh={key:1,class:"fa-solid fa-xmark text-danger"},rh=e("td",null,"Есть паттерны",-1),ch={key:0},uh={key:1},mh=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),hh=[mh],_h=e("td",null,"Пустой",-1),ph={key:0,class:"fa-solid fa-check text-success"},bh={key:1,class:"fa-solid fa-xmark text-danger"},fh=e("td",null,"Информационный",-1),gh={key:0,class:"fa-solid fa-check text-success"},yh={key:1,class:"fa-solid fa-xmark text-danger"},vh=e("td",null,"Есть кнопки",-1),$h={key:0,class:"fa-solid fa-check text-success"},kh={key:1,class:"fa-solid fa-xmark text-danger"},Fh=e("td",null,"Есть меню",-1),wh={key:0,class:"fa-solid fa-check text-success"},Ch={key:1,class:"fa-solid fa-xmark text-danger"},Sh={key:1,class:"small font-bold m-0"},jh=e("i",{class:"fa-solid fa-angles-right mx-2"},null,-1),Vh={style:{width:"150px"}},qh={class:"form-check"},zh=["onChange","onUpdate:modelValue","id"],Ph=["for"],Uh={style:{width:"90px"},class:"cursor-pointer"},Ah={class:"d-flex m-0 align-items-center"},Oh=["href"],Ih=e("i",{class:"fa-solid fa-anchor"},null,-1),Qh=[Ih],Th=e("i",{class:"fa-solid fa-angles-right mr-1"},null,-1),Bh=["onClick"],Mh=e("small",{class:"ml-1"},[e("i",{class:"fa-solid fa-arrow-up-right-from-square text-primary"})],-1),Rh=e("td",null,[e("i",{class:"fa-solid fa-arrow-right-long mx-2"})],-1),Dh={style:{"max-width":"770px"}},Eh={class:"dropdown"},Lh={style:{"line-height":"100%","font-size":"10px","text-align":"left"},class:"btn btn-link m-0 p-0 text-decoration-none",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},Kh={key:0},Nh={key:1},Jh={class:"dropdown-menu p-2"},Hh=["onSubmit"],Gh=e("p",{class:"mb-0"},"Значение",-1),Yh=["onUpdate:modelValue"],Wh=e("button",{class:"btn btn-outline-primary mt-2 w-100 text-center"}," Сохранить ",-1),Zh={key:0},Xh={key:0,class:"text-danger font-bold"},xh={key:1,class:"text-success font-bold"},e_={key:2,class:"text-warning font-bold"},t_={class:"cursor-pointer"},s_={class:"d-flex mb-0"},o_=["href"],l_=e("i",{class:"fa-solid fa-anchor"},null,-1),i_=[l_],n_=["onClick"],a_=e("i",{class:"fa-solid fa-angles-right mr-1"},null,-1),d_=e("small",{class:"ml-1"},[e("i",{class:"fa-solid fa-arrow-up-right-from-square text-primary"})],-1),r_={key:0},c_=e("i",{class:"fa-solid fa-arrow-right-long mx-2"},null,-1),u_=[c_],m_={key:1,style:{"max-width":"770px"}},h_={class:"mb-0",style:{"line-height":"100%","font-size":"10px"}},__={class:"text-center",style:{width:"40px"}},p_={class:"dropdown"},b_=["disabled"],f_=e("i",{class:"fa-solid fa-ellipsis"},null,-1),g_=[f_],y_={class:"dropdown-menu"},v_=["onClick"],$_=e("i",{class:"fa-solid fa-arrow-left mr-1"},null,-1),k_=e("hr",null,null,-1),F_=["onClick"],w_=e("i",{class:"fa-solid fa-clone mr-1"},null,-1),C_=["onClick"],S_=e("i",{class:"fa-solid fa-trash-can mr-1"},null,-1),j_={key:0},V_={colspan:"17"},q_={key:1,class:"row"},z_=e("div",{class:"col-12"},[e("div",{class:"alert alert-danger",role:"alert"}," Не найдено ни одного диалога! ")],-1),P_=[z_],U_={class:"modal fade",id:"dialog-command-modal-editor",tabindex:"-1"},A_={class:"modal-dialog modal-fullscreen"},O_={class:"modal-content"},I_=e("div",{class:"modal-header"},[e("h1",{class:"modal-title fs-5",id:"staticBackdropLabel"}," Создание диалогового сообщения "),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Q_={class:"modal-body"},T_=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),B_={data(){return{direction:"desc",order:"updated_at",size:500,variables:[],bot:null,selected:null,loading:!0,current_page:0,dialog_commands:[],search:null,dialog_commands_paginate_object:null}},computed:{...C(["getDialogCommands","getCurrentBot","getDialogCommandsPaginateObject"])},mounted(){this.loadCurrentBot().then(()=>{let s=localStorage.getItem("cashman_dialogs_current_page_"+this.bot.id)||0;this.loadDialogs(s)})},methods:{updateDialogCommand(s){let t=new FormData;Object.keys(s).forEach(o=>{const a=s[o]||"";typeof a=="object"?t.append(o,JSON.stringify(a)):t.append(o,a)}),this.$store.dispatch("updateDialogCommand",{dialogCommandForm:t}).then(o=>{this.loading=!1,this.$notify({title:"Конструктор ботов",text:"Успешная обработка диалоговой команды",type:"success"})}).catch(()=>{this.$notify({title:"Конструктор ботов",text:"Ошибка обработки диалоговой команды",type:"error"})})},updateAnswer(s){this.$store.dispatch("updatedDialogAnswer",{...s,bot_id:this.bot.id}).then(t=>{this.$notify({title:"Конструктор ботов",text:"Текст успешно обновлен",type:"success"})}).catch(t=>{})},loadAndOrder(s){this.order=s,this.direction=this.direction==="desc"?"asc":"desc",this.loadDialogs(0)},loadAndOpenEditor(s){this.loading=!0,this.$store.dispatch("loadLinkedDialogCommand",{command_id:s,bot_id:this.bot.id}).then(t=>{this.selected=t.data,console.log(t.data),this.loading=!1,new bootstrap.Modal(document.getElementById("dialog-command-modal-editor"),{}).show()}).catch(()=>{this.$notify({title:"Конструктор ботов",text:"Ошибка работы с командой",type:"error"})})},openEditor(s){this.loading=!0,s||this.dialog_commands.forEach(t=>{t.in_edit_mode=!1}),this.$nextTick(()=>{this.selected=s,this.loading=!1})},removeCommand(s){this.loading=!0,this.$store.dispatch("removeDialogCommand",{dataObject:{dialogCommandId:s}}).then(t=>{this.loading=!1,this.$notify({title:"Конструктор ботов",text:"Диалоговая команда успешно удалена!",type:"success"}),this.loadDialogs(),this.$emit("callback")}).catch(t=>{this.loading=!1})},duplicate(s){this.loading=!0,this.$store.dispatch("duplicateDialogCommand",{dataObject:{dialogCommandId:s}}).then(t=>{this.loading=!1,this.$notify({title:"Конструктор ботов",text:"Диалоговая команда успешно продублирована!",type:"success"}),this.loadDialogs(),this.$emit("callback")}).catch(t=>{this.loading=!1})},toggleEditMode(s){this.selected=s,s.in_edit_mode=!s.in_edit_mode},loadCurrentBot(s=null){return this.$store.dispatch("updateCurrentBot",{bot:s}).then(()=>{this.bot=this.getCurrentBot})},selectDialog(s){this.$emit("select-dialog",s),this.$notify("Вы выбрали диалог из списка!")},nextDialogs(s){this.loadDialogs(s)},selectElement(s){this.loading=!0,this.$nextTick(()=>{this.selected=this.dialog_commands.find(t=>t.id===s)||null,this.loading=!1})},loadDialogs(s=0){this.current_page=s,localStorage.setItem("cashman_dialogs_current_page_"+this.bot.id,this.current_page),this.$store.dispatch("loadDialogCommands",{dataObject:{botId:this.bot.id||null,search:this.search,order:this.order,direction:this.direction},page:s,size:this.size||25}).then(t=>{const o=this.selected;this.dialog_commands=this.getDialogCommands,this.dialog_commands_paginate_object=this.getDialogCommandsPaginateObject,this.loading=!0,this.$nextTick(()=>{o&&(this.selected=this.dialog_commands.find(a=>a.id===o.id)||null,this.selected.in_edit_mode=!1),this.loading=!1})}).catch(()=>{this.loading=!1})}}},ze=Object.assign(B_,{__name:"BotDialogGroupList",setup(s){return(t,o)=>(l(),i(g,null,[e("div",Mu,[e("div",Ru,[e("button",{type:"button",onClick:o[0]||(o[0]=a=>t.openEditor(null)),"data-bs-toggle":"modal","data-bs-target":"#dialog-command-modal-editor",class:"btn btn-outline-success mb-2 w-100"},[Du,m("Новый диалог ")])]),e("div",Eu,[e("div",Lu,[c(e("input",{type:"search",class:"form-control",placeholder:"Поиск диалога","aria-label":"Поиск диалога","onUpdate:modelValue":o[1]||(o[1]=a=>t.search=a),"aria-describedby":"button-addon2"},null,512),[[_,t.search]]),e("div",Ku,[c(e("select",{onChange:o[2]||(o[2]=a=>t.loadDialogs(t.current_page)),"onUpdate:modelValue":o[3]||(o[3]=a=>t.size=a),class:"form-select rounded-0"},Ju,544),[[B,t.size]])]),e("button",{class:"btn btn-outline-secondary",onClick:o[4]||(o[4]=a=>t.loadDialogs(0)),type:"button",id:"button-addon2"},"Найти ")])])]),t.dialog_commands.length>0?(l(),i("div",Hu,[e("div",Gu,[e("table",Yu,[e("thead",null,[e("tr",null,[Wu,e("th",{class:"text-left cursor-pointer",scope:"col",onClick:o[5]||(o[5]=a=>t.loadAndOrder("id")),style:{width:"80px"}}," # "),e("th",{class:"text-left cursor-pointer",scope:"col",onClick:o[6]||(o[6]=a=>t.loadAndOrder("pre_text")),style:{"min-width":"400px"}},"Текст диалога "),Zu])]),e("tbody",null,[(l(!0),i(g,null,$(t.dialog_commands,(a,n)=>(l(),i(g,null,[e("tr",{id:"key-"+a.id},[e("td",xu,[a.in_edit_mode?(l(),i("span",{key:1,onClick:d=>t.toggleEditMode(a)},im,8,om)):(l(),i("span",{key:0,onClick:d=>t.toggleEditMode(a)},sm,8,em))]),e("th",nm,[e("span",am,[m(u(a.id)+" ",1),a.is_empty?(l(),i("i",dm)):r("",!0),a.is_inform?(l(),i("i",rm)):r("",!0),a.next_bot_dialog_command_id===a.id?(l(),i("i",cm)):r("",!0)])]),e("td",um,[a.is_empty?r("",!0):(l(),i("div",mm,[e("button",hm,[m(" Результат будет сохранен в "),e("strong",null,u(a.use_result_as||"не задана"),1)]),e("div",_m,[e("form",{onSubmit:S(d=>t.updateDialogCommand(a),["prevent"]),class:"p-2"},[bm,c(e("textarea",{class:"form-control","onUpdate:modelValue":d=>a.use_result_as=d,name:"",id:"",cols:"30",rows:"10"},null,8,fm),[[_,a.use_result_as]]),gm],40,pm)])])),e("div",ym,[e("button",vm,u(a.pre_text||"-"),1),e("div",$m,[km,e("table",Fm,[e("tbody",null,[e("tr",null,[wm,e("td",null,[(a.answers||[]).length>0?(l(),i("p",Cm,u(a.answers.length),1)):(l(),i("p",Sm,Vm))])]),e("tr",null,[qm,e("td",null,[a.next_bot_dialog_command_id?(l(),i("span",zm,"#"+u(a.next_bot_dialog_command_id||"-")+" ("+u(a.chain.length||0)+")",1)):(l(),i("span",Pm,Am))])]),e("tr",null,[Om,e("td",null,[a.post_text?(l(),i("p",Im,u(a.post_text),1)):(l(),i("p",Qm,Bm))])]),e("tr",null,[Mm,e("td",null,[a.error_text?(l(),i("p",Rm,u(a.error_text),1)):(l(),i("p",Dm,Lm))])]),e("tr",null,[Km,e("td",null,[a.result_channel?(l(),i("p",Nm,u(a.result_channel),1)):(l(),i("p",Jm,Gm))])]),e("tr",null,[Ym,e("td",null,[a.result_flags.length>0?(l(),i("p",Wm,[(l(!0),i(g,null,$(a.result_flags,d=>(l(),i("span",Zm,u(d||"-"),1))),256))])):(l(),i("p",Xm,eh))])]),e("tr",null,[th,e("td",null,[a.store_to?(l(),i("p",sh,u(a.store_to),1)):(l(),i("p",oh,ih))])]),e("tr",null,[nh,e("td",null,[(a.images||[]).length>0?(l(),i("i",ah)):(l(),i("i",dh))])]),e("tr",null,[rh,e("td",null,[a.input_pattern?(l(),i("p",ch,u(a.input_pattern),1)):(l(),i("p",uh,hh))])]),e("tr",null,[_h,e("td",null,[a.is_empty?(l(),i("i",ph)):(l(),i("i",bh))])]),e("tr",null,[fh,e("td",null,[a.is_inform?(l(),i("i",gh)):(l(),i("i",yh))])]),e("tr",null,[vh,e("td",null,[a.inline_keyboard_id!=null?(l(),i("i",$h)):(l(),i("i",kh))])]),e("tr",null,[Fh,e("td",null,[a.reply_keyboard_id!=null?(l(),i("i",wh)):(l(),i("i",Ch))])])])])])]),(a.next_bot_dialog_command_id||(a.answers||[]).length>0)&&!a.is_inform?(l(),i("p",Sh,[m("Ответ"),jh,m("диалог")])):r("",!0),e("table",null,[(l(!0),i(g,null,$(a.answers,(d,h)=>(l(),i("tr",null,[e("td",Vh,[e("div",qh,[c(e("input",{class:"form-check-input",onChange:f=>t.updateAnswer(d),"onUpdate:modelValue":f=>a.answers[h].need_print=f,type:"checkbox",value:"",id:"answ-"+h+"-command-"+a.id},null,40,zh),[[k,a.answers[h].need_print]]),e("label",{class:"form-check-label",for:"answ-"+h+"-command-"+a.id},u(d.answer),9,Ph)])]),e("td",Uh,[e("p",Ah,[e("a",{href:"#key-"+d.next_bot_dialog_command_id,class:"mx-2"},Qh,8,Oh),Th,e("span",{class:"d-flex",onClick:f=>t.loadAndOpenEditor(d.next_bot_dialog_command_id)},[m(u(d.next_bot_dialog_command_id)+" ",1),Mh],8,Bh)])]),Rh,e("td",Dh,[e("div",Eh,[e("button",Lh,[d.custom_stored_value?(l(),i("span",Kh,u(d.custom_stored_value||"-"),1)):(l(),i("span",Nh,"нажмите, чтобы добавить"))]),e("div",Jh,[e("form",{onSubmit:S(f=>t.updateAnswer(d),["prevent"]),class:"p-2"},[Gh,c(e("textarea",{class:"form-control","onUpdate:modelValue":f=>d.custom_stored_value=f,name:"",id:"",cols:"30",rows:"10"},null,8,Yh),[[_,d.custom_stored_value]]),Wh],40,Hh)])])])]))),256)),a.next_bot_dialog_command_id?(l(),i("tr",Zh,[e("td",null,[(a.answers||[]).length>0&&!a.is_inform?(l(),i("span",Xh,"Другой ответ")):r("",!0),(a.answers||[]).length===0&&!a.is_inform?(l(),i("span",xh,"Любой ответ")):r("",!0),(a.answers||[]).length===0&&a.is_inform?(l(),i("span",e_," Переход к диалогу ")):r("",!0)]),e("td",t_,[e("p",s_,[e("a",{href:"#key-"+a.next_bot_dialog_command_id,class:"mx-2"},i_,8,o_),e("span",{onClick:d=>t.loadAndOpenEditor(a.next_bot_dialog_command_id),class:"d-flex align-items-center"},[a_,m(" "+u(a.next_bot_dialog_command_id||"-")+" ",1),d_],8,n_)])]),a.custom_stored_value?(l(),i("td",r_,u_)):r("",!0),a.custom_stored_value?(l(),i("td",m_,[e("p",h_,u(a.custom_stored_value||"-"),1)])):r("",!0)])):r("",!0)])]),e("td",__,[e("div",p_,[e("button",{disabled:t.loading,class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},g_,8,b_),e("ul",y_,[e("li",null,[e("a",{onClick:d=>t.selectDialog(a),title:"Выбрать диалог",class:"dropdown-item cursor-pointer"},[$_,m(" Выбрать диалог ")],8,v_)]),k_,e("li",null,[e("a",{title:"Дублирование команды",onClick:d=>t.duplicate(a.id),class:"dropdown-item cursor-pointer"},[w_,m(" Дублирование диалога ")],8,F_)]),e("li",null,[e("a",{onClick:d=>t.removeCommand(a.id),title:"Удаление команды",class:"dropdown-item cursor-pointer"},[S_,m(" Удаление диалога ")],8,C_)])])])])],8,Xu),a.in_edit_mode?(l(),i("tr",j_,[e("td",V_,[t.bot&&!t.loading?(l(),v(he,{key:0,item:t.selected,onCallback:t.loadDialogs,onSelectElement:t.selectElement,bot:t.bot},null,8,["item","onCallback","onSelectElement","bot"])):r("",!0)])])):r("",!0)],64))),256))])]),t.dialog_commands_paginate_object?(l(),v(V,{key:0,onPagination_page:t.nextDialogs,pagination:t.dialog_commands_paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])])):(l(),i("div",q_,P_)),e("div",U_,[e("div",A_,[e("div",O_,[I_,e("div",Q_,[t.bot&&!t.loading?(l(),v(he,{key:0,item:t.selected,onCallback:t.loadDialogs,onSelectElement:t.selectElement,bot:t.bot},null,8,["item","onCallback","onSelectElement","bot"])):r("",!0)]),T_])])])],64))}}),M_=e("div",{class:"alert alert-success",role:"alert"},' Проверка правил идет по методу "И" - все правила должны выполняться для перехода на данную страницу, иначе будет вызвана страница из блока "иначе". Действия для "иначе" добавлять не обязательно. ',-1),R_=e("h6",null,"Блок условий",-1),D_={key:0,class:"py-2"},E_={class:"form-label",id:"bot-domain"},L_=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),K_=e("div",null,"Напишите текст, который будет отображен пользователю вместе с основным контентом в случае если условие будет выполнено ",-1),N_={class:"dropdown mb-2"},J_=e("button",{class:"btn btn-outline-info dropdown-toggle w-100",type:"button",id:"dropdownMenuButton1","data-bs-toggle":"dropdown","aria-expanded":"false"}," Добавить условие ",-1),H_={class:"dropdown-menu","aria-labelledby":"dropdownMenuButton1"},G_=["onClick"],Y_={key:1},W_={key:2,class:"list-group"},Z_={key:0,class:"list-group-item d-flex justify-content-between align-items-center"},X_={class:"form-check"},x_={class:"form-check-label",for:"bot-user-is-vip"},ep={key:0},tp={key:1},sp=e("i",{class:"fa-solid fa-trash-can"},null,-1),op=[sp],lp={key:1,class:"list-group-item d-flex justify-content-between align-items-center"},ip={class:"form-check"},np={class:"form-check-label",for:"bot-user-is-admin"},ap={key:0},dp={key:1},rp=e("i",{class:"fa-solid fa-trash-can"},null,-1),cp=[rp],up={key:2,class:"list-group-item d-flex justify-content-between align-items-center"},mp={class:"form-check"},hp={class:"form-check-label",for:"bot-user-is-deliveryman"},_p={key:0},pp={key:1},bp=e("i",{class:"fa-solid fa-trash-can"},null,-1),fp=[bp],gp={key:3,class:"list-group-item d-flex justify-content-between align-items-center"},yp={class:"form-check"},vp={class:"form-check-label",for:"bot-user-is-work"},$p={key:0},kp={key:1},Fp=e("i",{class:"fa-solid fa-trash-can"},null,-1),wp=[Fp],Cp={key:4,class:"list-group-item d-flex justify-content-between align-items-center"},Sp={class:"form-check"},jp={class:"form-check-label",for:"bot-user-in-location"},Vp={key:0},qp={key:1},zp=e("i",{class:"fa-solid fa-trash-can"},null,-1),Pp=[zp],Up={key:5,class:"list-group-item d-flex justify-content-between align-items-center"},Ap=e("label",{class:"form-label",id:"bot-domain"}," Возраст от ",-1),Op=e("i",{class:"fa-solid fa-trash-can"},null,-1),Ip=[Op],Qp={key:6,class:"list-group-item d-flex justify-content-between align-items-center"},Tp=e("label",{class:"form-label",id:"bot-domain"}," Только для города ",-1),Bp=e("i",{class:"fa-solid fa-trash-can"},null,-1),Mp=[Bp],Rp={key:7,class:"list-group-item d-flex justify-content-between align-items-center"},Dp={class:"form-check"},Ep={class:"form-check-label",for:"bot-user-sex"},Lp={key:0},Kp={key:1},Np=e("i",{class:"fa-solid fa-trash-can"},null,-1),Jp=[Np],Hp={key:8,class:"list-group-item"},Gp={class:"mb-3"},Yp={class:"d-flex justify-content-between align-items-center"},Wp={class:"form-label d-flex w-100 align-items-center",id:"bot-order-channel"},Zp=["onClick"],Xp=e("i",{class:"fa-solid fa-trash-can"},null,-1),xp=[Xp],eb=["onUpdate:modelValue"],tb={key:3,class:"mt-5"},sb={key:4,class:"d-flex justify-content-between"},ob={key:6,class:"py-2"},lb={class:"form-label",id:"bot-domain"},ib=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),nb=e("div",null,'Напишите текст, который будет отображен пользователю вместе с основным контентом в случае если условие не будет выполнено и будет вызван блок "иначе" ',-1),ab={props:["bot","rulesForm"],data(){return{rules:[{id:1,title:"Является администратором",rules_block:"bot_user",rule:{is_admin:!0}},{id:2,title:"Является VIP-пользователем",rules_block:"bot_user",rule:{is_vip:!0}},{id:3,title:"Находится в заведении",rules_block:"bot_user",rule:{user_in_location:!0}},{id:4,title:"За работой",rules_block:"bot_user",rule:{is_work:!0}},{id:5,title:"Возраст от ...",rules_block:"bot_user",rule:{age:18}},{id:6,title:"Находится в городе ...",rules_block:"bot_user",rule:{city:"Краснодар"}},{id:7,title:"Пол",rules_block:"bot_user",rule:{sex:!0}},{id:8,title:"Состоит в канале",rules_block:"channels",rule:{channel:1}},{id:9,title:"Является Менеджером",rules_block:"bot_user",rule:{is_manager:!0}}]}},computed:{rulesForCustomFields(){let s=this.rules.filter(t=>t.key!=null);return console.log("filtered rules",s),s}},mounted(){},methods:{hasRuleKey(s){return this.rulesForm.rules_if==null?!1:(console.log("key=>",s||"-"),Object.keys(this.rulesForm.rules_if.bot_user).find(t=>t===s)!=null)},modifyChannel(s){this.rulesForm.rules_if.channels[s.param]=s.text},removeChannelFromRule(s){this.rulesForm.rules_if.channels.splice(s,1)},removeRule(s){delete this.rulesForm.rules_if.bot_user[s]},addRules(s){this.rulesForm.rules_if||(this.rulesForm.rules_if={bot_user:{},channels:[]}),s.rules_block==="bot_user"&&(this.rulesForm.rules_if.bot_user={...this.rulesForm.rules_if.bot_user,...s.rule}),s.rules_block==="channels"&&this.rulesForm.rules_if.channels.push(s.rule.channel)},loadCurrentBotFields(){return this.$store.dispatch("loadCurrentBotFields",{bot_id:this.bot.id}).then(s=>{(s.data||[]).forEach(o=>{o.is_active&&(this.rules.push({id:this.rules.length+1,title:o.label,key:o.key,type:o.type,rules_block:"bot_user",rule:{}}),o.type===0&&(this.rules[this.rules.length-1].rule[o.key]=""),o.type===1&&(this.rules[this.rules.length-1].rule[o.key]=0),o.type===2&&(this.rules[this.rules.length-1].rule[o.key]=!0))}),console.log("new rules=>",this.rules)})},attachPageToRule(s){s.id!=this.rulesForm.id?this.rulesForm.rules_else_page_id=s.id:this.$notify({title:"Конструктор страниц",text:"Вы не можете связать данную страницу с собой",type:"error"})}}},db=Object.assign(ab,{__name:"PageRules",setup(s){return(t,o)=>{const a=P("Popper");return l(),i(g,null,[M_,R_,s.rulesForm.rules_if?(l(),i("div",D_,[e("label",E_,[b(a,null,{content:y(()=>[K_]),default:y(()=>[L_]),_:1}),m(" Сообщение при успешном прохождении условий (не обязательно) ")]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Текст сообщения","aria-label":"Текст сообщения","onUpdate:modelValue":o[0]||(o[0]=n=>s.rulesForm.rules_if_message=n),maxlength:"255","aria-describedby":"rules-else-message"},`
            `,512),[[_,s.rulesForm.rules_if_message]])])):r("",!0),e("div",N_,[J_,e("ul",H_,[(l(!0),i(g,null,$(t.rules,n=>(l(),i("li",null,[e("a",{onClick:d=>t.addRules(n),class:"dropdown-item",href:"javascript:void(0)"},u(n.title||"Не указан"),9,G_)]))),256))])]),s.rulesForm.rules_if?(l(),i("h6",Y_,"Выбранные условия")):r("",!0),s.rulesForm.rules_if?(l(),i("ul",W_,[t.hasRuleKey("is_vip")?(l(),i("li",Z_,[e("div",X_,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[1]||(o[1]=n=>s.rulesForm.rules_if.bot_user.is_vip=n),type:"checkbox",id:"bot-user-is-vip"},null,512),[[k,s.rulesForm.rules_if.bot_user.is_vip]]),e("label",x_,[s.rulesForm.rules_if.bot_user.is_vip?(l(),i("span",ep,"Является VIP-пользователем")):(l(),i("span",tp,"Не является VIP-пользователем"))])]),e("button",{type:"button",class:"btn btn-outline-info",onClick:o[2]||(o[2]=n=>t.removeRule("is_vip"))},op)])):r("",!0),t.hasRuleKey("is_admin")?(l(),i("li",lp,[e("div",ip,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[3]||(o[3]=n=>s.rulesForm.rules_if.bot_user.is_admin=n),type:"checkbox",id:"bot-user-is-admin"},null,512),[[k,s.rulesForm.rules_if.bot_user.is_admin]]),e("label",np,[s.rulesForm.rules_if.bot_user.is_admin?(l(),i("span",ap,"Является администратором")):(l(),i("span",dp,"Не является администратором"))])]),e("button",{type:"button",class:"btn btn-outline-info",onClick:o[4]||(o[4]=n=>t.removeRule("is_admin"))},cp)])):r("",!0),t.hasRuleKey("is_deliveryman")?(l(),i("li",up,[e("div",mp,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[5]||(o[5]=n=>s.rulesForm.rules_if.bot_user.is_deliveryman=n),type:"checkbox",id:"bot-user-is-deliveryman"},null,512),[[k,s.rulesForm.rules_if.bot_user.is_deliveryman]]),e("label",hp,[s.rulesForm.rules_if.bot_user.is_deliveryman?(l(),i("span",_p,"Является доставщиком")):(l(),i("span",pp,"Не является доставщиком"))])]),e("button",{type:"button",class:"btn btn-outline-info",onClick:o[6]||(o[6]=n=>t.removeRule("is_deliveryman"))},fp)])):r("",!0),t.hasRuleKey("is_work")?(l(),i("li",gp,[e("div",yp,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[7]||(o[7]=n=>s.rulesForm.rules_if.bot_user.is_work=n),type:"checkbox",id:"bot-user-is-work"},null,512),[[k,s.rulesForm.rules_if.bot_user.is_work]]),e("label",vp,[s.rulesForm.rules_if.bot_user.is_work?(l(),i("span",$p,"За работой")):(l(),i("span",kp,"Не работает"))])]),e("button",{type:"button",class:"btn btn-outline-info",onClick:o[8]||(o[8]=n=>t.removeRule("is_work"))},wp)])):r("",!0),t.hasRuleKey("user_in_location")?(l(),i("li",Cp,[e("div",Sp,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[9]||(o[9]=n=>s.rulesForm.rules_if.bot_user.user_in_location=n),type:"checkbox",id:"bot-user-in-location"},null,512),[[k,s.rulesForm.rules_if.bot_user.user_in_location]]),e("label",jp,[s.rulesForm.rules_if.bot_user.user_in_location?(l(),i("span",Vp,"Находится в заведении")):(l(),i("span",qp,"Не находится в заведении"))])]),e("button",{type:"button",class:"btn btn-outline-info",onClick:o[10]||(o[10]=n=>t.removeRule("user_in_location"))},Pp)])):r("",!0),t.hasRuleKey("age")?(l(),i("li",Up,[e("div",null,[Ap,c(e("input",{type:"text",class:"form-control",placeholder:"Возраст от","aria-label":"Возраст от","onUpdate:modelValue":o[11]||(o[11]=n=>s.rulesForm.rules_if.bot_user.age=n),maxlength:"255","aria-describedby":"bot-user-age"},null,512),[[_,s.rulesForm.rules_if.bot_user.age]])]),e("button",{type:"button",class:"btn btn-outline-info",onClick:o[12]||(o[12]=n=>t.removeRule("age"))},Ip)])):r("",!0),t.hasRuleKey("city")?(l(),i("li",Qp,[e("div",null,[Tp,c(e("input",{type:"text",class:"form-control",placeholder:"Город","aria-label":"Город","onUpdate:modelValue":o[13]||(o[13]=n=>s.rulesForm.rules_if.bot_user.city=n),maxlength:"255","aria-describedby":"bot-user-city"},null,512),[[_,s.rulesForm.rules_if.bot_user.city]])]),e("button",{type:"button",class:"btn btn-outline-info",onClick:o[14]||(o[14]=n=>t.removeRule("city"))},Mp)])):r("",!0),t.hasRuleKey("sex")?(l(),i("li",Rp,[e("div",Dp,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[15]||(o[15]=n=>s.rulesForm.rules_if.bot_user.sex=n),type:"checkbox",id:"bot-user-sex"},null,512),[[k,s.rulesForm.rules_if.bot_user.sex]]),e("label",Ep,[s.rulesForm.rules_if.bot_user.sex?(l(),i("span",Lp,"Только для мужчин")):(l(),i("span",Kp,"Только для женщин"))])]),e("button",{type:"button",class:"btn btn-outline-info",onClick:o[16]||(o[16]=n=>t.removeRule("sex"))},Jp)])):r("",!0),s.rulesForm.rules_if.channels.length>0?(l(),i("li",Hp,[m("Проверка нахождения в канале \\ группе: "),(l(!0),i(g,null,$(s.rulesForm.rules_if.channels,(n,d)=>(l(),i("div",Gp,[e("div",Yp,[e("label",Wp,[b(Ce,{token:s.bot.bot_token,param:`${d}`,onCallback:t.modifyChannel},null,8,["token","param","onCallback"]),m(" Канал для проверки ")]),e("button",{type:"button",class:"btn btn-link text-danger",onClick:h=>t.removeChannelFromRule(d)},xp,8,Zp)]),c(e("input",{type:"text",class:"form-control",placeholder:"id канала","aria-label":"id канала","onUpdate:modelValue":h=>s.rulesForm.rules_if.channels[d]=h,maxlength:"255","aria-describedby":"bot-order-channel"},null,8,eb),[[_,s.rulesForm.rules_if.channels[d]]])]))),256))])):r("",!0)])):r("",!0),s.rulesForm.rules_if?(l(),i("h6",tb,"Иначе")):r("",!0),s.rulesForm.rules_else_page_id?(l(),i("p",sb,[m("Вы выбрали страницу #"+u(s.rulesForm.rules_else_page_id)+' в качестве условия "иначе" ',1),e("a",{href:"javascript:void(0)",onClick:o[17]||(o[17]=n=>s.rulesForm.rules_else_page_id=null)},"Очистить")])):r("",!0),s.rulesForm.rules_if?(l(),v(W,{key:5,current:s.rulesForm.id,onCallback:t.attachPageToRule,editor:!1},null,8,["current","onCallback"])):r("",!0),s.rulesForm.rules_if?(l(),i("div",ob,[e("label",lb,[b(a,null,{content:y(()=>[nb]),default:y(()=>[ib]),_:1}),m(" Сообщение в случае невыполнения условий (не обязательно) ")]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Текст сообщения","aria-label":"Текст сообщения","onUpdate:modelValue":o[18]||(o[18]=n=>s.rulesForm.rules_else_message=n),maxlength:"255","aria-describedby":"rules-else-message"},`
            `,512),[[_,s.rulesForm.rules_else_message]])])):r("",!0)],64)}}}),rb={class:"page-container"},cb={class:"page-content"},ub={class:"row"},mb={class:"col"},hb={class:"row"},_b={class:"col"},pb={class:"row"},bb={class:"col"},fb={class:"row"},gb={class:"col-12"},yb=["innerHTML"],vb={key:0,class:"row"},$b={class:"col-12"},kb={key:1,class:"row mt-2"},Fb=e("p",{class:"mb-0"},[e("strong",null,"Нижнее меню")],-1),wb={class:"col-12"},Cb={props:["page"]},Sb=Object.assign(Cb,{__name:"PagePreview",setup(s){return(t,o)=>{const a=T("lazy");return l(),i("div",rb,[e("div",cb,[e("div",ub,[s.page.images?(l(!0),i(g,{key:0},$(s.page.images,(n,d)=>(l(),i("div",mb,[c(e("img",null,null,512),[[a,"/images-by-bot-id/"+s.page.bot_id+"/"+n]])]))),256)):r("",!0)]),e("div",hb,[s.page.videos?(l(!0),i(g,{key:0},$(s.page.videos,(n,d)=>(l(),i("div",_b,[b(le,{content:n,type:"video"},null,8,["content"])]))),256)):r("",!0)]),e("div",pb,[s.page.audios?(l(!0),i(g,{key:0},$(s.page.audios,(n,d)=>(l(),i("div",bb,[b(le,{content:n,type:"audio"},null,8,["content"])]))),256)):r("",!0)]),e("div",fb,[e("div",gb,[e("p",{innerHTML:s.page.content},null,8,yb)])])]),s.page.inlineKeyboard?(l(),i("div",vb,[e("div",$b,[s.page.inlineKeyboard.deleted_at?r("",!0):(l(),v(ce,{key:0,simple:!0,"select-mode":!0,keyboard:s.page.inlineKeyboard},null,8,["keyboard"]))])])):r("",!0),s.page.replyKeyboard?(l(),i("div",kb,[Fb,e("div",wb,[s.page.replyKeyboard.deleted_at?r("",!0):(l(),v(ce,{key:0,simple:!0,"select-mode":!0,keyboard:s.page.replyKeyboard},null,8,["keyboard"]))])])):r("",!0)])}}}),jb={class:"d-flex justify-content-between btn-group mb-2"},Vb=e("div",{class:"alert alert-light"},[e("strong",{class:"fw-bold"},"Внимание!"),m(" Если страница с таким название уже есть, то повторно она не будет создана! ")],-1),qb={class:"input-group mb-3"},zb={class:"form-floating"},Pb=["onUpdate:modelValue"],Ub={for:"floatingInput"},Ab=["onClick"],Ob=e("i",{class:"fa-solid fa-trash-can"},null,-1),Ib=[Ob],Qb=["disabled"],Tb=e("div",{class:"alert alert-light"},[e("strong",{class:"fw-bold"},"Внимание!"),m(" Если страница с таким название уже есть, то повторно она не будет создана! Каждая создаваемая вами страница получит текущий вариант меню. ")],-1),Bb=["disabled"],Mb={data(){return{variant:0,bot:null,keyboard:null,settings:null,pages:[]}},computed:{...C(["getCurrentBot"])},mounted(){this.loadCurrentBot()},methods:{loadCurrentBot(s=null){return this.$store.dispatch("updateCurrentBot",{bot:s}).then(()=>{this.bot=this.getCurrentBot})},submit2(){this.$store.dispatch("addMultiPagesByKeyboard",{bot_id:this.bot.id,keyboard:this.keyboard,settings:this.settings}).then(()=>{this.keyboard=null,this.settings=null,this.$notify({title:"Конструктор страниц",text:"Вы успешно добавили страницы!",type:"success"}),this.$emit("callback")}).catch(()=>{this.$notify({title:"Конструктор страниц",text:"Ошибка добавления страниц",type:"error"})})},saveSettings(s){this.settings=s},submit(){this.$store.dispatch("addMultiPages",{bot_id:this.bot.id,pages:this.pages}).then(()=>{this.pages=[],this.$notify({title:"Конструктор страниц",text:"Вы успешно добавили страницы!",type:"success"}),this.$emit("callback")}).catch(()=>{this.$notify({title:"Конструктор страниц",text:"Ошибка добавления страниц",type:"error"})})},addPage(){this.pages.push("")},removePage(s){this.pages.splice(s,1)}}},Rb=Object.assign(Mb,{__name:"FastPageForm",setup(s){return(t,o)=>(l(),i(g,null,[e("div",jb,[e("button",{onClick:o[0]||(o[0]=a=>t.variant=0),class:p([{"btn-primary":t.variant===0,"btn-outline-primary":t.variant!==0},"btn w-100"])}," Через страницы ",2),e("button",{onClick:o[1]||(o[1]=a=>t.variant=1),class:p([{"btn-primary":t.variant===1,"btn-outline-primary":t.variant!==1},"btn w-100"])}," Через клавиатуру ",2)]),c(e("form",{onSubmit:o[3]||(o[3]=S((...a)=>t.submit&&t.submit(...a),["prevent"]))},[Vb,(l(!0),i(g,null,$(t.pages,(a,n)=>(l(),i("div",qb,[e("div",zb,[c(e("input",{"onUpdate:modelValue":d=>t.pages[n]=d,type:"text",class:"form-control",id:"floatingInput",placeholder:"name@example.com",required:""},null,8,Pb),[[_,t.pages[n]]]),e("label",Ub,"Название страницы #"+u(n+1),1)]),e("a",{onClick:d=>t.removePage(n),href:"javascript:void(0)",class:"input-group-text",id:"basic-addon1"},Ib,8,Ab)]))),256)),e("button",{type:"button",onClick:o[2]||(o[2]=(...a)=>t.addPage&&t.addPage(...a)),class:"btn btn-outline-primary p-3 w-100 mb-2"},"Добавить еще страницу"),e("button",{disabled:t.pages.length===0,class:"btn btn-primary p-3 w-100"},"Сохранить страницы",8,Qb)],544),[[q,t.variant===0]]),c(e("form",{onSubmit:o[5]||(o[5]=S((...a)=>t.submit2&&t.submit2(...a),["prevent"]))},[Tb,b(I,{type:"reply",onSaveSettings:t.saveSettings,modelValue:t.keyboard,"onUpdate:modelValue":o[4]||(o[4]=a=>t.keyboard=a)},null,8,["onSaveSettings","modelValue"]),e("button",{disabled:t.keyboard==null||(t.keyboard||[]).length===0,class:"btn btn-primary p-3 w-100"},"Сохранить страницы",8,Bb)],544),[[q,t.variant===1]])],64))}}),Pe="3.7.7",Db=Pe,L=typeof Buffer=="function",_e=typeof TextDecoder=="function"?new TextDecoder:void 0,pe=typeof TextEncoder=="function"?new TextEncoder:void 0,Eb="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",J=Array.prototype.slice.call(Eb),G=(s=>{let t={};return s.forEach((o,a)=>t[o]=a),t})(J),Lb=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,z=String.fromCharCode.bind(String),be=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):s=>new Uint8Array(Array.prototype.slice.call(s,0)),Ue=s=>s.replace(/=/g,"").replace(/[+\/]/g,t=>t=="+"?"-":"_"),Ae=s=>s.replace(/[^A-Za-z0-9\+\/]/g,""),Oe=s=>{let t,o,a,n,d="";const h=s.length%3;for(let f=0;f<s.length;){if((o=s.charCodeAt(f++))>255||(a=s.charCodeAt(f++))>255||(n=s.charCodeAt(f++))>255)throw new TypeError("invalid character found");t=o<<16|a<<8|n,d+=J[t>>18&63]+J[t>>12&63]+J[t>>6&63]+J[t&63]}return h?d.slice(0,h-3)+"===".substring(h):d},de=typeof btoa=="function"?s=>btoa(s):L?s=>Buffer.from(s,"binary").toString("base64"):Oe,ie=L?s=>Buffer.from(s).toString("base64"):s=>{let o=[];for(let a=0,n=s.length;a<n;a+=4096)o.push(z.apply(null,s.subarray(a,a+4096)));return de(o.join(""))},Y=(s,t=!1)=>t?Ue(ie(s)):ie(s),Kb=s=>{if(s.length<2){var t=s.charCodeAt(0);return t<128?s:t<2048?z(192|t>>>6)+z(128|t&63):z(224|t>>>12&15)+z(128|t>>>6&63)+z(128|t&63)}else{var t=65536+(s.charCodeAt(0)-55296)*1024+(s.charCodeAt(1)-56320);return z(240|t>>>18&7)+z(128|t>>>12&63)+z(128|t>>>6&63)+z(128|t&63)}},Nb=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,Ie=s=>s.replace(Nb,Kb),fe=L?s=>Buffer.from(s,"utf8").toString("base64"):pe?s=>ie(pe.encode(s)):s=>de(Ie(s)),D=(s,t=!1)=>t?Ue(fe(s)):fe(s),ge=s=>D(s,!0),Jb=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,Hb=s=>{switch(s.length){case 4:var t=(7&s.charCodeAt(0))<<18|(63&s.charCodeAt(1))<<12|(63&s.charCodeAt(2))<<6|63&s.charCodeAt(3),o=t-65536;return z((o>>>10)+55296)+z((o&1023)+56320);case 3:return z((15&s.charCodeAt(0))<<12|(63&s.charCodeAt(1))<<6|63&s.charCodeAt(2));default:return z((31&s.charCodeAt(0))<<6|63&s.charCodeAt(1))}},Qe=s=>s.replace(Jb,Hb),Te=s=>{if(s=s.replace(/\s+/g,""),!Lb.test(s))throw new TypeError("malformed base64.");s+="==".slice(2-(s.length&3));let t,o="",a,n;for(let d=0;d<s.length;)t=G[s.charAt(d++)]<<18|G[s.charAt(d++)]<<12|(a=G[s.charAt(d++)])<<6|(n=G[s.charAt(d++)]),o+=a===64?z(t>>16&255):n===64?z(t>>16&255,t>>8&255):z(t>>16&255,t>>8&255,t&255);return o},re=typeof atob=="function"?s=>atob(Ae(s)):L?s=>Buffer.from(s,"base64").toString("binary"):Te,Be=L?s=>be(Buffer.from(s,"base64")):s=>be(re(s).split("").map(t=>t.charCodeAt(0))),Me=s=>Be(Re(s)),Gb=L?s=>Buffer.from(s,"base64").toString("utf8"):_e?s=>_e.decode(Be(s)):s=>Qe(re(s)),Re=s=>Ae(s.replace(/[-_]/g,t=>t=="-"?"+":"/")),ne=s=>Gb(Re(s)),Yb=s=>{if(typeof s!="string")return!1;const t=s.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(t)||!/[^\s0-9a-zA-Z\-_]/.test(t)},De=s=>({value:s,enumerable:!1,writable:!0,configurable:!0}),Ee=function(){const s=(t,o)=>Object.defineProperty(String.prototype,t,De(o));s("fromBase64",function(){return ne(this)}),s("toBase64",function(t){return D(this,t)}),s("toBase64URI",function(){return D(this,!0)}),s("toBase64URL",function(){return D(this,!0)}),s("toUint8Array",function(){return Me(this)})},Le=function(){const s=(t,o)=>Object.defineProperty(Uint8Array.prototype,t,De(o));s("toBase64",function(t){return Y(this,t)}),s("toBase64URI",function(){return Y(this,!0)}),s("toBase64URL",function(){return Y(this,!0)})},Wb=()=>{Ee(),Le()},Zb={version:Pe,VERSION:Db,atob:re,atobPolyfill:Te,btoa:de,btoaPolyfill:Oe,fromBase64:ne,toBase64:D,encode:D,encodeURI:ge,encodeURL:ge,utob:Ie,btou:Qe,decode:ne,isValid:Yb,fromUint8Array:Y,toUint8Array:Me,extendString:Ee,extendUint8Array:Le,extendBuiltins:Wb};const Xb={class:"row mt-2"},xb={class:"col-12"},ef={class:"alert alert-light",role:"alert"},tf=e("strong",{class:"fw-bold"},"Внимание!",-1),sf=e("i",{class:"fa-solid fa-bolt"},null,-1),of={key:0,class:"row"},lf={class:"col-12"},nf={class:"alert alert-light",role:"alert"},af=e("strong",{class:"fw-bold"},"Внимание!",-1),df={style:{"font-size":"16px"}},rf={key:0,class:"row"},cf={class:"col-12 mb-2"},uf=e("h6",null,"На странице выбраны следующие разделы",-1),mf={class:"mini-pics justify-content-start d-inline-flex text-primary"},hf=e("i",{class:"fa-regular fa-images"},null,-1),_f=[hf],pf=e("i",{class:"fa-regular fa-note-sticky"},null,-1),bf=[pf],ff=e("i",{class:"fa-solid fa-photo-film"},null,-1),gf=[ff],yf=e("i",{class:"fa-regular fa-file-audio"},null,-1),vf=[yf],$f=e("i",{class:"fa-regular fa-file-word"},null,-1),kf=[$f],Ff=e("i",{class:"fa-solid fa-link"},null,-1),wf=[Ff],Cf=e("i",{class:"fa-solid fa-scroll"},null,-1),Sf=[Cf],jf=e("i",{class:"fa-regular fa-comment-dots"},null,-1),Vf=[jf],qf=e("i",{class:"fa-solid fa-scale-balanced"},null,-1),zf=[qf],Pf=e("i",{class:"fa-regular fa-keyboard"},null,-1),Uf=[Pf],Af=e("i",{class:"fa-solid fa-ellipsis"},null,-1),Of=[Af],If={class:"row"},Qf={class:"col-md-8 col-12 mb-2"},Tf=e("div",{class:"d-flex justify-content-between"},[e("label",{class:"form-label",id:"bot-domain"},[m(" Команда "),e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно")])],-1),Bf={class:"col-md-4 col-12 mb-2 d-flex justify-content-end align-items-end"},Mf={class:"btn-group",style:{background:"white"},role:"group","aria-label":"Basic example"},Rf={key:0,type:"submit",title:"Сохранить страницу",id:"save-page-btn",class:"btn btn-primary min-menu-btn"},Df=e("i",{class:"fa-regular fa-floppy-disk"},null,-1),Ef=[Df],Lf=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),Kf=[Lf],Nf=e("button",{type:"button",title:"Список страниц","data-bs-toggle":"offcanvas","data-bs-target":"#offcanvas",class:"btn btn-outline-primary text-primary min-menu-btn"},[e("i",{class:"fa-solid fa-list-ol"})],-1),Jf={class:"row"},Hf={class:"col-12 mb-2"},Gf={class:"d-flex justify-content-between"},Yf=e("label",{class:"form-label mb-0",id:"bot-domain"},[m(" Текстовое содержимое страницы "),e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно")],-1),Wf={class:"form-floating"},Zf={for:"main-text-field"},Xf={key:0},xf={class:"col-12 mb-2"},eg={class:"nav nav-tabs justify-content-center"},tg=e("i",{class:"fa-regular fa-keyboard"},null,-1),sg=e("span",null,"Нижнее меню",-1),og=[tg,sg],lg=e("i",{class:"fa-solid fa-ellipsis"},null,-1),ig=e("span",null,"Меню под текстом",-1),ng=[lg,ig],ag=e("i",{class:"fa-regular fa-images"},null,-1),dg=e("span",null,"Изображения",-1),rg=[ag,dg],cg=e("i",{class:"fa-solid fa-photo-film"},null,-1),ug=e("span",null,"Видео",-1),mg=[cg,ug],hg=e("i",{class:"fa-regular fa-file-audio"},null,-1),_g=e("span",null,"Аудио",-1),pg=[hg,_g],bg=e("i",{class:"fa-regular fa-file-word"},null,-1),fg=e("span",null,"Документы",-1),gg=[bg,fg],yg=e("i",{class:"fa-solid fa-link"},null,-1),vg=e("span",null,"Другая страница",-1),$g=[yg,vg],kg=e("i",{class:"fa-solid fa-scroll"},null,-1),Fg=e("span",null,"Скрипт",-1),wg=[kg,Fg],Cg=e("i",{class:"fa-regular fa-comment-dots"},null,-1),Sg=e("span",null,"Начало диалога",-1),jg=[Cg,Sg],Vg={class:"nav-item"},qg={class:"dropdown"},zg=e("button",{class:"nav-link dropdown-toggle d-flex flex-column justify-content-center align-items-center font-12",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-hamburger"}),m(" Другие возможности ")],-1),Pg={class:"dropdown-menu"},Ug=e("i",{class:"fa-solid fa-scale-balanced"},null,-1),Ag=e("i",{class:"fa fa-key","aria-hidden":"true"},null,-1),Og=e("i",{class:"fa fa-money-bill","aria-hidden":"true"},null,-1),Ig=e("i",{class:"fa-solid fa-sack-dollar"},null,-1),Qg=e("i",{class:"fa-regular fa-note-sticky"},null,-1),Tg={key:0,class:"col-12 mb-2"},Bg={class:"form-check"},Mg=e("label",{class:"form-check-label",for:"need-reply-menu"}," Нижнее меню страницы ",-1),Rg={key:1,class:"col-12 mb-2"},Dg={class:"card"},Eg={class:"card-header d-flex justify-between align-items-center"},Lg=e("h6",null,"Конструктор нижнего меню",-1),Kg={key:0},Ng={key:1},Jg={class:"card-body"},Hg={class:"row"},Gg={class:"col-12 mb-2"},Yg={class:"form-label",id:"bot-domain"},Wg=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Zg=e("div",null," Заголовок для нижнего меню ",-1),Xg={class:"form-check form-switch"},xg=e("label",{class:"form-check-label",for:"need-page-create-from-keyboard"}," Нужно создать страницы на основе клавиатуры ",-1),e1={key:2,class:"col-12 mb-2"},t1={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},s1={class:"d-flex justify-content-center mb-3"},o1={alt:"",width:"100",height:"100"},l1=e("h1",{class:"text-body-emphasis"},"Нижнее меню",-1),i1=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"}," Создание и настройка нижнего меню страницы бота. Добавление и редактирование функций кнопок бота на странице. Данное меню отображается пользователю всегда. ",-1),n1={class:"d-inline-flex gap-2 mb-5"},a1=["disabled"],d1=e("a",{href:"https://telegra.ph/Nizhnee-menyu-bota-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),r1={key:0,class:"col-12 mb-2"},c1={class:"form-check"},u1=e("label",{class:"form-check-label",for:"need-inline-menu"}," Меню под текстом страницы ",-1),m1={key:1,class:"col-12 mb-2"},h1={class:"card"},_1={class:"card-header d-flex justify-between align-items-center"},p1=e("h6",null,"Конструктор меню в сообщении",-1),b1={key:0},f1={key:1},g1={class:"card-body"},y1={key:2,class:"col-12 mb-2"},v1={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},$1={class:"d-flex justify-content-center mb-3"},k1={alt:"",width:"100",height:"100"},F1=e("h1",{class:"text-body-emphasis"},"Меню под текстом",-1),w1=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"}," В отличии от нижнего меню, которое отображается всегда, меню под текстом показывается под контентом только в момент отображения этого контента. ",-1),C1={class:"d-inline-flex gap-2 mb-5"},S1=["disabled"],j1=e("a",{href:"https://telegra.ph/Menyu-k-tekstu-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),V1={key:0,class:"col-12 mb-2"},q1={class:"form-check"},z1=e("label",{class:"form-check-label",for:"need-page-images"}," Изображения на странице (максимум 10) ",-1),P1={key:1,class:"col-12 mb-2"},U1={class:"card mb-3"},A1=e("div",{class:"card-header"},[e("h6",null,"Загрузите изображения с файловой системы")],-1),O1={class:"card-body d-flex justify-content-start"},I1={for:"photos",style:{"margin-right":"10px"},class:"photo-loader ml-2"},Q1={class:"row"},T1={key:0,class:"col-12 d-flex flex-wrap"},B1={class:"mb-2 img-preview",style:{"margin-right":"10px"}},M1={class:"remove"},R1=["onClick"],D1={key:1},E1={key:2,class:"col-12 d-flex flex-wrap"},L1={class:"mb-2 img-preview",style:{"margin-right":"10px"}},K1={class:"remove"},N1=["onClick"],J1={key:2,class:"col-12 mb-2"},H1={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},G1={class:"d-flex justify-content-center mb-3"},Y1={alt:"",width:"100",height:"100"},W1=e("h1",{class:"text-body-emphasis"},"Изображения",-1),Z1=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"},[m(" Вы можете добавить к одной странице от "),e("b",null,"1"),m(" до "),e("b",null,"10"),m(" изображений. Изображения (от 2х) будут собраны в группу и показаны под текстовым содержимым страницы. Если изображение одно, то текст будет отображен под ним. ")],-1),X1={class:"d-inline-flex gap-2 mb-5"},x1=["disabled"],ey=e("a",{href:"https://telegra.ph/Dobavlenie-izobrazhenij-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),ty={key:0,class:"col-12 mb-2"},sy={class:"form-check"},oy=e("label",{class:"form-check-label",for:"need-page-video"}," Видео к странице ",-1),ly={key:1,class:"col-12 mb-2"},iy={key:2,class:"col-12 mb-2"},ny={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},ay={class:"d-flex justify-content-center mb-3"},dy={alt:"",width:"100",height:"100"},ry=e("h1",{class:"text-body-emphasis"},"Видео",-1),cy=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"},[m(" Вы можете добавить к одной странице от "),e("b",null,"1"),m(" до "),e("b",null,"10"),m(" видео. Ролики (от 2х) будут собраны в группу и показаны под текстовым содержимым страницы. ")],-1),uy={class:"d-inline-flex gap-2 mb-5"},my=["disabled"],hy=e("a",{href:"https://telegra.ph/Dobavlenie-video-na-stranicu-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),_y={key:0,class:"col-12 mb-2"},py={class:"form-check"},by=e("label",{class:"form-check-label",for:"need-page-sticker"}," Стикер к странице ",-1),fy={key:1,class:"col-12 mb-2"},gy={key:2,class:"col-12 mb-2"},yy={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},vy={class:"d-flex justify-content-center mb-3"},$y={alt:"",width:"100",height:"100"},ky=e("h1",{class:"text-body-emphasis"},"Стикеры",-1),Fy=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"}," Вы можете переслать любой стикер в бота (от лица администратора) и затем этот стикер использовать для взаимодействия с пользователем. ",-1),wy={class:"d-inline-flex gap-2 mb-5"},Cy=["disabled"],Sy=e("a",{href:"https://telegra.ph/Dobavlenie-stikera-na-stranicu-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),jy={key:0,class:"col-12 mb-2"},Vy={class:"form-check"},qy=e("label",{class:"form-check-label",for:"need-page-audio"}," Звук к странице ",-1),zy={key:1,class:"col-12 mb-2"},Py={key:2,class:"col-12 mb-2"},Uy={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},Ay={class:"d-flex justify-content-center mb-3"},Oy={alt:"",width:"100",height:"100"},Iy=e("h1",{class:"text-body-emphasis"},"Аудио",-1),Qy=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"},[m(" Вы можете добавить к одной странице от "),e("b",null,"1"),m(" до "),e("b",null,"10"),m(" аудио. Музыка (от 2х) будет собрана в группу и показана под текстовым содержимым страницы. Если вы хотите использовать "),e("b",{class:"text-danger"},"голосовое"),m(", то можно использовать максимум "),e("b",{class:"text-danger"},"одну запись"),m(". Или же, вы можете конвертировать её в mp3 и залить как музыкальный файл в бота. ")],-1),Ty={class:"d-inline-flex gap-2 mb-5"},By=["disabled"],My=e("a",{href:"https://telegra.ph/Dobavlenie-audio-na-stranicu-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),Ry={key:0,class:"col-12 mb-2"},Dy={class:"form-check"},Ey=e("label",{class:"form-check-label",for:"need-page-document"}," Документ \\ презентацию к странице \\ картинку в оригинале ",-1),Ly={key:1,class:"col-12 mb-2"},Ky={key:2,class:"col-12 mb-2"},Ny={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},Jy={class:"d-flex justify-content-center mb-3"},Hy={alt:"",width:"100",height:"100"},Gy=e("h1",{class:"text-body-emphasis"},"Документы",-1),Yy=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"},[m(" Вы можете добавить к одной странице от "),e("b",null,"1"),m(" до "),e("b",null,"10"),m(" документов. Документы (от 2х) будут собраны в группу и показана под текстовым содержимым страницы. В качестве файлов вы можете использовать текстовые документы, презентации, файлы-pdf, изображения в оригинальном размере. ")],-1),Wy={class:"d-inline-flex gap-2 mb-5"},Zy=["disabled"],Xy=e("a",{href:"https://telegra.ph/Dobavlenie-dokumenta-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),xy={class:"col-12 mb-2"},ev={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},tv={class:"d-flex justify-content-center mb-3"},sv={alt:"",width:"100",height:"100"},ov=e("h1",{class:"text-body-emphasis"},"Связь со страницей",-1),lv=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"}," Вы можете привязать вызов другой страницы непосредственно после вызова текущей. Это позволит выводить контент по цепочке для пользователя. ",-1),iv={key:0,class:"my-3 text-success font-bold"},nv={class:"d-inline-flex gap-2 mb-5"},av={key:1,"data-bs-toggle":"modal","data-bs-target":"#page-list-modal",class:"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill btn-primary",type:"button"},dv=e("a",{href:"https://telegra.ph/Svyazyvanie-so-stranicej-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),rv=e("h6",{class:"mb-3"},"Конструктор цепочек",-1),cv={class:"d-flex justify-content-center align-items-center flex-wrap"},uv=e("span",{class:"px-2"},"Текущая страница",-1),mv=e("i",{class:"fa-solid fa-arrow-right"},null,-1),hv={class:"d-flex justify-content-center align-items-center px-3 py-2"},_v=["onClick"],pv={class:"position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger"},bv={key:0,class:"fa-solid fa-arrow-right ml-2"},fv={key:0,class:"fa-solid fa-arrow-right"},gv=e("button",{type:"button","data-bs-toggle":"modal","data-bs-target":"#page-list-modal",class:"btn btn-outline-secondary position-relative rounded-5 ml-5"},[e("i",{class:"fa-solid fa-plus"})],-1),yv={key:0,class:"col-12 mb-2"},vv=e("div",{class:"alert alert-info",role:"alert"}," Если в вашем боте нет каких-то предустановленных скриптов вы можете найти их в глобальном магазине скриптов ",-1),$v={class:"form-check"},kv=e("label",{class:"form-check-label",for:"need-show-global-slug-list"}," Добавить скрипты из глобального магазина? ",-1),Fv={key:1,class:"col-12 mb-2"},wv={class:"form-check"},Cv=e("label",{class:"form-check-label",for:"need-slug-attach"}," Привязать скрипт ",-1),Sv={key:2,class:"col-12 mb-2"},jv={key:0,class:"alert alert-success d-flex justify-content-between align-items-center",role:"alert"},Vv={key:3,class:"col-12 mb-2"},qv={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},zv={class:"d-flex justify-content-center mb-3"},Pv={alt:"",width:"100",height:"100"},Uv=e("h1",{class:"text-body-emphasis"},"Скрипты",-1),Av=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"}," Скрипты содержат основной функционал системы. Вы можете к каждой странице привязать один скрипт, который будет вызван после вывода основного содержимого страницы. ",-1),Ov={class:"d-inline-flex gap-2 mb-5"},Iv=["disabled"],Qv=e("a",{href:"https://telegra.ph/Svyazyvanie-so-skriptom-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),Tv={key:0,class:"col-12 mb-2"},Bv={class:"form-check"},Mv=e("label",{class:"form-check-label",for:"need-dialog-attach"}," Привязать начало диалога ",-1),Rv={key:1,class:"col-12 mb-2"},Dv={key:0},Ev={key:2,class:"col-12 mb-2"},Lv={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},Kv={class:"d-flex justify-content-center mb-3"},Nv={alt:"",width:"100",height:"100"},Jv=e("h1",{class:"text-body-emphasis"},"Диалоги",-1),Hv=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"}," Диалоги страницы - это инструмент запроса данных от пользователя. Вы можете привязать начало диалога к странице, а сам диалог будет вызван по цепочке. ",-1),Gv={class:"d-inline-flex gap-2 mb-5"},Yv=["disabled"],Wv=e("a",{href:"https://telegra.ph/Dobavlenie-dialoga-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),Zv={key:0,class:"col-12 mb-2"},Xv={class:"form-check"},xv=e("label",{class:"form-check-label",for:"need-rules"}," Нужны правила загрузки страницы ",-1),e$={key:1,class:"col-12 mb-2"},t$={key:2,class:"col-12 mb-2"},s$={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},o$={class:"d-flex justify-content-center mb-3"},l$={alt:"",width:"100",height:"100"},i$=e("h1",{class:"text-body-emphasis"},"Правила отображения страницы",-1),n$=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"}," Вы можете создать правила, согласно которым будет отображена та или иная страница. Вы можете перенаправить пользователя с одной страницы на другую, в случае если ваше условие не выполнено. ",-1),a$={class:"d-inline-flex gap-2 mb-5"},d$=["disabled"],r$=e("a",{href:"https://telegra.ph/Pravila-na-stranice-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),c$={key:0,class:"col-12 mb-2"},u$={class:"form-check"},m$=e("label",{class:"form-check-label",for:"need-secure-page"}," Безопасная страница ",-1),h$={key:1,class:"col-12 mb-2"},_$={class:"input-group mb-2"},p$={class:"form-floating"},b$=e("label",{for:"floatingPassword"},"Пароль страницы",-1),f$={class:"input-group-text",id:"basic-addon1"},g$=e("i",{class:"fa fa-refresh","aria-hidden":"true"},null,-1),y$=[g$],v$={class:"form-floating"},$$={for:"floatingTextarea2"},k$={key:0,class:"small"},F$={key:2,class:"col-12 mb-2"},w$={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},C$={class:"d-flex justify-content-center mb-3"},S$={alt:"",width:"100",height:"100"},j$=e("h1",{class:"text-body-emphasis"},"Безопасная страница",-1),V$=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"}," Создайте безопасную страницу, доступ к которой будет только у тех людей, кому вы дадите пароль! Люди, которые получат один раз пароль, смогут постоянно заходить на данную страницу, даже если вы смените его. ",-1),q$={class:"d-inline-flex gap-2 mb-5"},z$=["disabled"],P$=e("a",{href:"https://telegra.ph/Nizhnee-menyu-bota-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),U$={key:0,class:"col-12 mb-2"},A$={class:"form-check"},O$=e("label",{class:"form-check-label",for:"need-payed-page"}," Платная страница ",-1),I$={key:1,class:"col-12 mb-2"},Q$={key:0,class:"alert alert-light"},T$={class:"form-floating mb-2"},B$=["disabled"],M$=e("label",{for:"page-price"},"Цена за открытие страницы, руб",-1),R$={class:"form-floating"},D$=["disabled"],E$={for:"floatingTextarea2"},L$={key:0,class:"small"},K$={key:2,class:"col-12 mb-2"},N$={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},J$={class:"d-flex justify-content-center mb-3"},H$={alt:"",width:"100",height:"100"},G$=e("h1",{class:"text-body-emphasis"},"Платная страница",-1),Y$=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"}," Данная страница позволяет запросить оплату с пользователя за её просмотр. Задайте цену страницы, описание перед оплатой и др. настройки оплаты. Пользователи, оплатившие услугу, получат постоянный доступ к этой странице. ",-1),W$={class:"d-inline-flex gap-2 mb-5"},Z$=["disabled"],X$=e("a",{href:"https://telegra.ph/Nizhnee-menyu-bota-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),x$={class:"col-12 mb-2"},e2={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},t2={class:"d-flex justify-content-center mb-3"},s2={alt:"",width:"100",height:"100"},o2=e("h1",{class:"text-body-emphasis"},"Начисление бонусов",-1),l2=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"}," При переходе на данную страницу пользователь разово может получить указанную сумму бонусов! Начисление произойдет перед выводом контента страницы. ",-1),i2={class:"row d-flex justify-content-center my-2"},n2={class:"col-md-4"},a2={class:"form-floating mb-2 w-100"},d2=e("label",{for:"page-price"},"Сумма начисления бонусов, руб",-1),r2={class:"row"},c2={class:"col-md-12 my-3"},u2=e("h6",null,"Нужно ли запрашивать какие-то данные у пользователя?",-1),m2={class:"d-flex d-flex justify-content-center"},h2={key:0,class:"row justify-content-center"},_2={class:"col-md-12 my-3"},p2=e("h6",null,"Упрощенный вариант сбора данных?",-1),b2=e("p",{class:"fst-italic"},"Упрощенный вариант подразумевает получение только номера телефона!",-1),f2={class:"d-flex d-flex justify-content-center"},g2={class:"col-md-6 my-5"},y2={class:"form-floating"},v2={for:"floatingTextarea2"},$2={key:0},k2={class:"d-inline-flex gap-2 mb-5"},F2={key:0},w2={key:1},C2=e("a",{href:"https://telegra.ph/Nizhnee-menyu-bota-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),S2=e("div",{class:"row"},[e("div",{class:"col-12"},[e("div",{class:"alert alert-info",role:"alert"},[e("h6",null,"Страница поддерживает комбинации клавиш:"),e("ul",{class:"mb-0 mr-0 p-0"},[e("li",null,[e("strong",null,"Ctrl+S"),m(" - открыть\\закрыть окно сохранения")]),e("li",null,[e("strong",null,"Ctrl+D"),m(" - просмотр страницы (для сохраненных страниц)")]),e("li",null,[e("strong",null,"Ctrl+пробел"),m(" - открыть\\закрыть список страниц")]),e("li",null,[e("strong",null,"Ctrl+backspace"),m(" - очистить страницу\\новая страница")]),e("li",null,[e("strong",null,"Ctrl+стрелка вправо"),m(" - переключение между вкладка вперед")]),e("li",null,[e("strong",null,"Ctrl+стрелка влево"),m(" - переключение между вкладка назад")])])])])],-1),j2={class:"modal fade",id:"fast-pages-create",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},V2={class:"modal-dialog modal-lg"},q2={class:"modal-content"},z2=e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"exampleModalLabel"},"Быстрое создание страниц"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),P2={class:"modal-body"},U2=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Не сохранять")],-1),A2={class:"modal fade",id:"save-modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},O2={class:"modal-dialog"},I2={class:"modal-content"},Q2=e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"exampleModalLabel"},"Сохранение страницы"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),T2={class:"modal-body"},B2={key:0,class:"row"},M2={class:"col-12 mb-2"},R2={class:"d-flex justify-between"},D2=["href"],E2={class:"col-12 mb-2"},L2=e("h6",null,"На странице выбраны следующие разделы",-1),K2={class:"mini-pics text-primary"},N2=e("i",{class:"fa-regular fa-images"},null,-1),J2=[N2],H2=e("i",{class:"fa-regular fa-note-sticky"},null,-1),G2=[H2],Y2=e("i",{class:"fa-solid fa-photo-film"},null,-1),W2=[Y2],Z2=e("i",{class:"fa-regular fa-file-audio"},null,-1),X2=[Z2],x2=e("i",{class:"fa-regular fa-file-word"},null,-1),ek=[x2],tk=e("i",{class:"fa-solid fa-link"},null,-1),sk=[tk],ok=e("i",{class:"fa-solid fa-scroll"},null,-1),lk=[ok],ik=e("i",{class:"fa-regular fa-comment-dots"},null,-1),nk=[ik],ak=e("i",{class:"fa-solid fa-scale-balanced"},null,-1),dk=[ak],rk=e("i",{class:"fa-regular fa-keyboard"},null,-1),ck=[rk],uk=e("i",{class:"fa-solid fa-ellipsis"},null,-1),mk=[uk],hk={key:0,class:"col-12 mb-2"},_k={class:"form-check"},pk=e("label",{class:"form-check-label",for:"need-show-qr-and-link"}," Показать ссылку на страницу и QR-код ",-1),bk={key:1,class:"col-12 mb-2"},fk={class:"mb-2"},gk=e("div",{class:"alert alert-info mb-2"},[e("strong",{class:"fw-bold"},"Внимание!"),m(" Используйте метки "),e("strong",{class:"fw-bold text-primary"},"на английском языке"),m(" или "),e("strong",{class:"fw-bold text-primary"},"число"),m("! ")],-1),yk={class:"form-floating mb-2"},vk=e("label",{for:"utm-source"},"Укажите метку для статистики",-1),$k={class:"d-flex justify-content-center"},kk={style:{width:"200px",height:"200px"}},Fk={class:"col-12 mb-2"},wk={class:"form-label",id:"bot-domain"},Ck=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Sk=e("div",null,"Напишите для себя пояснение для чего нужна данная страница. Это поможет другим менеджерам лучше понять Вас. ",-1),jk=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Vk={class:"col-12"},qk={class:"form-check"},zk=e("label",{class:"form-check-label",for:"is-external"}," Внешнее управление страницей ",-1),Pk={key:0,class:"alert alert-danger",role:"alert"},Uk={key:0,class:"mb-0"},Ak=e("strong",null,'"Информация о боте"',-1),Ok=e("strong",null,"Другие настройки",-1),Ik=e("strong",null,'"Ссылка на внешний сервис обработки данных"',-1),Qk={class:"col-12"},Tk={class:"form-check"},Bk=e("label",{class:"form-check-label",for:"need_log_user_action"}," Логировать действия пользователя в канал при переходе ",-1),Mk={class:"col-12"},Rk={class:"form-check"},Dk=e("label",{class:"form-check-label",for:"need-stay-after-save"}," Остаться на текущей странице после сохранения ",-1),Ek=e("div",{class:"col-12"},[e("button",{type:"submit",id:"submit-page",class:"btn btn-success w-100 p-3"},"Сохранить ")],-1),Lk=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Не сохранять")],-1),Kk={class:"modal fade",id:"page-list-modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},Nk={class:"modal-dialog"},Jk={class:"modal-content"},Hk={class:"modal-body"},Gk={class:"offcanvas offcanvas-end w-25",tabindex:"-1",id:"offcanvas","data-bs-keyboard":"true","data-bs-scroll":"true","data-bs-backdrop":"true"},Yk=e("div",{class:"offcanvas-header"},[e("h6",{class:"offcanvas-title d-none d-sm-block"},"Ваши страницы (кнопки)"),e("button",{type:"button",class:"btn-close text-reset","data-bs-dismiss":"offcanvas","aria-label":"Close"})],-1),Wk={class:"offcanvas-body"},Zk={class:"row"},Xk={class:"col-12"},xk={class:"offcanvas offcanvas-end w-25",tabindex:"-1",id:"page-preview","data-bs-keyboard":"true","data-bs-scroll":"true","data-bs-backdrop":"true"},e0=e("div",{class:"offcanvas-header"},[e("h6",{class:"offcanvas-title d-none d-sm-block"},"Демонстрация страницы"),e("button",{type:"button",class:"btn-close text-reset","data-bs-dismiss":"offcanvas","aria-label":"Close"})],-1),t0={class:"offcanvas-body"},s0={key:1},o0={data(){return{need_page_create_from_keyboard:!1,tab:0,links:[],saveModal:null,pageModal:null,fastPageModal:null,pagePreviewModal:null,page:null,need_clean:!1,load:!1,photos:[],showReplyTemplateSelector:!1,showInlineTemplateSelector:!1,loaded_page_list:!0,load_slug_simple_list:!0,showMenu:!1,need_show_qr_and_link:!1,utm_source:null,need_stay_after_save:!0,need_show_global_slug_list:!1,need_page_sticker:!1,need_page_audios:!1,need_page_documents:!1,need_page_video:!1,need_page_images:!1,need_inline_menu:!1,need_reply_menu:!1,need_attach_page:!1,need_attach_dialog:!1,need_attach_slug:!1,need_rules:!1,need_secure_page:!1,need_payed_page:!1,need_cashback_page:!1,bot:null,pageForm:{id:null,content:"",command:null,slug:null,comment:null,password:null,password_description:null,price:null,cashback:null,cashback_config:{need_request_user_data:!1,simple_form:!0,description:null},price_description:null,videos:[],images:[],audios:[],documents:[],sticker:null,reply_keyboard_title:null,reply_keyboard:null,inline_keyboard:null,is_external:!1,need_log_user_action:!1,next_page_id:null,next_bot_dialog_command_id:null,next_bot_menu_slug_id:null,rules_if:null,rules_else_page_id:null,rules_if_message:null,rules_else_message:null}}},watch:{need_cashback_page:function(s,t){this.need_cashback_page||(this.pageForm.cashback=null)},need_payed_page:function(s,t){this.need_payed_page||(this.pageForm.price=null,this.pageForm.price_description=null)},need_secure_page:function(s,t){this.need_secure_page||(this.pageForm.password=null,this.pageForm.password_description=null)},need_page_images:function(s,t){this.need_page_images||(this.photos=[],this.pageForm.images=[])},need_page_audios:function(s,t){this.need_page_audios||(this.pageForm.audios=[])},need_page_documents:function(s,t){this.need_page_documents||(this.pageForm.documents=[])},need_page_sticker:function(s,t){this.need_page_sticker||(this.pageForm.sticker=null)},need_page_video:function(s,t){this.need_page_video||(this.pageForm.videos=[])},need_inline_menu:function(s,t){this.need_inline_menu||(this.pageForm.inline_keyboard=null,this.pageForm.inline_keyboard_id=null)},need_rules:function(s,t){this.need_rules||(this.pageForm.rules_if=null,this.pageForm.rules_else_page_id=null,this.pageForm.rules_if_message=null,this.pageForm.rules_else_message=null)},need_reply_menu:function(s,t){this.need_reply_menu||(this.pageForm.reply_keyboard=null,this.pageForm.reply_keyboard_id=null)},need_attach_page:function(s,t){this.need_attach_page||(this.pageForm.next_page_id=null)},need_attach_dialog:function(s,t){this.need_attach_dialog||(this.pageForm.next_bot_dialog_command_id=null)},need_attach_slug:function(s,t){this.need_attach_slug||(this.pageForm.next_bot_menu_slug_id=null)},pageForm:{handler:function(s){this.pageForm.reply_keyboard!=null&&(this.need_reply_menu=!0),this.pageForm.inline_keyboard!=null&&(this.need_inline_menu=!0),this.pageForm.images.length>0&&(this.need_page_images=!0),this.pageForm.next_bot_dialog_command_id!=null&&(this.need_attach_dialog=!0),this.pageForm.next_bot_menu_slug_id!=null&&(this.need_attach_slug=!0),this.pageForm.next_page_id!=null&&(this.need_attach_page=!0),this.pageForm.rules_if!=null&&(this.need_rules=!0),this.pageForm.videos.length>0&&(this.need_page_video=!0),this.pageForm.audios.length>0&&(this.need_page_audios=!0),this.pageForm.documents.length>0&&(this.need_page_documents=!0),this.pageForm.sticker&&(this.need_page_sticker=!0),this.pageForm.password!=null&&(this.need_secure_page=!0),this.pageForm.price!=null&&(this.need_payed_page=!0),this.pageForm.cashback!=null&&(this.need_cashback_page=!0),this.need_clean=!0},deep:!0}},computed:{...C(["getCurrentBot"]),qr(){return"https://api.qrserver.com/v1/create-qr-code/?size=450x450&qzone=2&data="+this.pageLink},selectedLinkIds(){let s=this.links.map(t=>t.id);return this.page==null?s:this.page.id!=null?[this.page.id,...s]:s},hasParts(){return this.need_page_sticker||this.need_page_audios||this.need_page_documents||this.need_page_video||this.need_page_images||this.need_inline_menu||this.need_reply_menu||this.need_attach_page||this.need_attach_dialog||this.need_attach_slug||this.need_secure_page||this.need_payed_page||this.need_cashback_page||this.need_rules},pageLink(){if(!this.pageForm.id)return"Ссылка недоступна";let s="";for(let t=0;t<10-(""+this.pageForm.id).length;t++)s+="0";return s+=this.pageForm.id,"https://t.me/"+this.getCurrentBot.bot_domain+"?start="+Zb.encode("004"+s+(this.utm_source!=null?"utm"+this.utm_source:""))}},mounted(){this.page?this.preparePageForm(this.page):this.clearForm(),this.loadCurrentBot().then(()=>{this.saveModal=new bootstrap.Modal(document.getElementById("save-modal"),{})}),this.pageModal=new bootstrap.Offcanvas(document.getElementById("offcanvas"),{scroll:!0}),this.pagePreviewModal=new bootstrap.Offcanvas(document.getElementById("page-preview"),{scroll:!0}),window.addEventListener("keydown",s=>{if(s.ctrlKey&&s.keyCode==8&&(s.preventDefault(),this.clearForm()),s.ctrlKey&&s.code=="KeyD"&&(s.preventDefault(),this.pagePreviewModal.toggle()),s.ctrlKey&&s.keyCode==32&&(s.preventDefault(),this.pageModal.toggle()),s.ctrlKey&&s.code=="KeyS"){s.preventDefault();const t=document.querySelector("#save-page-btn");t?t.click():this.$notify({title:"Конструктор страниц",text:"Вы еще не начали создавать страницу!",type:"warning"})}s.ctrlKey&&s.keyCode==39&&(s.preventDefault(),this.tab===10?this.tab=0:this.tab++),s.ctrlKey&&s.keyCode==37&&(s.preventDefault(),this.tab===0?this.tab=10:this.tab--)})},methods:{submitReLink(s){this.need_inline_menu=!0,this.tab=1;let t={text:"🔗Поделиться ссылкой",url:`https://t.me/share/url?url=${s.url}&text=${s.text}`};console.log("menu",this.pageForm.inline_keyboard),this.pageForm.inline_keyboard==null?this.pageForm.inline_keyboard={menu:[[{...t}]]}:this.pageForm.inline_keyboard.push([{...t}])},goToBotSettings(){this.$emit("bot-settings")},callbackFastPageCreate(){this.loaded_page_list=!1,this.$nextTick(()=>{this.loaded_page_list=!0}),this.fastPageModal.hide()},fastCreate(){this.fastPageModal=new bootstrap.Modal(document.getElementById("fast-pages-create"),{}),this.fastPageModal.show()},chainCollapseTest(s){return this.page==null?this.links.filter(t=>t.id==s.id).length>1:[this.page,...this.links].filter(t=>t.id==s.id).length>1},loadPageChains(){return this.$store.dispatch("loadPageChains",{dataObject:{start_page_id:this.page.id}}).then(s=>{this.links=s.data})},renewPassword(){let s="0123456789ABCDEF",t="";for(let o=0;o<10;o++)t+=s[Math.floor(Math.random()*s.length)];this.pageForm.password=t},removeLink(s){this.links.splice(s,1)},loadSlugs(){this.load_slug_simple_list=!1,this.need_show_global_slug_list=!1,this.$nextTick(()=>{this.load_slug_simple_list=!0})},preparePageForm(s){this.need_show_qr_and_link=!1,this.need_show_global_slug_list=!1,this.need_page_sticker=!1,this.need_page_audios=!1,this.need_page_documents=!1,this.need_page_video=!1,this.need_page_images=!1,this.need_inline_menu=!1,this.need_reply_menu=!1,this.need_attach_page=!1,this.need_attach_dialog=!1,this.need_attach_slug=!1,this.need_secure_page=!1,this.need_payed_page=!1,this.need_cashback_page=!1,this.need_rules=!1,this.links=[],this.page=s,this.photos=[],this.$nextTick(()=>{var t;if(this.pageForm.id=s.id,this.pageForm.slug_id=s.slug?s.slug.id:null,this.pageForm.content=s.content,this.pageForm.password=s.password||null,this.pageForm.password_description=s.password_description||null,this.pageForm.price=s.price||null,this.pageForm.cashback=s.cashback||null,s.cashback_config&&(this.pageForm.cashback_config={need_request_user_data:s.cashback_config.need_request_user_data||!1,simple_form:s.cashback_config.simple_form||!0,description:s.cashback_config.description||null}),this.pageForm.price_description=s.price_description||null,this.pageForm.command=s.slug?s.slug.command:null,this.pageForm.slug=s.slug?s.slug.slug:null,this.pageForm.comment=s.slug?s.slug.comment:null,this.pageForm.images=s.images||[],this.pageForm.sticker=s.sticker||null,this.pageForm.reply_keyboard_title=s.reply_keyboard_title||null,this.pageForm.reply_keyboard_id=s.reply_keyboard_id||null,this.pageForm.inline_keyboard_id=s.inline_keyboard_id||null,this.pageForm.reply_keyboard=s.replyKeyboard||null,this.pageForm.reply_keyboard!=null){let o=((t=s.reply_keyboard)==null?void 0:t.settings)||null;o!=null&&(this.pageForm.reply_keyboard_settings={resize_keyboard:o.resize_keyboard||!0,one_time_keyboard:o.one_time_keyboard||!1,input_field_placeholder:o.input_field_placeholder||null,is_persistent:o.is_persistent||!1})}this.pageForm.inline_keyboard=s.inlineKeyboard||null,this.pageForm.next_page_id=s.next_page_id||null,this.pageForm.next_bot_dialog_command_id=s.next_bot_dialog_command_id||null,this.pageForm.next_bot_menu_slug_id=s.next_bot_menu_slug_id||null,this.pageForm.is_external=s.is_external||!1,this.pageForm.need_log_user_action=s.need_log_user_action||!1,this.pageForm.rules_if=s.rules_if||null,this.pageForm.rules_else_page_id=s.rules_else_page_id||null,this.pageForm.audios=s.audios||[],this.pageForm.documents=s.documents||[],this.pageForm.videos=s.videos||[],this.pageForm.rules_if_message=s.rules_if_message||null,this.pageForm.rules_else_message=s.rules_else_message||null,this.pageForm.id!=null&&this.pageForm.next_page_id!=null&&this.loadPageChains()})},copyToClipBoard(s){navigator.clipboard.writeText(s).then(()=>{this.$notify({title:"Копирование",text:"Ссылка скопирована в буфер"})}).catch(t=>{this.$notify({title:"Копирование",text:"Ошибка копирования",type:"error"})})},associateDialog(s){this.pageForm.next_bot_dialog_command_id=s.id},associateSlug(s){this.pageForm.next_bot_menu_slug_id=s.id},loadCurrentBot(s=null){return this.$store.dispatch("updateCurrentBot",{bot:s}).then(()=>{this.bot=this.getCurrentBot})},clearLinks(){this.links=[],this.pageForm.next_page_id=null},attachPage(s){this.links.length==0&&(s.id!=this.pageForm.id?(this.$notify({title:"Конструктор страниц",text:"Вы успешно связали страницы!",type:"success"}),this.pageForm.next_page_id=s.id):this.$notify({title:"Конструктор страниц",text:"Вы не можете связать данную страницу с собой",type:"error"})),(this.page==null?this.links.findIndex(o=>o.id===s.id)!=-1:this.links.findIndex(o=>o.id===s.id)!=-1||s.id===this.page.id)||this.links.push(s)},clearForm(){this.photos=[],this.pageForm={id:null,content:null,command:null,slug:null,comment:null,sticker:null,password:null,password_description:null,price:null,cashback:null,cashback_config:{need_request_user_data:!1,simple_form:!0,description:null},price_description:null,images:[],reply_keyboard:null,inline_keyboard:null,is_external:!1,need_log_user_action:!1,videos:[],audios:[],documents:[],reply_keyboard_title:null,reply_keyboard_id:null,inline_keyboard_id:null,next_page_id:null,next_menu_slug:null,next_bot_dialog_command_id:null,next_bot_menu_slug_id:null,rules_if_message:null,rules_else_message:null},this.photos=[],this.showReplyTemplateSelector=!1,this.showInlineTemplateSelector=!1,this.need_page_images=!1,this.need_page_video=!1,this.need_inline_menu=!1,this.need_reply_menu=!1,this.need_attach_page=!1,this.need_attach_dialog=!1,this.need_attach_slug=!1,this.need_rules=!1,this.need_page_audios=!1,this.need_page_documents=!1,this.need_page_sticker=!1,this.need_payed_page=!1,this.need_cashback_page=!1,this.need_secure_page=!1,this.links=[],this.$nextTick(()=>{this.need_clean=!1})},openSaveModal(){(this.pageForm.comment||"").length===0&&(this.pageForm.comment=this.pageForm.command),this.saveModal.show()},submitPage(){let s=new FormData;if(Object.keys(this.pageForm).forEach(t=>{const o=this.pageForm[t]||"";typeof o=="object"?s.append(t,JSON.stringify(o)):s.append(t,o)}),this.need_page_create_from_keyboard&&s.append("need_page_create_from_keyboard",this.need_page_create_from_keyboard),this.bot&&s.append("bot_id",this.bot.id),this.photos.length>0)for(let t=0;t<this.photos.length;t++)s.append("photos[]",this.photos[t]);this.$store.dispatch(this.pageForm.id==null?"createPage":"updatePage",{pageForm:s}).then(t=>{this.pageForm.id==null&&this.preparePageForm(t.data),this.links.length>0&&this.$store.dispatch("storePageChains",{dataObject:{start_page_id:t.data.id,links:this.links.map(o=>o.id)}}),this.need_stay_after_save||(this.load=!0,this.$nextTick(()=>{this.load=!1,this.clearForm()})),this.loaded_page_list=!1,this.$nextTick(()=>{this.loaded_page_list=!0}),this.saveModal.hide(),this.$emit("callback",t.data),this.$notify({title:"Конструктор ботов",text:this.pageForm.id==null?"Страница успешно создана!":"Страница успешно обновлена!",type:"success"}),this.$store.dispatch("loadPages",{dataObject:{botId:this.bot.id,needNewFirst:!0},page:localStorage.getItem(`cashman_pagelist_${this.bot.id}_page_index`)||0})}).catch(t=>{})},saveInlineKeyboard(s){this.pageForm.inline_keyboard=s},saveSettings(s){console.log("settings save",s),this.pageForm.reply_keyboard_settings={resize_keyboard:s.resize_keyboard||!0,one_time_keyboard:s.one_time_keyboard||!1,input_field_placeholder:s.input_field_placeholder||null,is_persistent:s.is_persistent||!1}},selectReplyKeyboard(s){this.pageForm.reply_keyboard=s,this.showReplyTemplateSelector=!1},selectInlineKeyboard(s){this.pageForm.inline_keyboard=s,this.showInlineTemplateSelector=!1},getPhoto(s){return{imageUrl:URL.createObjectURL(s)}},removePhoto(s){this.photos.splice(s,1)},removeImage(s){this.pageForm.images.splice(s,1)},onChangePhotos(s){const t=s.target.files;for(let o=0;o<t.length;o++)this.photos.push(t[o])},onChange(s){this.pageForm.content=s},selectPhoto(s){this.pageForm.images||(this.pageForm.images=[]);let t=this.pageForm.images.indexOf(s.file_id);t!==-1?this.pageForm.images.splice(t,1):this.pageForm.images.push(s.file_id)},selectSticker(s){this.pageForm.sticker=s.file_id},selectVideo(s){this.pageForm.videos||(this.pageForm.videos=[]);let t=this.pageForm.videos.indexOf(s.file_id);t!==-1?this.pageForm.videos.splice(t,1):this.pageForm.videos.push(s.file_id)},selectAudio(s){this.pageForm.audios||(this.pageForm.audios=[]);let t=this.pageForm.audios.indexOf(s.file_id);if(s.type==="voice"){if(t!==-1){this.pageForm.audios.splice(t,1);return}this.pageForm.audios=[s.file_id];return}t!==-1?this.pageForm.audios.splice(t,1):this.pageForm.audios.push(s.file_id)},selectDocument(s){this.pageForm.documents||(this.pageForm.documents=[]);let t=this.pageForm.documents.indexOf(s.file_id);t!==-1?this.pageForm.documents.splice(t,1):this.pageForm.documents.push(s.file_id)},pageListCallback(s){this.$notify("Вы выбрали страницу из списка! Все остальные действия будут производится для этой страницы"),this.load=!0,this.preparePageForm(s),this.$nextTick(()=>{this.load=!1})}}},l0=Object.assign(o0,{__name:"Page",setup(s){return(t,o)=>{const a=P("Popper"),n=T("lazy");return l(),i(g,null,[e("div",Xb,[e("div",xb,[e("div",ef,[tf,m(" Вы можете создать сразу все страницы через "),e("a",{href:"javascript:void(0)",class:"text-primary fw-bold",onClick:o[0]||(o[0]=(...d)=>t.fastCreate&&t.fastCreate(...d))},[sf,m(" быстрое создание страниц")]),m(", а затем наполнить их контентом! ")])])]),t.pageForm.id?(l(),i("div",of,[e("div",lf,[e("div",nf,[af,m(" Вы в режиме редактирования страницы (кнопки) "),e("strong",df,u(t.page.slug?t.page.slug.command:"Без названия"),1),m(", если хотите создать новую нажмите "),e("a",{href:"javascript:void(0)",class:"btn btn-primary ml-2",onClick:o[1]||(o[1]=(...d)=>t.clearForm&&t.clearForm(...d))},"Создать новую страницу")])])])):r("",!0),t.bot?(l(),i("form",{key:1,id:"page-construct",class:"py-3",onSubmit:o[68]||(o[68]=S((...d)=>t.openSaveModal&&t.openSaveModal(...d),["prevent"]))},[t.hasParts?(l(),i("div",rf,[e("div",cf,[uf,e("ul",mf,[e("li",{class:p(["mr-1",{active:t.need_page_images}]),title:"Изображения"},_f,2),e("li",{class:p(["mr-1",{active:t.need_page_sticker}]),title:"Стикеры"},bf,2),e("li",{class:p(["mr-1",{active:t.need_page_video}]),title:"Видео"},gf,2),e("li",{class:p(["mr-1",{active:t.need_page_audios}]),title:"Аудио"},vf,2),e("li",{class:p(["mr-1",{active:t.need_page_documents}]),title:"Документы"},kf,2),e("li",{class:p(["mr-1",{active:t.need_attach_page}]),title:"Страницы"},wf,2),e("li",{class:p(["mr-1",{active:t.need_attach_slug}]),title:"Скрипты"},Sf,2),e("li",{class:p(["mr-1",{active:t.need_attach_dialog}]),title:"Диалоги"},Vf,2),e("li",{class:p(["mr-1",{active:t.need_rules}]),title:"Правила"},zf,2),e("li",{class:p(["mr-1",{active:t.need_reply_menu}]),title:"Нижнее меню"},Uf,2),e("li",{title:"Текстовое меню",class:p({active:t.need_inline_menu})},Of,2)])])])):r("",!0),e("div",If,[e("div",Qf,[Tf,c(e("input",{type:"text",class:"form-control",placeholder:"Команда","aria-label":"Команда","onUpdate:modelValue":o[2]||(o[2]=d=>t.pageForm.command=d),maxlength:"255","aria-describedby":"bot-domain",required:""},null,512),[[_,t.pageForm.command]])]),e("div",Bf,[e("div",Mf,[t.pageForm.id||t.need_clean?(l(),i("button",Rf,Ef)):r("",!0),t.pageForm.id||t.need_clean?(l(),i("button",{key:1,type:"button",onClick:o[3]||(o[3]=(...d)=>t.clearForm&&t.clearForm(...d)),title:"Очистить \\ Новая страница",class:"btn btn-outline-primary min-menu-btn"},Kf)):r("",!0),Nf])])]),c(e("div",Jf,[e("div",Hf,[e("div",Gf,[Yf,b(Es,{modelValue:t.pageForm.content,"onUpdate:modelValue":o[4]||(o[4]=d=>t.pageForm.content=d),onSubmitRelink:t.submitReLink,"field-id":"#main-text-field"},null,8,["modelValue","onSubmitRelink"])]),e("div",Wf,[c(e("textarea",{class:"form-control","onUpdate:modelValue":o[5]||(o[5]=d=>t.pageForm.content=d),maxlength:"4096",placeholder:"Введите текст",id:"main-text-field",style:{"min-height":"150px"}},null,512),[[_,t.pageForm.content]]),e("label",Zf,[m("Содержимое страницы "),t.pageForm.content?(l(),i("span",Xf,u(t.pageForm.content.length)+"/4096 ",1)):r("",!0)])])]),e("div",xf,[e("ul",eg,[e("li",{class:"nav-item",onClick:o[6]||(o[6]=d=>t.tab=0)},[e("a",{class:p([{active:t.tab===0,"primary-mark":t.need_reply_menu},"nav-link d-flex flex-column justify-content-center align-items-center font-12"]),href:"javascript:void(0)"},og,2)]),e("li",{class:"nav-item",onClick:o[7]||(o[7]=d=>t.tab=1)},[e("a",{class:p([{active:t.tab===1,"primary-mark":t.need_inline_menu},"nav-link d-flex flex-column justify-content-center align-items-center font-12"]),href:"javascript:void(0)"},ng,2)]),e("li",{class:"nav-item",onClick:o[8]||(o[8]=d=>t.tab=2)},[e("a",{class:p([{active:t.tab===2,"primary-mark":t.need_page_images},"nav-link d-flex flex-column justify-content-center align-items-center font-12"]),href:"javascript:void(0)"},rg,2)]),e("li",{class:"nav-item",onClick:o[9]||(o[9]=d=>t.tab=3)},[e("a",{class:p([{active:t.tab===3,"primary-mark":t.need_page_video},"nav-link d-flex flex-column justify-content-center align-items-center font-12"]),href:"javascript:void(0)"},mg,2)]),e("li",{class:"nav-item",onClick:o[10]||(o[10]=d=>t.tab=5)},[e("a",{class:p([{active:t.tab===5,"primary-mark":t.need_page_audios},"nav-link d-flex flex-column justify-content-center align-items-center font-12"]),href:"javascript:void(0)"},pg,2)]),e("li",{class:"nav-item",onClick:o[11]||(o[11]=d=>t.tab=6)},[e("a",{class:p([{active:t.tab===6,"primary-mark":t.need_page_documents},"nav-link d-flex flex-column justify-content-center align-items-center font-12"]),href:"javascript:void(0)"},gg,2)]),e("li",{class:"nav-item",onClick:o[12]||(o[12]=d=>t.tab=7)},[e("a",{class:p([{active:t.tab===7,"primary-mark":t.need_attach_page},"nav-link d-flex flex-column justify-content-center align-items-center font-12"]),href:"javascript:void(0)"},$g,2)]),e("li",{class:"nav-item",onClick:o[13]||(o[13]=d=>t.tab=8)},[e("a",{class:p([{active:t.tab===8,"primary-mark":t.need_attach_slug},"nav-link d-flex flex-column justify-content-center align-items-center font-12"]),href:"javascript:void(0)"},wg,2)]),e("li",{class:"nav-item",onClick:o[14]||(o[14]=d=>t.tab=9)},[e("a",{class:p([{active:t.tab===9,"primary-mark":t.need_attach_dialog},"nav-link d-flex flex-column justify-content-center align-items-center font-12"]),href:"javascript:void(0)"},jg,2)]),e("li",Vg,[e("div",qg,[zg,e("ul",Pg,[e("li",{onClick:o[15]||(o[15]=d=>t.tab=10)},[e("a",{class:p(["dropdown-item",{active:t.tab===10,"primary-mark":t.need_rules}]),href:"javascript:void(0)"},[Ug,m(" Правила на странице")],2)]),e("li",{onClick:o[16]||(o[16]=d=>t.tab=11)},[e("a",{class:p(["dropdown-item",{active:t.tab===11,"primary-mark":t.need_secure_page}]),href:"javascript:void(0)"},[Ag,m(" Безопасная страница")],2)]),e("li",{onClick:o[17]||(o[17]=d=>t.tab=12)},[e("a",{class:p(["dropdown-item",{active:t.tab===12,"primary-mark":t.need_payed_page}]),href:"javascript:void(0)"},[Og,m(" Платная страница")],2)]),e("li",{onClick:o[18]||(o[18]=d=>t.tab=13)},[e("a",{class:p(["dropdown-item",{active:t.tab===13,"primary-mark":t.need_cashback_page}]),href:"javascript:void(0)"},[Ig,m(" Начислить бонусы")],2)]),e("li",{onClick:o[19]||(o[19]=d=>t.tab=4)},[e("a",{class:p(["dropdown-item",{active:t.tab===4,"primary-mark":t.need_page_sticker}]),href:"javascript:void(0)"},[Qg,m(" Стикеры")],2)])])])])])]),c(e("div",null,[t.need_reply_menu?(l(),i("div",Tg,[e("div",Bg,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[20]||(o[20]=d=>t.need_reply_menu=d),type:"checkbox",id:"need-reply-menu"},null,512),[[k,t.need_reply_menu]]),Mg])])):r("",!0),t.need_reply_menu?(l(),i("div",Rg,[e("div",Dg,[e("div",Eg,[Lg,e("button",{class:p(["btn",{"btn-outline-primary":!t.showReplyTemplateSelector,"btn-primary":t.showReplyTemplateSelector}]),type:"button",onClick:o[21]||(o[21]=d=>t.showReplyTemplateSelector=!t.showReplyTemplateSelector)},[t.showReplyTemplateSelector?(l(),i("span",Ng," Скрыть шаблоны меню")):(l(),i("span",Kg," Открыть шаблоны меню"))],2)]),e("div",Jg,[e("div",Hg,[e("div",Gg,[e("label",Yg,[b(a,null,{content:y(()=>[Zg]),default:y(()=>[Wg]),_:1}),m(" Заголовок ")]),c(e("input",{type:"text",class:"form-control",placeholder:"Заголовок меню","aria-label":"Заголовок меню","onUpdate:modelValue":o[22]||(o[22]=d=>t.pageForm.reply_keyboard_title=d),maxlength:"255","aria-describedby":"bot-domain"},null,512),[[_,t.pageForm.reply_keyboard_title]])])]),t.showReplyTemplateSelector?(l(),v(E,{key:0,class:"mb-2",type:"reply",onSelect:t.selectReplyKeyboard,"select-mode":!0},null,8,["onSelect"])):(l(),v(I,{key:1,type:"reply",modelValue:t.pageForm.reply_keyboard,"onUpdate:modelValue":o[23]||(o[23]=d=>t.pageForm.reply_keyboard=d)},null,8,["modelValue"])),e("div",Xg,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[24]||(o[24]=d=>t.need_page_create_from_keyboard=d),type:"checkbox",role:"switch",id:"need-page-create-from-keyboard"},null,512),[[k,t.need_page_create_from_keyboard]]),xg])])])])):(l(),i("div",e1,[e("div",t1,[e("div",s1,[c(e("img",o1,null,512),[[n,"../images/icon.png"]])]),l1,i1,e("div",n1,[e("button",{disabled:t.need_reply_menu,onClick:o[25]||(o[25]=d=>t.need_reply_menu=!0),class:p([{"btn-primary":!t.need_reply_menu,"btn-outline-secondary":t.need_reply_menu},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,a1),d1])])]))],512),[[q,t.tab===0]]),c(e("div",null,[t.need_inline_menu?(l(),i("div",r1,[e("div",c1,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[26]||(o[26]=d=>t.need_inline_menu=d),type:"checkbox",id:"need-inline-menu"},null,512),[[k,t.need_inline_menu]]),u1])])):r("",!0),t.need_inline_menu?(l(),i("div",m1,[e("div",h1,[e("div",_1,[p1,e("button",{class:p(["btn",{"btn-outline-primary":!t.showInlineTemplateSelector,"btn-primary":t.showInlineTemplateSelector}]),type:"button",onClick:o[27]||(o[27]=d=>t.showInlineTemplateSelector=!t.showInlineTemplateSelector)},[t.showInlineTemplateSelector?(l(),i("span",f1," Скрыть шаблоны меню")):(l(),i("span",b1," Открыть шаблоны меню"))],2)]),e("div",g1,[t.showInlineTemplateSelector?(l(),v(E,{key:0,class:"mb-2",type:"inline",onSelect:t.selectInlineKeyboard,"select-mode":!0},null,8,["onSelect"])):(l(),v(I,{key:1,type:"inline",modelValue:t.pageForm.inline_keyboard,"onUpdate:modelValue":o[28]||(o[28]=d=>t.pageForm.inline_keyboard=d)},null,8,["modelValue"]))])])])):(l(),i("div",y1,[e("div",v1,[e("div",$1,[c(e("img",k1,null,512),[[n,"../images/icon.png"]])]),F1,w1,e("div",C1,[e("button",{disabled:t.need_inline_menu,onClick:o[29]||(o[29]=d=>t.need_inline_menu=!0),class:p([{"btn-primary":!t.need_inline_menu,"btn-outline-secondary":t.need_inline_menu},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,S1),j1])])]))],512),[[q,t.tab===1]]),c(e("div",null,[t.need_page_images?(l(),i("div",V1,[e("div",q1,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[30]||(o[30]=d=>t.need_page_images=d),type:"checkbox",id:"need-page-images"},null,512),[[k,t.need_page_images]]),z1])])):r("",!0),t.need_page_images?(l(),i("div",P1,[e("div",U1,[A1,e("div",O1,[e("label",I1,[m(" + "),e("input",{type:"file",id:"photos",multiple:"",accept:"image/*",onChange:o[31]||(o[31]=(...d)=>t.onChangePhotos&&t.onChangePhotos(...d)),style:{display:"none"}},null,32)]),e("div",Q1,[t.photos.length>0?(l(),i("div",T1,[(l(!0),i(g,null,$(t.photos,(d,h)=>(l(),i("div",B1,[c(e("img",null,null,512),[[n,t.getPhoto(d).imageUrl]]),e("div",M1,[e("a",{onClick:f=>t.removePhoto(h)},"Удалить",8,R1)])]))),256))])):r("",!0),t.pageForm.images.length>0?(l(),i("h6",D1,"Ранее загруженные фотографии")):r("",!0),t.pageForm.images.length>0?(l(),i("div",E1,[(l(!0),i(g,null,$(t.pageForm.images,(d,h)=>(l(),i("div",L1,[c(e("img",null,null,512),[[n,"/images-by-bot-id/"+t.bot.id+"/"+d]]),e("div",K1,[e("a",{onClick:f=>t.removeImage(h)},"Удалить",8,N1)])]))),256))])):r("",!0)])])])])):(l(),i("div",J1,[e("div",H1,[e("div",G1,[c(e("img",Y1,null,512),[[n,"../images/icon.png"]])]),W1,Z1,e("div",X1,[e("button",{disabled:t.need_page_images,onClick:o[32]||(o[32]=d=>t.need_page_images=!0),class:p([{"btn-primary":!t.need_page_images,"btn-outline-secondary":t.need_page_images},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,x1),ey])])]))],512),[[q,t.tab===2]]),c(e("div",null,[t.need_page_video?(l(),i("div",ty,[e("div",sy,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[33]||(o[33]=d=>t.need_page_video=d),type:"checkbox",id:"need-page-video"},null,512),[[k,t.need_page_video]]),oy])])):r("",!0),t.need_page_video?(l(),i("div",ly,[b(U,{"need-video":!0,"need-video-note":!0,selected:t.pageForm.videos,onSelect:t.selectVideo},null,8,["selected","onSelect"])])):(l(),i("div",iy,[e("div",ny,[e("div",ay,[c(e("img",dy,null,512),[[n,"../images/icon.png"]])]),ry,cy,e("div",uy,[e("button",{disabled:t.need_page_video,onClick:o[34]||(o[34]=d=>t.need_page_video=!0),class:p([{"btn-primary":!t.need_page_video,"btn-outline-secondary":t.need_page_video},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,my),hy])])]))],512),[[q,t.tab===3]]),c(e("div",null,[t.need_page_sticker?(l(),i("div",_y,[e("div",py,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[35]||(o[35]=d=>t.need_page_sticker=d),type:"checkbox",id:"need-page-sticker"},null,512),[[k,t.need_page_sticker]]),by])])):r("",!0),t.need_page_sticker?(l(),i("div",fy,[b(U,{"need-sticker":!0,selected:[t.pageForm.sticker],onSelect:t.selectSticker},null,8,["selected","onSelect"])])):(l(),i("div",gy,[e("div",yy,[e("div",vy,[c(e("img",$y,null,512),[[n,"../images/icon.png"]])]),ky,Fy,e("div",wy,[e("button",{disabled:t.need_page_sticker,onClick:o[36]||(o[36]=d=>t.need_page_sticker=!0),class:p([{"btn-primary":!t.need_page_sticker,"btn-outline-secondary":t.need_page_sticker},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,Cy),Sy])])]))],512),[[q,t.tab===4]]),c(e("div",null,[t.need_page_audios?(l(),i("div",jy,[e("div",Vy,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[37]||(o[37]=d=>t.need_page_audios=d),type:"checkbox",id:"need-page-audio"},null,512),[[k,t.need_page_audios]]),qy])])):r("",!0),t.need_page_audios?(l(),i("div",zy,[b(U,{"need-audio":!0,selected:t.pageForm.audios,onSelect:t.selectAudio},null,8,["selected","onSelect"])])):(l(),i("div",Py,[e("div",Uy,[e("div",Ay,[c(e("img",Oy,null,512),[[n,"../images/icon.png"]])]),Iy,Qy,e("div",Ty,[e("button",{disabled:t.need_page_audios,onClick:o[38]||(o[38]=d=>t.need_page_audios=!0),class:p([{"btn-primary":!t.need_page_audios,"btn-outline-secondary":t.need_page_audios},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,By),My])])]))],512),[[q,t.tab===5]]),c(e("div",null,[t.need_page_documents?(l(),i("div",Ry,[e("div",Dy,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[39]||(o[39]=d=>t.need_page_documents=d),type:"checkbox",id:"need-page-document"},null,512),[[k,t.need_page_documents]]),Ey])])):r("",!0),t.need_page_documents?(l(),i("div",Ly,[b(U,{"need-document":!0,selected:t.pageForm.documents,onSelect:t.selectDocument},null,8,["selected","onSelect"])])):(l(),i("div",Ky,[e("div",Ny,[e("div",Jy,[c(e("img",Hy,null,512),[[n,"../images/icon.png"]])]),Gy,Yy,e("div",Wy,[e("button",{disabled:t.need_page_documents,onClick:o[40]||(o[40]=d=>t.need_page_documents=!0),class:p([{"btn-primary":!t.need_page_documents,"btn-outline-secondary":t.need_page_documents},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,Zy),Xy])])]))],512),[[q,t.tab===6]]),c(e("div",null,[e("div",xy,[e("div",ev,[e("div",tv,[c(e("img",sv,null,512),[[n,"../images/icon.png"]])]),ov,lv,t.pageForm.next_page_id?(l(),i("p",iv,"Связано со страницей #"+u(t.pageForm.next_page_id),1)):r("",!0),e("div",nv,[t.pageForm.next_page_id?(l(),i("button",{key:0,class:"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill btn-danger",type:"button",onClick:o[41]||(o[41]=(...d)=>t.clearLinks&&t.clearLinks(...d))},"Очистить ")):(l(),i("button",av," Связать ")),dv]),rv,e("div",cv,[uv,mv,(l(!0),i(g,null,$(t.links,(d,h)=>(l(),i("div",hv,[e("button",{type:"button",onClick:f=>t.removeLink(h),class:p([{"btn-danger":t.chainCollapseTest(d)},"btn btn-primary position-relative rounded-5"])},[m(u(d.slug.command||"-")+" ",1),e("span",pv," #"+u(d.id),1)],10,_v),h<t.links.length-1?(l(),i("i",bv)):r("",!0)]))),256)),t.links.length>0?(l(),i("i",fv)):r("",!0),gv])])])],512),[[q,t.tab===7]]),c(e("div",null,[t.need_attach_slug?(l(),i("div",yv,[vv,e("div",$v,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[42]||(o[42]=d=>t.need_show_global_slug_list=d),type:"checkbox",id:"need-show-global-slug-list"},null,512),[[k,t.need_show_global_slug_list]]),kv]),t.bot&&t.need_show_global_slug_list?(l(),v(ae,{key:0,"can-add":!0,bot:t.bot,onCallback:t.loadSlugs},null,8,["bot","onCallback"])):r("",!0)])):r("",!0),t.need_attach_slug?(l(),i("div",Fv,[e("div",wv,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[43]||(o[43]=d=>t.need_attach_slug=d),type:"checkbox",id:"need-slug-attach"},null,512),[[k,t.need_attach_slug]]),Cv])])):r("",!0),t.need_attach_slug?(l(),i("div",Sv,[t.pageForm.next_bot_menu_slug_id?(l(),i("div",jv,[m(" Связано со скриптом #"+u(t.pageForm.next_bot_menu_slug_id)+" ",1),e("a",{class:"btn btn-link text-danger",onClick:o[44]||(o[44]=d=>t.pageForm.next_bot_menu_slug_id=null)},"Очистить")])):r("",!0),t.bot&&t.load_slug_simple_list?(l(),v(ka,{key:1,global:!0,"can-select":!0,selected:[t.pageForm.next_bot_menu_slug_id],onCallback:t.associateSlug,bot:t.bot},null,8,["selected","onCallback","bot"])):r("",!0)])):(l(),i("div",Vv,[e("div",qv,[e("div",zv,[c(e("img",Pv,null,512),[[n,"../images/icon.png"]])]),Uv,Av,e("div",Ov,[e("button",{disabled:t.need_attach_slug,onClick:o[45]||(o[45]=d=>t.need_attach_slug=!0),class:p([{"btn-primary":!t.need_attach_slug,"btn-outline-secondary":t.need_attach_slug},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,Iv),Qv])])]))],512),[[q,t.tab===8]]),c(e("div",null,[t.need_attach_dialog?(l(),i("div",Tv,[e("div",Bv,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[46]||(o[46]=d=>t.need_attach_dialog=d),type:"checkbox",id:"need-dialog-attach"},null,512),[[k,t.need_attach_dialog]]),Mv])])):r("",!0),t.need_attach_dialog?(l(),i("div",Rv,[t.pageForm.next_bot_dialog_command_id?(l(),i("p",Dv,[m("Связано с диалогом #"+u(t.pageForm.next_bot_dialog_command_id)+" ",1),e("a",{class:"btn btn-link",onClick:o[47]||(o[47]=d=>t.pageForm.next_bot_dialog_command_id=null)},"Очистить")])):r("",!0),t.bot?(l(),v(ze,{key:1,onSelectDialog:t.associateDialog,bot:t.bot},null,8,["onSelectDialog","bot"])):r("",!0)])):(l(),i("div",Ev,[e("div",Lv,[e("div",Kv,[c(e("img",Nv,null,512),[[n,"../images/icon.png"]])]),Jv,Hv,e("div",Gv,[e("button",{disabled:t.need_attach_dialog,onClick:o[48]||(o[48]=d=>t.need_attach_dialog=!0),class:p([{"btn-primary":!t.need_attach_dialog,"btn-outline-secondary":t.need_attach_dialog},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,Yv),Wv])])]))],512),[[q,t.tab===9]]),c(e("div",null,[t.need_rules?(l(),i("div",Zv,[e("div",Xv,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[49]||(o[49]=d=>t.need_rules=d),type:"checkbox",id:"need-rules"},null,512),[[k,t.need_rules]]),xv])])):r("",!0),t.need_rules?(l(),i("div",e$,[b(db,{bot:t.bot,"rules-form":t.pageForm},null,8,["bot","rules-form"])])):(l(),i("div",t$,[e("div",s$,[e("div",o$,[c(e("img",l$,null,512),[[n,"../images/icon.png"]])]),i$,n$,e("div",a$,[e("button",{disabled:t.need_rules,onClick:o[50]||(o[50]=d=>t.need_rules=!0),class:p([{"btn-primary":!t.need_rules,"btn-outline-secondary":t.need_rules},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,d$),r$])])]))],512),[[q,t.tab===10]]),c(e("div",null,[t.need_secure_page?(l(),i("div",c$,[e("div",u$,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[51]||(o[51]=d=>t.need_secure_page=d),type:"checkbox",id:"need-secure-page"},null,512),[[k,t.need_secure_page]]),m$])])):r("",!0),t.need_secure_page?(l(),i("div",h$,[e("div",_$,[e("div",p$,[c(e("input",{type:"text","onUpdate:modelValue":o[52]||(o[52]=d=>t.pageForm.password=d),class:"form-control",id:"floatingPassword",placeholder:"Пароль",required:""},null,512),[[_,t.pageForm.password]]),b$]),e("span",f$,[e("a",{href:"javascript:void(0)",onClick:o[53]||(o[53]=(...d)=>t.renewPassword&&t.renewPassword(...d))},y$)])]),e("div",v$,[c(e("textarea",{class:"form-control","onUpdate:modelValue":o[54]||(o[54]=d=>t.pageForm.password_description=d),placeholder:"Пояснение",id:"floatingTextarea2",style:{height:"200px"}},null,512),[[_,t.pageForm.password_description]]),e("label",$$,[m(" Пояснение для пользователя "),(t.pageForm.password_description||"").length>0?(l(),i("span",k$,u(t.pageForm.password_description.length)+"/512",1)):r("",!0)])])])):(l(),i("div",F$,[e("div",w$,[e("div",C$,[c(e("img",S$,null,512),[[n,"../images/icon.png"]])]),j$,V$,e("div",q$,[e("button",{disabled:t.need_secure_page,onClick:o[55]||(o[55]=d=>t.need_secure_page=!0),class:p([{"btn-primary":!t.need_secure_page,"btn-outline-secondary":t.need_secure_page},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,z$),P$])])]))],512),[[q,t.tab===11]]),c(e("div",null,[t.need_payed_page?(l(),i("div",U$,[e("div",A$,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[56]||(o[56]=d=>t.need_payed_page=d),type:"checkbox",id:"need-payed-page"},null,512),[[k,t.need_payed_page]]),O$])])):r("",!0),t.need_payed_page?(l(),i("div",I$,[t.bot.payment_provider_token==null?(l(),i("div",Q$,[m("Вы не добавили тоукен платежной системы в "),e("span",{onClick:o[57]||(o[57]=(...d)=>t.goToBotSettings&&t.goToBotSettings(...d)),class:"cursor-pointer text-primary fw-bold text-decoration-underline"},"настройках бота!")])):r("",!0),e("div",T$,[c(e("input",{type:"number",min:"100",disabled:t.bot.payment_provider_token==null,"onUpdate:modelValue":o[58]||(o[58]=d=>t.pageForm.price=d),class:"form-control",id:"page-price",placeholder:"Цена",required:""},null,8,B$),[[_,t.pageForm.price]]),M$]),e("div",R$,[c(e("textarea",{class:"form-control",disabled:t.bot.payment_provider_token==null,"onUpdate:modelValue":o[59]||(o[59]=d=>t.pageForm.price_description=d),placeholder:"Пояснение",id:"floatingTextarea2",style:{height:"200px"}},null,8,D$),[[_,t.pageForm.price_description]]),e("label",E$,[m(" Пояснение для пользователя "),(t.pageForm.price_description||"").length>0?(l(),i("span",L$,u(t.pageForm.price_description.length)+"/512",1)):r("",!0)])])])):(l(),i("div",K$,[e("div",N$,[e("div",J$,[c(e("img",H$,null,512),[[n,"../images/icon.png"]])]),G$,Y$,e("div",W$,[e("button",{disabled:t.need_payed_page,onClick:o[60]||(o[60]=d=>t.need_payed_page=!0),class:p([{"btn-primary":!t.need_payed_page,"btn-outline-secondary":t.need_payed_page},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,Z$),X$])])]))],512),[[q,t.tab===12]]),c(e("div",null,[e("div",x$,[e("div",e2,[e("div",t2,[c(e("img",s2,null,512),[[n,"../images/icon.png"]])]),o2,l2,t.need_cashback_page?(l(),i(g,{key:0},[e("div",i2,[e("div",n2,[e("div",a2,[c(e("input",{type:"number",min:"0","onUpdate:modelValue":o[61]||(o[61]=d=>t.pageForm.cashback=d),class:"form-control w-100",id:"page-price",placeholder:"Бонусы",required:""},null,512),[[_,t.pageForm.cashback]]),d2])])]),e("div",r2,[e("div",c2,[u2,e("div",m2,[e("button",{onClick:o[62]||(o[62]=d=>t.pageForm.cashback_config.need_request_user_data=!t.pageForm.cashback_config.need_request_user_data),class:p([{"btn-primary":t.pageForm.cashback_config.need_request_user_data,"btn-outline-primary":!t.pageForm.cashback_config.need_request_user_data},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill mr-2"]),type:"button"}," Да ",2),e("button",{onClick:o[63]||(o[63]=d=>t.pageForm.cashback_config.need_request_user_data=!t.pageForm.cashback_config.need_request_user_data),class:p([{"btn-primary":!t.pageForm.cashback_config.need_request_user_data,"btn-outline-primary":t.pageForm.cashback_config.need_request_user_data},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Нет ",2)])])]),t.pageForm.cashback_config.need_request_user_data?(l(),i("div",h2,[e("div",_2,[p2,b2,e("div",f2,[e("button",{onClick:o[64]||(o[64]=d=>t.pageForm.cashback_config.simple_form=!t.pageForm.cashback_config.simple_form),class:p([{"btn-primary":t.pageForm.cashback_config.simple_form,"btn-outline-primary":!t.pageForm.cashback_config.simple_form},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill mr-2"]),type:"button"}," Да ",2),e("button",{onClick:o[65]||(o[65]=d=>t.pageForm.cashback_config.simple_form=!t.pageForm.cashback_config.simple_form),class:p([{"btn-primary":!t.pageForm.cashback_config.simple_form,"btn-outline-primary":t.pageForm.cashback_config.simple_form},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Нет ",2)])]),e("div",g2,[e("div",y2,[c(e("textarea",{class:"form-control",maxlength:"255","onUpdate:modelValue":o[66]||(o[66]=d=>t.pageForm.cashback_config.description=d),placeholder:"Leave a comment here",id:"floatingTextarea2",style:{height:"100px"}},null,512),[[_,t.pageForm.cashback_config.description]]),e("label",v2,[m(" Пояснение для пользователя "),(t.pageForm.cashback_config.description||"").length>0?(l(),i("span",$2,u(t.pageForm.cashback_config.description.length)+" / 255",1)):r("",!0)])])])])):r("",!0)],64)):r("",!0),e("div",k2,[e("button",{onClick:o[67]||(o[67]=d=>t.need_cashback_page=!t.need_cashback_page),class:p([{"btn-primary":!t.need_cashback_page,"btn-danger":t.need_cashback_page},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"},[t.need_cashback_page?r("",!0):(l(),i("span",F2,"Добавить")),t.need_cashback_page?(l(),i("span",w2,"Убрать")):r("",!0)],2),C2])])])],512),[[q,t.tab===13]])],512),[[q,!t.pageForm.is_external]])],32)):r("",!0),S2,e("div",j2,[e("div",V2,[e("div",q2,[z2,e("div",P2,[b(Rb,{onCallback:t.callbackFastPageCreate},null,8,["onCallback"])]),U2])])]),e("div",A2,[e("div",O2,[e("div",I2,[Q2,e("div",T2,[t.bot?(l(),i("div",B2,[e("div",M2,[e("h6",R2,[e("span",null,[m("Вы создаете страницу для "),e("a",{href:"https://t.me/"+t.bot.bot_domain,target:"_blank"},u(t.bot.bot_domain),9,D2)])])])])):r("",!0),e("form",{onSubmit:o[76]||(o[76]=S((...d)=>t.submitPage&&t.submitPage(...d),["prevent"])),class:"row"},[e("div",E2,[L2,e("ul",K2,[e("li",{class:p({active:t.need_page_images})},J2,2),e("li",{class:p({active:t.need_page_sticker})},G2,2),e("li",{class:p({active:t.need_page_video})},W2,2),e("li",{class:p({active:t.need_page_audios})},X2,2),e("li",{class:p({active:t.need_page_documents})},ek,2),e("li",{class:p({active:t.need_attach_page})},sk,2),e("li",{class:p({active:t.need_attach_slug})},lk,2),e("li",{class:p({active:t.need_attach_dialog})},nk,2),e("li",{class:p({active:t.need_rules})},dk,2),e("li",{class:p({active:t.need_reply_menu})},ck,2),e("li",{class:p({active:t.need_inline_menu})},mk,2)])]),t.pageForm.id?(l(),i("div",hk,[e("div",_k,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[69]||(o[69]=d=>t.need_show_qr_and_link=d),type:"checkbox",id:"need-show-qr-and-link"},null,512),[[k,t.need_show_qr_and_link]]),pk])])):r("",!0),t.pageForm.id&&t.need_show_qr_and_link?(l(),i("div",bk,[e("p",fk,[m("Ссылка на текущую страницу: "),e("span",{style:{"word-wrap":"break-word"},class:"bg-secondary text-white font-bold cursor-pointer",onClick:o[70]||(o[70]=d=>t.copyToClipBoard(t.pageLink))},u(t.pageLink),1)]),gk,e("div",yk,[c(e("input",{type:"text",maxlength:"100","onUpdate:modelValue":o[71]||(o[71]=d=>t.utm_source=d),class:"form-control",id:"utm-source",placeholder:"name@example.com"},null,512),[[_,t.utm_source]]),vk]),e("div",$k,[c(e("img",kk,null,512),[[n,t.qr]])])])):r("",!0),e("div",Fk,[e("label",wk,[b(a,null,{content:y(()=>[Sk]),default:y(()=>[Ck]),_:1}),m(" Описание страницы "),jk]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Описание страницы","aria-label":"Описание страницы","onUpdate:modelValue":o[72]||(o[72]=d=>t.pageForm.comment=d),maxlength:"255","aria-describedby":"bot-domain",required:""},`
            `,512),[[_,t.pageForm.comment]])]),e("div",Vk,[e("div",qk,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[73]||(o[73]=d=>t.pageForm.is_external=d),type:"checkbox",id:"is-external"},null,512),[[k,t.pageForm.is_external]]),zk]),t.pageForm.is_external?(l(),i("div",Pk,[m(" Обработка ссылок передана на внешний адрес, указанный в настройках бота! Все запросы по данной кнопке будут отправлены на указанный URL-адрес: "),e("strong",null,u(t.bot.callback_link||"не указано")+".",1),t.bot.callback_link?r("",!0):(l(),i("p",Uk,[m("Внешня ссылка не установлена! Перейдите в раздел "),Ak,m(", затем "),Ok,m(" и установите ссылку для внешнего управления в поле "),Ik,m("!")]))])):r("",!0)]),e("div",Qk,[e("div",Tk,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[74]||(o[74]=d=>t.pageForm.need_log_user_action=d),type:"checkbox",id:"need_log_user_action"},null,512),[[k,t.pageForm.need_log_user_action]]),Bk])]),e("div",Mk,[e("div",Rk,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[75]||(o[75]=d=>t.need_stay_after_save=d),type:"checkbox",id:"need-stay-after-save"},null,512),[[k,t.need_stay_after_save]]),Dk])]),Ek],32)]),Lk])])]),e("div",Kk,[e("div",Nk,[e("div",Jk,[e("div",Hk,[b(W,{current:t.pageForm.id,selected:t.selectedLinkIds,onCallback:t.attachPage,editor:!1},null,8,["current","selected","onCallback"])])])])]),e("div",Gk,[Yk,e("div",Wk,[e("div",Zk,[e("div",Xk,[t.loaded_page_list?(l(),v(W,{key:0,editor:!0,current:t.page,onCallback:t.pageListCallback},null,8,["current","onCallback"])):r("",!0)])])])]),e("div",xk,[e0,e("div",t0,[t.page?(l(),v(Sb,{key:0,page:t.page},null,8,["page"])):(l(),i("p",s0,"Сперва сохраните страницу"))])])],64)}}}),i0={props:["bot","item"],data(){return{sectionForm:{section:null},categoryForm:{label:null},tab:0,types:[{title:"Готовый продукт",value:1},{title:"Товар на вес",value:2},{title:"Конструктор товара",value:3}],productCategories:[],sections:["Общие характеристики","Дополнительная информация"],photos:[],categories:[],removed_options:[],productForm:{article:null,vk_product_id:null,frontpad_article:null,iiko_article:null,title:null,description:null,images:[],type:1,old_price:null,current_price:null,variants:[],in_stop_list_at:null,bot_id:null,options:[],reviews:[],categories:[]}}},computed:{...C(["getProductCategories"]),filteredCategories(){return this.productCategories.length===0?this.categories:this.categories.filter(s=>this.productCategories.indexOf(s.value)===-1)}},mounted(){this.loadProductCategories(),this.item&&this.$nextTick(()=>{this.productForm={id:this.item.id||null,article:this.item.article||null,vk_product_id:this.item.vk_product_id||null,frontpad_article:this.item.frontpad_article||null,iiko_article:this.item.iiko_article||null,title:this.item.title||null,description:this.item.description||null,images:this.item.images||null,type:this.item.type||1,old_price:this.item.old_price||null,current_price:this.item.current_price||null,variants:this.item.variants||null,in_stop_list_at:this.item.in_stop_list_at||null,bot_id:this.item.bot_id||null,options:this.item.options||null,reviews:this.item.reviews||null},this.options=[],this.item.categories.forEach(s=>{this.productCategories.push(s.id)})})},methods:{prepareCategoryName(s){let t=this.categories.find(o=>o.value===s);return console.log(t),t?t.label:s},addCategory(){const s=this.categoryForm.label;this.productCategories.push(s),this.categoryForm.label=null},selectCategory(s){this.productCategories.push(s.value)},submit(){let s=new FormData;if(Object.keys(this.productForm).forEach(t=>{const o=this.productForm[t]||"";typeof o=="object"?s.append(t,JSON.stringify(o)):s.append(t,o)}),this.bot&&s.append("bot_id",this.bot.id),this.photos.length>0)for(let t=0;t<this.photos.length;t++)s.append("photos[]",this.photos[t]);this.removed_options.length>0&&s.append("removed_options",JSON.stringify(this.removed_options)),this.productCategories.length>0&&s.append("categories",JSON.stringify(this.productCategories)),this.$store.dispatch("saveProduct",{productForm:s}).then(t=>{this.load=!0,this.$notify({title:"Конструктор ботов",text:"Продукт успешно сохранен!",type:"success"}),this.clearForm(),this.$emit("refresh")}).catch(t=>{})},onChangePhotos(s){const t=s.target.files;for(let o=0;o<t.length;o++)this.photos.push(t[o])},loadProductCategories(){this.$store.dispatch("loadProductCategories",{dataObject:{bot_id:this.bot.id}}).then(()=>{this.getProductCategories.forEach(t=>{this.categories.push({value:t.id,label:t.title})})})},getPhoto(s){return{imageUrl:URL.createObjectURL(s)}},removeSection(s){this.sections.splice(s,1)},addSection(){this.sections.push(this.sectionForm.section),this.sectionForm.section=null},addOption(){this.productForm.options||(this.productForm.options=[]),this.productForm.options.push({id:null,key:null,value:null,title:null,section:null})},addVariant(){this.productForm.variants||(this.productForm.variants=[]),this.productForm.variants.push({key:null,value:null})},removeProductCategory(s){this.productCategories.splice(s,1)},removeVariant(s){this.productForm.variants.splice(s,1)},removeOption(s){this.productForm.options[s].id&&this.removed_options.push(this.productForm.options[s].id),this.productForm.options.splice(s,1)},removeImage(s){this.productForm.images.splice(s,1)},removePhoto(s){this.photos.splice(s,1)},clearForm(){const s={article:null,vk_product_id:null,title:null,description:null,images:[],type:1,old_price:null,current_price:null,variants:[],in_stop_list_at:null,bot_id:null,options:[],reviews:[],categories:[]};this.photos=[],this.removed_options=[],this.productCategories=[],this.productForm=s}}},n0={class:"nav nav-tabs"},a0={class:"nav-item"},d0={class:"nav-item"},r0={class:"nav-item"},c0={key:0},u0=e("div",{class:"col-12"},[e("button",{type:"submit",class:"btn btn-outline-primary"},[e("i",{class:"fa-regular fa-floppy-disk mr-2"}),m(" Сохранить товар ")])],-1),m0={class:"col-md-8 d-flex align-items-center"},h0={class:"form-check"},_0=e("label",{class:"form-check-label",for:"in-stop-list"}," Товар находится в стоп-листе ",-1),p0={class:"col-md-4 d-flex justify-content-end"},b0={class:"col-md-12 mb-3"},f0=["onClick"],g0={class:"dropdown"},y0=e("button",{type:"button",class:"btn btn-outline-info w-100","data-bs-toggle":"dropdown","data-bs-display":"static","aria-expanded":"false"},[e("p",{class:"mb-0"},"Выберите категорию")],-1),v0={class:"dropdown-menu w-100",style:{"overflow-y":"scroll",height:"300px"}},$0={class:"p-3"},k0=e("label",{for:"exampleDropdownFormEmail1",class:"form-label"},"Новая категория",-1),F0={class:"p-3"},w0=e("li",null,[e("hr",{class:"dropdown-divider"})],-1),C0=["onClick"],S0={class:"col-md-6"},j0={class:"form-floating mb-3"},V0=e("label",{for:"article"},"Артикул товара",-1),q0={class:"col-md-6"},z0={class:"form-floating mb-3"},P0=e("label",{for:"article"},"Артикул товара FrontPad",-1),U0={class:"col-md-6"},A0={class:"form-floating mb-3"},O0=e("label",{for:"article"},"Артикул товара в IIKO",-1),I0={class:"col-md-6"},Q0={class:"form-floating mb-3"},T0=e("label",{for:"vk-product-id"},"Идентификатор товара VK",-1),B0={class:"col-md-6"},M0={class:"form-floating mb-3"},R0=e("label",{for:"title"},"Названи товара",-1),D0={class:"col-md-6"},E0={class:"form-floating mb-3"},L0=["value"],K0=e("label",{for:"type"},"Тип товара",-1),N0={class:"col-md-12"},J0={class:"form-floating mb-3"},H0=e("label",{for:"description"},"Описание товара",-1),G0={class:"col-md-6"},Y0={class:"form-floating mb-3"},W0=e("label",{for:"current-price"},"Актуальная цена",-1),Z0={class:"col-md-6"},X0={class:"form-floating mb-3"},x0=e("label",{for:"old-price"},"Старая цена",-1),e3={class:"col-md-12 mb-3"},t3={class:"card"},s3={class:"card-header"},o3={key:0},l3={class:"card-body"},i3={class:"row"},n3={class:"col-12 mb-3"},a3={class:"col-md-6 mb-3"},d3={class:"card w-100"},r3={class:"card-body"},c3={class:"form-floating mb-3"},u3=["onUpdate:modelValue","id"],m3=["for"],h3={class:"form-floating mb-3"},_3=["onUpdate:modelValue","id"],p3=["for"],b3={class:"card-footer"},f3=["onClick"],g3=e("i",{class:"fa-solid fa-trash-can"},null,-1),y3=[g3],v3={class:"col-md-12 mb-3"},$3={class:"card"},k3=e("div",{class:"card-header"},[e("h6",null,"Характеристики товара")],-1),F3={class:"card-body"},w3={class:"row mb-3"},C3={class:"col-12"},S3=e("button",{class:"btn btn-outline-info",type:"submit",id:"button-addon2"},"Добавить секцию ",-1),j3={class:"badge bg-info mr-1"},V3=["onClick"],q3=e("i",{class:"fa-solid fa-xmark"},null,-1),z3=[q3],P3={class:"row"},U3={class:"col-md-4 mb-3"},A3={class:"card w-100"},O3={class:"card-body"},I3={class:"form-floating mb-3"},Q3=["onUpdate:modelValue","id"],T3=["for"],B3={class:"form-floating mb-3"},M3=["onUpdate:modelValue","id"],R3=["for"],D3={class:"form-floating mb-3"},E3=["onUpdate:modelValue","id"],L3=e("option",{value:null},"Без секции",-1),K3=["value"],N3=["for"],J3={class:"card-footer"},H3=["onClick"],G3=e("i",{class:"fa-solid fa-trash-can"},null,-1),Y3=[G3],W3={class:"row"},Z3={class:"col-12"},X3={class:"col-md-12 mb-3"},x3=e("h6",null,"Фотографии товара",-1),e5={class:"photo-preview d-flex justify-content-start flex-wrap w-100"},t5={for:"location-photos",style:{"margin-right":"10px"},class:"photo-loader ml-2"},s5=e("span",null,"+",-1),o5={class:"mb-2 img-preview",style:{"margin-right":"10px"}},l5={class:"remove"},i5=["onClick"],n5={class:"mb-2 img-preview",style:{"margin-right":"10px"}},a5={class:"remove"},d5=["onClick"],r5={key:1};function c5(s,t,o,a,n,d){const h=T("lazy");return l(),i(g,null,[e("ul",n0,[e("li",a0,[e("a",{class:p(["nav-link",{active:n.tab===0}]),onClick:t[0]||(t[0]=f=>n.tab=0),"aria-current":"page",href:"#product-form-info"},"Информация о товаре",2)]),e("li",d0,[e("a",{class:p(["nav-link",{active:n.tab===1}]),onClick:t[1]||(t[1]=f=>n.tab=1),href:"#product-reviews"},"Комментарии",2)]),e("li",r0,[e("a",{class:p(["nav-link",{active:n.tab===2}]),onClick:t[2]||(t[2]=f=>n.tab=2),href:"#product-reviews"},"Заказы",2)])]),n.tab===0?(l(),i("div",c0,[e("form",{onSubmit:t[21]||(t[21]=S((...f)=>d.submit&&d.submit(...f),["prevent"])),class:"row py-2"},[u0,e("div",m0,[e("div",h0,[c(e("input",{class:"form-check-input","onUpdate:modelValue":t[3]||(t[3]=f=>n.productForm.in_stop_list_at=f),type:"checkbox",value:"false",id:"in-stop-list"},null,512),[[k,n.productForm.in_stop_list_at]]),_0])]),e("div",p0,[e("a",{href:"#",class:"btn btn-link",onClick:t[4]||(t[4]=(...f)=>d.clearForm&&d.clearForm(...f))},"Новый товар")]),e("div",b0,[(l(!0),i(g,null,$(n.productCategories,(f,F)=>(l(),i("span",{class:"badge bg-info mr-1 mb-1 cursor-pointer",onClick:w=>d.removeProductCategory(F)},u(d.prepareCategoryName(f)),9,f0))),256)),e("div",g0,[y0,e("ul",v0,[e("div",$0,[k0,c(e("input",{type:"text",class:"form-control","onUpdate:modelValue":t[5]||(t[5]=f=>n.categoryForm.label=f),id:"exampleDropdownFormEmail1",placeholder:"Название категории"},null,512),[[_,n.categoryForm.label]])]),e("div",F0,[e("button",{class:"btn btn-primary w-100",type:"button",onClick:t[6]||(t[6]=(...f)=>d.addCategory&&d.addCategory(...f))},"Добавить категорию ")]),w0,(l(!0),i(g,null,$(d.filteredCategories,f=>(l(),i("li",null,[e("button",{class:"dropdown-item",type:"button",onClick:F=>d.selectCategory(f)},u(f.label),9,C0)]))),256))])])]),e("div",S0,[e("div",j0,[c(e("input",{type:"text","onUpdate:modelValue":t[7]||(t[7]=f=>n.productForm.article=f),class:"form-control",id:"article",placeholder:"name@example.com"},null,512),[[_,n.productForm.article]]),V0])]),e("div",q0,[e("div",z0,[c(e("input",{type:"text","onUpdate:modelValue":t[8]||(t[8]=f=>n.productForm.frontpad_article=f),class:"form-control",id:"article",placeholder:"name@example.com"},null,512),[[_,n.productForm.frontpad_article]]),P0])]),e("div",U0,[e("div",A0,[c(e("input",{type:"text","onUpdate:modelValue":t[9]||(t[9]=f=>n.productForm.iiko_article=f),class:"form-control",id:"article",placeholder:"name@example.com"},null,512),[[_,n.productForm.iiko_article]]),O0])]),e("div",I0,[e("div",Q0,[c(e("input",{type:"text","onUpdate:modelValue":t[10]||(t[10]=f=>n.productForm.vk_product_id=f),disabled:!0,class:"form-control",id:"vk-product-id",placeholder:"name@example.com"},null,512),[[_,n.productForm.vk_product_id]]),T0])]),e("div",B0,[e("div",M0,[c(e("input",{type:"text","onUpdate:modelValue":t[11]||(t[11]=f=>n.productForm.title=f),class:"form-control",id:"title",placeholder:"name@example.com"},null,512),[[_,n.productForm.title]]),R0])]),e("div",D0,[e("div",E0,[c(e("select",{class:"form-select","onUpdate:modelValue":t[12]||(t[12]=f=>n.productForm.type=f),id:"type","aria-label":"Floating label select example"},[(l(!0),i(g,null,$(n.types,(f,F)=>(l(),i("option",{value:f.value},u(f.title),9,L0))),256))],512),[[B,n.productForm.type]]),K0])]),e("div",N0,[e("div",J0,[c(e("textarea",{class:"form-control","onUpdate:modelValue":t[13]||(t[13]=f=>n.productForm.description=f),placeholder:"Leave a comment here",id:"description"},null,512),[[_,n.productForm.description]]),H0])]),e("div",G0,[e("div",Y0,[c(e("input",{type:"number","onUpdate:modelValue":t[14]||(t[14]=f=>n.productForm.current_price=f),class:"form-control",id:"current-price",placeholder:"name@example.com"},null,512),[[_,n.productForm.current_price]]),W0])]),e("div",Z0,[e("div",X0,[c(e("input",{type:"number","onUpdate:modelValue":t[15]||(t[15]=f=>n.productForm.old_price=f),class:"form-control",id:"old-price",placeholder:"name@example.com"},null,512),[[_,n.productForm.old_price]]),x0])]),e("div",e3,[e("div",t3,[e("div",s3,[e("h6",null,[m("Варианты товара "),n.productForm.variants?(l(),i("span",o3,"("+u(n.productForm.variants.length)+")",1)):r("",!0)])]),e("div",l3,[e("div",i3,[e("div",n3,[e("button",{type:"button",class:"btn btn-outline-info w-100",onClick:t[16]||(t[16]=(...f)=>d.addVariant&&d.addVariant(...f))},"Добавить вариант ")]),(l(!0),i(g,null,$(n.productForm.variants,(f,F)=>(l(),i("div",a3,[e("div",d3,[e("div",r3,[e("div",c3,[c(e("input",{type:"text","onUpdate:modelValue":w=>n.productForm.variants[F].key=w,class:"form-control",id:"variant-key-"+F,placeholder:"name@example.com",required:""},null,8,u3),[[_,n.productForm.variants[F].key]]),e("label",{for:"variant-key-"+F},"Ключ",8,m3)]),e("div",h3,[c(e("input",{type:"text","onUpdate:modelValue":w=>n.productForm.variants[F].value=w,class:"form-control",id:"variant-value-"+F,placeholder:"name@example.com",required:""},null,8,_3),[[_,n.productForm.variants[F].value]]),e("label",{for:"variant-value-"+F},"Значение",8,p3)])]),e("div",b3,[e("button",{type:"button",class:"btn btn-outline-danger",onClick:w=>d.removeVariant(F)},y3,8,f3)])])]))),256))])])])]),e("div",v3,[e("div",$3,[k3,e("div",F3,[e("div",w3,[e("div",C3,[e("form",{onSubmit:t[18]||(t[18]=S((...f)=>d.addSection&&d.addSection(...f),["prevent"])),class:"input-group mb-3"},[c(e("input",{type:"text","onUpdate:modelValue":t[17]||(t[17]=f=>n.sectionForm.section=f),class:"form-control border-info",placeholder:"Название секции","aria-label":"Recipient's username","aria-describedby":"button-addon2",required:""},null,512),[[_,n.sectionForm.section]]),S3],32),(l(!0),i(g,null,$(n.sections,(f,F)=>(l(),i("span",j3,[m(u(f)+" ",1),e("strong",{onClick:w=>d.removeSection(F)},z3,8,V3)]))),256))])]),e("div",P3,[(l(!0),i(g,null,$(n.productForm.options,(f,F)=>(l(),i("div",U3,[e("div",A3,[e("div",O3,[e("div",I3,[c(e("input",{type:"text","onUpdate:modelValue":w=>n.productForm.options[F].title=w,class:"form-control",id:"option-title-"+F,placeholder:"name@example.com"},null,8,Q3),[[_,n.productForm.options[F].title]]),e("label",{for:"option-title-"+F},"Название характеристики",8,T3)]),e("div",B3,[c(e("input",{type:"text","onUpdate:modelValue":w=>n.productForm.options[F].value=w,class:"form-control",id:"option-value-"+F,placeholder:"name@example.com"},null,8,M3),[[_,n.productForm.options[F].value]]),e("label",{for:"option-value-"+F},"Значение характеристики",8,R3)]),e("div",D3,[c(e("select",{class:"form-select","onUpdate:modelValue":w=>n.productForm.options[F].section=w,id:"option-section-"+F,"aria-label":"Floating label select example"},[L3,(l(!0),i(g,null,$(n.sections,w=>(l(),i("option",{value:w},u(w),9,K3))),256))],8,E3),[[B,n.productForm.options[F].section]]),e("label",{for:"option-section-"+F},"Секция товара",8,N3)])]),e("div",J3,[e("button",{type:"button",class:"btn btn-outline-danger",onClick:w=>d.removeOption(F)},Y3,8,H3)])])]))),256))]),e("div",W3,[e("div",Z3,[e("button",{type:"button",class:"btn btn-outline-info w-100",onClick:t[19]||(t[19]=(...f)=>d.addOption&&d.addOption(...f))},"Добавить характеристику ")])])])])]),e("div",X3,[x3,e("div",e5,[e("label",t5,[s5,e("input",{type:"file",id:"location-photos",multiple:"",accept:"image/*",onChange:t[20]||(t[20]=(...f)=>d.onChangePhotos&&d.onChangePhotos(...f)),style:{display:"none"}},null,32)]),n.productForm.images?(l(!0),i(g,{key:0},$(n.productForm.images,(f,F)=>(l(),i("div",o5,[c(e("img",null,null,512),[[h,f]]),e("div",l5,[e("a",{onClick:w=>d.removeImage(F)},"Удалить",8,i5)])]))),256)):r("",!0),n.photos.length>0?(l(!0),i(g,{key:1},$(n.photos,(f,F)=>(l(),i("div",n5,[c(e("img",null,null,512),[[h,d.getPhoto(f).imageUrl]]),e("div",a5,[e("a",{onClick:w=>d.removePhoto(F)},"Удалить",8,d5)])]))),256)):r("",!0)])])],32)])):r("",!0),n.tab===1?(l(),i("div",r5," Отзывы ")):r("",!0)],64)}const Ke=A(i0,[["render",c5]]);({...C(["getCurrentBot"])});const u5=e("button",{class:"btn btn-outline-info",type:"submit",id:"button-addon2"}," Найти ",-1),m5={key:0},h5={class:"row"},_5={class:"col-12"},p5={class:"table"},b5=e("thead",null,[e("tr",null,[e("th",{scope:"col"}),e("th",{scope:"col"},"#"),e("th",{scope:"col"},"Название"),e("th",{scope:"col"},"Картинка"),e("th",{scope:"col"},"Действия")])],-1),f5=["onClick"],g5=e("i",{class:"fa-solid fa-toggle-off cursor-pointer text-secondary"},null,-1),y5=[g5],v5=["onClick"],$5=e("i",{class:"fa-solid fa-toggle-on cursor-pointer text-primary"},null,-1),k5=[$5],F5={scope:"row"},w5=["onClick"],C5=["src"],S5={key:1},j5={class:"d-flex"},V5=e("i",{class:"fa-regular fa-copy"},null,-1),q5=[V5],z5=e("i",{class:"fa-solid fa-trash-can"},null,-1),P5=[z5],U5={key:0},A5={colspan:"5"},O5={props:["bot"],data(){return{search:null,products:[],paginate:null}},computed:{...C(["getProducts","getProductsPaginateObject"]),filteredProducts(){return this.search?this.products.filter(s=>s.title.toLowerCase().trim().indexOf(this.search.toLowerCase().trim())>=0):this.products}},mounted(){this.loadProducts()},methods:{refresh(){this.products.forEach(s=>{s.in_edit_mode=!1})},toggleEditProduct(s){console.log("product0",s),s.in_edit_mode=!s.in_edit_mode},selectProduct(s){this.$emit("select",s)},nextProducts(s){this.loadProducts(s)},preparedImgUrl(s){return s.toLocaleLowerCase().startsWith("https://")||s.toLocaleLowerCase().startsWith("http://")?s:"/images-by-bot-id/"+this.bot.id+"/"+s},removeProduct(s){this.$store.dispatch("removeProduct",s.id).then(t=>{this.$notify({title:"Конструктор ботов",text:"Продукт успешно удален!",type:"success"})}).catch(t=>{})},duplicateProduct(s){this.$store.dispatch("duplicateProduct",s.id).then(t=>{this.$notify({title:"Конструктор ботов",text:"Продукт успешно продублирован!",type:"success"})}).catch(t=>{})},loadProducts(s=0){return this.$store.dispatch("loadProducts",{dataObject:{bot_id:this.bot.id,search:this.search},page:s}).then(()=>{this.products=this.getProducts,this.paginate=this.getProductsPaginateObject})}}},I5=Object.assign(O5,{__name:"ProductTableList",setup(s){return(t,o)=>(l(),i(g,null,[e("form",{class:"input-group mb-3",onSubmit:o[1]||(o[1]=S(a=>t.loadProducts(0),["prevent"]))},[c(e("input",{type:"text",class:"form-control border-info",placeholder:"Поиск товара","aria-label":"Поиск товара","onUpdate:modelValue":o[0]||(o[0]=a=>t.search=a),"aria-describedby":"button-addon2",required:""},null,512),[[_,t.search]]),u5],32),e("p",null,[m("Всего товаров: "),t.paginate?(l(),i("span",m5,u(t.paginate.meta.total||0),1)):r("",!0)]),e("div",h5,[e("div",_5,[e("table",p5,[b5,e("tbody",null,[(l(!0),i(g,null,$(t.filteredProducts,(a,n)=>(l(),i(g,null,[e("tr",null,[e("td",null,[a.in_edit_mode?(l(),i("span",{key:1,onClick:d=>t.toggleEditProduct(a)},k5,8,v5)):(l(),i("span",{key:0,onClick:d=>t.toggleEditProduct(a)},y5,8,f5))]),e("th",F5,u(a.id),1),e("td",null,[e("a",{href:"javascript:void(0)",onClick:d=>t.selectProduct(a)},u(a.title),9,w5)]),e("td",null,[(a.images||[]).length>0?(l(),i("img",{key:0,src:t.preparedImgUrl(a.images[0]),style:{width:"100px",height:"100px","object-fit":"cover"},class:"d-block",alt:"..."},null,8,C5)):(l(),i("p",S5,"Не добавлено"))]),e("td",null,[e("div",j5,[e("button",{title:"Дублировать товар",onClick:o[2]||(o[2]=(...d)=>t.duplicateProduct&&t.duplicateProduct(...d)),class:"btn btn-outline-info mr-1"},q5),e("button",{title:"Удалить товар",onClick:o[3]||(o[3]=(...d)=>t.removeProduct&&t.removeProduct(...d)),class:"btn btn-outline-danger"},P5)])])]),a.in_edit_mode?(l(),i("tr",U5,[e("td",A5,[b(Ke,{bot:s.bot,item:a,onRefresh:t.refresh},null,8,["bot","item","onRefresh"])])])):r("",!0)],64))),256))])])])]),t.paginate?(l(),v(V,{key:0,onPagination_page:t.nextProducts,pagination:t.paginate},null,8,["onPagination_page","pagination"])):r("",!0)],64))}}),Q5=e("button",{class:"btn btn-outline-info",type:"submit",id:"button-addon2"}," Найти ",-1),T5={key:0},B5={class:"row"},M5={class:"col-12"},R5={class:"table"},D5=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"#"),e("th",{scope:"col"},"Название"),e("th",{scope:"col"},"Состояние"),e("th",{scope:"col"},"Позиция в выдаче"),e("th",{scope:"col"},"Действия")])],-1),E5={scope:"row"},L5=["onClick"],K5=["onClick"],N5={key:0},J5={key:1},H5=["onChange","onUpdate:modelValue"],G5=["onClick"],Y5=e("i",{class:"fa-solid fa-trash-can"},null,-1),W5=[Y5],Z5={props:["bot"],data(){return{search:null,categories:[],paginate:null}},computed:{...C(["getProductCategories","getProductCategoriesPaginateObject"]),filteredProductCategories(){return this.search?this.categories.filter(s=>s.title.toLowerCase().trim().indexOf(this.search.toLowerCase().trim())>=0):this.categories}},mounted(){this.loadProductCategories()},methods:{updateCategory(s){console.log("update",s),this.$store.dispatch("storeProductCategory",{category:s,bot_id:this.bot.id}).then(t=>{this.$notify({title:"Конструктор ботов",text:"Данные сохранены!",type:"success"})}).catch(t=>{this.$notify({title:"Конструктор ботов",text:"Ошибка сохранения данных!",type:"error"})})},changeCategoryStatus(s){let t=this.categories.findIndex(o=>s.id===o.id);t!==-1&&(this.categories[t].is_active=!this.categories[t].is_active,this.$store.dispatch("changeProductCategoryStatus",s.id).then(o=>{this.$notify({title:"Конструктор ботов",text:"Статус категории успешно изменен!",type:"success"})}).catch(o=>{}))},selectProductCategory(s){this.$emit("select",s)},nextProductCategories(s){this.loadProductCategories(s)},removeProductCategory(s){this.$store.dispatch("removeProductCategory",s.id).then(t=>{this.$notify({title:"Конструктор ботов",text:"Продукт успешно удален!",type:"success"})}).catch(t=>{})},loadProductCategories(s=0){return this.$store.dispatch("loadProductCategories",{dataObject:{bot_id:this.bot.id,search:this.search},page:s}).then(()=>{this.categories=this.getProductCategories,this.paginate=this.getProductCategoriesPaginateObject})}}},X5=Object.assign(Z5,{__name:"ProductCategoryTableList",setup(s){return(t,o)=>(l(),i(g,null,[e("form",{class:"input-group mb-3",onSubmit:o[1]||(o[1]=S(a=>t.loadProductCategories(0),["prevent"]))},[c(e("input",{type:"text",class:"form-control border-info",placeholder:"Поиск категории товара","aria-label":"Поиск категории товара","onUpdate:modelValue":o[0]||(o[0]=a=>t.search=a),"aria-describedby":"button-addon2",required:""},null,512),[[_,t.search]]),Q5],32),e("p",null,[m("Всего категорий: "),t.paginate?(l(),i("span",T5,u(t.paginate.meta.total||0),1)):r("",!0)]),e("div",B5,[e("div",M5,[e("table",R5,[D5,e("tbody",null,[(l(!0),i(g,null,$(t.filteredProductCategories,(a,n)=>(l(),i("tr",null,[e("th",E5,u(a.id),1),e("td",null,[e("a",{href:"javascript:void(0)",onClick:d=>t.selectProductCategory(a),"data-bs-toggle":"modal","data-bs-target":"#product-form-edit"},null,8,L5),m(u(a.title),1)]),e("td",null,[e("button",{type:"button",onClick:d=>t.changeCategoryStatus(a),class:"btn btn-outline-success"},[a.is_active?(l(),i("span",N5,"Активная")):(l(),i("span",J5,"Не активная"))],8,K5)]),e("td",null,[c(e("input",{type:"number",onChange:d=>t.updateCategory(a),"onUpdate:modelValue":d=>a.order_position=d,class:"form-control"},null,40,H5),[[_,a.order_position]])]),e("td",null,[e("button",{title:"Удалить товар",onClick:d=>t.removeProductCategory(a),class:"btn btn-outline-danger"},W5,8,G5)])]))),256))])])])]),t.paginate?(l(),v(V,{key:0,onPagination_page:t.nextProductCategories,pagination:t.paginate},null,8,["onPagination_page","pagination"])):r("",!0)],64))}}),x5={class:"nav nav-tabs my-3"},eF={class:"nav-item"},tF={class:"nav-item"},sF={class:"nav-item"},oF={class:"nav-item"},lF={key:0},iF={class:"card mb-2"},nF=e("div",{class:"card-header"},[e("h6",null,"Управление магазином")],-1),aF={class:"card-body"},dF={class:"row"},rF={class:"col-12"},cF={class:"form-label d-flex justify-content-between mt-2",id:"bot-level-3"},uF=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),mF=e("div",null,"Ссылка на страницу ВК с товарами для вашего магазина в боте ",-1),hF=e("a",{href:"https://vk.com/groups?w=groups_create",target:"_blank"},"Создать",-1),_F=["disabled"],pF=e("i",{class:"fa-regular fa-floppy-disk mr-2"},null,-1),bF={class:"row mb-3"},fF={class:"col-md-3"},gF=["href"],yF=H('<div class="col-md-3"><button class="btn btn-outline-info w-100">Экспорт в XLS</button></div><div class="col-md-3"><button class="btn btn-outline-info w-100">Импорт из XLS</button></div><div class="col-md-3"><button class="btn btn-outline-danger w-100">Удалить товары</button></div>',3),vF=e("div",{class:"row"},[e("div",{class:"col-md-3"},[e("button",{class:"btn btn-outline-info w-100"},"Экспортировать заказы")])],-1),$F={key:1},kF={class:"modal fade",id:"product-form-edit",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},FF={class:"modal-dialog"},wF={class:"modal-content"},CF=e("div",{class:"modal-header"},[e("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"Modal title"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),SF={class:"modal-body"},jF=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close"),e("button",{type:"button",class:"btn btn-primary"},"Save changes")],-1),VF={key:2},qF={key:3},zF={data(){return{load:!1,tab:0,url:null,link:null,bot:null,selectedProduct:null,selectedCategory:null,botForm:{vk_shop_link:null}}},computed:{...C(["getCurrentBot"])},mounted(){this.bot=this.getCurrentBot,this.botForm.vk_shop_link=this.bot.vk_shop_link||null,this.updateProducts()},methods:{updateShopLink(){this.load=!0,this.botForm.bot_id=this.bot.id,this.$store.dispatch("updateShopLink",{botForm:this.botForm}).then(s=>{this.load=!1,this.updateProducts(),this.$notify({title:"Менеджер магазина",text:"Ссылка на источник в ВК обновлена"})}).catch(()=>{this.load=!1})},refresh(){this.load=!0,this.selectedProduct=null,this.$nextTick(()=>{this.load=!1})},selectProduct(s){this.load=!0,this.$nextTick(()=>{this.selectedProduct=s,this.load=!1})},selectProductCategory(s){this.load=!0,this.$nextTick(()=>{this.selectedCategory=s,this.load=!1})},updateProducts(){this.load=!0,this.$store.dispatch("updateProductsFromVk",{dataObject:{bot_domain:this.getCurrentBot.bot_domain}}).then(s=>{this.link=s.data.url,this.load=!1,this.url=null}).catch(()=>{this.load=!1})}}},PF=Object.assign(zF,{__name:"Shop",setup(s){return(t,o)=>{const a=P("Popper");return l(),i(g,null,[e("ul",x5,[e("li",eF,[e("a",{class:p(["nav-link",{active:t.tab===0}]),onClick:o[0]||(o[0]=n=>t.tab=0),"aria-current":"page",href:"#"},"Товары",2)]),e("li",tF,[e("a",{class:p(["nav-link",{active:t.tab===3}]),onClick:o[1]||(o[1]=n=>t.tab=3),href:"#"},"Категории товаров",2)]),e("li",sF,[e("a",{class:p(["nav-link",{active:t.tab===1}]),onClick:o[2]||(o[2]=n=>t.tab=1),href:"#"},"Настройка&Обновление",2)]),e("li",oF,[e("a",{class:p(["nav-link",{active:t.tab===2}]),onClick:o[3]||(o[3]=n=>t.tab=2),href:"#"},"Заказы",2)])]),t.tab===1?(l(),i("div",lF,[e("div",iF,[nF,e("div",aF,[e("div",dF,[e("div",rF,[e("form",{onSubmit:o[5]||(o[5]=S((...n)=>t.updateShopLink&&t.updateShopLink(...n),["prevent"])),class:"mb-2"},[e("label",cF,[e("div",null,[b(a,null,{content:y(()=>[mF]),default:y(()=>[uF]),_:1}),m(" ВК-группа ")]),hF]),c(e("input",{type:"url",class:"form-control",placeholder:"Ссылка на группу ВК","aria-label":"ссылка на группу ВК","onUpdate:modelValue":o[4]||(o[4]=n=>t.botForm.vk_shop_link=n),"aria-describedby":"vk_shop_link"},null,512),[[_,t.botForm.vk_shop_link]]),e("button",{disabled:t.load,class:"btn btn-outline-primary mt-2 mb-2 w-100"},[pF,m(" Сохранить ")],8,_F)],32)])]),e("div",bF,[e("div",fF,[e("a",{target:"_blank",href:t.link,class:"btn btn-primary w-100"}," Обновить товар ",8,gF)]),yF]),vF])])])):r("",!0),t.tab===0?(l(),i("div",$F,[t.bot&&!t.load?(l(),v(I5,{key:0,bot:t.bot,onSelect:t.selectProduct},null,8,["bot","onSelect"])):r("",!0),e("div",kF,[e("div",FF,[e("div",wF,[CF,e("div",SF,[t.bot&&!t.load?(l(),v(Ke,{key:0,bot:t.bot,item:t.selectedProduct,onRefresh:t.refresh},null,8,["bot","item","onRefresh"])):r("",!0)]),jF])])])])):r("",!0),t.tab===2?(l(),i("div",VF)):r("",!0),t.tab===3?(l(),i("div",qF,[t.bot&&!t.load?(l(),v(X5,{key:0,bot:t.bot,onSelect:t.selectProductCategory},null,8,["bot","onSelect"])):r("",!0)])):r("",!0)],64)}}}),UF={props:["data"],data(){return{hasConnect:!1,bot:null,amoForm:{client_id:null,client_secret:null,auth_code:null,redirect_uri:null,subdomain:null,bot_id:null}}},computed:{...C(["getCurrentBot"])},mounted(){this.bot=this.getCurrentBot,this.data?this.$nextTick(()=>{this.amoForm.client_id=this.data.client_id||null,this.amoForm.client_secret=this.data.client_secret||null,this.amoForm.auth_code=this.data.auth_code||null,this.amoForm.redirect_uri=this.data.redirect_uri||null,this.amoForm.subdomain=this.data.subdomain||null,this.amoForm.bot_id=this.data.bot_id||this.bot.id||null}):this.amoForm.bot_id=this.bot.id||null},methods:{submitAmo(){let s=new FormData;Object.keys(this.amoForm).forEach(t=>{const o=this.amoForm[t]||"";typeof o=="object"?s.append(t,JSON.stringify(o)):s.append(t,o)}),this.$store.dispatch("saveAmoCRM",{amoForm:s}).then(t=>{this.$notify("Данные CRM успешно сохранены")}).catch(t=>{})}}},AF=e("div",{class:"col-12"},[e("p",null,[e("a",{target:"_blank",href:"https://www.amocrm.ru/developers/content/oauth/step-by-step"},"Документация для разработчика "),m(" по шагам")])],-1),OF={class:"col-md-6 col-12 mb-2"},IF={class:"form-label",id:"client_id"},QF=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),TF=e("div",null,"ID интеграции",-1),BF=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),MF={class:"col-md-6 col-12 mb-2"},RF={class:"form-label",id:"client_secret"},DF=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),EF=e("div",null,"Секрет интеграции",-1),LF=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),KF={class:"col-md-6 mb-2"},NF={class:"form-label",id:"auth_code"},JF=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),HF=e("div",null,"Полученный код авторизации",-1),GF=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),YF={class:"col-md-6 col-12 mb-2"},WF={class:"form-label",id:"subdomain2"},ZF=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),XF=e("div",null,"Ваш поддомен в системе AMO CRM",-1),xF=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),ew=e("div",{class:"col-md-12 col-12"},[e("button",{type:"submit",class:"btn btn-outline-primary p-3 w-100"},[e("i",{class:"fa-solid fa-cloud-arrow-down mr-1"}),m(" Сохранить настройку AMO ")])],-1);function tw(s,t,o,a,n,d){const h=P("Popper");return l(),i("form",{onSubmit:t[4]||(t[4]=S((...f)=>d.submitAmo&&d.submitAmo(...f),["prevent"])),class:"row"},[AF,e("div",OF,[e("label",IF,[b(h,null,{content:y(()=>[TF]),default:y(()=>[QF]),_:1}),m(" client_id "),BF]),c(e("input",{type:"text",class:"form-control",placeholder:"client_id","aria-label":"client_id","onUpdate:modelValue":t[0]||(t[0]=f=>n.amoForm.client_id=f),"aria-describedby":"client_id"},null,512),[[_,n.amoForm.client_id]])]),e("div",MF,[e("label",RF,[b(h,null,{content:y(()=>[EF]),default:y(()=>[DF]),_:1}),m(" client_secret "),LF]),c(e("input",{type:"text",class:"form-control",placeholder:"client_secret","aria-label":"client_secret","onUpdate:modelValue":t[1]||(t[1]=f=>n.amoForm.client_secret=f),"aria-describedby":"client_secret"},null,512),[[_,n.amoForm.client_secret]])]),e("div",KF,[e("label",NF,[b(h,null,{content:y(()=>[HF]),default:y(()=>[JF]),_:1}),m(" auth_code "),GF]),c(e("textarea",{class:"form-control",placeholder:"auth_code","aria-label":"auth_code","onUpdate:modelValue":t[2]||(t[2]=f=>n.amoForm.auth_code=f),"aria-describedby":"auth_code"},`
                                    `,512),[[_,n.amoForm.auth_code]])]),e("div",YF,[e("label",WF,[b(h,null,{content:y(()=>[XF]),default:y(()=>[ZF]),_:1}),m(" subdomain "),xF]),c(e("input",{type:"text",class:"form-control",placeholder:"subdomain","aria-label":"subdomain","onUpdate:modelValue":t[3]||(t[3]=f=>n.amoForm.subdomain=f),"aria-describedby":"subdomain"},null,512),[[_,n.amoForm.subdomain]])]),ew],32)}const sw=A(UF,[["render",tw]]),ow={props:["data"],data(){return{load:!1,bot:null,yClientsForm:{login:null,password:null,partner_token:null,company:null}}},computed:{...C(["getCurrentBot"])},mounted(){this.bot=this.getCurrentBot,this.data&&this.$nextTick(()=>{this.yClientsForm.login=this.data.login||null,this.yClientsForm.password=this.data.password||null,this.yClientsForm.partner_token=this.data.partner_token||null,this.yClientsForm.company=this.data.company||null})},methods:{submitYClients(){let s=new FormData;Object.keys(this.yClientsForm).forEach(t=>{const o=this.yClientsForm[t]||"";typeof o=="object"?s.append(t,JSON.stringify(o)):s.append(t,o)}),s.append("bot_id",this.bot.id),this.$store.dispatch("saveYClients",{yClientsForm:s}).then(t=>{this.$notify({title:"Работа с YClients",text:"Данные YClients успешно сохранены",type:"success"})}).catch(t=>{this.$notify({title:"Работа с YClients",text:"Ошибка сохранения данных",type:"error"})})}}},lw=e("h6",null,"Настройка YClients",-1),iw={class:"row"},nw={class:"col-md-12"},aw={class:"mb-2"},dw=e("label",{class:"form-label d-flex justify-content-between mt-2",for:"login"},[m(" Логин "),e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно")],-1),rw={class:"mb-2"},cw=e("label",{class:"form-label d-flex justify-content-between mt-2",for:"password"},[m(" Пароль "),e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно")],-1),uw={class:"mb-2"},mw=e("label",{class:"form-label d-flex justify-content-between mt-2",for:"partner_token"},[m(" Партнерский тоукен "),e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно")],-1),hw={class:"mb-2"},_w=e("label",{class:"form-label d-flex justify-content-between mt-2",for:"partner_token"},[m(" ID компании, в которую записывать клиентов "),e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно")],-1),pw=e("button",{class:"btn btn-success w-100 r mb-3 text-uppercase font-900"}," Сохранить ",-1);function bw(s,t,o,a,n,d){return l(),i(g,null,[lw,e("form",{onSubmit:t[4]||(t[4]=S((...h)=>d.submitYClients&&d.submitYClients(...h),["prevent"]))},[e("div",iw,[e("div",nw,[e("div",aw,[dw,c(e("input",{type:"text",id:"login",class:"form-control",placeholder:"Ваш логин","aria-label":"Ваш логин","onUpdate:modelValue":t[0]||(t[0]=h=>n.yClientsForm.login=h),"aria-describedby":"Ваш логин",required:""},null,512),[[_,n.yClientsForm.login]])]),e("div",rw,[cw,c(e("input",{type:"text",id:"password",class:"form-control",placeholder:"Ваш пароль","aria-label":"Ваш пароль","onUpdate:modelValue":t[1]||(t[1]=h=>n.yClientsForm.password=h),"aria-describedby":"Ваш пароль",required:""},null,512),[[_,n.yClientsForm.password]])]),e("div",uw,[mw,c(e("input",{type:"text",id:"partner_token",class:"form-control",placeholder:"Ваш партнерский тоукен","aria-label":"Ваш партнерский тоукен","onUpdate:modelValue":t[2]||(t[2]=h=>n.yClientsForm.partner_token=h),"aria-describedby":"Ваш партнерский тоукен",required:""},null,512),[[_,n.yClientsForm.partner_token]])]),e("div",hw,[_w,c(e("input",{type:"number",id:"throttle",class:"form-control",placeholder:"ID компании","aria-label":"ID компании","onUpdate:modelValue":t[3]||(t[3]=h=>n.yClientsForm.company=h),"aria-describedby":"ID компании",required:""},null,512),[[_,n.yClientsForm.company]])])])]),pw],32)],64)}const fw=A(ow,[["render",bw]]),gw={class:"py-2"},yw={class:"nav nav-tabs"},vw={class:"nav-item"},$w={class:"nav-item"},kw={key:0,class:"row"},Fw={class:"col-12 py-2"},ww={key:1,class:"row"},Cw={class:"col-12 py-2"},Sw={class:"col-12"},jw={props:["bot"],data(){return{tab:1,load:!1,loadMailingTable:!1}},mounted(){},methods:{callbackPersonalMail(){this.loadMailingTable=!0,this.$nextTick(()=>{this.loadMailingTable=!1})}}},Vw=Object.assign(jw,{__name:"Mail",setup(s){return(t,o)=>(l(),i("div",gw,[e("ul",yw,[e("li",vw,[e("a",{class:p(["nav-link",{active:t.tab===0}]),onClick:o[0]||(o[0]=a=>t.tab=0),"aria-current":"page",href:"#"},"Рассылка в канал",2)]),e("li",$w,[e("a",{class:p(["nav-link",{active:t.tab===1}]),onClick:o[1]||(o[1]=a=>t.tab=1),href:"#"},"Рассылка в бота",2)])]),t.tab===0?(l(),i("div",kw,[e("div",Fw,[b(Ye)])])):r("",!0),t.tab===1?(l(),i("div",ww,[e("div",Cw,[b(We,{onCallback:t.callbackPersonalMail},null,8,["onCallback"])]),e("div",Sw,[t.loadMailingTable?r("",!0):(l(),v(Ze,{key:0,bot:s.bot},null,8,["bot"]))])])):r("",!0)]))}}),qw={data(){return{load:!1,bot:null,fieldTypes:[{title:"Текст",value:0},{title:"Число",value:1},{title:"Логический",value:2},{title:"Дата и время",value:3}],fieldForm:{fields:[]}}},computed:{...C(["getCurrentBot"])},mounted(){this.loadCurrentBot().then(()=>{this.bot=this.getCurrentBot,this.$nextTick(()=>{this.fieldForm.fields=this.bot.field_settings||[]}),this.loadCurrentBotFields()})},methods:{loadCurrentBotFields(){return this.$store.dispatch("loadCurrentBotFields",{bot_id:this.bot.id}).then(s=>{this.fieldForm.fields=s.data||[]})},loadCurrentBot(s=null){return this.$store.dispatch("updateCurrentBot",{bot:s}).then(()=>{this.bot=this.getCurrentBot})},removeField(s){this.fieldForm.fields.splice(s,1)},submit(){let s=new FormData;Object.keys(this.fieldForm).forEach(t=>{const o=this.fieldForm[t]||"";typeof o=="object"?s.append(t,JSON.stringify(o)):s.append(t,o)}),s.append("bot_id",this.bot.id),this.$store.dispatch("storeBotFields",{dataObject:s}).then(t=>{this.$notify({title:"Конструктор ботов",text:"Поля успешно обновлены",type:"success"}),this.fieldForm.fields=[],this.fieldForm.fields=t.data}).catch(t=>{this.$notify({title:"Конструктор ботов",text:"Ошибка обновления полей",type:"error"})})},addField(){if(this.fieldForm.fields||(this.fieldForm.fields=[]),this.fieldForm.fields.length>0&&this.fieldForm.fields.findIndex(t=>t.key==null)!==-1){this.$notify({title:"Настраиваемые поля",text:"У вас есть пустые ключевые поля!",type:"error"});return}this.fieldForm.fields.push({key:null,type:0,label:null,description:null,required:!1,validate_pattern:null})}}},zw={class:"mb-2"},Pw={class:"d-flex justify-content-between"},Uw=e("h6",null,"Настройка полей пользователя бота",-1),Aw=e("i",{class:"fa-solid fa-plus mr-2"},null,-1),Ow=e("p",null,[e("em",null,"Данные поля будут добавлены пользователю бота и будут автоматически учитываться в условиях страниц, скриптах (в формах заполнения данных), диалогах. Ключи должны быть уникальные для каждого бота. Если ключ дублируется, то будет использовано более позднее его значение. Если поле добавлено и сохранено, то удалить его уже нельзя, только скрыть. "),m(". "),e("br"),e("span",{class:"text-danger"},"*"),m(" - обязательное поле ")],-1),Iw={class:"table"},Qw=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"#"),e("th",{scope:"col"},[m("Ключ"),e("span",{class:"text-danger"},"*")]),e("th",{scope:"col"},[m("Подпись поля"),e("span",{class:"text-danger"},"*")]),e("th",{scope:"col"},[m("Тип поля"),e("span",{class:"text-danger"},"*")]),e("th",{scope:"col"},"Паттерн"),e("th",{scope:"col"},"Обязательный"),e("th",{scope:"col"},[m("Вопрос для анкеты"),e("span",{class:"text-danger"},"*")]),e("th",{scope:"col"})])],-1),Tw={scope:"row"},Bw={scope:"col"},Mw=["onUpdate:modelValue"],Rw={scope:"col"},Dw=["onUpdate:modelValue"],Ew={scope:"col"},Lw=["onUpdate:modelValue"],Kw=["value"],Nw={scope:"col"},Jw=["disabled","onUpdate:modelValue"],Hw={scope:"col"},Gw={class:"form-check"},Yw=["onUpdate:modelValue","id"],Ww=["for"],Zw={key:0},Xw={key:1},xw={scope:"col"},eC=["onUpdate:modelValue"],tC={scope:"col"},sC=["onClick"],oC=e("i",{class:"fa-regular fa-trash-can"},null,-1),lC=[oC],iC={key:1,class:"form-check mt-2"},nC=["onUpdate:modelValue","id"],aC=["for"],dC={key:0},rC=e("i",{class:"fa-solid fa-eye text-success"},null,-1),cC=[rC],uC={key:1},mC=e("i",{class:"fa-solid fa-eye-slash text-danger"},null,-1),hC=[mC],_C=e("button",{type:"submit",class:"btn btn-success w-100 p-3"}," Сохранить поля ",-1);function pC(s,t,o,a,n,d){return l(),i("div",zw,[e("div",Pw,[Uw,e("button",{type:"button",onClick:t[0]||(t[0]=h=>d.addField()),class:"btn mb-2 rounded-sm btn-outline-info"},[Aw,m(" Добавить параметр ")])]),Ow,e("form",{onSubmit:t[1]||(t[1]=S((...h)=>d.submit&&d.submit(...h),["prevent"]))},[e("table",Iw,[Qw,e("tbody",null,[(l(!0),i(g,null,$(n.fieldForm.fields,(h,f)=>(l(),i("tr",null,[e("th",Tw,u(f+1),1),e("th",Bw,[c(e("input",{type:"text",class:"form-control mb-2 w-100",placeholder:"Ключ","aria-label":"Ключ",maxlength:"255","onUpdate:modelValue":F=>n.fieldForm.fields[f].key=F,required:""},null,8,Mw),[[_,n.fieldForm.fields[f].key]])]),e("th",Rw,[c(e("input",{type:"text",class:"form-control mb-2 w-100",placeholder:"Подпись поля","aria-label":"Название поля",maxlength:"255","onUpdate:modelValue":F=>n.fieldForm.fields[f].label=F,required:""},null,8,Dw),[[_,n.fieldForm.fields[f].label]])]),e("th",Ew,[c(e("select",{class:"form-select","onUpdate:modelValue":F=>n.fieldForm.fields[f].type=F},[(l(!0),i(g,null,$(n.fieldTypes,F=>(l(),i("option",{value:F.value},u(F.title||"Не указан"),9,Kw))),256))],8,Lw),[[B,n.fieldForm.fields[f].type]])]),e("th",Nw,[c(e("input",{type:"text",class:"form-control mb-2 w-100",placeholder:"Паттерн","aria-label":"Паттерн",maxlength:"255",disabled:n.fieldForm.fields[f].type===2,"onUpdate:modelValue":F=>n.fieldForm.fields[f].validate_pattern=F},null,8,Jw),[[_,n.fieldForm.fields[f].validate_pattern]])]),e("th",Hw,[e("div",Gw,[c(e("input",{class:"form-check-input","onUpdate:modelValue":F=>n.fieldForm.fields[f].required=F,type:"checkbox",value:"",id:"field-required"+f},null,8,Yw),[[k,n.fieldForm.fields[f].required]]),e("label",{class:"form-check-label",for:"field-required"+f},[n.fieldForm.fields[f].required?(l(),i("span",Zw,"Да")):r("",!0),n.fieldForm.fields[f].required?r("",!0):(l(),i("span",Xw,"Нет"))],8,Ww)])]),e("th",xw,[c(e("input",{type:"text",class:"form-control mb-2 w-100",placeholder:"Описание вопроса","aria-label":"Описание вопроса",maxlength:"255","onUpdate:modelValue":F=>n.fieldForm.fields[f].description=F,required:""},null,8,eC),[[_,n.fieldForm.fields[f].description]])]),e("th",tC,[n.fieldForm.fields[f].id?(l(),i("div",iC,[c(e("input",{class:"form-check-input d-none","onUpdate:modelValue":F=>n.fieldForm.fields[f].is_active=F,type:"checkbox",value:"",id:"field-is_active-"+f},null,8,nC),[[k,n.fieldForm.fields[f].is_active]]),e("label",{class:"form-check-label",for:"field-is_active-"+f},[n.fieldForm.fields[f].is_active?(l(),i("span",dC,cC)):r("",!0),n.fieldForm.fields[f].is_active?r("",!0):(l(),i("span",uC,hC))],8,aC)])):(l(),i("button",{key:0,type:"button",onClick:F=>d.removeField(f),class:"btn btn-link text-danger"},lC,8,sC))])]))),256))])]),_C],32)])}const bC=A(qw,[["render",pC]]),fC={class:"row"},gC={class:"input-group mb-3"},yC={key:0,class:"row"},vC={class:"col-12 col-md-12 mb-3"},$C={class:"table"},kC=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"#"),e("th",{scope:"col"},"Тип"),e("th",{scope:"col"},"Подпись"),e("th",{scope:"col"},"File Id"),e("th",{scope:"col"},"Действия")])],-1),FC={scope:"row"},wC={class:"badge bg-info rounded-pill"},CC={style:{"word-break":"break-all"}},SC={style:{"word-break":"break-all"}},jC={style:{"min-width":"200px"}},VC=["onClick"],qC=e("i",{class:"fa-solid fa-eye"},null,-1),zC=[qC],PC=["onClick"],UC=e("i",{class:"fa-brands fa-telegram"},null,-1),AC=[UC],OC=["onClick"],IC=e("i",{class:"fa-solid fa-trash"},null,-1),QC=[IC],TC={class:"col-12"},BC={key:1,class:"row"},MC=e("div",{class:"col-12"},[e("div",{class:"alert alert-warning",role:"alert"}," У выбранного бота нет медиа-файлов ")],-1),RC=[MC],DC={class:"modal fade",id:"preview-modal",tabindex:"-1","aria-labelledby":"preview-modal-label","aria-hidden":"true"},EC={class:"modal-dialog"},LC={class:"modal-content"},KC={class:"modal-body"},NC={key:0,class:"d-flex justify-content-center align-items-center"},JC=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),HC={data(){return{bot:null,previewContent:null,loading:!0,media:[],search:null,media_paginate_object:null}},computed:{...C(["getMedia","getMediaPaginateObject","getCurrentBot"])},mounted(){this.loadCurrentBot().then(()=>{this.loadMedia()})},methods:{selectMedia(s){this.$emit("select",s)},loadCurrentBot(s=null){return this.$store.dispatch("updateCurrentBot",{bot:s}).then(()=>{this.bot=this.getCurrentBot})},nextMedia(s){this.loadMedia(s)},remove(s){this.$store.dispatch("removeMedia",{dataObject:{mediaId:s}}).then(t=>{this.loadMedia(),this.$notify({title:"Удаление медиа-контента",text:"Медиа контент удален"})}).catch(()=>{})},showPreview(s){this.previewContent=null,this.$nextTick(()=>{this.previewContent=s,new bootstrap.Modal("#preview-modal",{}).show()})},showPreviewInTg(s){this.$store.dispatch("showMediaPreview",{dataObject:{mediaId:s}}).then(t=>{this.$notify({title:"Превью медиа-контента",text:"Отправлено в бота"})}).catch(()=>{})},loadMedia(s=0){this.loading=!0,this.$store.dispatch("loadMedia",{dataObject:{bot_id:this.bot.id||null,search:this.search,needVideo:!0,needVideoNote:!0,needPhoto:!0,needAudio:!0,needDocument:!0,needSticker:!0},page:s}).then(t=>{this.loading=!1,this.media=this.getMedia,this.media_paginate_object=this.getMediaPaginateObject}).catch(()=>{this.loading=!1})}}},GC=Object.assign(HC,{__name:"BotMediaTable",setup(s){return(t,o)=>(l(),i(g,null,[e("div",fC,[e("div",gC,[c(e("input",{type:"search",class:"form-control",placeholder:"Поиск файла","aria-label":"Поиск файла","onUpdate:modelValue":o[0]||(o[0]=a=>t.search=a)},null,512),[[_,t.search]]),e("button",{class:"btn btn-outline-secondary",onClick:o[1]||(o[1]=a=>t.loadMedia(0)),type:"button",id:"button-addon2"},"Найти ")])]),t.media.length>0?(l(),i("div",yC,[e("div",vC,[e("table",$C,[kC,e("tbody",null,[(l(!0),i(g,null,$(t.media,(a,n)=>(l(),i("tr",null,[e("th",FC,u(a.id),1),e("td",null,[e("span",wC,u(a.type),1)]),e("td",null,[e("p",CC,u(a.caption??"Без подписи"),1)]),e("td",null,[e("p",SC,u(a.file_id),1)]),e("td",null,[e("div",jC,[e("a",{href:"javascript:void(0)",class:"btn btn-info mr-2",onClick:d=>t.showPreview(a)},zC,8,VC),e("a",{href:"javascript:void(0)",class:"btn btn-info mr-2",onClick:d=>t.showPreviewInTg(a.id)},AC,8,PC),e("a",{href:"javascript:void(0)",class:"btn btn-outline-danger text-danger",onClick:d=>t.remove(a.id)},QC,8,OC)])])]))),256))])])]),e("div",TC,[t.media_paginate_object?(l(),v(V,{key:0,onPagination_page:t.nextMedia,pagination:t.media_paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])])):(l(),i("div",BC,RC)),e("div",DC,[e("div",EC,[e("div",LC,[e("div",KC,[t.previewContent!=null?(l(),i("div",NC,[b(le,{type:t.previewContent.type,content:t.previewContent.file_id},null,8,["type","content"])])):r("",!0)]),JC])])])],64))}}),YC={class:"row py-3"},WC={class:"col-12"},ZC={class:"row"},XC={class:"col-12"},xC={key:0},e4={key:1},t4={key:0,class:"col-12 mb-3"},s4={class:"col-12 mb-3"},o4={key:0},l4={key:1},i4={key:1,class:"col-12 mb-3"},n4={class:"row py-3"},a4=e("div",{class:"col-12"},[e("p",{class:"mb-0"},"Выбор статуса")],-1),d4={class:"col-md-3"},r4=["onClick"],c4={class:"row"},u4={class:"col-12 mb-3"},m4={class:"form-label",id:"service-title"},h4=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),_4=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),p4={class:"col-12 mb-3"},b4={class:"form-label",id:"service-title"},f4=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),g4=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),y4={class:"col-12 mb-3"},v4={class:"form-label",id:"appointment-info"},$4=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),k4=e("div",null," Краткая информация от клиента ",-1),F4=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),w4={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},C4={class:"row"},S4={class:"col-12"},j4={type:"submit",class:"btn btn-outline-success w-100 p-3"},V4={key:0},q4={key:1},z4={props:["eventId","bot","appointment"],data(){return{step:0,load:!1,selected_schedule_time:null,selected_bot_user:null,need_load_users:!1,need_schedule_time:!1,statuses:[{value:0,title:"Новая запись"},{value:1,title:"Подтверждение записи"},{value:2,title:"Прохождение по записи"},{value:3,title:"Отмена записи"}],days:["понедельник","вторник","среду","четверг","пятницу","субботу","воскресенье"],appointmentForm:{id:null,appointment_event_id:null,appointment_schedule_id:null,bot_user_id:null,status:0,name:null,phone:null,info:null}}},mounted(){this.appointment&&this.$nextTick(()=>{this.appointmentForm={id:this.appointment.id||null,appointment_event_id:this.appointment.appointment_event_id||null,appointment_schedule_id:this.appointment.appointment_schedule_id||null,bot_user_id:this.appointment.bot_user_id||null,status:this.appointment.status||0,name:this.appointment.name||null,phone:this.appointment.phone||null,info:this.appointment.info||null},this.selected_schedule_time=this.appointment.schedule||null,this.selected_bot_user=this.appointment.botUser||null})},methods:{selectScheduleTime(s){if(s.appointment){this.$notify("Данное время уже занято!");return}this.selected_schedule_time=s,this.need_schedule_time=!1},selectBotUser(s){this.selected_bot_user=s,this.need_load_users=!1},clearAppointmentForm(){this.appointmentForm={id:null,appointment_event_id:null,appointment_schedule_id:null,bot_user_id:null,status:0},this.selected_schedule_time=null,this.selected_bot_user=null},submitForm(){this.appointmentForm.bot_user_id=this.selected_bot_user.id,this.appointmentForm.appointment_schedule_id=this.selected_schedule_time.id,this.appointmentForm.appointment_event_id=this.eventId;let s=new FormData;Object.keys(this.appointmentForm).forEach(t=>{const o=this.appointmentForm[t]||"";typeof o=="object"?s.append(t,JSON.stringify(o)):s.append(t,o)}),s.append("bot_id",this.bot.id),this.$store.dispatch("storeAppointment",{dataObject:{appointmentForm:s}}).then(t=>{this.clearAppointmentForm(),this.$emit("callback"),this.$notify("Запись успешно создана")}).catch(t=>{this.$notify("Ошибка создания записи")})}}},P4=Object.assign(z4,{__name:"AppointmentForm",setup(s){return(t,o)=>{const a=P("Popper"),n=T("mask");return l(),i(g,null,[e("div",YC,[e("div",WC,[e("button",{onClick:o[0]||(o[0]=(...d)=>t.clearAppointmentForm&&t.clearAppointmentForm(...d)),class:"btn btn-primary"},"Новая заявка ")])]),e("form",{onSubmit:o[6]||(o[6]=S((...d)=>t.submitForm&&t.submitForm(...d),["prevent"]))},[e("div",ZC,[e("div",XC,[e("a",{href:"javascript:void(0)",class:"btn btn-link",onClick:o[1]||(o[1]=d=>t.need_load_users=!t.need_load_users)},[t.selected_bot_user==null?(l(),i("span",xC,"Выберите пользователя")):r("",!0),t.selected_bot_user?(l(),i("span",e4," Пользователь "+u(t.selected_bot_user.name||t.selected_bot_user.fio_from_telegram||t.selected_bot_user.telegram_chat_id||"-"),1)):r("",!0)])]),t.need_load_users?(l(),i("div",t4,[b(X,{simple:!0,onSelect:t.selectBotUser},null,8,["onSelect"])])):r("",!0),e("div",s4,[e("a",{href:"javascript:void(0)",class:"btn btn-link",onClick:o[2]||(o[2]=d=>t.need_schedule_time=!t.need_schedule_time)},[t.selected_schedule_time==null?(l(),i("span",o4,"Выберите время в расписании")):r("",!0),t.selected_schedule_time?(l(),i("span",l4," Запись на "+u(t.days[t.selected_schedule_time.day-1]||"-")+" с "+u(t.selected_schedule_time.start_time||"-")+" до "+u(t.selected_schedule_time.end_time||"-"),1)):r("",!0)])]),t.need_schedule_time?(l(),i("div",i4,[b(Se,{"event-id":s.eventId,bot:s.bot,onSelect:t.selectScheduleTime},null,8,["event-id","bot","onSelect"])])):r("",!0)]),e("div",n4,[a4,(l(!0),i(g,null,$(t.statuses,d=>(l(),i("div",d4,[e("button",{type:"button",class:p([{"btn-success text-white":t.appointmentForm.status==d.value},"btn btn-outline-success w-100"]),onClick:h=>t.appointmentForm.status=d.value},u(d.title||"не указано"),11,r4)]))),256))]),e("div",c4,[e("div",u4,[e("label",m4,[b(a,{content:"ФИО человека, который посетит запись"},{default:y(()=>[h4]),_:1}),m(" Ф.И.О. посетителя "),_4]),c(e("input",{type:"text",class:"form-control",placeholder:"Иванов Иван Иванович","aria-label":"ФИО","onUpdate:modelValue":o[3]||(o[3]=d=>t.appointmentForm.name=d),maxlength:"255","aria-describedby":"appointment-name",required:""},null,512),[[_,t.appointmentForm.name]])]),e("div",p4,[e("label",b4,[b(a,{content:"Номер телефона человека, который посетит запись"},{default:y(()=>[f4]),_:1}),m(" Телефонный номер "),g4]),c(e("input",{type:"text",class:"form-control",placeholder:"+7(000)000-00-00","aria-label":"номер телефона","onUpdate:modelValue":o[4]||(o[4]=d=>t.appointmentForm.phone=d),maxlength:"255","aria-describedby":"appointment-phone",required:""},null,512),[[n,"+7(###)###-##-##"],[_,t.appointmentForm.phone]])]),e("div",y4,[e("label",v4,[b(a,null,{content:y(()=>[k4]),default:y(()=>[$4]),_:1}),m(" Описание услуги "),F4,t.appointmentForm.info?(l(),i("small",w4," Длина текста "+u(t.appointmentForm.info.length)+" / 255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Информация от клиента","aria-label":"Информация от клиента",maxlength:"255","onUpdate:modelValue":o[5]||(o[5]=d=>t.appointmentForm.info=d),"aria-describedby":"appointment-info",required:""},`
                    `,512),[[_,t.appointmentForm.info]])])]),e("div",C4,[e("div",S4,[e("button",j4,[t.appointmentForm.id==null?(l(),i("span",V4,"Записаться")):(l(),i("span",q4,"Обновить запись"))])])])],32)],64)}}}),U4={class:"row"},A4={class:"col-12"},O4={key:0,class:"table"},I4=e("th",{scope:"col"},"Действие",-1),Q4=["onClick"],T4={scope:"row"},B4={key:0},M4={key:0,class:"dropdown"},R4=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),D4={class:"dropdown-menu"},E4={key:0},L4=["onClick"],K4={key:1},N4={class:"col-12"},J4={props:["bot","eventId"],data(){return{direction:"desc",order:"updated_at",show:!0,is_group:!1,loading:!0,services:[],search:null,statuses:["Новая запись","Подтверждение записи","Прохождение по записи","Отмена записи"],days:["понедельник","вторник","среду","четверг","пятницу","субботу","воскресенье"],paginate_object:null}},computed:{...C(["getAppointments","getAppointmentsPaginateObject"])},mounted(){this.loadAppointments()},methods:{nextAppointments(s){this.loadAppointments(s)},selectAppointment(s){this.$emit("select",s)},loadAndOrder(s){this.order=s,this.direction=this.direction==="desc"?"asc":"desc",this.loadAppointments(0)},removeAppointment(s){this.loading=!0,this.$store.dispatch("removeAppointment",{dataObject:{appointmentId:s}}).then(t=>{this.loading=!1,this.loadAppointments(0),this.$notify("Запись успешно удалена")}).catch(()=>{this.loading=!1,this.$notify("Ошибка удаления записи")})},loadAppointments(s=0){this.loading=!0,this.$store.dispatch("loadAppointments",{dataObject:{event_id:this.eventId,bot_id:this.bot.id||null,search:this.search,order:this.order,direction:this.direction},page:s,size:100}).then(t=>{this.loading=!1,this.services=this.getAppointments,this.paginate_object=this.getAppointmentsPaginateObject}).catch(()=>{this.loading=!1})}}},H4=Object.assign(J4,{__name:"AppointmentsTable",setup(s){return(t,o)=>(l(),i("div",U4,[e("div",A4,[t.services.length>0?(l(),i("table",O4,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:o[0]||(o[0]=a=>t.loadAndOrder("id"))},"#"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[1]||(o[1]=a=>t.loadAndOrder("bot_user_id"))},"Пользователь"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[2]||(o[2]=a=>t.loadAndOrder("appointment_schedule_id"))},"Дата записи "),e("th",{scope:"col",class:"cursor-pointer",onClick:o[3]||(o[3]=a=>t.loadAndOrder("status"))},"Статус"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[4]||(o[4]=a=>t.loadAndOrder("name"))},"Посетитель"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[5]||(o[5]=a=>t.loadAndOrder("phone"))},"Телефон посетителя"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[6]||(o[6]=a=>t.loadAndOrder("info"))},"Доп.инф"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[7]||(o[7]=a=>t.loadAndOrder("updated_at"))},"Дата изменения"),I4])]),e("tbody",null,[(l(!0),i(g,null,$(t.services,(a,n)=>(l(),i("tr",{onClick:d=>t.selectAppointment(a),class:p({"border-info":a.deleted_at==null,"border-danger":a.deleted_at!=null})},[e("th",T4,u(a.id),1),e("td",null,u(a.botUser.fio_from_telegram||a.botUser.telegram_chat_id||"Не указано"),1),e("td",null,[a.schedule?(l(),i("p",B4," Запись на "+u(t.days[a.schedule.day-1]||"Не указано")+" с "+u(a.schedule.start_time||"Не указано")+" до "+u(a.schedule.end_time||"Не указано"),1)):r("",!0)]),e("td",null,u(t.statuses[a.status]),1),e("td",null,u(t.$filters.current(a.updated_at)),1),e("td",null,u(a.name||"не указано"),1),e("td",null,u(a.phone||"не указано"),1),e("td",null,u(a.info||"не указано"),1),e("td",null,[a.id?(l(),i("div",M4,[R4,e("ul",D4,[a.deleted_at==null?(l(),i("li",E4,[e("a",{class:"dropdown-item",onClick:d=>t.removeAppointment(a.id),href:"javascript:void(0)"},"Удалить",8,L4)])):r("",!0)])])):r("",!0)])],10,Q4))),256))])])):(l(),i("p",K4,"На текущий момент нет ни одного созданного сервиса"))]),e("div",N4,[t.paginate_object?(l(),v(V,{key:0,onPagination_page:t.nextAppointments,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])]))}}),G4={class:"row py-2"},Y4={class:"col-12"},W4={class:"input-group mb-3"},Z4={class:"col-12"},X4={key:0,class:"table"},x4=e("th",{scope:"col"},"Действие",-1),e8={scope:"row"},t8=["onClick"],s8={key:0,class:"fa-solid fa-chevron-down text-success"},o8={key:1,class:"fa-solid fa-xmark text-danger"},l8={key:0,class:"dropdown"},i8=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),n8={class:"dropdown-menu"},a8={key:0},d8=["onClick"],r8={key:1},c8=["onClick"],u8={key:1},m8={class:"col-12"},h8={props:["bot"],data(){return{direction:"desc",order:"updated_at",show:!0,is_group:!1,loading:!0,events:[],search:null,paginate_object:null}},computed:{...C(["getAppointmentEvents","getAppointmentEventsPaginateObject"])},mounted(){this.loadAppointmentEvents()},methods:{duplicateAppointmentEvent(s){this.loading=!0,this.$store.dispatch("duplicateAppointmentEvent",{dataObject:{appointmentEventId:s,bot_id:this.bot.id}}).then(t=>{this.loading=!1,this.loadAppointmentEvents(0),this.$notify("Событие успешно продублировано")}).catch(()=>{this.loading=!1,this.$notify("Ошибка дублирования события")})},removeAppointmentEvent(s){this.loading=!0,this.$store.dispatch("removeAppointmentEvent",{dataObject:{appointmentEventId:s}}).then(t=>{this.loading=!1,this.loadAppointmentEvents(0),this.$notify("Событие успешно удалено")}).catch(()=>{this.loading=!1,this.$notify("Ошибка удаления события")})},nextAppointmentEvents(s){this.loadAppointmentEvents(s)},selectEvent(s){this.$emit("select",s)},loadAndOrder(s){this.order=s,this.direction=this.direction==="desc"?"asc":"desc",this.loadAppointmentEvents(0)},loadAppointmentEvents(s=0){this.loading=!0,this.$store.dispatch("loadAppointmentEvents",{dataObject:{bot_id:this.bot.id||null,search:this.search,is_group:this.is_group,order:this.order,direction:this.direction},page:s,size:20}).then(t=>{this.loading=!1,this.events=this.getAppointmentEvents,this.paginate_object=this.getAppointmentEventsPaginateObject}).catch(()=>{this.loading=!1})}}},_8=Object.assign(h8,{__name:"AppointmentEventTable",setup(s){return(t,o)=>(l(),i("div",G4,[e("div",Y4,[e("div",W4,[c(e("input",{type:"search",class:"form-control",placeholder:"Поиск события","aria-label":"Поиск события","onUpdate:modelValue":o[0]||(o[0]=a=>t.search=a),"aria-describedby":"appointment-search-event"},null,512),[[_,t.search]]),e("button",{class:"btn btn-outline-secondary",onClick:o[1]||(o[1]=a=>t.loadAppointmentEvents(0)),type:"button",id:"appointment-search-event"},"Найти ")])]),e("div",Z4,[t.events.length>0?(l(),i("table",X4,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:o[2]||(o[2]=a=>t.loadAndOrder("id"))},"#"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[3]||(o[3]=a=>t.loadAndOrder("title"))},"Название"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[4]||(o[4]=a=>t.loadAndOrder("subtitle"))},"Подзаголовок"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[5]||(o[5]=a=>t.loadAndOrder("address"))},"Адрес"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[6]||(o[6]=a=>t.loadAndOrder("description"))},"Описание"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[7]||(o[7]=a=>t.loadAndOrder("is_group"))},"Групповое"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[8]||(o[8]=a=>t.loadAndOrder("updated_at"))},"Дата изменения"),x4])]),e("tbody",null,[(l(!0),i(g,null,$(t.events,(a,n)=>(l(),i("tr",{class:p({"border-info":a.deleted_at==null,"border-danger":a.deleted_at!=null})},[e("th",e8,u(a.id),1),e("td",{onClick:d=>t.selectEvent(a)},u(a.title||"Не указано"),9,t8),e("td",null,u(a.subtitle||"Не указано"),1),e("td",null,u(a.address||"Не указано"),1),e("td",null,u(a.description||"Не указано"),1),e("td",null,[a.is_group?(l(),i("i",s8)):(l(),i("i",o8))]),e("td",null,u(t.$filters.current(a.updated_at)),1),e("td",null,[a.id?(l(),i("div",l8,[i8,e("ul",n8,[a.deleted_at==null?(l(),i("li",a8,[e("a",{class:"dropdown-item",onClick:d=>t.removeAppointmentEvent(a.id),href:"javascript:void(0)"},"Удалить",8,d8)])):r("",!0),a.deleted_at==null?(l(),i("li",r8,[e("a",{class:"dropdown-item",onClick:d=>t.duplicateAppointmentEvent(a.id),href:"javascript:void(0)"},"Дублировать",8,c8)])):r("",!0)])])):r("",!0)])],2))),256))])])):(l(),i("p",u8,"На текущий момент нет событий в вашем списке"))]),e("div",m8,[t.paginate_object?(l(),v(V,{key:0,onPagination_page:t.nextAppointmentEvents,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])]))}}),p8={class:"row"},b8={class:"col-12"},f8={key:0,class:"table"},g8=e("th",{scope:"col"},"Действие",-1),y8={scope:"row"},v8=["onClick"],$8={key:0,class:"fa-solid fa-chevron-down text-success"},k8={key:1,class:"fa-solid fa-xmark text-danger"},F8={key:0,class:"dropdown"},w8=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),C8={class:"dropdown-menu"},S8={key:0},j8=["onClick"],V8={key:1},q8={class:"col-12"},z8={props:["bot","eventId"],data(){return{direction:"desc",order:"updated_at",show:!0,is_group:!1,loading:!0,services:[],search:null,paginate_object:null}},computed:{...C(["getAppointmentServices","getAppointmentServicesPaginateObject"])},mounted(){this.loadAppointmentServices()},methods:{nextAppointmentService(s){this.loadAppointmentServices(s)},selectService(s){this.$emit("select",s)},removeAppointmentService(s){this.loading=!0,this.$store.dispatch("removeAppointmentService",{dataObject:{appointmentServiceId:s}}).then(t=>{this.loading=!1,this.loadAppointmentServices(0),this.$notify("Сервис успешно удален")}).catch(()=>{this.loading=!1,this.$notify("Ошибка удаления сервиса")})},loadAndOrder(s){this.order=s,this.direction=this.direction==="desc"?"asc":"desc",this.loadAppointmentServices(0)},loadAppointmentServices(s=0){this.loading=!0,this.$store.dispatch("loadAppointmentServices",{dataObject:{event_id:this.eventId,bot_id:this.bot.id||null,search:this.search,order:this.order,direction:this.direction},page:s,size:100}).then(t=>{this.loading=!1,this.services=this.getAppointmentServices,this.paginate_object=this.getAppointmentServicesPaginateObject}).catch(()=>{this.loading=!1})}}},P8=Object.assign(z8,{__name:"AppointmentServicesTable",setup(s){return(t,o)=>(l(),i("div",p8,[e("div",b8,[t.services.length>0?(l(),i("table",f8,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:o[0]||(o[0]=a=>t.loadAndOrder("id"))},"#"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[1]||(o[1]=a=>t.loadAndOrder("title"))},"Название"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[2]||(o[2]=a=>t.loadAndOrder("subtitle"))},"Подзаголовок"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[3]||(o[3]=a=>t.loadAndOrder("description"))},"Описание"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[4]||(o[4]=a=>t.loadAndOrder("is_group"))},"Групповое"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[5]||(o[5]=a=>t.loadAndOrder("updated_at"))},"Дата изменения"),g8])]),e("tbody",null,[(l(!0),i(g,null,$(t.services,(a,n)=>(l(),i("tr",{class:p({"border-info":a.deleted_at==null,"border-danger":a.deleted_at!=null})},[e("th",y8,u(a.id),1),e("td",{onClick:d=>t.selectService(a)},u(a.title||"Не указано"),9,v8),e("td",null,u(a.subtitle||"Не указано"),1),e("td",null,u(a.description||"Не указано"),1),e("td",null,[a.is_group?(l(),i("i",$8)):(l(),i("i",k8))]),e("td",null,u(t.$filters.current(a.updated_at)),1),e("td",null,[a.id?(l(),i("div",F8,[w8,e("ul",C8,[a.deleted_at==null?(l(),i("li",S8,[e("a",{class:"dropdown-item",onClick:d=>t.removeAppointmentService(a.id),href:"javascript:void(0)"},"Удалить",8,j8)])):r("",!0)])])):r("",!0)])],2))),256))])])):(l(),i("p",V8,"На текущий момент нет ни одного созданого сервиса"))]),e("div",q8,[t.paginate_object?(l(),v(V,{key:0,onPagination_page:t.nextAppointmentService,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])]))}}),U8={class:"row"},A8={class:"col-12 mb-3"},O8={class:"form-label",id:"event-title"},I8=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Q8=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),T8={class:"col-12 mb-3"},B8={class:"form-label",id:"event-subtitle"},M8=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),R8=e("div",null,"Подзаголовок события или доп. инфа под названием события ",-1),D8=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),E8={class:"col-12 mb-3"},L8={class:"form-check"},K8=e("label",{class:"form-check-label",for:"need_add_address"}," Нужно указать адрес и координат мероприятия ",-1),N8={key:0,class:"col-12 mb-3"},J8={class:"form-label",id:"event-address"},H8=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),G8=e("div",null,"Адрес, указывающий точное место проведения события \\ мероприятия ",-1),Y8={key:1,class:"col-12 mb-3"},W8={class:"form-label",id:"event-coords"},Z8=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),X8=e("div",null,"Координаты мероприятия ",-1),x8={class:"col-12 mb-3"},e6={class:"form-label",id:"event-description"},t6=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),s6=e("div",null," Краткая информация о происходящем мероприятии ",-1),o6=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),l6={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},i6={class:"col-12 mb-3"},n6={class:"form-label",id:"event-on_start_appointment"},a6=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),d6=e("div",null," Текст, который будет отображен клиенту, когда тот записался ",-1),r6=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),c6={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},u6={class:"col-12 mb-3"},m6={class:"form-label",id:"event-on_cancel_appointment"},h6=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),_6=e("div",null," Текст, который будет отображен клиенту, когда тот отменил запись ",-1),p6=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),b6={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},f6={class:"col-12 mb-3"},g6={class:"form-label",id:"event-on_after_appointment"},y6=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),v6=e("div",null," Текст, который будет отображен клиенту, когда тот прошел событие успешно ",-1),$6=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),k6={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},F6={class:"col-12 mb-3"},w6={class:"form-label",id:"event-on_repeat_appointment"},C6=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),S6=e("div",null," Текст, который будет отображен клиенту, когда тот записывается 2й и более раз ",-1),j6=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),V6={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},q6={class:"col-12 mb-3"},z6={class:"form-check"},P6=e("label",{class:"form-check-label",for:"need_media"}," Нужно изображение к событию ",-1),U6={key:2,class:"col-12 mb-3"},A6={class:"form-label",id:"event-images"},O6=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),I6=e("div",null," Изображение, которое видит пользователь при выборе события ",-1),Q6=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),T6={class:"col-12 mb-3"},B6={class:"form-check"},M6=e("label",{class:"form-check-label",for:"is-group"}," Является групповым мероприятием ",-1),R6={key:3,class:"col-md-6 col-12 mb-3"},D6={class:"form-label",id:"event-min_people"},E6=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),L6=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),K6={key:4,class:"col-md-6 col-12 mb-3"},N6={class:"form-label",id:"event-max_people"},J6=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),H6=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),G6={class:"row"},Y6={class:"col-12"},W6={type:"submit",class:"btn btn-outline-success w-100 p-3"},Z6={key:0},X6={key:1},x6={props:["event","bot"],data(){return{step:0,load:!1,need_reset:!1,need_services:!1,need_add_address:!1,need_media:!1,eventForm:{id:null,title:null,subtitle:null,description:null,address:null,coords:null,images:[],services:[],times:[],is_group:!1,max_people:0,min_people:0,on_start_appointment:null,on_cancel_appointment:null,on_after_appointment:null,on_repeat_appointment:null}}},watch:{eventForm:{handler(s){this.need_reset=!0},deep:!0}},mounted(){this.event&&this.$nextTick(()=>{this.eventForm={id:this.event.id||null,title:this.event.title||null,subtitle:this.event.subtitle||null,description:this.event.description||null,images:this.event.images||[],is_group:this.event.is_group||!1,address:this.event.address||null,coords:this.event.coords||null,max_people:this.event.max_people||0,min_people:this.event.min_people||0,on_start_appointment:this.event.on_start_appointment||null,on_cancel_appointment:this.event.on_cancel_appointment||null,on_after_appointment:this.event.on_after_appointment||null,on_repeat_appointment:this.event.on_repeat_appointment||null}})},methods:{selectPhotos(s){this.eventForm.images||(this.eventForm.images=[]);let t=this.eventForm.images.indexOf(s.file_id);t!==-1?this.eventForm.images.splice(t,1):this.eventForm.images.push(s.file_id)},resetForm(){},submitForm(){let s=new FormData;Object.keys(this.eventForm).forEach(t=>{const o=this.eventForm[t]||"";typeof o=="object"?s.append(t,JSON.stringify(o)):s.append(t,o)}),s.append("bot_id",this.bot.id),this.$store.dispatch(this.eventForm.id===null?"addAppointmentEvent":"updateAppointmentEvent",{appointmentEventForm:s}).then(t=>{this.$emit("callback",t.data),this.$nextTick(()=>{this.eventForm={id:null,title:null,subtitle:null,description:null,address:null,coords:null,images:[],services:[],times:[],is_group:!1,max_people:0,min_people:0,on_start_appointment:null,on_cancel_appointment:null,on_after_appointment:null,on_repeat_appointment:null}}),this.$notify("Событие успешно создано")}).catch(t=>{this.$notify("Ошибка создания события")})}}},ye=Object.assign(x6,{__name:"AppointmentEventForm",setup(s){return(t,o)=>{const a=P("Popper"),n=T("mask");return l(),i("form",{onSubmit:o[14]||(o[14]=S((...d)=>t.submitForm&&t.submitForm(...d),["prevent"]))},[e("div",U8,[e("div",A8,[e("label",O8,[b(a,{content:"Название вашего события (или специалиста), на которое планируется осуществить запись"},{default:y(()=>[I8]),_:1}),m(" Название события "),Q8]),c(e("input",{type:"text",class:"form-control",placeholder:"Название","aria-label":"Название","onUpdate:modelValue":o[0]||(o[0]=d=>t.eventForm.title=d),maxlength:"255","aria-describedby":"event-title",required:""},null,512),[[_,t.eventForm.title]])]),e("div",T8,[e("label",B8,[b(a,null,{content:y(()=>[R8]),default:y(()=>[M8]),_:1}),m(" Подзаголовок события "),D8]),c(e("input",{type:"text",class:"form-control",placeholder:"Подзаголовок","aria-label":"Подзаголовок","onUpdate:modelValue":o[1]||(o[1]=d=>t.eventForm.subtitle=d),maxlength:"255","aria-describedby":"event-subtitle",required:""},null,512),[[_,t.eventForm.subtitle]])]),e("div",E8,[e("div",L8,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[2]||(o[2]=d=>t.need_add_address=d),type:"checkbox",id:"need_add_address"},null,512),[[k,t.need_add_address]]),K8])]),t.need_add_address?(l(),i("div",N8,[e("label",J8,[b(a,null,{content:y(()=>[G8]),default:y(()=>[H8]),_:1}),m(" Адрес события \\ мероприятия ")]),c(e("input",{type:"text",class:"form-control",placeholder:"Адрес события","aria-label":"Адрес события","onUpdate:modelValue":o[3]||(o[3]=d=>t.eventForm.address=d),maxlength:"255","aria-describedby":"event-address",required:""},null,512),[[_,t.eventForm.address]])])):r("",!0),t.need_add_address?(l(),i("div",Y8,[e("label",W8,[b(a,null,{content:y(()=>[X8]),default:y(()=>[Z8]),_:1}),m(" Координаты мероприятия: широта, долгота ")]),c(e("input",{type:"text",class:"form-control",placeholder:"00.0000,00.0000","aria-label":"Координаты события","onUpdate:modelValue":o[4]||(o[4]=d=>t.eventForm.coords=d),maxlength:"255","aria-describedby":"event-coords",required:""},null,512),[[_,t.eventForm.coords],[n,"##.####,##.####"]])])):r("",!0),e("div",x8,[e("label",e6,[b(a,null,{content:y(()=>[s6]),default:y(()=>[t6]),_:1}),m(" Описание события "),o6,t.eventForm.description?(l(),i("small",l6," Длина текста "+u(t.eventForm.description.length)+"/255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Описание мероприятия","aria-label":"Описание мероприятия",maxlength:"255","onUpdate:modelValue":o[5]||(o[5]=d=>t.eventForm.description=d),"aria-describedby":"event-description",required:""},`
                    `,512),[[_,t.eventForm.description]])]),e("div",i6,[e("label",n6,[b(a,null,{content:y(()=>[d6]),default:y(()=>[a6]),_:1}),m(" Текст при записи на событие "),r6,t.eventForm.on_start_appointment?(l(),i("small",c6," Длина текста "+u(t.eventForm.on_start_appointment.length)+"/255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Текст при записи на событие","aria-label":"Текст при записи на событие","onUpdate:modelValue":o[6]||(o[6]=d=>t.eventForm.on_start_appointment=d),maxlength:"255","aria-describedby":"event-on_start_appointment",required:""},`
                    `,512),[[_,t.eventForm.on_start_appointment]])]),e("div",u6,[e("label",m6,[b(a,null,{content:y(()=>[_6]),default:y(()=>[h6]),_:1}),m(" Текст при отмене записи на событие "),p6,t.eventForm.on_cancel_appointment?(l(),i("small",b6," Длина текста "+u(t.eventForm.on_cancel_appointment.length)+"/255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Текст при отмене записи на событие","aria-label":"Текст при отмене записи на событие","onUpdate:modelValue":o[7]||(o[7]=d=>t.eventForm.on_cancel_appointment=d),maxlength:"255","aria-describedby":"event-on_cancel_appointment",required:""},`
                    `,512),[[_,t.eventForm.on_cancel_appointment]])]),e("div",f6,[e("label",g6,[b(a,null,{content:y(()=>[v6]),default:y(()=>[y6]),_:1}),m(" Текст после прохождения события "),$6,t.eventForm.on_after_appointment?(l(),i("small",k6," Длина текста "+u(t.eventForm.on_after_appointment.length)+"/255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Текст после прохождения события","aria-label":"Текст после прохождения события","onUpdate:modelValue":o[8]||(o[8]=d=>t.eventForm.on_after_appointment=d),maxlength:"255","aria-describedby":"event-on_after_appointment",required:""},`
                    `,512),[[_,t.eventForm.on_after_appointment]])]),e("div",F6,[e("label",w6,[b(a,null,{content:y(()=>[S6]),default:y(()=>[C6]),_:1}),m(" Текст при повторной записи на событие "),j6,t.eventForm.on_repeat_appointment?(l(),i("small",V6," Длина текста "+u(t.eventForm.on_repeat_appointment.length)+"/255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:" Текст при повторной записи на событие","aria-label":" Текст при повторной записи на событие","onUpdate:modelValue":o[9]||(o[9]=d=>t.eventForm.on_repeat_appointment=d),maxlength:"255","aria-describedby":"event-on_repeat_appointment",required:""},`
                    `,512),[[_,t.eventForm.on_repeat_appointment]])]),e("div",q6,[e("div",z6,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[10]||(o[10]=d=>t.need_media=d),type:"checkbox",id:"need_media"},null,512),[[k,t.need_media]]),P6])]),t.need_media?(l(),i("div",U6,[e("label",A6,[b(a,null,{content:y(()=>[I6]),default:y(()=>[O6]),_:1}),m(" Изображение к событию "),Q6]),b(U,{"need-photo":!0,selected:t.eventForm.images,onSelect:t.selectPhotos},null,8,["selected","onSelect"])])):r("",!0),e("div",T6,[e("div",B6,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[11]||(o[11]=d=>t.eventForm.is_group=d),type:"checkbox",id:"is-group"},null,512),[[k,t.eventForm.is_group]]),M6])]),t.eventForm.is_group?(l(),i("div",R6,[e("label",D6,[b(a,{content:"Минимально необходимое число людей, для начала 1 мероприятия"},{default:y(()=>[E6]),_:1}),m(" Минимальное число посетителей в группе "),L6]),c(e("input",{type:"number",class:"form-control",placeholder:"Минимальное число посетителей","aria-label":"Название","onUpdate:modelValue":o[12]||(o[12]=d=>t.eventForm.min_people=d),"aria-describedby":"event-min_people",required:""},null,512),[[_,t.eventForm.min_people]])])):r("",!0),t.eventForm.is_group?(l(),i("div",K6,[e("label",N6,[b(a,{content:"Количество людей, которые могут посетить мероприятие за 1 сеанс"},{default:y(()=>[J6]),_:1}),m(" Максимальное число посетителей в группе "),H6]),c(e("input",{type:"number",class:"form-control",placeholder:"Максимальное число посетителей","aria-label":"Название","onUpdate:modelValue":o[13]||(o[13]=d=>t.eventForm.max_people=d),"aria-describedby":"event-max_people",required:""},null,512),[[_,t.eventForm.max_people]])])):r("",!0)]),e("div",G6,[e("div",Y6,[e("button",W6,[t.eventForm.id==null?(l(),i("span",Z6,"Создать событие")):(l(),i("span",X6,"Обновить событие"))])])])],32)}}}),e7={class:"row pt-3"},t7={class:"col-md-4"},s7={class:"form-floating mb-3"},o7=e("label",{for:"config-step"},"Шаг, минуты",-1),l7={class:"col-md-4"},i7={class:"form-floating mb-3"},n7=e("label",{for:"config-start-time"},"Начало, часы",-1),a7={class:"col-md-4"},d7={class:"form-floating mb-3"},r7=["min"],c7=e("label",{for:"config-end-time"},"Конец, часы",-1),u7=e("hr",null,null,-1),m7={key:0,class:"row"},h7={class:"col-12 d-flex justify-content-end pb-3"},_7={class:"row"},p7={class:"col-md-4 text-center"},b7={key:0,class:"fa-solid fa-arrow-down-short-wide"},f7={key:1,class:"fa-solid fa-arrow-up-wide-short"},g7={class:"col-md-4 text-center"},y7={key:0,class:"fa-solid fa-arrow-down-short-wide"},v7={key:1,class:"fa-solid fa-arrow-up-wide-short"},$7={class:"col-md-4 text-center"},k7={key:0,class:"fa-solid fa-arrow-down-short-wide"},F7={key:1,class:"fa-solid fa-arrow-up-wide-short"},w7={class:"col-md-4"},C7={class:"form-floating"},S7=["onUpdate:modelValue","id"],j7=["for"],V7={class:"col-md-4"},q7={class:"form-floating"},z7=["onUpdate:modelValue","id"],P7=["for"],U7={class:"col-md-4"},A7={class:"form-floating"},O7=["onUpdate:modelValue","id"],I7=["for"],Q7={class:"row mt-3"},T7={class:"col-12"},B7={class:"row"},M7={class:"col-12"},R7={class:"col-12"},D7={class:"text-center"},E7={class:"row d-flex justify-content-center"},L7={class:"col-md-4"},K7={class:"table"},N7=e("th",{scope:"col"},"#",-1),J7={scope:"col"},H7={scope:"row"},G7=["onClick"],Y7={key:0,class:"fa-solid fa-check"},W7={key:1,class:"fa-solid fa-xmark"},Z7={components:{VueDatePicker:x},props:["eventId","bot"],data(){return{date:null,load:!1,step:30,start:8,end:18,order:null,direction:null,paginate_object:null,years:[2024,2025],months:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","октябрь","Ноябрь","Декабрь"],days:["Понедельник","Вторник","Среда","Четверг","Пятница","Суббота","Воскресенье"],schedule:[],added_schedule:[]}},watch:{date:{handler:function(s){this.loadAppointmentSchedules()},deep:!0}},computed:{...C(["getAppointmentSchedules","getAppointmentSchedulesPaginateObject"]),currentWeek(){return new Date().getWeek()},currentMonthWeek(){return new Date().getMonthWeek()},currentMonth(){return new Date().getMonth()},currentYear(){return new Date().getFullYear()},times(){let s=this.step,t=[],o=0,a=0;for(let n=0;o<24*60;n++){let d=Math.floor(o/60);if(d>=this.start&&d<=this.end){let h=o%60;t[a]=("0"+d).slice(-2)+":"+("0"+h).slice(-2),a++}o=o+s}return t}},mounted(){this.date=new Date,this.loadAppointmentSchedules()},methods:{removeAppointmentSchedule(s){this.loading=!0,this.$store.dispatch("removeAppointmentSchedule",{dataObject:{appointmentScheduleId:s}}).then(t=>{this.loading=!1,this.loadAppointmentSchedules(0),this.$notify("Время успешно удалено")}).catch(()=>{this.loading=!1,this.$notify("Ошибка удаления времени")})},loadAndOrder(s){this.order=s,this.direction=this.direction==="desc"?"asc":"desc",this.loadAppointmentSchedules(0)},nextAppointmentSchedule(s){this.loadAppointmentSchedules(s)},loadAppointmentSchedules(s=0){this.loading=!0,this.$store.dispatch("loadAppointmentSchedules",{dataObject:{date:this.date||null,event_id:this.eventId,bot_id:this.bot.id||null,order:this.order,direction:this.direction},page:s,size:20}).then(t=>{this.loading=!1,this.schedule=this.getAppointmentSchedules,this.paginate_object=this.getAppointmentSchedulesPaginateObject}).catch(()=>{this.loading=!1})},storeSchedule(){this.$store.dispatch("storeAppointmentSchedule",{dataObject:{schedule:[...this.schedule,...this.added_schedule],bot_id:this.bot.id,appointment_event_id:this.eventId}}).then(()=>{this.$notify("Расписание успешно сохранено"),this.loadAppointmentSchedules(),this.added_schedule=[]}).catch(()=>{this.$notify("Ошибка сохраения расписания")})},inScheduleRow(s){return this.schedule.findIndex(t=>t.start_time==this.times[s])!=-1||this.added_schedule.findIndex(t=>t.start_time==this.times[s])!=-1},inSchedule(s,t){return this.schedule.findIndex(o=>o.day==t&&o.start_time==this.times[s])!=-1||this.added_schedule.findIndex(o=>o.day==t&&o.start_time==this.times[s])!=-1},setScheduleItem(s,t){let o=this.schedule.findIndex(a=>a.day==t&&a.start_time==this.times[s]);if(o!==-1){this.schedule.splice(o,1);return}if(o=this.added_schedule.findIndex(a=>a.day==t&&a.start_time==this.times[s]),o!==-1){this.added_schedule.splice(o,1);return}this.added_schedule.push({day:t,start_time:this.times[s]||null,end_time:this.times[s+1]||null,week:this.date==null?this.currentWeek:new Date(this.date).getWeek(),month:this.date==null?this.currentMonth:new Date(this.date).getMonth(),year:this.date==null?this.currentYear:new Date(this.date).getFullYear()})}}},X7=Object.assign(Z7,{__name:"AppointmentScheduleForm",setup(s){return(t,o)=>(l(),i(g,null,[e("div",e7,[e("div",t7,[e("div",s7,[c(e("input",{type:"number",class:"form-control","onUpdate:modelValue":o[0]||(o[0]=a=>t.step=a),min:"0",id:"config-step",placeholder:"30 минут"},null,512),[[_,t.step]]),o7])]),e("div",l7,[e("div",i7,[c(e("input",{type:"number","onUpdate:modelValue":o[1]||(o[1]=a=>t.start=a),min:"0",max:"23",class:"form-control",id:"config-start-time",placeholder:"Часы"},null,512),[[_,t.start]]),n7])]),e("div",a7,[e("div",d7,[c(e("input",{type:"number","onUpdate:modelValue":o[2]||(o[2]=a=>t.end=a),min:t.start,max:"23",class:"form-control",id:"config-end-time",placeholder:"Часы"},null,8,r7),[[_,t.end]]),c7])])]),u7,t.schedule.length>0||t.added_schedule.length>0?(l(),i("div",m7,[e("div",h7,[e("button",{onClick:o[3]||(o[3]=(...a)=>t.storeSchedule&&t.storeSchedule(...a)),class:"btn btn-primary"},"Сохранить текущий график ")]),e("div",_7,[e("div",p7,[e("a",{onClick:o[4]||(o[4]=a=>t.loadAndOrder("day")),href:"javascript:void(0)"},[m("День "),t.order==="day"&&t.direction==="asc"?(l(),i("i",b7)):r("",!0),t.order==="day"&&t.direction==="desc"?(l(),i("i",f7)):r("",!0)])]),e("div",g7,[e("a",{onClick:o[5]||(o[5]=a=>t.loadAndOrder("start_time")),href:"javascript:void(0)"},[m("Начало "),t.order==="start_time"&&t.direction==="asc"?(l(),i("i",y7)):r("",!0),t.order==="start_time"&&t.direction==="desc"?(l(),i("i",v7)):r("",!0)])]),e("div",$7,[e("a",{onClick:o[6]||(o[6]=a=>t.loadAndOrder("end_time")),href:"javascript:void(0)"},[m("Конец "),t.order==="end_time"&&t.direction==="asc"?(l(),i("i",k7)):r("",!0),t.order==="end_time"&&t.direction==="desc"?(l(),i("i",F7)):r("",!0)])])])])):r("",!0),(l(!0),i(g,null,$([...t.schedule,...t.added_schedule],(a,n)=>(l(),i("div",{class:p(["row py-2",{"bg-warning":a.id==null}])},[e("div",w7,[e("div",C7,[c(e("input",{type:"text","onUpdate:modelValue":d=>t.days[a.day-1]=d,class:"form-control",id:"day-of-week-"+n,placeholder:"День недели"},null,8,S7),[[_,t.days[a.day-1]]]),e("label",{for:"day-of-week-"+n},"День недели",8,j7)])]),e("div",V7,[e("div",q7,[c(e("input",{type:"text","onUpdate:modelValue":d=>a.start_time=d,class:"form-control",id:"day-of-start-at-"+n,placeholder:"Время начало"},null,8,z7),[[_,a.start_time]]),e("label",{for:"day-of-start-at-"+n},"Начало",8,P7)])]),e("div",U7,[e("div",A7,[c(e("input",{type:"text","onUpdate:modelValue":d=>a.end_time=d,class:"form-control",id:"day-of-end-at-"+n,placeholder:"Время окончания"},null,8,O7),[[_,a.end_time]]),e("label",{for:"day-of-end-at-"+n},"Окончание",8,I7)])])],2))),256)),e("div",Q7,[e("div",T7,[t.paginate_object?(l(),v(V,{key:0,onPagination_page:t.nextAppointmentSchedule,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])]),e("div",B7,[e("div",M7,[e("button",{class:"btn btn-primary",onClick:o[7]||(o[7]=a=>t.schedule=[])},"Очистить таблицу")]),e("div",R7,[e("p",D7,[m(" Год: "),e("strong",null,u(t.currentYear),1),m(" Месяц: "),e("strong",null,u(t.months[t.currentMonth]),1),m(" Неделя: "),e("strong",null,u(t.currentWeek),1)])])]),e("div",E7,[e("div",L7,[b(j(x),{modelValue:t.date,"onUpdate:modelValue":o[8]||(o[8]=a=>t.date=a)},null,8,["modelValue"])])]),e("table",K7,[e("thead",null,[e("tr",null,[N7,(l(!0),i(g,null,$(t.days,a=>(l(),i("th",J7,u(a),1))),256))])]),e("tbody",null,[(l(!0),i(g,null,$(t.times,(a,n)=>(l(),i("tr",{class:p({"table-light":t.inScheduleRow(n)})},[e("th",H7,u(a),1),(l(),i(g,null,$(7,d=>e("td",null,[e("button",{class:p([{"btn-primary text-white":t.inSchedule(n,d)},"btn btn-outline-primary"]),onClick:h=>t.setScheduleItem(n,d)},[t.inSchedule(n,d)?(l(),i("i",Y7)):(l(),i("i",W7))],10,G7)])),64))],2))),256))])])],64))}});(function(){try{if(typeof document<"u"){var s=document.createElement("style");s.appendChild(document.createTextNode(".vue3-star-ratings[data-v-7fab3f62]{width:fit-content;overflow:hidden;position:relative;white-space:nowrap}.vue3-star-ratings *[data-v-7fab3f62]{box-sizing:border-box;margin:0;padding:0;line-height:1}.vue3-star-ratings__inner[data-v-7fab3f62],.vue3-star-ratings__outer[data-v-7fab3f62]{height:inherit}.vue3-star-ratings__outer[data-v-7fab3f62]{position:absolute;top:0;left:0;width:var(--vue3StarRatingOuterWidth);max-width:100%;overflow:hidden;color:var(--vue3StarRatingsOuterColor);transition:width .32s cubic-bezier(.075,.82,.165,1)}.vue3-star-ratings__inner[data-v-7fab3f62]{color:var(--vue3StarRatingsInnerColor)}.vue3-star-ratings__icon[data-v-7fab3f62]{fill:currentColor;width:var(--vue3StarRatingIconSize);aspect-ratio:1;cursor:pointer;display:inline-block}")),document.head.appendChild(s)}}catch(t){console.error("vite-plugin-css-injected-by-js",t)}})();const Ne=(s,t)=>{const o=s.__vccOpts||s;for(const[a,n]of t)o[a]=n;return o},x7={},e9={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512.002 512.002"},t9=e("path",{d:"M511.267 197.258a14.995 14.995 0 00-12.107-10.209l-158.723-23.065-70.985-143.827a14.998 14.998 0 00-26.901 0l-70.988 143.827-158.72 23.065a14.998 14.998 0 00-8.312 25.585l114.848 111.954-27.108 158.083a14.999 14.999 0 0021.763 15.812l141.967-74.638 141.961 74.637a15 15 0 0021.766-15.813l-27.117-158.081 114.861-111.955a14.994 14.994 0 003.795-15.375z"},null,-1),s9=[t9];function o9(s,t){return l(),i("svg",e9,s9)}const ve=Ne(x7,[["render",o9]]),l9={class:"vue3-star-ratings__outer"},i9={class:"vue3-star-ratings__inner"},n9=Xe({__name:"Vue3StarRatings",props:{modelValue:{default:0},numberOfStars:{default:5},starColor:{default:"#ff9800"},inactiveColor:{default:"#333333"},starSize:{default:24},disableClick:{type:Boolean},customSvg:{default:ve}},emits:["update:modelValue"],setup(s,{emit:t}){const o=s,a=se(()=>o.customSvg||ve),n={rounded(w,Q){const O=Math.pow(10,Q);return Math.round(w*O)/O}},d=xe(),h=se({get(){return o.modelValue},set(w){const Q=n.rounded(w,1);t("update:modelValue",Q)}});function f(w){if(o.disableClick)return;const Q=this.getBoundingClientRect(),{pageX:O}=w,te=O-Q.left,Je=Q.width,He=o.numberOfStars,Ge=te/Je*He;h.value=Ge}const F=se(()=>(h.value<0?0:h.value>o.numberOfStars?o.numberOfStars:h.value)/o.numberOfStars*100);return et(()=>{var w;const Q={"--vue3StarRatingsInnerColor":o.inactiveColor,"--vue3StarRatingsOuterColor":o.starColor,"--vue3StarRatingOuterWidth":`${F.value}%`,"--vue3StarRatingIconSize":`${o.starSize}px`};for(const[O,te]of Object.entries(Q))(w=d.value)==null||w.style.setProperty(O,te)}),tt(()=>{var w;(w=d.value)==null||w.addEventListener("click",f)}),st(()=>{var w;(w=d.value)==null||w.removeEventListener("click",f)}),(w,Q)=>(l(),i("div",{class:"vue3-star-ratings",ref_key:"starsContainer",ref:d,style:Fe({pointerEvents:w.disableClick?"none":"auto"})},[e("div",l9,[(l(!0),i(g,null,$(w.numberOfStars,O=>(l(),v(ue(a.value),{key:O,class:"vue3-star-ratings__icon"}))),128))]),e("div",i9,[(l(!0),i(g,null,$(w.numberOfStars,O=>(l(),v(ue(a.value),{key:O,class:"vue3-star-ratings__icon"}))),128))])],4))}}),ee=Ne(n9,[["__scopeId","data-v-7fab3f62"]]),a9={class:"row py-3"},d9={class:"col-12"},r9={class:"row"},c9={class:"col-12"},u9={key:0},m9={key:1},h9={key:0,class:"col-12 mb-3"},_9={class:"col-12 mb-3"},p9={key:0},b9={key:1},f9={key:1,class:"col-12 mb-3"},g9={class:"col-12 mb-3"},y9={class:"col-12 mb-3"},v9={class:"form-label",id:"event-on_after_appointment"},$9=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),k9=e("div",null," Текст, который пользователь оставляет после прохождения услуги ",-1),F9=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),w9={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},C9={class:"row"},S9={class:"col-12"},j9={type:"submit",class:"btn btn-outline-success w-100 p-3"},V9={key:0},q9={key:1},z9={props:["eventId","bot","review"],components:{vue3starRatings:ee},data(){return{step:0,load:!1,selected_schedule_time:null,selected_bot_user:null,need_load_users:!1,need_schedule_time:!1,days:["понедельник","вторник","среду","четверг","пятницу","субботу","воскресенье"],reviewForm:{id:null,appointment_event_id:null,appointment_schedule_id:null,bot_user_id:null,rating:null,text:null}}},watch:{reviewForm:{handler(s){this.need_reset=!0},deep:!0}},mounted(){this.review&&this.$nextTick(()=>{this.reviewForm={id:this.review.id||null,appointment_event_id:this.review.appointment_event_id||null,appointment_schedule_id:this.review.appointment_schedule_id||null,bot_user_id:this.review.bot_user_id||null,rating:this.review.rating||null,text:this.review.text||null},this.selected_schedule_time=this.review.schedule||null,this.selected_bot_user=this.review.botUser||null})},methods:{selectScheduleTime(s){this.selected_schedule_time=s,this.need_schedule_time=!1},selectBotUser(s){this.selected_bot_user=s,this.need_load_users=!1},clearReviewForm(){this.reviewForm={id:null,appointment_event_id:null,appointment_schedule_id:null,bot_user_id:null,rating:null,text:null},this.selected_schedule_time=null,this.selected_bot_user=null},submitForm(){this.reviewForm.bot_user_id=this.selected_bot_user.id,this.reviewForm.appointment_schedule_id=this.selected_schedule_time.id,this.reviewForm.appointment_event_id=this.eventId;let s=new FormData;Object.keys(this.reviewForm).forEach(t=>{const o=this.reviewForm[t]||"";typeof o=="object"?s.append(t,JSON.stringify(o)):s.append(t,o)}),s.append("bot_id",this.bot.id),this.$store.dispatch("storeAppointmentReview",{dataObject:{appointmentReviewForm:s}}).then(t=>{this.$emit("callback",t.data),this.$notify("Отзыв успешно создан"),this.clearReviewForm()}).catch(t=>{this.$notify("Ошибка создания отзыва")})}}},P9=Object.assign(z9,{__name:"AppointmentReviewForm",setup(s){return(t,o)=>{const a=P("Popper");return l(),i(g,null,[e("div",a9,[e("div",d9,[e("button",{onClick:o[0]||(o[0]=(...n)=>t.clearReviewForm&&t.clearReviewForm(...n)),class:"btn btn-primary"},"Новый отзыв")])]),e("form",{onSubmit:o[5]||(o[5]=S((...n)=>t.submitForm&&t.submitForm(...n),["prevent"]))},[e("div",r9,[e("div",c9,[e("a",{href:"javascript:void(0)",class:"btn btn-link",onClick:o[1]||(o[1]=n=>t.need_load_users=!t.need_load_users)},[t.selected_bot_user==null?(l(),i("span",u9,"Выберите пользователя")):r("",!0),t.selected_bot_user?(l(),i("span",m9," Пользователь "+u(t.selected_bot_user.name||t.selected_bot_user.fio_from_telegram||t.selected_bot_user.telegram_chat_id||"-"),1)):r("",!0)])]),t.need_load_users?(l(),i("div",h9,[b(X,{simple:!0,onSelect:t.selectBotUser},null,8,["onSelect"])])):r("",!0),e("div",_9,[e("a",{href:"javascript:void(0)",class:"btn btn-link",onClick:o[2]||(o[2]=n=>t.need_schedule_time=!t.need_schedule_time)},[t.selected_schedule_time==null?(l(),i("span",p9,"Выберите время в расписании")):r("",!0),t.selected_schedule_time?(l(),i("span",b9," Запись на "+u(t.days[t.selected_schedule_time.day-1]||"-")+" с "+u(t.selected_schedule_time.start_time||"-")+" до "+u(t.selected_schedule_time.end_time||"-"),1)):r("",!0)])]),t.need_schedule_time?(l(),i("div",f9,[b(Se,{"event-id":s.eventId,bot:s.bot,onSelect:t.selectScheduleTime},null,8,["event-id","bot","onSelect"])])):r("",!0),e("div",g9,[e("p",null," Рейтинг: "+u(t.reviewForm.rating||0),1),b(j(ee),{modelValue:t.reviewForm.rating,"onUpdate:modelValue":o[3]||(o[3]=n=>t.reviewForm.rating=n)},null,8,["modelValue"])]),e("div",y9,[e("label",v9,[b(a,null,{content:y(()=>[k9]),default:y(()=>[$9]),_:1}),m(" Текст отзыва "),F9,t.reviewForm.text?(l(),i("small",w9," Длина текста "+u(t.reviewForm.text.length)+"/255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Текст отзыва","aria-label":"Текст отзыва","onUpdate:modelValue":o[4]||(o[4]=n=>t.reviewForm.text=n),maxlength:"255","aria-describedby":"review-text",required:""},`
                    `,512),[[_,t.reviewForm.text]])])]),e("div",C9,[e("div",S9,[e("button",j9,[t.reviewForm.id==null?(l(),i("span",V9,"Оставить отзыв")):(l(),i("span",q9,"Обновить отзыв"))])])])],32)],64)}}}),U9={class:"row"},A9={class:"col-12"},O9={key:0,class:"table"},I9=e("th",{scope:"col"},"Действие",-1),Q9=["onClick"],T9={scope:"row"},B9={class:"d-flex align-items-center"},M9={class:"ml-2"},R9={key:0,class:"dropdown"},D9=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),E9={class:"dropdown-menu"},L9={key:0},K9=["onClick"],N9={key:1},J9={class:"col-12"},H9={props:["bot","eventId"],components:{vue3starRatings:ee},data(){return{direction:"desc",order:"updated_at",show:!0,is_group:!1,loading:!0,reviews:[],search:null,paginate_object:null}},computed:{...C(["getAppointmentReviews","getAppointmentReviewsPaginateObject"])},mounted(){this.loadAppointmentReviews()},methods:{nextAppointmentReviews(s){this.loadAppointmentReviews(s)},selectReview(s){this.$emit("select",s)},loadAndOrder(s){this.order=s,this.direction=this.direction==="desc"?"asc":"desc",this.loadAppointmentReviews(0)},removeAppointmentReview(s){this.loading=!0,this.$store.dispatch("removeAppointmentReview",{dataObject:{appointmentReviewId:s}}).then(t=>{this.loadAppointmentReviews(0),this.$notify("Сервис успешно удален"),this.loading=!1}).catch(()=>{this.loading=!1,this.$notify("Ошибка удаления сервиса")})},loadAppointmentReviews(s=0){this.loading=!0,this.$store.dispatch("loadAppointmentReviews",{dataObject:{event_id:this.eventId,bot_id:this.bot.id||null,search:this.search,order:this.order,direction:this.direction},page:s,size:100}).then(t=>{this.loading=!1,this.reviews=this.getAppointmentReviews,this.paginate_object=this.getAppointmentReviewsPaginateObject}).catch(()=>{this.loading=!1})}}},G9=Object.assign(H9,{__name:"AppointmentReviewsTable",setup(s){return(t,o)=>(l(),i("div",U9,[e("div",A9,[t.reviews.length>0?(l(),i("table",O9,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:o[0]||(o[0]=a=>t.loadAndOrder("id"))},"#"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[1]||(o[1]=a=>t.loadAndOrder("bot_user_id"))},"Пользователь"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[2]||(o[2]=a=>t.loadAndOrder("rating"))},"Рейтинг"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[3]||(o[3]=a=>t.loadAndOrder("text"))},"Текст"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[4]||(o[4]=a=>t.loadAndOrder("updated_at"))},"Дата изменения"),I9])]),e("tbody",null,[(l(!0),i(g,null,$(t.reviews,(a,n)=>(l(),i("tr",{onClick:d=>t.selectReview(a),class:p({"border-info":a.deleted_at==null,"border-danger":a.deleted_at!=null})},[e("th",T9,u(a.id),1),e("td",null,u(a.botUser.fio_from_telegram||a.botUser.telegram_chat_id||"Не указано"),1),e("td",null,[e("p",B9,[b(j(ee),{disableClick:!0,modelValue:a.rating,"onUpdate:modelValue":d=>a.rating=d},null,8,["modelValue","onUpdate:modelValue"]),e("span",M9,u(a.rating||0),1)])]),e("td",null,u(a.text||"Не указано"),1),e("td",null,u(t.$filters.current(a.updated_at)),1),e("td",null,[a.id?(l(),i("div",R9,[D9,e("ul",E9,[a.deleted_at==null?(l(),i("li",L9,[e("a",{class:"dropdown-item",onClick:d=>t.removeAppointmentReview(a.id),href:"javascript:void(0)"},"Удалить",8,K9)])):r("",!0)])])):r("",!0)])],10,Q9))),256))])])):(l(),i("p",N9,"На текущий момент нет ни одного созданного отзыва"))]),e("div",J9,[t.paginate_object?(l(),v(V,{key:0,onPagination_page:t.nextAppointmentReviews,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])]))}}),Y9={key:0,class:"py-2"},W9={class:"row"},Z9={class:"col-12"},X9={key:1,class:"py-2"},x9={class:"row"},eS={class:"col-12"},tS={key:2,class:"py-2"},sS={class:"row"},oS={class:"col-12"},lS={class:"nav nav-tabs justify-content-center"},iS={key:0,class:"row py-3"},nS={class:"col-12"},aS={key:1,class:"row py-3"},dS={class:"col-12"},rS={class:"col-12 py-3"},cS=e("h4",null,"Доступные сервисы в событии",-1),uS={key:2,class:"row"},mS={class:"col-12"},hS={key:3,class:"row"},_S={class:"col-12"},pS={class:"col-12 py-3"},bS=e("h4",null,"Актуальные записи на событие",-1),fS={key:4,class:"row"},gS={class:"col-12"},yS={class:"col-12 py-3"},vS=e("h4",null,"Отзывы к событию",-1),$S={props:["bot"],data(){return{part:0,tab:0,loadTable:!1,loadService:!1,loadReviewForm:!1,loadAppointments:!1,loadReviews:!1,loadAppointmentForm:!1,loadForm:!1,selectedEvent:null,selectedService:null,selectedAppointment:null,selectedReview:null}},computed:{...C(["getAppointmentEvents","getAppointmentEventsPaginateObject"])},mounted(){},methods:{callbackForm(){this.loadTable=!0,this.$nextTick(()=>{this.loadTable=!1})},callbackAppointment(){this.loadAppointments=!0,this.$nextTick(()=>{this.loadAppointments=!1})},callbackReview(){this.loadReviews=!0,this.$nextTick(()=>{this.loadReviews=!1})},createEvent(){this.part=2},selectAppointment(s){this.loadAppointmentForm=!0,this.selectedAppointment=s,this.$nextTick(()=>{this.loadAppointmentForm=!1})},selectService(s){this.loadService=!0,this.selectedService=s,this.$nextTick(()=>{this.loadService=!1})},selectReview(s){this.loadReviewForm=!0,this.selectedReview=s,this.$nextTick(()=>{this.loadReviewForm=!1})},selectEvent(s){this.loadForm=!0,this.$nextTick(()=>{this.loadForm=!1,this.selectedEvent=s,this.part=1,this.tab=0})}}},kS=Object.assign($S,{__name:"Appointment",setup(s){return(t,o)=>(l(),i(g,null,[t.part===0?(l(),i("div",Y9,[e("div",W9,[e("div",Z9,[e("button",{type:"button",onClick:o[0]||(o[0]=(...a)=>t.createEvent&&t.createEvent(...a)),class:"btn btn-primary"}," Создать новое событие ")])]),t.loadTable?r("",!0):(l(),v(_8,{key:0,onSelect:t.selectEvent,bot:s.bot},null,8,["onSelect","bot"]))])):r("",!0),t.part===2?(l(),i("div",X9,[e("div",x9,[e("div",eS,[e("button",{type:"button",onClick:o[1]||(o[1]=a=>t.part=0),class:"btn btn-outline-primary"}," Назад ")])]),t.loadForm?r("",!0):(l(),v(ye,{key:0,onCallback:t.callbackForm,bot:s.bot},null,8,["onCallback","bot"]))])):r("",!0),t.part===1?(l(),i("div",tS,[e("div",sS,[e("div",oS,[e("button",{type:"button",onClick:o[2]||(o[2]=a=>t.part=0),class:"btn btn-outline-primary"}," Назад ")])]),e("ul",lS,[e("li",{class:"nav-item",onClick:o[3]||(o[3]=a=>t.tab=0)},[e("a",{class:p(["nav-link",{active:t.tab===0}]),"aria-current":"page",href:"javascript:void(0)"},"Информация о событии",2)]),e("li",{class:"nav-item",onClick:o[4]||(o[4]=a=>t.tab=1)},[e("a",{class:p(["nav-link",{active:t.tab===1}]),href:"javascript:void(0)"},"Сервисы в событии",2)]),e("li",{class:"nav-item",onClick:o[5]||(o[5]=a=>t.tab=2)},[e("a",{class:p(["nav-link",{active:t.tab===2}]),href:"javascript:void(0)"},"График",2)]),e("li",{class:"nav-item",onClick:o[6]||(o[6]=a=>t.tab=3)},[e("a",{class:p(["nav-link",{active:t.tab===3}]),href:"javascript:void(0)"},"Записи на событие",2)]),e("li",{class:"nav-item",onClick:o[7]||(o[7]=a=>t.tab=4)},[e("a",{class:p(["nav-link",{active:t.tab===4}]),href:"javascript:void(0)"},"Отзывы о событии",2)])]),t.tab===0?(l(),i("div",iS,[e("div",nS,[t.loadForm?r("",!0):(l(),v(ye,{key:0,onCallback:t.callbackForm,event:t.selectedEvent,bot:s.bot},null,8,["onCallback","event","bot"]))])])):r("",!0),t.tab===1?(l(),i("div",aS,[e("div",dS,[t.loadService?r("",!0):(l(),v(Wt,{key:0,service:t.selectedService,"event-id":t.selectedEvent.id,bot:s.bot},null,8,["service","event-id","bot"]))]),e("div",rS,[cS,b(P8,{"event-id":t.selectedEvent.id,onSelect:t.selectService,bot:s.bot},null,8,["event-id","onSelect","bot"])])])):r("",!0),t.tab===2?(l(),i("div",uS,[e("div",mS,[b(X7,{"event-id":t.selectedEvent.id,bot:s.bot},null,8,["event-id","bot"])])])):r("",!0),t.tab===3?(l(),i("div",hS,[e("div",_S,[t.loadAppointmentForm?r("",!0):(l(),v(P4,{key:0,bot:s.bot,onCallback:t.callbackAppointment,"event-id":t.selectedEvent.id,appointment:t.selectedAppointment},null,8,["bot","onCallback","event-id","appointment"]))]),e("div",pS,[bS,t.loadAppointments?r("",!0):(l(),v(H4,{key:0,"event-id":t.selectedEvent.id,onSelect:t.selectAppointment,bot:s.bot},null,8,["event-id","onSelect","bot"]))])])):r("",!0),t.tab===4?(l(),i("div",fS,[e("div",gS,[t.loadReviewForm?r("",!0):(l(),v(P9,{key:0,review:t.selectedReview,bot:s.bot,onCallback:o[8]||(o[8]=a=>t.callbackReview()),"event-id":t.selectedEvent.id},null,8,["review","bot","event-id"]))]),e("div",yS,[vS,t.loadReviews?r("",!0):(l(),v(G9,{key:0,bot:s.bot,onSelect:t.selectReview,"event-id":t.selectedEvent.id},null,8,["bot","onSelect","event-id"]))])])):r("",!0)])):r("",!0)],64))}}),FS={props:["param"],data(){return{htmlInjections:[{title:"Кнопка синяя",value:"<a href='http://test.com/test' class='w-100 btn btn-primary'>Текст кнопки</a>"},{title:"Кнопка без цвета",value:"<a href='http://test.com/test' class='w-100 btn btn-link'>Текст кнопки</a>"},{title:"Кнопка с синей обводкой",value:"<a href='http://test.com/test' class='w-100 btn btn-outline-primary'>Текст кнопки</a>"}]}},mounted(){},methods:{attachTo(s){this.$emit("callback",{param:this.param||null,value:s})}}},wS={class:"dropdown"},CS=e("button",{class:"btn btn-link dropdown-toggle",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"}," Кнопки ",-1),SS={class:"dropdown-menu"},jS=["onClick"],VS={class:"dropdown-item",href:"javascript:void(0)"};function qS(s,t,o,a,n,d){return l(),i("div",wS,[CS,e("ul",SS,[(l(!0),i(g,null,$(n.htmlInjections,h=>(l(),i("li",{onClick:f=>d.attachTo(h.value)},[e("a",VS,u(h.title||"Не указано"),1)],8,jS))),256))])])}const Z=A(FS,[["render",qS]]),zS={class:"row"},PS={class:"col-12 mb-3"},US={class:"form-label",id:"quiz-title"},AS=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),OS=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),IS={class:"col-12 mb-3"},QS={class:"form-check"},TS=e("label",{class:"form-check-label",for:"need_media"}," Нужен медиа-контент ",-1),BS={key:0,class:"col-12 mb-3"},MS={class:"form-label",id:"quiz-images"},RS=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),DS=e("div",null," Изображение, которое видит пользователь при выборе квиза ",-1),ES=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),LS={class:"col-12 mb-3"},KS={class:"form-label",id:"quiz-description"},NS=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),JS=e("div",null," Краткая информация о квизе ",-1),HS=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),GS={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},YS={class:"col-12 mb-3"},WS={class:"form-check"},ZS=e("label",{class:"form-check-label",for:"polling_mode"}," Квиз в режиме опроса (без команд и таймеров) ",-1),XS={key:1,class:"col-12 mb-3"},xS={class:"form-label",id:"quiz-time_limit"},ej=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),tj=e("div",null," Время на ответ ",-1),sj=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),oj={class:"col-12 mb-3"},lj={class:"form-check"},ij=e("label",{class:"form-check-label",for:"is-group"}," Показывать ответы по окончанию раунда ",-1),nj={class:"col-12 mb-3"},aj={class:"form-check"},dj=e("label",{class:"form-check-label",for:"is_active"}," Квиз виден пользователям ",-1),rj={key:2,class:"col-12 mb-3"},cj={class:"form-check"},uj=e("label",{class:"form-check-label",for:"round_mode"}," Использовать систему раундов ",-1),mj={class:"col-12 mb-3"},hj={class:"form-label",id:"quiz-time_limit"},_j=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),pj=e("div",null," Число попыток прохождения квиза ",-1),bj=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),fj={class:"col-12 mb-3"},gj={class:"form-label",id:"quiz-time_limit"},yj=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),vj=e("div",null," Сколько % нужно ответить чтоб пройти ",-1),$j=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),kj={class:"row"},Fj={class:"col-12 py-2"},wj={class:"col-12 mb-3"},Cj={class:"row"},Sj={class:"col-10"},jj={class:"d-flex justify-content-between"},Vj={class:"form-label",id:"quiz-success_message"},qj=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),zj=e("div",null," Текст в случае успешного прохождения квиза ",-1),Pj=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Uj={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},Aj=["onUpdate:modelValue"],Oj={class:"col-2 d-flex align-items-center justify-content-center"},Ij=["disabled","onClick"],Qj={class:"row"},Tj={class:"col-12 mb-2"},Bj={class:"form-check"},Mj=e("label",{class:"form-check-label",for:"need_inline_menu_on_success"}," Меню под текстом страницы при выигрыше ",-1),Rj={key:0,class:"col-12 mb-2"},Dj={class:"card"},Ej={class:"card-header d-flex justify-between align-items-center"},Lj=e("h6",null,"Конструктор меню в сообщении",-1),Kj={key:0},Nj={key:1},Jj={class:"card-body"},Hj={class:"row"},Gj={class:"col-12 py-2"},Yj={class:"col-12 mb-3"},Wj={class:"row"},Zj={class:"col-10"},Xj={class:"d-flex justify-content-between"},xj=["id"],eV=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),tV=e("div",null," Текст в случае неудачного прохождения квиза ",-1),sV=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),oV={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},lV=["onUpdate:modelValue"],iV={class:"col-2 d-flex align-items-center justify-content-center"},nV=["disabled","onClick"],aV={class:"row"},dV={class:"col-12 mb-2"},rV={class:"form-check"},cV=e("label",{class:"form-check-label",for:"need_template_selector_on_failure"}," Меню под текстом страницы при проигрыше ",-1),uV={key:0,class:"col-12 mb-2"},mV={class:"card"},hV={class:"card-header d-flex justify-between align-items-center"},_V=e("h6",null,"Конструктор меню в сообщении",-1),pV={key:0},bV={key:1},fV={class:"card-body"},gV={class:"row"},yV={class:"col-12 mb-3"},vV={class:"form-floating"},$V=["value","selected"],kV=e("label",{for:"quiz-display-type"},"Тип вывода вопросов",-1),FV={class:"row"},wV={class:"col-12"},CV={type:"submit",class:"btn btn-outline-success w-100 p-3"},SV={key:0},jV={key:1},VV={props:["quiz","bot"],data(){return{step:0,load:!1,need_reset:!1,need_services:!1,need_media:!1,need_inline_menu_on_success:!1,need_template_selector_on_success:!1,need_template_selector_on_failure:!1,need_inline_menu_on_failure:!1,types:["По порядку","Перемешать всё","Перемешать ответы","Перемешать вопросы"],quizForm:{id:null,title:null,image:null,description:null,completed_at:null,start_at:null,end_at:null,display_type:0,time_limit:30,show_answers:!1,polling_mode:!1,round_mode:!0,is_active:!1,try_count:1,success_percent:50,success_message:["Задание успешно пройдено!"],failure_message:["К сожалению вы не прошли задание!"],success_inline_keyboard_id:null,success_inline_keyboard:null,failure_inline_keyboard_id:null,failure_inline_keyboard:null}}},watch:{quizForm:{handler(s){this.need_reset=!0},deep:!0},"quizForm.polling_mode":{handler(s){this.quizForm.round_mode=!1},deep:!0}},mounted(){this.quiz&&this.$nextTick(()=>{this.quizForm={id:this.quiz.id||null,title:this.quiz.title||null,image:this.quiz.image||null,description:this.quiz.description||null,completed_at:this.quiz.completed_at?this.$filters.currentFull(this.quiz.completed_at):null,start_at:this.quiz.start_at?this.$filters.currentFull(this.quiz.start_at):null,end_at:this.quiz.end_at?this.$filters.currentFull(this.quiz.end_at):null,display_type:this.quiz.display_type||0,time_limit:this.quiz.time_limit||30,show_answers:this.quiz.show_answers||!1,polling_mode:this.quiz.polling_mode||!1,round_mode:this.quiz.round_mode||!1,is_active:this.quiz.is_active||!1,try_count:this.quiz.try_count||1,success_inline_keyboard_id:this.quiz.success_inline_keyboard_id||null,success_inline_keyboard:this.quiz.success_inline_keyboard||null,failure_inline_keyboard_id:this.quiz.failure_inline_keyboard_id||null,failure_inline_keyboard:this.quiz.failure_inline_keyboard||null,success_percent:this.quiz.success_percent||50,success_message:this.quiz.success_message||["Задание успешно пройдено!"],failure_message:this.quiz.failure_message||["К сожалению вы не прошли задание!"]},this.quizForm.success_inline_keyboard&&(this.need_inline_menu_on_success=!0),this.quizForm.failure_inline_keyboard&&(this.need_inline_menu_on_failure=!0)})},methods:{selectInlineKeyboardOnSuccess(s){this.quizForm.success_inline_keyboard=s,this.need_template_selector_on_success=!1},selectInlineKeyboardOnFailure(s){this.quizForm.failure_inline_keyboard=s,this.need_template_selector_on_failure=!1},attachTo(s,t){this.quizForm[s.param][t]==null?this.quizForm[s.param][t]=s.value:this.quizForm[s.param][t]+=s.value},selectPhoto(s){this.quizForm.image=s.file_id},removeMessage(s,t){this.quizForm[s||"success_message"].splice(t,1)},addMessage(s,t){this.quizForm[s||"success_message"].push(t)},submitForm(){let s=new FormData;Object.keys(this.quizForm).forEach(t=>{const o=this.quizForm[t]||"";typeof o=="object"?s.append(t,JSON.stringify(o)):s.append(t,o)}),s.append("bot_id",this.bot.id),this.$store.dispatch("storeQuiz",{quizForm:s}).then(t=>{this.quizForm={id:null,title:null,image:null,description:null,completed_at:null,start_at:null,end_at:null,display_type:0,time_limit:30,show_answers:!1,polling_mode:!1,round_mode:!1,is_active:!1,try_count:1,success_percent:50,success_inline_keyboard_id:null,success_inline_keyboard:null,failure_inline_keyboard_id:null,failure_inline_keyboard:null,success_message:["Задание успешно пройдено!"],failure_message:["К сожалению вы не прошли задание!"]},this.$emit("callback",t.data),this.$notify("Событие успешно создано")}).catch(t=>{this.$notify("Ошибка создания события")})}}},$e=Object.assign(VV,{__name:"QuizForm",setup(s){return(t,o)=>{const a=P("Popper");return l(),i("form",{onSubmit:o[19]||(o[19]=S((...n)=>t.submitForm&&t.submitForm(...n),["prevent"])),class:"py-3"},[e("div",zS,[e("div",PS,[e("label",US,[b(a,{content:"Название вашего квиза"},{default:y(()=>[AS]),_:1}),m(" Название квиза "),OS]),c(e("input",{type:"text",class:"form-control",placeholder:"Название","aria-label":"Название","onUpdate:modelValue":o[0]||(o[0]=n=>t.quizForm.title=n),maxlength:"255","aria-describedby":"quiz-title",required:""},null,512),[[_,t.quizForm.title]])]),e("div",IS,[e("div",QS,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[1]||(o[1]=n=>t.need_media=n),type:"checkbox",id:"need_media"},null,512),[[k,t.need_media]]),TS])]),t.need_media?(l(),i("div",BS,[e("label",MS,[b(a,null,{content:y(()=>[DS]),default:y(()=>[RS]),_:1}),m(" Изображение к квизу "),ES]),b(U,{"need-photo":!0,selected:t.quizForm.image,onSelect:t.selectPhoto},null,8,["selected","onSelect"])])):r("",!0),e("div",LS,[e("label",KS,[b(a,null,{content:y(()=>[JS]),default:y(()=>[NS]),_:1}),m(" Описание события "),HS,t.quizForm.description?(l(),i("small",GS," Длина текста "+u(t.quizForm.description.length)+"/255",1)):r("",!0)]),c(e("textarea",{class:"form-control",placeholder:"Описание мероприятия","aria-label":"Описание мероприятия",maxlength:"255","onUpdate:modelValue":o[2]||(o[2]=n=>t.quizForm.description=n),"aria-describedby":"quiz-description",required:""},`
                    `,512),[[_,t.quizForm.description]])]),e("div",YS,[e("div",WS,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[3]||(o[3]=n=>t.quizForm.polling_mode=n),type:"checkbox",id:"polling_mode"},null,512),[[k,t.quizForm.polling_mode]]),ZS])]),t.quizForm.polling_mode?r("",!0):(l(),i("div",XS,[e("label",xS,[b(a,null,{content:y(()=>[tj]),default:y(()=>[ej]),_:1}),m(" Лимит времени на ответ в секундах "),sj]),c(e("input",{type:"number",class:"form-control",placeholder:"Лимит времени на ответ","aria-label":"Лимит времени на ответ",step:"0.1",min:"0","onUpdate:modelValue":o[4]||(o[4]=n=>t.quizForm.time_limit=n),"aria-describedby":"quiz-time_limit",required:""},null,512),[[_,t.quizForm.time_limit]])])),e("div",oj,[e("div",lj,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[5]||(o[5]=n=>t.quizForm.show_answers=n),type:"checkbox",id:"is-group"},null,512),[[k,t.quizForm.show_answers]]),ij])]),e("div",nj,[e("div",aj,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[6]||(o[6]=n=>t.quizForm.is_active=n),type:"checkbox",id:"is_active"},null,512),[[k,t.quizForm.is_active]]),dj])]),t.quizForm.polling_mode?r("",!0):(l(),i("div",rj,[e("div",cj,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[7]||(o[7]=n=>t.quizForm.round_mode=n),type:"checkbox",id:"round_mode"},null,512),[[k,t.quizForm.round_mode]]),uj])])),e("div",mj,[e("label",hj,[b(a,null,{content:y(()=>[pj]),default:y(()=>[_j]),_:1}),m(" Количество попыток "),bj]),c(e("input",{type:"number",class:"form-control",placeholder:"Число попыток","aria-label":"Число попыток",step:"1",min:"1","onUpdate:modelValue":o[8]||(o[8]=n=>t.quizForm.try_count=n),"aria-describedby":"quiz-try_count",required:""},null,512),[[_,t.quizForm.try_count]])]),e("div",fj,[e("label",gj,[b(a,null,{content:y(()=>[vj]),default:y(()=>[yj]),_:1}),m(" % для прохождения "),$j]),c(e("input",{type:"number",class:"form-control",placeholder:"Процент для победы","aria-label":"Процент для победы",step:"1",min:"0","onUpdate:modelValue":o[9]||(o[9]=n=>t.quizForm.success_percent=n),"aria-describedby":"quiz-success_percent",required:""},null,512),[[_,t.quizForm.success_percent]])])]),e("div",kj,[e("div",Fj,[e("button",{class:"btn btn-outline-info rounded-5",type:"button",onClick:o[10]||(o[10]=n=>t.addMessage("success_message",null))},"Добавить еще вариант текста ")]),(l(!0),i(g,null,$(t.quizForm.success_message,(n,d)=>(l(),i("div",wj,[e("div",Cj,[e("div",Sj,[e("div",jj,[e("label",Vj,[b(a,null,{content:y(()=>[zj]),default:y(()=>[qj]),_:1}),m(" Текст при победе "),Pj,t.quizForm.success_message[d]?(l(),i("small",Uj," Длина текста "+u(t.quizForm.success_message[d].length)+"/255",1)):r("",!0)]),b(Z,{param:"success_message",onCallback:h=>t.attachTo(h,d)},null,8,["onCallback"])]),c(e("textarea",{class:"form-control",placeholder:"Текст при победе","aria-label":"Текст при победе",maxlength:"255","onUpdate:modelValue":h=>t.quizForm.success_message[d]=h,"aria-describedby":"quiz-success_message",required:""},`
                    `,8,Aj),[[_,t.quizForm.success_message[d]]])]),e("div",Oj,[e("button",{class:"btn btn-outline-danger",disabled:t.quizForm.success_message.length<=1,onClick:h=>t.removeMessage("success_message",d)},"Удалить ",8,Ij)])])]))),256))]),e("div",Qj,[e("div",Tj,[e("div",Bj,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[11]||(o[11]=n=>t.need_inline_menu_on_success=n),type:"checkbox",id:"need_inline_menu_on_success"},null,512),[[k,t.need_inline_menu_on_success]]),Mj])]),t.need_inline_menu_on_success?(l(),i("div",Rj,[e("div",Dj,[e("div",Ej,[Lj,e("button",{class:p(["btn",{"btn-outline-primary":!t.need_template_selector_on_success,"btn-primary":t.need_template_selector_on_success}]),type:"button",onClick:o[12]||(o[12]=n=>t.need_template_selector_on_success=!t.need_template_selector_on_success)},[t.need_template_selector_on_success?(l(),i("span",Nj," Скрыть шаблоны меню")):(l(),i("span",Kj," Открыть шаблоны меню"))],2)]),e("div",Jj,[t.need_template_selector_on_success?(l(),v(E,{key:0,class:"mb-2",type:"inline",onSelect:t.selectInlineKeyboardOnSuccess,"select-mode":!0},null,8,["onSelect"])):(l(),v(I,{key:1,type:"inline",modelValue:t.quizForm.success_inline_keyboard,"onUpdate:modelValue":o[13]||(o[13]=n=>t.quizForm.success_inline_keyboard=n)},null,8,["modelValue"]))])])])):r("",!0)]),e("div",Hj,[e("div",Gj,[e("button",{class:"btn btn-outline-info rounded-5",type:"button",onClick:o[14]||(o[14]=n=>t.addMessage("failure_message",null))},"Добавить еще вариант текста ")]),(l(!0),i(g,null,$(t.quizForm.failure_message,(n,d)=>(l(),i("div",Yj,[e("div",Wj,[e("div",Zj,[e("div",Xj,[e("label",{class:"form-label",id:"quiz-failure_message"+d},[b(a,null,{content:y(()=>[tV]),default:y(()=>[eV]),_:1}),m(" Текст при проигрыше "),sV,t.quizForm.failure_message[d]?(l(),i("small",oV," Длина текста "+u(t.quizForm.failure_message[d].length)+"/255",1)):r("",!0)],8,xj),b(Z,{param:"failure_message",onCallback:h=>t.attachTo(h,d)},null,8,["onCallback"])]),c(e("textarea",{class:"form-control",placeholder:"Текст при проигрыше","aria-label":"Текст при проигрыше",maxlength:"255","onUpdate:modelValue":h=>t.quizForm.failure_message[d]=h,"aria-describedby":"quiz-success_message",required:""},`
                    `,8,lV),[[_,t.quizForm.failure_message[d]]])]),e("div",iV,[e("button",{class:"btn btn-outline-danger",disabled:t.quizForm.failure_message.length<=1,onClick:h=>t.removeMessage("failure_message",d)},"Удалить ",8,nV)])])]))),256))]),e("div",aV,[e("div",dV,[e("div",rV,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[15]||(o[15]=n=>t.need_inline_menu_on_failure=n),type:"checkbox",id:"need_template_selector_on_failure"},null,512),[[k,t.need_inline_menu_on_failure]]),cV])]),t.need_inline_menu_on_failure?(l(),i("div",uV,[e("div",mV,[e("div",hV,[_V,e("button",{class:p(["btn",{"btn-outline-primary":!t.need_template_selector_on_failure,"btn-primary":t.need_template_selector_on_failure}]),type:"button",onClick:o[16]||(o[16]=n=>t.need_template_selector_on_failure=!t.need_template_selector_on_failure)},[t.need_template_selector_on_failure?(l(),i("span",bV," Скрыть шаблоны меню")):(l(),i("span",pV," Открыть шаблоны меню"))],2)]),e("div",fV,[t.need_template_selector_on_failure?(l(),v(E,{key:0,class:"mb-2",type:"inline",onSelect:t.selectInlineKeyboardOnFailure,"select-mode":!0},null,8,["onSelect"])):(l(),v(I,{key:1,type:"inline",modelValue:t.quizForm.failure_inline_keyboard,"onUpdate:modelValue":o[17]||(o[17]=n=>t.quizForm.failure_inline_keyboard=n)},null,8,["modelValue"]))])])])):r("",!0)]),e("div",gV,[e("div",yV,[e("div",vV,[c(e("select",{class:"form-select","onUpdate:modelValue":o[18]||(o[18]=n=>t.quizForm.display_type=n),id:"quiz-display-type","aria-label":"quiz-display-type"},[(l(!0),i(g,null,$(t.types,(n,d)=>(l(),i("option",{value:d,selected:d==t.quizForm.display_type},u(n),9,$V))),256))],512),[[B,t.quizForm.display_type]]),kV])])]),e("div",FV,[e("div",wV,[e("button",CV,[t.quizForm.id==null?(l(),i("span",SV,"Создать квиз")):(l(),i("span",jV,"Обновить квиз"))])])])],32)}}}),qV={class:"row py-2"},zV={class:"col-12"},PV={class:"input-group mb-3"},UV={class:"col-12"},AV={key:0,class:"table"},OV=e("th",{scope:"col"},"Число вопросов",-1),IV=e("th",{scope:"col"},"Число команд",-1),QV=e("th",{scope:"col"},"Действие",-1),TV={scope:"row"},BV=["onClick"],MV={key:0,style:{width:"50px",height:"50px"},alt:""},RV={key:1},DV={key:0,class:"mb-0"},EV={key:1},LV={key:0,class:"mb-0"},KV={key:1},NV={key:0,class:"mb-0"},JV={key:1},HV={key:0,class:"fa-solid fa-chevron-down text-success"},GV={key:1,class:"fa-solid fa-xmark text-danger"},YV={key:0,class:"fa-solid fa-chevron-down text-success"},WV={key:1,class:"fa-solid fa-xmark text-danger"},ZV={key:0,class:"dropdown"},XV=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),xV={class:"dropdown-menu"},eq={key:0},tq=["onClick"],sq={key:1},oq=e("div",{class:"alert alert-warning alert-dismissible fade show",role:"alert"},[e("strong",null,"Внимание!"),m(" Вы еще не добавили ни одного квиза! "),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"alert","aria-label":"Close"})],-1),lq={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},iq={class:"d-flex justify-content-center mb-3"},nq={alt:"",width:"100",height:"100"},aq=e("h1",{class:"text-body-emphasis"},"Создание Квиза",-1),dq=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"}," Квиз - это игра. Создавайте игры и делитесь с клиентами ссылкой на игру. Формируйте команды, начисляйте баллы, меняйте баллы на вкусные призы. Всё в ваших руках. ",-1),rq={class:"d-inline-flex gap-2 mb-5"},cq=e("a",{href:"https://telegra.ph/Sozdanie-Kviza-01-13",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),uq={key:0,class:"col-12"},mq={props:["bot"],data(){return{direction:"desc",order:"updated_at",show:!0,loading:!0,quizzes:[],search:null,paginate_object:null}},computed:{...C(["getQuizzes","getQuizzesPaginateObject"])},mounted(){this.loadQuizzes()},methods:{removeQuiz(s){this.loading=!0,this.$store.dispatch("removeQuiz",{quizId:s}).then(t=>{this.loading=!1,this.loadQuizzes(0),this.$notify("Событие успешно удалено")}).catch(()=>{this.loading=!1,this.$notify("Ошибка удаления события")})},createQuiz(){this.$emit("create")},nextQuizzes(s){this.loadQuizzes(s)},selectEvent(s){this.$emit("select",s)},loadAndOrder(s){this.order=s,this.direction=this.direction==="desc"?"asc":"desc",this.loadQuizzes(0)},loadQuizzes(s=0){this.loading=!0,this.$store.dispatch("loadQuizzes",{dataObject:{bot_id:this.bot.id||null,search:this.search,order:this.order,direction:this.direction},page:s,size:20}).then(t=>{this.loading=!1,this.quizzes=this.getQuizzes,this.paginate_object=this.getQuizzesPaginateObject}).catch(()=>{this.loading=!1})}}},hq=Object.assign(mq,{__name:"QuizTable",setup(s){return(t,o)=>{const a=T("lazy");return l(),i("div",qV,[e("div",zV,[e("div",PV,[c(e("input",{type:"search",class:"form-control",placeholder:"Поиск квиза","aria-label":"Поиск квиза","onUpdate:modelValue":o[0]||(o[0]=n=>t.search=n),"aria-describedby":"quiz-search-quiz"},null,512),[[_,t.search]]),e("button",{class:"btn btn-outline-secondary",onClick:o[1]||(o[1]=n=>t.loadQuizzes(0)),type:"button",id:"quiz-search-quiz"},"Найти ")])]),e("div",UV,[t.quizzes.length>0?(l(),i("table",AV,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:o[2]||(o[2]=n=>t.loadAndOrder("id"))},"#"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[3]||(o[3]=n=>t.loadAndOrder("title"))},"Название"),OV,IV,e("th",{scope:"col",class:"cursor-pointer",onClick:o[4]||(o[4]=n=>t.loadAndOrder("image"))},"Изображение к квизу"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[5]||(o[5]=n=>t.loadAndOrder("description"))},"Описание"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[6]||(o[6]=n=>t.loadAndOrder("completed_at"))},"Квиз пройден"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[7]||(o[7]=n=>t.loadAndOrder("start_at"))},"Дата и время начала"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[8]||(o[8]=n=>t.loadAndOrder("end_at"))},"Дата и время завершения"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[9]||(o[9]=n=>t.loadAndOrder("display_type"))},"Тип отображения"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[10]||(o[10]=n=>t.loadAndOrder("show_answers"))},"Показывать ответы по окончанию раунда "),e("th",{scope:"col",class:"cursor-pointer",onClick:o[11]||(o[11]=n=>t.loadAndOrder("is_active"))},"Активный "),e("th",{scope:"col",class:"cursor-pointer",onClick:o[12]||(o[12]=n=>t.loadAndOrder("updated_at"))},"Дата изменения"),QV])]),e("tbody",null,[(l(!0),i(g,null,$(t.quizzes,(n,d)=>(l(),i("tr",{class:p({"border-info":n.deleted_at==null,"border-danger":n.deleted_at!=null})},[e("th",TV,u(n.id),1),e("td",{onClick:h=>t.selectEvent(n)},u(n.title||"Не указано"),9,BV),e("td",null,u((n.questions||[]).length),1),e("td",null,u((n.commands||[]).length),1),e("td",null,[n.image!=null?c((l(),i("img",MV,null,512)),[[a,"/file-by-file-id/"+n.image]]):(l(),i("p",RV,"не указано"))]),e("td",null,u(n.description||"Не указано"),1),e("td",null,[n.completed_at?(l(),i("p",DV,u(t.$filters.currentFull(n.completed_at)),1)):(l(),i("p",EV,"Не задано"))]),e("td",null,[n.start_at?(l(),i("p",LV,u(t.$filters.currentFull(n.start_at)),1)):(l(),i("p",KV,"Не задано"))]),e("td",null,[n.end_at?(l(),i("p",NV,u(t.$filters.currentFull(n.end_at)),1)):(l(),i("p",JV,"Не задано"))]),e("td",null,u(n.display_type),1),e("td",null,u(n.time_limit),1),e("td",null,[n.show_answers?(l(),i("i",HV)):(l(),i("i",GV))]),e("td",null,[n.is_active?(l(),i("i",YV)):(l(),i("i",WV))]),e("td",null,u(t.$filters.current(n.updated_at)),1),e("td",null,[n.id?(l(),i("div",ZV,[XV,e("ul",xV,[n.deleted_at==null?(l(),i("li",eq,[e("a",{class:"dropdown-item",onClick:h=>t.removeQuiz(n.id),href:"javascript:void(0)"},"Удалить",8,tq)])):r("",!0)])])):r("",!0)])],2))),256))])])):(l(),i("div",sq,[oq,e("div",lq,[e("div",iq,[c(e("img",nq,null,512),[[a,"../images/icon.png"]])]),aq,dq,e("div",rq,[e("button",{onClick:o[13]||(o[13]=(...n)=>t.createQuiz&&t.createQuiz(...n)),class:"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill btn-primary",type:"button"}," Добавить "),cq])])]))]),t.quizzes.length>0?(l(),i("div",uq,[t.paginate_object?(l(),v(V,{key:0,onPagination_page:t.nextQuizzes,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])):r("",!0)])}}}),_q={props:{type:String,value:String}},pq={class:"d-flex mb-2"},bq={class:"form-floating mb-3"},fq=["value"],gq=e("label",{for:"custom-url-link-for-success"},"Ссылка на файл",-1);function yq(s,t,o,a,n,d){return l(),i(g,null,[e("div",pq,[e("span",{class:p(["badge bg-secondary cursor-pointer mr-1",{"bg-success":o.type=="video"}]),onClick:t[0]||(t[0]=h=>s.$emit("update:type","video"))},"Видео",2),e("span",{class:p(["badge bg-secondary cursor-pointer mr-1",{"bg-success":o.type=="video_note"}]),onClick:t[1]||(t[1]=h=>s.$emit("update:type","video_note"))},"Кружок",2),e("span",{class:p(["badge bg-secondary cursor-pointer mr-1",{"bg-success":o.type=="photo"}]),onClick:t[2]||(t[2]=h=>s.$emit("update:type","photo"))},"Изображение",2),e("span",{class:p(["badge bg-secondary cursor-pointer mr-1",{"bg-success":o.type=="audio"}]),onClick:t[3]||(t[3]=h=>s.$emit("update:type","audio"))},"Звук",2)]),e("div",bq,[e("input",{type:"text",class:"form-control",value:o.value,onInput:t[4]||(t[4]=h=>s.$emit("update:value",h.target.value)),id:"custom-url-link-for-success",placeholder:"https://...."},null,40,fq),gq])],64)}const oe=A(_q,[["render",yq]]),vq={class:"row py-3"},$q={class:"col-12"},kq={class:"row"},Fq={class:"col-12 mb-3"},wq={key:0},Cq=["onClick"],Sq={class:"form-label",id:"quiz-round"},jq=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Vq=e("div",null," Раунд, в котором будет отображен вопрос ",-1),qq=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),zq={class:"col-12 mb-3"},Pq={class:"form-label",id:"event-on_after_appointment"},Uq=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Aq=e("div",null," Текст вопроса ",-1),Oq=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Iq={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},Qq={class:"col-12 mb-3"},Tq={class:"form-check"},Bq=e("label",{class:"form-check-label",for:"need_media"}," Нужен медиа-контент ",-1),Mq={key:0,class:"col-12 mb-3"},Rq={class:"form-label",id:"quiz-images"},Dq=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Eq=e("div",null," Изображение, видео, аудио сопровождение вопроса ",-1),Lq={key:0,class:"badge rounded-pill text-bg-info m-0"},Kq=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Nq=e("h6",null,"Вставьте ссылку на контент...",-1),Jq=e("h6",null,"...или выберите из доступных",-1),Hq={class:"col-12 mb-3"},Gq={class:"form-check"},Yq=e("label",{class:"form-check-label",for:"is_multiply"}," Множественные ответы ",-1),Wq={class:"col-12 mb-3"},Zq={class:"form-check"},Xq=e("label",{class:"form-check-label",for:"is_open"}," Открытый вопрос ",-1),xq={class:"col-12 mb-3"},ez={class:"d-flex justify-content-between"},tz={class:"form-label",id:"quiz-description"},sz=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),oz=e("div",null," Текст при выборе правильного ответа ",-1),lz=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),iz={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},nz={class:"col-12 mb-3"},az={class:"form-check"},dz=e("label",{class:"form-check-label",for:"need_media_for_success"}," Нужен медиа-контент при правильном ответе ",-1),rz={key:1,class:"col-12 mb-3"},cz=e("h6",null,"Вставьте ссылку на контент...",-1),uz=e("h6",null,"...или выберите из доступных",-1),mz={class:"col-12 mb-3"},hz={class:"d-flex justify-content-between"},_z={class:"form-label",id:"quiz-description"},pz=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),bz=e("div",null," Текст в выбора неправильного ответа ",-1),fz=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),gz={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},yz={class:"col-12 mb-3"},vz={class:"form-check"},$z=e("label",{class:"form-check-label",for:"need_media_for_failed"}," Нужен медиа-контент при неправильном ответе ",-1),kz={key:2,class:"col-12 mb-3"},Fz=e("h6",null,"Вставьте ссылку на контент...",-1),wz=e("h6",null,"...или выберите из доступных",-1),Cz={class:"row"},Sz={class:"col-12"},jz={class:"col-12"},Vz={key:0,class:"table"},qz=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"#"),e("th",{scope:"col"},"Текст вопроса"),e("th",{scope:"col"},"Баллы"),e("th",{scope:"col"},"Контент"),e("th",{scope:"col"},"Тип контента"),e("th",{scope:"col"},"Является верным"),e("th",{scope:"col"},"Действие")])],-1),zz={scope:"row"},Pz={class:"form-floating mb-3"},Uz=["onUpdate:modelValue","id"],Az=["for"],Oz={class:"form-floating mb-3"},Iz=["onUpdate:modelValue","id"],Qz=["for"],Tz=["onClick"],Bz={class:"form-check"},Mz=["onUpdate:modelValue","id"],Rz=["for"],Dz={class:"dropdown"},Ez=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),Lz={class:"dropdown-menu"},Kz={key:0},Nz=["onClick"],Jz={key:1},Hz=["onClick"],Gz={key:1},Yz={class:"row"},Wz={class:"col-12"},Zz={type:"submit",class:"btn btn-outline-success w-100 p-3"},Xz={key:0},xz={key:1},eP={class:"modal fade",id:"chooseMediaContent",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},tP={class:"modal-dialog"},sP={class:"modal-content"},oP={key:0,class:"modal-body"},lP=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),iP={class:"modal fade",id:"chooseSuccessMediaContent",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},nP={class:"modal-dialog"},aP={class:"modal-content"},dP={class:"modal-body"},rP=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),cP={class:"modal fade",id:"chooseFailureMediaContent",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},uP={class:"modal-dialog"},mP={class:"modal-content"},hP={class:"modal-body"},_P=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),pP={class:"modal fade",id:"chooseBaseMediaContent",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},bP={class:"modal-dialog"},fP={class:"modal-content"},gP={class:"modal-body"},yP=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),vP={props:["quizId","bot","question"],data(){return{step:0,load:!1,selectedQuestionIndex:null,need_media:!1,need_media_for_success:!1,need_media_for_failed:!1,rounds:[],questionForm:{id:null,text:null,round:null,media_content:null,content_type:null,is_multiply:!1,is_open:!1,answers:[],success_message:null,failure_message:null,success_media_content:null,failure_media_content:null,success_media_content_type:null,failure_media_content_type:null}}},watch:{questionForm:{handler(s){this.need_reset=!0},deep:!0},need_media:function(s,t){this.need_page_images||(this.questionForm.media_content=null,this.questionForm.content_type=null)},need_media_for_success:function(s,t){this.need_page_images||(this.questionForm.success_media_content=null,this.questionForm.success_media_content_type=null)},need_media_for_failed:function(s,t){this.need_page_images||(this.questionForm.failure_media_content=null,this.questionForm.failure_media_content_type=null)}},mounted(){this.loadQuizRounds(),this.question&&(this.question.media_content!=null&&(this.need_media=!0),this.question.success_media_content!=null&&(this.need_media_for_success=!0),this.question.failure_media_content!=null&&(this.need_media_for_failed=!0),this.$nextTick(()=>{this.questionForm={id:this.question.id||null,text:this.question.text||null,round:this.question.round||null,media_content:this.question.media_content||null,content_type:this.question.content_type||null,is_multiply:this.question.is_multiply||!1,is_open:this.question.is_open||!1,answers:this.question.answers||[],success_message:this.question.success_message||null,failure_message:this.question.failure_message||null,success_media_content:this.question.success_media_content||null,failure_media_content:this.question.failure_media_content||null,success_media_content_type:this.question.success_media_content_type||null,failure_media_content_type:this.question.failure_media_content_type||null}}))},methods:{attachTo(s){this.questionForm[s.param]==null?this.questionForm[s.param]=s.value:this.questionForm[s.param]+=s.value},loadQuizRounds(){this.$store.dispatch("loadQuizRounds",{dataObject:{bot_id:this.bot.id||null,quiz_id:this.quizId||null}}).then(s=>{this.rounds=s})},chooseBaseMediaContent(s){new bootstrap.Modal(document.getElementById("chooseBaseMediaContent"),{}).show()},chooseSuccessMediaContent(s){new bootstrap.Modal(document.getElementById("chooseSuccessMediaContent"),{}).show()},chooseFailureMediaContent(s){new bootstrap.Modal(document.getElementById("chooseFailureMediaContent"),{}).show()},chooseMediaContent(s){this.selectedQuestionIndex=null,this.$nextTick(()=>{this.selectedQuestionIndex=s}),new bootstrap.Modal(document.getElementById("chooseMediaContent"),{}).show()},selectMediaForFailure(s){this.questionForm.failure_media_content=s.file_id,this.questionForm.failure_media_content_type=s.type},selectMediaForSuccess(s){this.questionForm.success_media_content=s.file_id,this.questionForm.success_media_content_type=s.type},selectMediaForAnswer(s){this.questionForm.answers[this.selectedQuestionIndex].media_content=s.file_id,this.questionForm.answers[this.selectedQuestionIndex].content_type=s.type},selectMedia(s){this.questionForm.media_content=s.file_id,this.questionForm.content_type=s.type},clearQuestionForm(){this.questionForm={id:null,text:null,round:null,media_content:null,content_type:null,is_multiply:!1,is_open:!1,answers:[],success_message:null,failure_message:null,success_media_content:null,failure_media_content:null,success_media_content_type:null,failure_media_content_type:null}},addNewAnswer(){this.questionForm.answers.push({text:null,media_content:null,content_type:null,is_right_answer:!1,points:0})},removeAnswerFromArray(s){this.questionForm.answers.splice(s,1)},removeAnswer(s){this.$store.dispatch("removeQuizAnswer",{quizAnswerId:s}).then(t=>{this.$notify("Вопрос успешно удален");let o=this.questionForm.answers.findIndex(a=>a.id==s);this.questionForm.answers.splice(o,1)}).catch(t=>{this.$notify("Ошибка удаления вопроса")})},submitForm(){let s=new FormData;Object.keys(this.questionForm).forEach(t=>{const o=this.questionForm[t]||"";typeof o=="object"?s.append(t,JSON.stringify(o)):s.append(t,o)}),s.append("bot_id",this.bot.id),s.append("quiz_id",this.quizId),this.$store.dispatch("storeQuizQuestion",{quizQuestionForm:s}).then(t=>{this.$emit("callback",t.data),this.$notify("Вопрос успешно создан"),this.clearQuestionForm(),this.loadQuizRounds()}).catch(t=>{this.$notify("Ошибка создания вопроса")})}}},$P=Object.assign(vP,{__name:"QuizQuestionForm",setup(s){return(t,o)=>{const a=P("Popper");return l(),i(g,null,[e("div",vq,[e("div",$q,[e("button",{onClick:o[0]||(o[0]=(...n)=>t.clearQuestionForm&&t.clearQuestionForm(...n)),class:"btn btn-primary"},"Новый вопрос ")])]),e("form",{onSubmit:o[20]||(o[20]=S((...n)=>t.submitForm&&t.submitForm(...n),["prevent"]))},[e("div",kq,[e("div",Fq,[t.rounds.length>0?(l(),i("p",wq,[m(" Ранее созданные раунды: "),(l(!0),i(g,null,$(t.rounds,n=>(l(),i("span",{onClick:d=>t.questionForm.round=n,class:"badge bg-primary mr-1 cursor-pointer"},u(n),9,Cq))),256))])):r("",!0),e("label",Sq,[b(a,null,{content:y(()=>[Vq]),default:y(()=>[jq]),_:1}),m(" Раунд "),qq]),c(e("input",{type:"number",class:"form-control",placeholder:"Раунд","aria-label":"Раундт",step:"1",min:"1","onUpdate:modelValue":o[1]||(o[1]=n=>t.questionForm.round=n),"aria-describedby":"quiz-round",required:""},null,512),[[_,t.questionForm.round]])]),e("div",zq,[e("label",Pq,[b(a,null,{content:y(()=>[Aq]),default:y(()=>[Uq]),_:1}),m(" Текст вопроса "),Oq,t.questionForm.text?(l(),i("small",Iq," Длина текста "+u(t.questionForm.text.length)+"/255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Текст вопроса","aria-label":"Текст вопроса","onUpdate:modelValue":o[2]||(o[2]=n=>t.questionForm.text=n),maxlength:"255","aria-describedby":"review-text",required:""},`
                    `,512),[[_,t.questionForm.text]])]),e("div",Qq,[e("div",Tq,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[3]||(o[3]=n=>t.need_media=n),type:"checkbox",id:"need_media"},null,512),[[k,t.need_media]]),Bq])]),t.need_media?(l(),i("div",Mq,[e("label",Rq,[b(a,null,{content:y(()=>[Eq]),default:y(()=>[Dq]),_:1}),m(" Медиа контент к вопросу "),t.questionForm.content_type?(l(),i("span",Lq,u(t.questionForm.content_type),1)):r("",!0),Kq]),Nq,b(oe,{value:t.questionForm.media_content,type:t.questionForm.content_type,"onUpdate:type":o[4]||(o[4]=n=>t.questionForm.content_type=n),"onUpdate:value":o[5]||(o[5]=n=>t.questionForm.media_content=n)},null,8,["value","type"]),Jq,e("button",{type:"button",onClick:o[6]||(o[6]=(...n)=>t.chooseBaseMediaContent&&t.chooseBaseMediaContent(...n)),class:"btn btn-outline-info rounded-lg"},"Выбрать медиа-файл ")])):r("",!0),e("div",Hq,[e("div",Gq,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[7]||(o[7]=n=>t.questionForm.is_multiply=n),type:"checkbox",id:"is_multiply"},null,512),[[k,t.questionForm.is_multiply]]),Yq])]),e("div",Wq,[e("div",Zq,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[8]||(o[8]=n=>t.questionForm.is_open=n),type:"checkbox",id:"is_open"},null,512),[[k,t.questionForm.is_open]]),Xq])]),e("div",xq,[e("div",ez,[e("label",tz,[b(a,null,{content:y(()=>[oz]),default:y(()=>[sz]),_:1}),m(" Текст при выборе правильного ответа "),lz,t.questionForm.success_message?(l(),i("small",iz," Длина текста "+u(t.questionForm.success_message.length)+"/255",1)):r("",!0)]),b(Z,{param:"success_message",onCallback:t.attachTo},null,8,["onCallback"])]),c(e("textarea",{class:"form-control",placeholder:"Текст при правильном ответе","aria-label":"Текст при правильном ответе",maxlength:"255","onUpdate:modelValue":o[9]||(o[9]=n=>t.questionForm.success_message=n),"aria-describedby":"quiz-question-success_message"},`
                    `,512),[[_,t.questionForm.success_message]])]),e("div",nz,[e("div",az,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[10]||(o[10]=n=>t.need_media_for_success=n),type:"checkbox",id:"need_media_for_success"},null,512),[[k,t.need_media_for_success]]),dz])]),t.need_media_for_success?(l(),i("div",rz,[cz,b(oe,{type:t.questionForm.success_media_content_type,"onUpdate:type":o[11]||(o[11]=n=>t.questionForm.success_media_content_type=n),value:t.questionForm.success_media_content,"onUpdate:value":o[12]||(o[12]=n=>t.questionForm.success_media_content=n)},null,8,["type","value"]),uz,e("button",{type:"button",onClick:o[13]||(o[13]=(...n)=>t.chooseSuccessMediaContent&&t.chooseSuccessMediaContent(...n)),class:"btn btn-outline-info rounded-lg"},"Выбрать медиа-файл ")])):r("",!0),e("div",mz,[e("div",hz,[e("label",_z,[b(a,null,{content:y(()=>[bz]),default:y(()=>[pz]),_:1}),m(" Текст при выборе неправильного ответа "),fz,t.questionForm.failure_message?(l(),i("small",gz," Длина текста "+u(t.questionForm.failure_message.length)+"/255",1)):r("",!0)]),b(Z,{param:"failure_message",onCallback:t.attachTo},null,8,["onCallback"])]),c(e("textarea",{class:"form-control",placeholder:"Текст при неправильном ответе","aria-label":"Текст при неправильном ответе",maxlength:"255","onUpdate:modelValue":o[14]||(o[14]=n=>t.questionForm.failure_message=n),"aria-describedby":"quiz-question-failure-message"},`
                    `,512),[[_,t.questionForm.failure_message]])]),e("div",yz,[e("div",vz,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[15]||(o[15]=n=>t.need_media_for_failed=n),type:"checkbox",id:"need_media_for_failed"},null,512),[[k,t.need_media_for_failed]]),$z])]),t.need_media_for_failed?(l(),i("div",kz,[Fz,b(oe,{type:t.questionForm.failure_media_content_type,"onUpdate:type":o[16]||(o[16]=n=>t.questionForm.failure_media_content_type=n),value:t.questionForm.failure_media_content,"onUpdate:value":o[17]||(o[17]=n=>t.questionForm.failure_media_content=n)},null,8,["type","value"]),wz,e("button",{type:"button",onClick:o[18]||(o[18]=(...n)=>t.chooseFailureMediaContent&&t.chooseFailureMediaContent(...n)),class:"btn btn-outline-info rounded-lg"},"Выбрать медиа-файл ")])):r("",!0)]),e("div",Cz,[e("div",Sz,[e("button",{onClick:o[19]||(o[19]=(...n)=>t.addNewAnswer&&t.addNewAnswer(...n)),type:"button",class:"btn btn-outline-success rounded-5"}," Добавить ответы ")]),e("div",jz,[t.questionForm.answers.length>0?(l(),i("table",Vz,[qz,e("tbody",null,[(l(!0),i(g,null,$(t.questionForm.answers,(n,d)=>(l(),i("tr",{class:p({"border-info":n.deleted_at==null,"border-danger":n.deleted_at!=null})},[e("th",zz,u(n.id||"Новый"),1),e("td",null,[e("div",Pz,[c(e("input",{type:"text","onUpdate:modelValue":h=>t.questionForm.answers[d].text=h,class:"form-control",id:"answer-text-"+d,placeholder:"Текст ответа"},null,8,Uz),[[_,t.questionForm.answers[d].text]]),e("label",{for:"answer-text-"+d},"Текст ответа",8,Az)])]),e("td",null,[e("div",Oz,[c(e("input",{type:"text","onUpdate:modelValue":h=>t.questionForm.answers[d].points=h,class:"form-control",id:"answer-points-"+d,placeholder:"Текст ответа"},null,8,Iz),[[_,t.questionForm.answers[d].points]]),e("label",{for:"answer-points-"+d},"Баллы",8,Qz)])]),e("td",null,[e("p",{class:"cursor-pointer",onClick:h=>t.chooseMediaContent(d)},u(n.media_content||"Не указано"),9,Tz)]),e("td",null,u(n.content_type||"Не указано"),1),e("td",null,[e("div",Bz,[c(e("input",{class:"form-check-input","onUpdate:modelValue":h=>t.questionForm.answers[d].is_right_answer=h,type:"checkbox",id:"answer-is_right_answer-"+d},null,8,Mz),[[k,t.questionForm.answers[d].is_right_answer]]),e("label",{class:"form-check-label",for:"answer-is_right_answer-"+d}," Правильный ответ ",8,Rz)])]),e("td",null,[e("div",Dz,[Ez,e("ul",Lz,[n.id==null?(l(),i("li",Kz,[e("a",{class:"dropdown-item",onClick:h=>t.removeAnswerFromArray(d),href:"javascript:void(0)"},"Удалить",8,Nz)])):r("",!0),n.deleted_at==null&&n.id!=null?(l(),i("li",Jz,[e("a",{class:"dropdown-item",onClick:h=>t.removeAnswer(n.id),href:"javascript:void(0)"},"Удалить",8,Hz)])):r("",!0)])])])],2))),256))])])):(l(),i("p",Gz,"На текущий момент нет ни одного созданного ответа"))])]),e("div",Yz,[e("div",Wz,[e("button",Zz,[t.questionForm.id==null?(l(),i("span",Xz,"Сохранить вопрос")):(l(),i("span",xz,"Обновить вопрос"))])])])],32),e("div",eP,[e("div",tP,[e("div",sP,[t.selectedQuestionIndex!=null?(l(),i("div",oP,[b(U,{"need-video":!0,"need-video-note":!0,"need-audio":!0,"need-photo":!0,selected:[t.questionForm.answers[t.selectedQuestionIndex||0].media_content||""],onSelect:t.selectMediaForAnswer},null,8,["selected","onSelect"])])):r("",!0),lP])])]),e("div",iP,[e("div",nP,[e("div",aP,[e("div",dP,[b(U,{"need-video":!0,"need-video-note":!0,"need-audio":!0,"need-photo":!0,selected:[t.questionForm.success_media_content],onSelect:t.selectMediaForSuccess},null,8,["selected","onSelect"])]),rP])])]),e("div",cP,[e("div",uP,[e("div",mP,[e("div",hP,[b(U,{"need-video":!0,"need-video-note":!0,"need-audio":!0,"need-photo":!0,selected:[t.questionForm.failure_media_content],onSelect:t.selectMediaForFailure},null,8,["selected","onSelect"])]),_P])])]),e("div",pP,[e("div",bP,[e("div",fP,[e("div",gP,[b(U,{"need-video":!0,"need-video-note":!0,"need-audio":!0,"need-photo":!0,selected:[t.questionForm.media_content],onSelect:t.selectMedia},null,8,["selected","onSelect"])]),yP])])])],64)}}}),kP={class:"row"},FP={class:"col-12"},wP={key:0,class:"table"},CP=e("th",{scope:"col"},"Число ответов",-1),SP=e("th",{scope:"col"},"Действие",-1),jP={scope:"row"},VP=["onClick"],qP={key:0,class:"fa-solid fa-chevron-down text-success"},zP={key:1,class:"fa-solid fa-xmark text-danger"},PP={key:0,class:"fa-solid fa-chevron-down text-success"},UP={key:1,class:"fa-solid fa-xmark text-danger"},AP={key:0,class:"dropdown"},OP=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),IP={class:"dropdown-menu"},QP={key:0},TP=["onClick"],BP={key:1},MP={class:"col-12"},RP={props:["bot","quizId"],data(){return{direction:"desc",order:"updated_at",show:!0,is_group:!1,loading:!0,questions:[],search:null,paginate_object:null}},computed:{...C(["getQuizQuestions","getQuizQuestionsPaginateObject"])},mounted(){this.loadQuizQuestions()},methods:{nextQuizQuestion(s){this.loadQuizQuestions(s)},selectQuizQuestion(s){this.$emit("select",s),this.$notify("Вопрос успешно выбран")},removeQuizQuestion(s){this.loading=!0,this.$store.dispatch("removeQuizQuestion",{quizQuestionId:s}).then(t=>{this.loading=!1,this.loadQuizQuestions(0),this.$notify("Вопрос успешно удален")}).catch(()=>{this.loading=!1,this.$notify("Вопрос удаления сервиса")})},loadAndOrder(s){this.order=s,this.direction=this.direction==="desc"?"asc":"desc",this.loadQuizQuestions(0)},loadQuizQuestions(s=0){this.loading=!0,this.$store.dispatch("loadQuizQuestions",{dataObject:{quiz_id:this.quizId,bot_id:this.bot.id||null,search:this.search,order:this.order,direction:this.direction},page:s,size:100}).then(t=>{this.loading=!1,this.questions=this.getQuizQuestions,this.paginate_object=this.getQuizQuestionsPaginateObject}).catch(()=>{this.loading=!1})}}},DP=Object.assign(RP,{__name:"QuizQuestionTable",setup(s){return(t,o)=>(l(),i("div",kP,[e("div",FP,[t.questions.length>0?(l(),i("table",wP,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:o[0]||(o[0]=a=>t.loadAndOrder("id"))},"#"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[1]||(o[1]=a=>t.loadAndOrder("text"))},"Текст вопроса"),CP,e("th",{scope:"col",class:"cursor-pointer",onClick:o[2]||(o[2]=a=>t.loadAndOrder("round"))},"Раунд"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[3]||(o[3]=a=>t.loadAndOrder("media_content"))},"Контент"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[4]||(o[4]=a=>t.loadAndOrder("content_type"))},"Тип контента"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[5]||(o[5]=a=>t.loadAndOrder("is_multiply"))},"Множественный"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[6]||(o[6]=a=>t.loadAndOrder("is_open"))},"Открытый"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[7]||(o[7]=a=>t.loadAndOrder("updated_at"))},"Дата изменения"),SP])]),e("tbody",null,[(l(!0),i(g,null,$(t.questions,(a,n)=>(l(),i("tr",{class:p({"border-info":a.deleted_at==null,"border-danger":a.deleted_at!=null})},[e("th",jP,u(a.id),1),e("td",{onClick:d=>t.selectQuizQuestion(a)},u(a.text||"Не указано"),9,VP),e("td",null,u((a.answers||[]).length),1),e("td",null,u(a.round||"Не указано"),1),e("td",null,u(a.media_content||"Не указано"),1),e("td",null,u(a.content_type||"Не указано"),1),e("td",null,[a.is_multiply?(l(),i("i",qP)):(l(),i("i",zP))]),e("td",null,[a.is_open?(l(),i("i",PP)):(l(),i("i",UP))]),e("td",null,u(t.$filters.current(a.updated_at)),1),e("td",null,[a.id?(l(),i("div",AP,[OP,e("ul",IP,[a.deleted_at==null?(l(),i("li",QP,[e("a",{class:"dropdown-item",onClick:d=>t.removeQuizQuestion(a.id),href:"javascript:void(0)"},"Удалить",8,TP)])):r("",!0)])])):r("",!0)])],2))),256))])])):(l(),i("p",BP,"На текущий момент нет ни одного созданного вопроса"))]),e("div",MP,[t.paginate_object?(l(),v(V,{key:0,onPagination_page:t.nextQuizQuestion,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])]))}}),EP={class:"row py-3"},LP={class:"col-12"},KP={class:"row"},NP={class:"col-12 mb-3"},JP={class:"form-label",id:"command-title"},HP=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),GP=e("div",null," Название команды ",-1),YP=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),WP={class:"col-12 mb-3"},ZP={class:"form-label",id:"event-on_after_appointment"},XP=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),xP=e("div",null," Текст описания команды ",-1),eU=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),tU={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},sU=e("div",{class:"col-12 mb-3"},[e("button",{type:"button",class:"btn btn-outline-info rounded-5","data-bs-toggle":"modal","data-bs-target":"#select-players"}," Подобрать участников команды ")],-1),oU={key:0,class:"col-12 mb-3"},lU=e("h4",null,"Пользователи в команде",-1),iU={class:"list-group list-group-numbered"},nU={class:"list-group-item d-flex justify-content-between align-items-start"},aU={class:"ms-2 me-auto"},dU={class:"fw-bold"},rU={class:"dropdown"},cU=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),uU={class:"dropdown-menu"},mU=["onClick"],hU={class:"row"},_U={class:"col-12"},pU={type:"submit",class:"btn btn-outline-success w-100 p-3"},bU={key:0},fU={key:1},gU={class:"modal fade",id:"select-players",tabindex:"-1","aria-labelledby":"select-players-label","aria-hidden":"true"},yU={class:"modal-dialog modal-fullscreen"},vU={class:"modal-content"},$U=e("div",{class:"modal-header"},[e("h1",{class:"modal-title fs-5",id:"select-players-label"},"Подбор участников команды"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),kU={class:"modal-body"},FU=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),wU={props:["quizId","bot","command"],data(){return{step:0,load:!1,commandForm:{id:null,title:null,description:null,players:[]}}},watch:{commandForm:{handler(s){this.need_reset=!0},deep:!0}},mounted(){this.command&&this.$nextTick(()=>{this.commandForm={id:this.command.id||null,title:this.command.title||null,description:this.command.description||null,players:this.command.players||[]}})},methods:{removePlayerFromCommand(s){},selectBotUser(s){if(this.commandForm.players.findIndex(o=>o.id==s.id)>=0){this.$notify("Такой пользователь уже есть в списке");return}this.$notify("Пользователь успешно добавлен"),this.commandForm.players.push(s)},clearCommandForm(){this.commandForm={id:null,title:null,description:null,players:[]}},submitForm(){let s=new FormData;Object.keys(this.commandForm).forEach(t=>{const o=this.commandForm[t]||"";typeof o=="object"?s.append(t,JSON.stringify(o)):s.append(t,o)}),s.append("bot_id",this.bot.id),s.append("quiz_id",this.quizId),this.$store.dispatch("storeQuizCommand",{quizCommandForm:s}).then(t=>{this.$emit("callback",t.data),this.$notify("Команда успешно создана"),this.clearCommandForm()}).catch(t=>{this.$notify("Ошибка создания команды")})}}},CU=Object.assign(wU,{__name:"QuizCommandForm",setup(s){return(t,o)=>{const a=P("Popper");return l(),i(g,null,[e("div",EP,[e("div",LP,[e("button",{onClick:o[0]||(o[0]=(...n)=>t.clearCommandForm&&t.clearCommandForm(...n)),class:"btn btn-primary"},"Новая команда")])]),e("form",{onSubmit:o[3]||(o[3]=S((...n)=>t.submitForm&&t.submitForm(...n),["prevent"]))},[e("div",KP,[e("div",NP,[e("label",JP,[b(a,null,{content:y(()=>[GP]),default:y(()=>[HP]),_:1}),m(" Название команды "),YP]),c(e("input",{type:"text",class:"form-control",placeholder:"Название команды","aria-label":"Название команды",maxlength:"255","onUpdate:modelValue":o[1]||(o[1]=n=>t.commandForm.title=n),"aria-describedby":"command-title",required:""},null,512),[[_,t.commandForm.title]])]),e("div",WP,[e("label",ZP,[b(a,null,{content:y(()=>[xP]),default:y(()=>[XP]),_:1}),m(" Описание команды "),eU,t.commandForm.description?(l(),i("small",tU," Длина текста "+u(t.commandForm.description.length)+"/255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Текст описания","aria-label":"Текст описания","onUpdate:modelValue":o[2]||(o[2]=n=>t.commandForm.description=n),maxlength:"255","aria-describedby":"command-text",required:""},`
                    `,512),[[_,t.commandForm.description]])]),sU,t.commandForm.players.length>0?(l(),i("div",oU,[lU,e("ol",iU,[(l(!0),i(g,null,$(t.commandForm.players,n=>(l(),i("li",nU,[e("div",aU,[e("div",dU,"#"+u(n.id),1),m(" "+u(n.fio_from_telegram||n.telegram_chat_id),1)]),e("div",rU,[cU,e("ul",uU,[e("li",null,[e("a",{class:"dropdown-item",onClick:d=>t.removePlayerFromCommand(n.id),href:"javascript:void(0)"},"Удалить",8,mU)])])])]))),256))])])):r("",!0)]),e("div",hU,[e("div",_U,[e("button",pU,[t.commandForm.id==null?(l(),i("span",bU,"Сохранить команду")):(l(),i("span",fU,"Обновить команду"))])])])],32),e("div",gU,[e("div",yU,[e("div",vU,[$U,e("div",kU,[b(X,{simple:!0,onSelect:t.selectBotUser},null,8,["onSelect"])]),FU])])])],64)}}}),SU={class:"row"},jU={class:"col-12"},VU={key:0,class:"table"},qU=e("th",{scope:"col"},"Число участников",-1),zU=e("th",{scope:"col"},"Действие",-1),PU={scope:"row"},UU=["onClick"],AU={key:0,class:"dropdown"},OU=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),IU={class:"dropdown-menu"},QU={key:0},TU=["onClick"],BU={key:1},MU={class:"col-12"},RU={props:["bot","quizId"],data(){return{direction:"desc",order:"updated_at",show:!0,is_group:!1,loading:!0,commands:[],search:null,paginate_object:null}},computed:{...C(["getQuizCommands","getQuizCommandsPaginateObject"])},mounted(){this.loadQuizCommands()},methods:{nextQuizCommand(s){this.loadQuizCommands(s)},selectQuizCommand(s){this.$emit("select",s),this.$notify("Вопрос успешно выбран")},removeQuizCommand(s){this.loading=!0,this.$store.dispatch("removeQuizCommand",{quizCommandId:s}).then(t=>{this.loading=!1,this.loadQuizCommands(0),this.$notify("Вопрос успешно удален")}).catch(()=>{this.loading=!1,this.$notify("Вопрос удаления сервиса")})},loadAndOrder(s){this.order=s,this.direction=this.direction==="desc"?"asc":"desc",this.loadQuizCommands(0)},loadQuizCommands(s=0){this.loading=!0,this.$store.dispatch("loadQuizCommands",{dataObject:{quiz_id:this.quizId,bot_id:this.bot.id||null,search:this.search,order:this.order,direction:this.direction},page:s,size:100}).then(t=>{this.loading=!1,this.commands=this.getQuizCommands,this.paginate_object=this.getQuizCommandsPaginateObject}).catch(()=>{this.loading=!1})}}},DU=Object.assign(RU,{__name:"QuizCommandTable",setup(s){return(t,o)=>(l(),i("div",SU,[e("div",jU,[t.commands.length>0?(l(),i("table",VU,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:o[0]||(o[0]=a=>t.loadAndOrder("id"))},"#"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[1]||(o[1]=a=>t.loadAndOrder("title"))},"Название"),qU,e("th",{scope:"col",class:"cursor-pointer",onClick:o[2]||(o[2]=a=>t.loadAndOrder("description"))},"Описание"),zU])]),e("tbody",null,[(l(!0),i(g,null,$(t.commands,(a,n)=>(l(),i("tr",{class:p({"border-info":a.deleted_at==null,"border-danger":a.deleted_at!=null})},[e("th",PU,u(a.id),1),e("td",{onClick:d=>t.selectQuizCommand(a)},u(a.title||"Не указано"),9,UU),e("td",null,u((a.players||[]).length),1),e("td",null,u(a.description||"Не указано"),1),e("td",null,[a.id?(l(),i("div",AU,[OU,e("ul",IU,[a.deleted_at==null?(l(),i("li",QU,[e("a",{class:"dropdown-item",onClick:d=>t.removeQuizCommand(a.id),href:"javascript:void(0)"},"Удалить",8,TU)])):r("",!0)])])):r("",!0)])],2))),256))])])):(l(),i("p",BU,"На текущий момент нет ни одной созданной команды"))]),e("div",MU,[t.paginate_object?(l(),v(V,{key:0,onPagination_page:t.nextQuizCommand,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])]))}}),EU={class:"row"},LU={class:"col-12"},KU={key:0,class:"table"},NU=e("th",{scope:"col"},"Название квиза",-1),JU=e("th",{scope:"col"},"Название команды",-1),HU=e("th",{scope:"col"},"Число участников",-1),GU=e("th",{scope:"col"},"Результат",-1),YU=e("th",{scope:"col"},"Действие",-1),WU={scope:"row"},ZU=["onClick"],XU={key:0},xU=e("td",null,"-",-1),eA={key:0,class:"dropdown"},tA=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),sA={class:"dropdown-menu"},oA={key:0},lA=["onClick"],iA={key:1},nA={class:"col-12"},aA={props:["bot","quizId"],data(){return{direction:"desc",order:"updated_at",show:!0,is_group:!1,loading:!0,results:[],search:null,paginate_object:null}},computed:{...C(["getQuizResults","getQuizResultsPaginateObject"])},mounted(){this.loadQuizResults()},methods:{nextQuizResult(s){this.loadQuizResults(s)},selectQuizResult(s){this.$emit("select",s),this.$notify("Вопрос успешно выбран")},removeQuizResult(s){this.loading=!0,this.$store.dispatch("removeQuizResult",{quizResultId:s}).then(t=>{this.loading=!1,this.loadQuizResults(0),this.$notify("Вопрос успешно удален")}).catch(()=>{this.loading=!1,this.$notify("Вопрос удаления сервиса")})},loadAndOrder(s){this.order=s,this.direction=this.direction==="desc"?"asc":"desc",this.loadQuizResults(0)},loadQuizResults(s=0){this.loading=!0,this.$store.dispatch("loadQuizResults",{dataObject:{quiz_id:this.quizId,bot_id:this.bot.id||null,search:this.search,order:this.order,direction:this.direction},page:s,size:100}).then(t=>{this.loading=!1,this.results=this.getQuizResults,this.paginate_object=this.getQuizResultsPaginateObject}).catch(()=>{this.loading=!1})}}},dA=Object.assign(aA,{__name:"QuizResultTable",setup(s){return(t,o)=>(l(),i("div",EU,[e("div",LU,[t.results.length>0?(l(),i("table",KU,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:o[0]||(o[0]=a=>t.loadAndOrder("id"))},"#"),NU,JU,HU,e("th",{scope:"col",class:"cursor-pointer",onClick:o[1]||(o[1]=a=>t.loadAndOrder("points"))},"Баллы"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[2]||(o[2]=a=>t.loadAndOrder("times"))},"Время"),GU,YU])]),e("tbody",null,[(l(!0),i(g,null,$(t.results,(a,n)=>(l(),i("tr",{class:p({"border-info":a.deleted_at==null,"border-danger":a.deleted_at!=null})},[e("th",WU,u(a.id),1),e("td",{onClick:d=>t.selectQuizResult(a)},u(a.quiz.title||"Не указано"),9,ZU),e("td",null,[a.command?(l(),i("span",XU,u(a.command.title||"Не указано"),1)):r("",!0)]),e("td",null,u((a.command.players||[]).length),1),e("td",null,u(a.points||"Не указано"),1),e("td",null,u(a.times||"Не указано"),1),xU,e("td",null,[a.id?(l(),i("div",eA,[tA,e("ul",sA,[a.deleted_at==null?(l(),i("li",oA,[e("a",{class:"dropdown-item",onClick:d=>t.removeQuizResult(a.id),href:"javascript:void(0)"},"Удалить",8,lA)])):r("",!0)])])):r("",!0)])],2))),256))])])):(l(),i("p",iA,"На текущий момент нет ни одного созданного вопроса"))]),e("div",nA,[t.paginate_object?(l(),v(V,{key:0,onPagination_page:t.nextQuizResult,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])]))}}),rA={key:0,class:"py-2"},cA={class:"row"},uA={class:"col-12"},mA={key:1,class:"py-2"},hA={class:"row"},_A={class:"col-12"},pA={key:2,class:"py-2"},bA={class:"row"},fA={class:"col-12"},gA={class:"nav nav-tabs justify-content-center"},yA={key:0,class:"row py-3"},vA={class:"col-12"},$A={key:1,class:"row py-3"},kA={class:"col-12"},FA={class:"col-12 py-3"},wA=e("h4",null,"Доступные вопросы",-1),CA={key:2,class:"row"},SA={class:"col-12"},jA={class:"col-12 py-3"},VA=e("h4",null,"Команды участники квиза",-1),qA={key:3,class:"row"},zA={class:"col-12 py-3"},PA=e("h4",null,"Статистика",-1),UA={key:4,class:"row"},AA=e("div",{class:"col-12"},null,-1),OA=e("div",{class:"col-12 py-3"},[e("h4",null,"Отзывы к событию")],-1),IA=[AA,OA],QA={props:["bot"],data(){return{part:0,tab:0,loadTable:!1,loadQuizCommand:!1,loadQuizQuestion:!1,loadQuizQuestionTable:!1,loadQuizCommandTable:!1,loadQuizResult:!1,loadForm:!1,selectedQuiz:null,selectedQuizQuestion:null,selectedQuizCommand:null,selectedQuizResult:null}},mounted(){},methods:{callbackCommandForm(){this.loadQuizCommandTable=!0,this.$nextTick(()=>{this.loadQuizCommandTable=!1})},callbackQuestionForm(){this.loadQuizQuestionTable=!0,this.$nextTick(()=>{this.loadQuizQuestionTable=!1})},callbackForm(){this.loadTable=!0,this.part=0,this.$nextTick(()=>{this.loadTable=!1})},createQuiz(){this.part=2},selectQuizResult(s){this.loadQuizResult=!0,this.$nextTick(()=>{this.loadQuizResult=!1,this.selectedQuizResult=s})},selectQuizCommand(s){this.loadQuizCommand=!0,this.$nextTick(()=>{this.loadQuizCommand=!1,this.selectedQuizCommand=s})},selectQuizQuestion(s){this.loadQuizQuestion=!0,this.$nextTick(()=>{this.loadQuizQuestion=!1,this.selectedQuizQuestion=s})},selectQuiz(s){this.loadForm=!0,this.$nextTick(()=>{this.loadForm=!1,this.selectedQuiz=s,this.part=1,this.tab=0})}}},TA=Object.assign(QA,{__name:"Quizzes",setup(s){return(t,o)=>(l(),i(g,null,[t.part===0?(l(),i("div",rA,[e("div",cA,[e("div",uA,[e("button",{type:"button",onClick:o[0]||(o[0]=(...a)=>t.createQuiz&&t.createQuiz(...a)),class:"btn btn-primary"}," Создать новый квиз ")])]),t.loadTable?r("",!0):(l(),v(hq,{key:0,onCreate:t.createQuiz,onSelect:t.selectQuiz,bot:s.bot},null,8,["onCreate","onSelect","bot"]))])):r("",!0),t.part===2?(l(),i("div",mA,[e("div",hA,[e("div",_A,[e("button",{type:"button",onClick:o[1]||(o[1]=a=>t.part=0),class:"btn btn-outline-primary"}," Назад ")])]),t.loadForm?r("",!0):(l(),v($e,{key:0,onCallback:t.callbackForm,bot:s.bot},null,8,["onCallback","bot"]))])):r("",!0),t.part===1?(l(),i("div",pA,[e("div",bA,[e("div",fA,[e("button",{type:"button",onClick:o[2]||(o[2]=a=>t.part=0),class:"btn btn-outline-primary"}," Назад ")])]),e("ul",gA,[e("li",{class:"nav-item",onClick:o[3]||(o[3]=a=>t.tab=0)},[e("a",{class:p(["nav-link",{active:t.tab===0}]),"aria-current":"page",href:"javascript:void(0)"},"Информация о квизе",2)]),e("li",{class:"nav-item",onClick:o[4]||(o[4]=a=>t.tab=1)},[e("a",{class:p(["nav-link",{active:t.tab===1}]),href:"javascript:void(0)"},"Вопросы квиза",2)]),e("li",{class:"nav-item",onClick:o[5]||(o[5]=a=>t.tab=2)},[e("a",{class:p(["nav-link",{active:t.tab===2}]),href:"javascript:void(0)"},"Команды на квизе",2)]),e("li",{class:"nav-item",onClick:o[6]||(o[6]=a=>t.tab=3)},[e("a",{class:p(["nav-link",{active:t.tab===3}]),href:"javascript:void(0)"},"Командная статистика",2)])]),t.tab===0?(l(),i("div",yA,[e("div",vA,[t.loadForm?r("",!0):(l(),v($e,{key:0,onCallback:t.callbackForm,quiz:t.selectedQuiz,bot:s.bot},null,8,["onCallback","quiz","bot"]))])])):r("",!0),t.tab===1?(l(),i("div",$A,[e("div",kA,[t.loadQuizQuestion?r("",!0):(l(),v($P,{key:0,question:t.selectedQuizQuestion,"quiz-id":t.selectedQuiz.id,onCallback:t.callbackQuestionForm,bot:s.bot},null,8,["question","quiz-id","onCallback","bot"]))]),e("div",FA,[wA,t.loadQuizQuestionTable?r("",!0):(l(),v(DP,{key:0,"quiz-id":t.selectedQuiz.id,onSelect:t.selectQuizQuestion,bot:s.bot},null,8,["quiz-id","onSelect","bot"]))])])):r("",!0),t.tab===2?(l(),i("div",CA,[e("div",SA,[t.loadQuizCommand?r("",!0):(l(),v(CU,{key:0,command:t.selectedQuizCommand,"quiz-id":t.selectedQuiz.id,onCallback:t.callbackCommandForm,bot:s.bot},null,8,["command","quiz-id","onCallback","bot"]))]),e("div",jA,[VA,t.loadQuizCommandTable?r("",!0):(l(),v(DU,{key:0,"quiz-id":t.selectedQuiz.id,onSelect:t.selectQuizCommand,bot:s.bot},null,8,["quiz-id","onSelect","bot"]))])])):r("",!0),t.tab===3?(l(),i("div",qA,[e("div",zA,[PA,b(dA,{"quiz-id":t.selectedQuiz.id,onSelect:t.selectQuizResult,bot:s.bot},null,8,["quiz-id","onSelect","bot"])])])):r("",!0),t.tab===4?(l(),i("div",UA,IA)):r("",!0)])):r("",!0)],64))}}),BA={class:"row"},MA={class:"col-12 mb-3 d-flex align-items-center"},RA={class:"dropdown mr-2"},DA={class:"btn btn-info dropdown-toggle",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},EA={key:0},LA={key:1},KA={class:"dropdown-menu"},NA=["onClick"],JA={class:"dropdown-item",href:"#"},HA=e("p",{class:"mb-0"}," - тип пункта меню",-1),GA={class:"col-12 col-md-12 mb-3"},YA={class:"form-label",id:"service-title"},WA=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),ZA=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),XA={class:"col-12 mb-3"},xA={class:"form-label",id:"service-description"},eO=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),tO=e("div",null," Краткая информация о команде ",-1),sO=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),oO={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},lO={class:"col-12 mb-3"},iO={class:"form-label",id:"service-input_message_content"},nO=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),aO=e("div",null," Текст, который будет в сообщении после выбора данного пункта меню ",-1),dO=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),rO={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},cO={class:"col-12 mb-3"},uO={class:"form-check"},mO=e("label",{class:"form-check-label",for:"need_keyboard"}," Нужна клавиатура к тексту ",-1),hO={key:0,class:"col-12 mb-3"},_O={class:"card"},pO={class:"card-body"},bO={class:"form-check"},fO=e("label",{class:"form-check-label",for:"need_show_inline_template_selector"}," Выбрать клавиатуру из шаблона ",-1),gO={class:"col-12 mb-3"},yO={class:"form-check"},vO=e("label",{class:"form-check-label",for:"need_custom_settings"}," Нужны дополнительные настройки ",-1),$O={class:"col-12"},kO={key:0,class:"card mb-2"},FO={class:"card-header d-flex justify-content-between align-items-center"},wO=e("h6",null,"Дополнительная конфигурация",-1),CO={class:"card-body"},SO={class:"row mb-2"},jO={class:"col-5"},VO={class:"form-label",id:"service-title"},qO=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),zO=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),PO=["onUpdate:modelValue"],UO={class:"col-5"},AO={class:"form-label",id:"service-title"},OO=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),IO=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),QO=["onUpdate:modelValue"],TO={class:"col-2 d-flex flex-column justify-content-end align-items-center"},BO=["onClick"],MO={key:1,class:"row mb-2"},RO=e("div",{class:"col-12"},[e("div",{class:"alert alert-info",role:"alert"}," Вы еще не добавили ни одной дополнительной настройки ")],-1),DO=[RO],EO=e("div",{class:"row"},[e("div",{class:"col-12"},[e("button",{type:"submit",class:"btn btn-outline-primary w-100"},"Сохранить пункт меню ")])],-1),LO={props:["item"],data(){return{need_custom_settings:!1,need_keyboard:!1,need_show_inline_template_selector:!1,types:[{title:"Текст",value:0},{title:"Фото",value:1}],itemForm:{id:null,type:0,title:null,description:null,input_message_content:null,inline_keyboard_id:null,inline_keyboard:{menu:null},custom_settings:[]}}},computed:{preparedTypeTile(){return this.types.filter(s=>s.value==this.itemForm.type)[0]||null},uuid(){return nt()}},watch:{itemForm:{handler(s){this.need_reset=!0},deep:!0}},mounted(){this.item&&this.$nextTick(()=>{console.log("menu",this.item.inline_keyboard),this.itemForm={id:this.item.id||uuid,type:this.item.type||0,title:this.item.title||null,description:this.item.description||null,input_message_content:this.item.input_message_content||null,need_keyboard:this.item.title||!1,inline_keyboard_id:this.item.inline_keyboard_id||null,inline_keyboard:this.item.inline_keyboard?this.item.inline_keyboard:{menu:null},custom_settings:this.item.custom_settings||[]},this.itemForm.inline_keyboard&&(this.need_keyboard=!0),this.itemForm.custom_settings&&(this.need_custom_settings=!0)})},methods:{submitForm(){this.$emit("callback",this.itemForm),this.itemForm={id:null,type:0,title:null,description:null,input_message_content:null,inline_keyboard_id:null,inline_keyboard:{menu:null},custom_settings:[]},this.need_keyboard=!1,this.need_custom_settings=!1,this.need_show_inline_template_selector=!1},addCustomSettings(){this.itemForm.custom_settings.push({key:null,value:null})},removeCustomSetting(s){this.itemForm.custom_settings.splice(s,1)},selectInlineKeyboard(s){this.itemForm.inline_keyboard={id:null,menu:s,slug:null},this.need_show_inline_template_selector=!1}}},KO=Object.assign(LO,{__name:"InlineQueryItemForm",setup(s){return(t,o)=>{const a=P("Popper");return l(),i("form",{onSubmit:o[8]||(o[8]=S((...n)=>t.submitForm&&t.submitForm(...n),["prevent"])),class:"mb-2"},[e("div",BA,[e("div",MA,[e("div",RA,[e("button",DA,[t.itemForm.type?(l(),i("span",EA,u(t.preparedTypeTile.title),1)):(l(),i("span",LA,"Тип поля"))]),e("ul",KA,[(l(!0),i(g,null,$(t.types,n=>(l(),i("li",{onClick:d=>t.itemForm.type=n.value},[e("a",JA,u(n.title||"Не указан"),1)],8,NA))),256))])]),HA]),e("div",GA,[e("label",YA,[b(a,{content:"Заголовок"},{default:y(()=>[WA]),_:1}),m(" Заголовок "),ZA]),c(e("input",{type:"text",class:"form-control",placeholder:"Заголовок","aria-label":"Заголовок","onUpdate:modelValue":o[0]||(o[0]=n=>t.itemForm.title=n),"aria-describedby":"title",required:""},null,512),[[_,t.itemForm.title]])]),e("div",XA,[e("label",xA,[b(a,null,{content:y(()=>[tO]),default:y(()=>[eO]),_:1}),m(" Описание команду "),sO,t.itemForm.description?(l(),i("small",oO," Длина текста "+u(t.itemForm.description.length)+" / 255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Описание команды","aria-label":"Описание команды",maxlength:"255","onUpdate:modelValue":o[1]||(o[1]=n=>t.itemForm.description=n),"aria-describedby":"service-description",required:""},`
                    `,512),[[_,t.itemForm.description]])]),e("div",lO,[e("label",iO,[b(a,null,{content:y(()=>[aO]),default:y(()=>[nO]),_:1}),m(" Текст после выбора "),dO,t.itemForm.input_message_content?(l(),i("small",rO," Длина текста "+u(t.itemForm.input_message_content.length)+" / 255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Текст поста","aria-label":"Текст поста",maxlength:"255","onUpdate:modelValue":o[2]||(o[2]=n=>t.itemForm.input_message_content=n),"aria-describedby":"service-input_message_content",required:""},`
                    `,512),[[_,t.itemForm.input_message_content]])]),e("div",cO,[e("div",uO,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[3]||(o[3]=n=>t.need_keyboard=n),type:"checkbox",id:"need_keyboard"},null,512),[[k,t.need_keyboard]]),mO])]),t.need_keyboard?(l(),i("div",hO,[e("div",_O,[e("div",pO,[e("div",bO,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[4]||(o[4]=n=>t.need_show_inline_template_selector=n),type:"checkbox",id:"need_show_inline_template_selector"},null,512),[[k,t.need_show_inline_template_selector]]),fO]),t.need_show_inline_template_selector?(l(),v(E,{key:0,class:"mb-2",type:"inline",onSelect:t.selectInlineKeyboard,"select-mode":!0},null,8,["onSelect"])):(l(),v(I,{key:1,type:"inline",modelValue:t.itemForm.inline_keyboard.menu,"onUpdate:modelValue":o[5]||(o[5]=n=>t.itemForm.inline_keyboard.menu=n)},null,8,["modelValue"]))])])])):r("",!0),e("div",gO,[e("div",yO,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[6]||(o[6]=n=>t.need_custom_settings=n),type:"checkbox",id:"need_custom_settings"},null,512),[[k,t.need_custom_settings]]),vO])]),e("div",$O,[t.need_custom_settings?(l(),i("div",kO,[e("div",FO,[wO,e("button",{type:"button",onClick:o[7]||(o[7]=(...n)=>t.addCustomSettings&&t.addCustomSettings(...n)),class:"btn btn-outline-primary"},"Добавить настройку ")]),e("div",CO,[t.itemForm.custom_settings.length>0?(l(!0),i(g,{key:0},$(t.itemForm.custom_settings,(n,d)=>(l(),i("div",SO,[e("div",jO,[e("label",VO,[b(a,{content:"Ключ"},{default:y(()=>[qO]),_:1}),m(" Ключ "),zO]),c(e("input",{type:"text",class:"form-control",placeholder:"Ключ","aria-label":"Ключ",min:"0","onUpdate:modelValue":h=>t.itemForm.custom_settings[d].key=h,"aria-describedby":"price",required:""},null,8,PO),[[_,t.itemForm.custom_settings[d].key]])]),e("div",UO,[e("label",AO,[b(a,{content:"Значение"},{default:y(()=>[OO]),_:1}),m(" Значение "),IO]),c(e("input",{type:"text",class:"form-control",placeholder:"Значение","aria-label":"Значение",min:"0","onUpdate:modelValue":h=>t.itemForm.custom_settings[d].value=h,"aria-describedby":"price",required:""},null,8,QO),[[_,t.itemForm.custom_settings[d].value]])]),e("div",TO,[e("button",{onClick:h=>t.removeCustomSetting(d),class:"btn btn-outline-danger"},"Удалить ",8,BO)])]))),256)):(l(),i("div",MO,DO))])])):r("",!0)])]),EO],32)}}}),NO={class:"row"},JO={class:"col-12 mb-3"},HO={class:"form-label",id:"service-title"},GO=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),YO=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),WO={class:"col-12 mb-3"},ZO={class:"form-label",id:"service-description"},XO=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),xO=e("div",null," Краткая информация о команде ",-1),eI=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),tI={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},sI={class:"col-12 mb-2"},oI={key:0},lI={class:"table-responsive"},iI={class:"table"},nI=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"Название"),e("th",{scope:"col"},"Описание"),e("th",{scope:"col"},"Текст"),e("th",{scope:"col"},"Есть клавиатура"),e("th",{scope:"col"},"Есть доп настройки"),e("th",{scope:"col"},"Действие")])],-1),aI=["onClick"],dI=["onClick"],rI=["onClick"],cI={key:0,class:"fa-solid fa-check text-success"},uI={key:1,class:"fa-solid fa-xmark text-danger"},mI={key:0,class:"fa-solid fa-check text-success"},hI={key:1,class:"fa-solid fa-xmark text-danger"},_I={class:"dropdown"},pI=e("button",{class:"btn btn-link",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-bars"})],-1),bI={class:"dropdown-menu"},fI=["onClick"],gI={class:"row"},yI={class:"col-12"},vI={type:"submit",class:"btn btn-outline-success w-100 p-3"},$I={key:0},kI={key:1},FI={class:"modal fade",id:"inline-query-item-editor",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},wI={class:"modal-dialog modal-lg"},CI={class:"modal-content"},SI={class:"modal-body"},jI={props:["bot","inlineQuery"],data(){return{load:!1,selectedInlineQueryItem:null,inlineQueryModal:null,inlineQueryForm:{id:null,command:null,description:null,items:[]}}},watch:{inlineQueryForm:{handler(s){this.need_reset=!0},deep:!0}},mounted(){this.inlineQueryModal=new bootstrap.Modal(document.getElementById("inline-query-item-editor"),{}),this.inlineQuery&&this.$nextTick(()=>{this.inlineQueryForm={id:this.inlineQuery.id||null,command:this.inlineQuery.command||null,description:this.inlineQuery.description||null,items:this.inlineQuery.items||[]}})},methods:{removeInlineQueryItem(s){const t=this.inlineQueryForm.items[s];this.inlineQueryForm.items.splice(s,1),this.$store.dispatch("removeInlineQueryItem",{queryItemId:t.id}).then(o=>{this.$notify("Команда успешно удалена")}).catch(o=>{this.$notify("Ошибка удаления команды")})},openModal(){this.load=!0,this.$nextTick(()=>{this.selectedInlineQueryItem=null,this.load=!1,this.inlineQueryModal.show()})},addInlineQueryItem(s){let t=this.inlineQueryForm.items.findIndex(o=>o.id===s.id);t===-1?this.inlineQueryForm.items.push(s):this.inlineQueryForm.items[t]=s},selectInlineQueryItem(s){this.load=!0,this.$nextTick(()=>{this.selectedInlineQueryItem=s,this.load=!1,this.inlineQueryModal.show()})},submitForm(){let s=new FormData;Object.keys(this.inlineQueryForm).forEach(t=>{const o=this.inlineQueryForm[t]||"";typeof o=="object"?s.append(t,JSON.stringify(o)):s.append(t,o)}),s.append("bot_id",this.bot.id),this.$store.dispatch("storeInlineQuery",{inlineQueryForm:s}).then(t=>{this.inlineQueryForm={id:null,command:null,description:null,items:[]},this.$emit("callback",t.data),this.$notify("Команда успешно создана")}).catch(t=>{this.$notify("Ошибка создания команды"),this.$emit("callback",response.data)})}}},VI=Object.assign(jI,{__name:"InlineQueryForm",setup(s){return(t,o)=>{const a=P("Popper");return l(),i(g,null,[e("form",{onSubmit:o[3]||(o[3]=S((...n)=>t.submitForm&&t.submitForm(...n),["prevent"]))},[e("div",NO,[e("div",JO,[e("label",HO,[b(a,{content:"Название оказываемой услуги"},{default:y(()=>[GO]),_:1}),m(" Название команды "),YO]),c(e("input",{type:"text",class:"form-control",placeholder:"Команда","aria-label":"Команда","onUpdate:modelValue":o[0]||(o[0]=n=>t.inlineQueryForm.command=n),maxlength:"255","aria-describedby":"service-title",required:""},null,512),[[_,t.inlineQueryForm.command]])]),e("div",WO,[e("label",ZO,[b(a,null,{content:y(()=>[xO]),default:y(()=>[XO]),_:1}),m(" Описание команду "),eI,t.inlineQueryForm.description?(l(),i("small",tI," Длина текста "+u(t.inlineQueryForm.description.length)+" / 255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Описание команды","aria-label":"Описание команды",maxlength:"255","onUpdate:modelValue":o[1]||(o[1]=n=>t.inlineQueryForm.description=n),"aria-describedby":"service-description",required:""},`
                    `,512),[[_,t.inlineQueryForm.description]])]),e("div",sI,[e("button",{type:"button",class:"btn btn-outline-primary",onClick:o[2]||(o[2]=(...n)=>t.openModal&&t.openModal(...n))}," Добавление пункта меню ")]),t.inlineQueryForm.items.length>0?(l(),i("div",oI,[e("div",lI,[e("table",iI,[nI,e("tbody",null,[(l(!0),i(g,null,$(t.inlineQueryForm.items,(n,d)=>(l(),i("tr",null,[e("td",{onClick:h=>t.selectInlineQueryItem(n)},u(n.title||"-"),9,aI),e("td",{onClick:h=>t.selectInlineQueryItem(n)},u(n.description||"-"),9,dI),e("td",{onClick:h=>t.selectInlineQueryItem(n)},u(n.input_message_content||"-"),9,rI),e("td",null,[n.inline_keyboard?(l(),i("i",cI)):(l(),i("i",uI))]),e("td",null,[(n.custom_settings||[]).length>0?(l(),i("i",mI)):(l(),i("i",hI))]),e("td",null,[e("div",_I,[pI,e("ul",bI,[e("li",null,[e("a",{class:"dropdown-item",onClick:h=>t.removeInlineQueryItem(d),href:"#"},"Удалить",8,fI)])])])])]))),256))])])])])):r("",!0)]),e("div",gI,[e("div",yI,[e("button",vI,[t.inlineQueryForm.id===null?(l(),i("span",$I,"Создать встроенное меню")):(l(),i("span",kI,"Обновить встроенное меню"))])])])],32),e("div",FI,[e("div",wI,[e("div",CI,[e("div",SI,[t.load?r("",!0):(l(),v(KO,{key:0,item:t.selectedInlineQueryItem,onCallback:t.addInlineQueryItem},null,8,["item","onCallback"]))])])])])],64)}}}),qI={class:"row"},zI={class:"col-12"},PI={key:0,class:"table"},UI=e("th",{scope:"col",class:"cursor-pointer"},"Кол-во пунктов меню",-1),AI=e("th",{scope:"col"},"Действие",-1),OI={scope:"row"},II=["onClick"],QI={key:0,class:"dropdown"},TI=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),BI={class:"dropdown-menu"},MI={key:0},RI=["onClick"],DI={key:1},EI={class:"col-12"},LI={props:["bot"],data(){return{direction:"desc",order:"updated_at",show:!0,loading:!0,queries:[],search:null,paginate_object:null}},computed:{...C(["getInlineQueries","getInlineQueriesPaginateObject"])},mounted(){this.loadInlineQueries()},methods:{nextInlineQuery(s){this.loadInlineQueries(s)},selectInlineQuery(s){this.$emit("select",s),this.$notify("Встроенное меню успешно выбрано")},removeInlineQuery(s){this.loading=!0,this.$store.dispatch("removeInlineQuery",{queryId:s}).then(t=>{this.loading=!1,this.loadInlineQueries(0),this.$notify("Встроенное меню успешно удалено")}).catch(()=>{this.loading=!1,this.$notify("Ошибка удаления встроенного меню")})},loadAndOrder(s){this.order=s,this.direction=this.direction==="desc"?"asc":"desc",this.loadInlineQueries(0)},loadInlineQueries(s=0){this.loading=!0,this.$store.dispatch("loadInlineQueries",{dataObject:{bot_id:this.bot.id||null,search:this.search,order:this.order,direction:this.direction},page:s,size:100}).then(t=>{this.loading=!1,this.queries=this.getInlineQueries,this.paginate_object=this.getInlineQueriesPaginateObject}).catch(()=>{this.loading=!1})}}},KI=Object.assign(LI,{__name:"InlineQueryTable",setup(s){return(t,o)=>(l(),i("div",qI,[e("div",zI,[t.queries.length>0?(l(),i("table",PI,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:o[0]||(o[0]=a=>t.loadAndOrder("id"))},"#"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[1]||(o[1]=a=>t.loadAndOrder("command"))},"Команда"),UI,e("th",{scope:"col",class:"cursor-pointer",onClick:o[2]||(o[2]=a=>t.loadAndOrder("description"))},"Описание"),AI])]),e("tbody",null,[(l(!0),i(g,null,$(t.queries,(a,n)=>(l(),i("tr",{class:p({"border-info":a.deleted_at==null,"border-danger":a.deleted_at!=null})},[e("th",OI,u(a.id),1),e("td",{onClick:d=>t.selectInlineQuery(a)},u(a.command||"Не указано"),9,II),e("td",null,u(a.items.length),1),e("td",null,u(a.description||"Не указано"),1),e("td",null,[a.id?(l(),i("div",QI,[TI,e("ul",BI,[a.deleted_at==null?(l(),i("li",MI,[e("a",{class:"dropdown-item",onClick:d=>t.removeInlineQuery(a.id),href:"javascript:void(0)"},"Удалить",8,RI)])):r("",!0)])])):r("",!0)])],2))),256))])])):(l(),i("p",DI,"На текущий момент нет ни одной созданной команды"))]),e("div",EI,[t.paginate_object?(l(),v(V,{key:0,onPagination_page:t.nextInlineQuery,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])]))}}),NI={class:"my-2"},JI={key:0,class:"row mb-2"},HI={class:"col-12"},GI={key:3,class:"spinner-border",role:"status"},YI=e("span",{class:"visually-hidden"},"Loading...",-1),WI=[YI],ZI={props:["bot"],data(){return{load:!1,selectedInlineQuery:null}},mounted(){},methods:{selectInlineQuery(s){this.load=!0,this.$nextTick(()=>{this.selectedInlineQuery=s,this.load=!1})},reloadTable(){this.load=!0,this.$nextTick(()=>{this.load=!1})}}},XI=Object.assign(ZI,{__name:"InlineQuery",setup(s){return(t,o)=>(l(),i("div",NI,[t.selectedInlineQuery!=null?(l(),i("div",JI,[e("div",HI,[e("button",{type:"button",onClick:o[0]||(o[0]=a=>t.selectInlineQuery(null)),class:"btn btn-primary"}," Добавить новое встроенное меню")])])):r("",!0),t.load?r("",!0):(l(),v(VI,{key:1,bot:s.bot,onCallback:t.reloadTable,"inline-query":t.selectedInlineQuery},null,8,["bot","onCallback","inline-query"])),t.load?r("",!0):(l(),v(KI,{key:2,bot:s.bot,onSelect:t.selectInlineQuery},null,8,["bot","onSelect"])),t.load?(l(),i("div",GI,WI)):r("",!0)]))}}),xI={class:"row"},eQ={class:"col-12 mb-3"},tQ={class:"form-label",id:"quiz-title"},sQ=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),oQ=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),lQ={class:"col-12 mb-3"},iQ={class:"form-label",id:"quiz-description"},nQ=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),aQ=e("div",null," Краткая информация о назначении промокода ",-1),dQ=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),rQ={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},cQ={class:"col-12 mb-3"},uQ={class:"form-check"},mQ=e("label",{class:"form-check-label",for:"is_active"}," Доступен для активации ",-1),hQ={class:"col-12 mb-3"},_Q={class:"form-label",id:"promoCodeForm-max_activation_count"},pQ=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),bQ=e("div",null," Максимальное число активация кода ",-1),fQ=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),gQ={class:"col-12 mb-3"},yQ={class:"form-check"},vQ=e("label",{class:"form-check-label",for:"promoCodeForm-cashback_amount"}," Нужно начислить CashBack по промокоду ",-1),$Q={key:0,class:"col-12 mb-3"},kQ={class:"form-label",id:"quiz-time_limit"},FQ=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),wQ=e("div",null," Сколько % нужно ответить чтоб пройти ",-1),CQ=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),SQ={key:1,class:"col-12 mb-3"},jQ={class:"form-check"},VQ=e("label",{class:"form-check-label",for:"promoCodeForm-need_slots"}," Нужны слоты для активации ",-1),qQ={key:2,class:"col-12 mb-3"},zQ={class:"form-label",id:"promoCodeForm-slot_amount"},PQ=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),UQ=e("div",null," Укажите количество слотов, которые получит пользователь при активации (внимание, доступно только для администраторов) ",-1),AQ=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),OQ={key:0,class:"col-12 mb-3"},IQ={class:"form-check"},QQ=e("label",{class:"form-check-label",for:"promoCodeForm-need_attach_scripts"}," Нужно добавить скрипты ",-1),TQ={key:1,class:"col-12 mb-3"},BQ=["onClick"],MQ={class:"row"},RQ={class:"col-12"},DQ={type:"submit",class:"btn btn-outline-success w-100 p-3"},EQ={key:0},LQ={key:1},KQ={props:["code","bot"],data(){return{step:0,load:!1,need_reset:!1,need_cashback:!1,need_slots:!1,need_attach_scripts:!1,promoCodeForm:{id:null,code:null,description:null,slot_amount:0,cashback_amount:0,max_activation_count:1,is_active:!1,scripts:[]}}},computed:{getSelf(){return window.profile}},watch:{promoCodeForm:{handler(s){this.need_reset=!0},deep:!0}},mounted(){this.code&&this.$nextTick(()=>{this.promoCodeForm={id:this.code.id||null,description:this.code.description||null,code:this.code.code||null,slot_amount:this.code.slot_amount||0,cashback_amount:this.code.cashback_amount||0,max_activation_count:this.code.max_activation_count||1,is_active:this.code.is_active||!1,scripts:this.code.scripts||[]},this.promoCodeForm.slot_amount>0&&(this.need_slots=!0),this.promoCodeForm.cashback_amount>0&&(this.need_cashback=!0),this.promoCodeForm.scripts.length>0&&(this.need_attach_scripts=!0)})},methods:{removeSlug(s){this.promoCodeForm.scripts.splice(s,1)},selectSlugsCallback(s){this.promoCodeForm.scripts.findIndex(o=>o.id===s.id)===-1&&this.promoCodeForm.scripts.push(s)},submitForm(){let s=new FormData;Object.keys(this.promoCodeForm).forEach(t=>{const o=this.promoCodeForm[t]||"";typeof o=="object"?s.append(t,JSON.stringify(o)):s.append(t,o)}),s.append("bot_id",this.bot.id),this.$store.dispatch("storePromoCodes",{promoCodeForm:s}).then(t=>{this.promoCodeForm={id:null,code:null,description:null,slot_amount:0,cashback_amount:0,max_activation_count:1,scripts:[],is_active:!1},this.$emit("callback",t.data),this.$notify("Промокод успешно создан")}).catch(t=>{this.$notify("Ошибка создания промокода")})}}},ke=Object.assign(KQ,{__name:"PromoCodesForm",setup(s){return(t,o)=>{const a=P("Popper");return l(),i("form",{onSubmit:o[9]||(o[9]=S((...n)=>t.submitForm&&t.submitForm(...n),["prevent"])),class:"py-3"},[e("div",xI,[e("div",eQ,[e("label",tQ,[b(a,{content:"Название вашего квиза"},{default:y(()=>[sQ]),_:1}),m(" Промокод (вписать или сгенерировать) "),oQ]),c(e("input",{type:"text",class:"form-control",placeholder:"Название","aria-label":"Название","onUpdate:modelValue":o[0]||(o[0]=n=>t.promoCodeForm.code=n),maxlength:"255","aria-describedby":"quiz-title",required:""},null,512),[[_,t.promoCodeForm.code]])]),e("div",lQ,[e("label",iQ,[b(a,null,{content:y(()=>[aQ]),default:y(()=>[nQ]),_:1}),m(" Назначение промокода "),dQ,t.promoCodeForm.description?(l(),i("small",rQ," Длина текста "+u(t.promoCodeForm.description.length)+"/255",1)):r("",!0)]),c(e("textarea",{class:"form-control",placeholder:"Описание промокода","aria-label":"Описание промокода",maxlength:"255","onUpdate:modelValue":o[1]||(o[1]=n=>t.promoCodeForm.description=n),"aria-describedby":"quiz-description",required:""},`
                    `,512),[[_,t.promoCodeForm.description]])]),e("div",cQ,[e("div",uQ,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[2]||(o[2]=n=>t.promoCodeForm.is_active=n),type:"checkbox",id:"is_active"},null,512),[[k,t.promoCodeForm.is_active]]),mQ])]),e("div",hQ,[e("label",_Q,[b(a,null,{content:y(()=>[bQ]),default:y(()=>[pQ]),_:1}),m(" Количество активация кода "),fQ]),c(e("input",{type:"number",class:"form-control",placeholder:"Число попыток","aria-label":"Число попыток",step:"1",min:"1","onUpdate:modelValue":o[3]||(o[3]=n=>t.promoCodeForm.max_activation_count=n),"aria-describedby":"promoCodeForm-max_activation_count",required:""},null,512),[[_,t.promoCodeForm.max_activation_count]])]),e("div",gQ,[e("div",yQ,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[4]||(o[4]=n=>t.need_cashback=n),type:"checkbox",id:"promoCodeForm-cashback_amount"},null,512),[[k,t.need_cashback]]),vQ])]),t.need_cashback?(l(),i("div",$Q,[e("label",kQ,[b(a,null,{content:y(()=>[wQ]),default:y(()=>[FQ]),_:1}),m(" Сколько CashBack начислить по промокоду? "),CQ]),c(e("input",{type:"number",class:"form-control",placeholder:"Процент для победы","aria-label":"Процент для победы",step:"1",min:"0","onUpdate:modelValue":o[5]||(o[5]=n=>t.promoCodeForm.cashback_amount=n),"aria-describedby":"promoCodeForm-cashback_amount",required:""},null,512),[[_,t.promoCodeForm.cashback_amount]])])):r("",!0),t.getSelf.is_admin?(l(),i("div",SQ,[e("div",jQ,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[6]||(o[6]=n=>t.need_slots=n),type:"checkbox",id:"promoCodeForm-need_slots"},null,512),[[k,t.need_slots]]),VQ])])):r("",!0),t.need_slots?(l(),i("div",qQ,[e("label",zQ,[b(a,null,{content:y(()=>[UQ]),default:y(()=>[PQ]),_:1}),m(" Сколько нужно добавить слотов? "),AQ]),c(e("input",{type:"number",class:"form-control",placeholder:"Количество слотов","aria-label":"Количество слотов",step:"1",min:"0","onUpdate:modelValue":o[7]||(o[7]=n=>t.promoCodeForm.slot_amount=n),"aria-describedby":"promoCodeForm-slot_amount",required:""},null,512),[[_,t.promoCodeForm.slot_amount]])])):r("",!0)]),t.getSelf.is_admin?(l(),i("div",OQ,[e("div",IQ,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[8]||(o[8]=n=>t.need_attach_scripts=n),type:"checkbox",id:"promoCodeForm-need_attach_scripts"},null,512),[[k,t.need_attach_scripts]]),QQ])])):r("",!0),t.need_attach_scripts?(l(),i("div",TQ,[e("p",null,[(l(!0),i(g,null,$(t.promoCodeForm.scripts,(n,d)=>(l(),i("span",{class:"badge bg-primary mr-2 mb-2 cursor-pointer",onClick:h=>t.removeSlug(d)},u(n.command||"-"),9,BQ))),256))]),s.bot?(l(),v(ae,{key:0,"can-add":!0,bot:s.bot,"hide-add-modal":!0,onSelect:t.selectSlugsCallback},null,8,["bot","onSelect"])):r("",!0)])):r("",!0),e("div",MQ,[e("div",RQ,[e("button",DQ,[t.promoCodeForm.id==null?(l(),i("span",EQ,"Создать промокод")):(l(),i("span",LQ,"Обновить промокод"))])])])],32)}}}),NQ={class:"row py-2"},JQ={class:"col-12"},HQ={class:"input-group mb-3"},GQ={class:"col-12"},YQ={key:0,class:"table"},WQ=e("th",{scope:"col",class:"cursor-pointer"},"Число активаций",-1),ZQ=e("th",{scope:"col"},"Действие",-1),XQ={scope:"row"},xQ=["onClick"],eT={key:0},tT={key:0,class:"fa-solid fa-chevron-down text-success"},sT={key:1,class:"fa-solid fa-xmark text-danger"},oT={key:0,class:"dropdown"},lT=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),iT={class:"dropdown-menu"},nT={key:0},aT=["onClick"],dT={key:1},rT=e("div",{class:"alert alert-warning alert-dismissible fade show",role:"alert"},[e("strong",null,"Внимание!"),m(" Вы еще не добавили ни одного промокода! "),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"alert","aria-label":"Close"})],-1),cT={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},uT={class:"d-flex justify-content-center mb-3"},mT={alt:"",width:"100",height:"100"},hT=e("h1",{class:"text-body-emphasis"},"Создание промокода",-1),_T=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"}," Промокод - это инструмент мотивации пользователей пользоваться вашим сервисом. Он позволяет клиентам получать некоторые бонусы за активацию кода, а вы в свою очередь будете видеть статистику активация прмокода. ",-1),pT={class:"d-inline-flex gap-2 mb-5"},bT=e("a",{href:"#",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),fT={key:0,class:"col-12"},gT={props:["bot"],data(){return{direction:"desc",order:"updated_at",show:!0,loading:!0,codes:[],search:null,paginate_object:null}},computed:{...C(["getPromoCodes","getPromoCodesPaginateObject"]),getSelf(){return window.profile}},mounted(){this.loadPromoCodes()},methods:{removeQuiz(s){this.loading=!0,this.$store.dispatch("removePromoCodes",{promoCodeId:s}).then(t=>{this.loading=!1,this.loadPromoCodes(0),this.$notify("Промокод успешно удален")}).catch(()=>{this.loading=!1,this.$notify("Ошибка удаления промокода")})},createPromoCode(){this.$emit("create")},nextPromoCodes(s){this.loadPromoCodes(s)},selectEvent(s){this.$emit("select",s)},loadAndOrder(s){this.order=s,this.direction=this.direction==="desc"?"asc":"desc",this.loadPromoCodes(0)},loadPromoCodes(s=0){this.loading=!0,this.$store.dispatch("loadPromoCodes",{dataObject:{bot_id:this.bot.id||null,search:this.search,order:this.order,direction:this.direction},page:s,size:20}).then(t=>{this.loading=!1,this.codes=this.getPromoCodes,this.paginate_object=this.getPromoCodesPaginateObject}).catch(()=>{this.loading=!1})}}},yT=Object.assign(gT,{__name:"PromoCodesTable",setup(s){return(t,o)=>{const a=T("lazy");return l(),i("div",NQ,[e("div",JQ,[e("div",HQ,[c(e("input",{type:"search",class:"form-control",placeholder:"Поиск кода","aria-label":"Поиск кода","onUpdate:modelValue":o[0]||(o[0]=n=>t.search=n),"aria-describedby":"promocode-search-and-filter"},null,512),[[_,t.search]]),e("button",{class:"btn btn-outline-secondary",onClick:o[1]||(o[1]=n=>t.loadPromoCodes(0)),type:"button",id:"promocode-search-and-filter"},"Найти ")])]),e("div",GQ,[t.codes.length>0?(l(),i("table",YQ,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:o[2]||(o[2]=n=>t.loadAndOrder("id"))},"#"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[3]||(o[3]=n=>t.loadAndOrder("code"))},"Код"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[4]||(o[4]=n=>t.loadAndOrder("description"))},"Описание"),t.getSelf.is_admin?(l(),i("th",{key:0,scope:"col",class:"cursor-pointer",onClick:o[5]||(o[5]=n=>t.loadAndOrder("slot_amount"))},"Число слотов ")):r("",!0),e("th",{scope:"col",class:"cursor-pointer",onClick:o[6]||(o[6]=n=>t.loadAndOrder("cashback_amount"))},"Величина CashBack-а, руб "),e("th",{scope:"col",class:"cursor-pointer",onClick:o[7]||(o[7]=n=>t.loadAndOrder("max_activation_count"))},"Максимальное число активаций "),WQ,e("th",{scope:"col",class:"cursor-pointer",onClick:o[8]||(o[8]=n=>t.loadAndOrder("is_active"))},"Активный"),ZQ])]),e("tbody",null,[(l(!0),i(g,null,$(t.codes,(n,d)=>(l(),i("tr",{class:p({"border-info":n.deleted_at==null,"border-danger":n.deleted_at!=null})},[e("th",XQ,u(n.id),1),e("td",{onClick:h=>t.selectEvent(n)},u(n.code||"Не указано"),9,xQ),e("td",null,u(n.description||"Не указано"),1),t.getSelf.is_admin?(l(),i("td",eT,u(n.slot_amount),1)):r("",!0),e("td",null,u(n.cashback_amount),1),e("td",null,u(n.max_activation_count),1),e("td",null,u(n.current_activation_count||0),1),e("td",null,[n.is_active?(l(),i("i",tT)):(l(),i("i",sT))]),e("td",null,[n.id?(l(),i("div",oT,[lT,e("ul",iT,[n.deleted_at==null?(l(),i("li",nT,[e("a",{class:"dropdown-item",onClick:h=>t.removeQuiz(n.id),href:"javascript:void(0)"},"Удалить",8,aT)])):r("",!0)])])):r("",!0)])],2))),256))])])):(l(),i("div",dT,[rT,e("div",cT,[e("div",uT,[c(e("img",mT,null,512),[[a,"../images/icon.png"]])]),hT,_T,e("div",pT,[e("button",{onClick:o[9]||(o[9]=(...n)=>t.createPromoCode&&t.createPromoCode(...n)),class:"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill btn-primary",type:"button"}," Добавить "),bT])])]))]),t.codes.length>0?(l(),i("div",fT,[t.paginate_object?(l(),v(V,{key:0,onPagination_page:t.nextPromoCodes,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])):r("",!0)])}}}),vT={key:0,class:"py-2"},$T={class:"row"},kT={class:"col-12"},FT={key:1,class:"py-2"},wT={class:"row"},CT={class:"col-12"},ST={key:2,class:"py-2"},jT={class:"row"},VT={class:"col-12"},qT={class:"nav nav-tabs justify-content-center"},zT={key:0,class:"row py-3"},PT={class:"col-12"},UT={key:1,class:"row py-3"},AT=e("div",{class:"col-12 py-3"},[e("h4",null,"Статистика")],-1),OT=[AT],IT={props:["bot"],data(){return{part:0,tab:0,selectedPromoCode:null,loadForm:!1,loadTable:!1}},methods:{callbackForm(){this.loadTable=!0,this.selectedPromoCode=null,this.part=0,this.$nextTick(()=>{this.loadTable=!1})},createPromoCode(){this.part=2},selectPromoCode(s){this.loadForm=!0,this.$nextTick(()=>{this.loadForm=!1,this.selectedPromoCode=s,this.part=1,this.tab=0})}}},QT=Object.assign(IT,{__name:"PromoCodes",setup(s){return(t,o)=>(l(),i(g,null,[t.part===0?(l(),i("div",vT,[e("div",$T,[e("div",kT,[e("button",{type:"button",onClick:o[0]||(o[0]=(...a)=>t.createPromoCode&&t.createPromoCode(...a)),class:"btn btn-primary"}," Создать новый промокод ")])]),t.loadTable?r("",!0):(l(),v(yT,{key:0,onCreate:t.createPromoCode,onSelect:t.selectPromoCode,bot:s.bot},null,8,["onCreate","onSelect","bot"]))])):r("",!0),t.part===2?(l(),i("div",FT,[e("div",wT,[e("div",CT,[e("button",{type:"button",onClick:o[1]||(o[1]=a=>t.part=0),class:"btn btn-outline-primary"}," Назад ")])]),t.loadForm?r("",!0):(l(),v(ke,{key:0,onCallback:t.callbackForm,bot:s.bot},null,8,["onCallback","bot"]))])):r("",!0),t.part===1?(l(),i("div",ST,[e("div",jT,[e("div",VT,[e("button",{type:"button",onClick:o[2]||(o[2]=a=>t.part=0),class:"btn btn-outline-primary"}," Назад ")])]),e("ul",qT,[e("li",{class:"nav-item",onClick:o[3]||(o[3]=a=>t.tab=0)},[e("a",{class:p(["nav-link",{active:t.tab===0}]),"aria-current":"page",href:"javascript:void(0)"},"Информация о Промокоде",2)]),e("li",{class:"nav-item",onClick:o[4]||(o[4]=a=>t.tab=1)},[e("a",{class:p(["nav-link",{active:t.tab===1}]),href:"javascript:void(0)"},"Статистика использования",2)])]),t.tab===0?(l(),i("div",zT,[e("div",PT,[t.loadForm?r("",!0):(l(),v(ke,{key:0,onCallback:t.callbackForm,code:t.selectedPromoCode,bot:s.bot},null,8,["onCallback","code","bot"]))])])):r("",!0),t.tab===1?(l(),i("div",UT,OT)):r("",!0)])):r("",!0)],64))}}),TT={props:["data"],data(){return{hasConnect:!1,bot:null,frontPadForm:{hook_url:null,channel:null,affiliate:null,point:null,token:null,statuses:[{value:null,key:"new",title:"Новый"}],bot_id:null,pays:[{value:null,key:"cash",title:"Наличные"},{value:null,key:"card",title:"Перевод на карту"}]}}},computed:{...C(["getCurrentBot"])},mounted(){this.bot=this.getCurrentBot,this.data?this.$nextTick(()=>{this.frontPadForm.hook_url=this.data.hook_url||null,this.frontPadForm.channel=this.data.channel||null,this.frontPadForm.affiliate=this.data.affiliate||null,this.frontPadForm.point=this.data.point||null,this.frontPadForm.token=this.data.token||null,this.frontPadForm.bot_id=this.data.bot_id||this.bot.id||null,this.data.pays!=null&&(this.frontPadForm.pays=this.data.pays),this.data.statuses!=null&&(this.frontPadForm.statuses=this.data.statuses)}):this.frontPadForm.bot_id=this.bot.id||null},methods:{submit(){let s=new FormData;Object.keys(this.frontPadForm).forEach(t=>{const o=this.frontPadForm[t]||"";typeof o=="object"?s.append(t,JSON.stringify(o)):s.append(t,o)}),this.$store.dispatch("saveFrontPad",{frontPadForm:s}).then(t=>{this.$notify("Данные CRM успешно сохранены")}).catch(t=>{})}}},BT={class:"col-md-6 col-12 mb-2"},MT={class:"form-label",id:"token"},RT=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),DT=e("div",null,"Токен интеграции",-1),ET=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),LT={class:"col-md-6 col-12 mb-2"},KT={class:"form-label",id:"channel"},NT=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),JT=e("div",null,'Данные брать из справочника FrontPad "Каналы продаж". Создать канал. Telegram. Указать значение для API',-1),HT={class:"col-md-6 col-12 mb-2"},GT={class:"form-label",id:"affiliate"},YT=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),WT=e("div",null,"Филиал",-1),ZT={class:"col-md-6 col-12 mb-2"},XT={class:"form-label",id:"point"},xT=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),eB=e("div",null,"Филиал",-1),tB={class:"col-12"},sB=e("div",{class:"alert alert-info",role:"alert"},' Данные брать из справочника FrontPad "Статусы". Указать значение для API ',-1),oB={key:0,class:"card mb-2 p-0"},lB=e("div",{class:"card-header"},[e("h6",null,"Статусы")],-1),iB={class:"card-body"},nB={class:"table"},aB=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"Название"),e("th",{scope:"col"},"Ключ"),e("th",{scope:"col"},"Значение")])],-1),dB=["onUpdate:modelValue"],rB={class:"col-12"},cB=e("div",{class:"alert alert-info",role:"alert"},' Данные брать из справочника FrontPad "Варианты оплат". Указать значение для API ',-1),uB={key:0,class:"card mb-2 p-0"},mB=e("div",{class:"card-header"},[e("h6",null,"Типы оплаты")],-1),hB={class:"card-body"},_B={class:"table"},pB=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"Название"),e("th",{scope:"col"},"Ключ"),e("th",{scope:"col"},"Значение")])],-1),bB=["onUpdate:modelValue"],fB=e("div",{class:"col-md-12 col-12"},[e("button",{type:"submit",class:"btn btn-outline-primary p-3 w-100"},[e("i",{class:"fa-solid fa-cloud-arrow-down mr-1"}),m(" Сохранить настройку ")])],-1);function gB(s,t,o,a,n,d){const h=P("Popper");return l(),i("form",{onSubmit:t[4]||(t[4]=S((...f)=>d.submit&&d.submit(...f),["prevent"])),class:"row"},[e("div",BT,[e("label",MT,[b(h,null,{content:y(()=>[DT]),default:y(()=>[RT]),_:1}),m(" Токен интеграции "),ET]),c(e("input",{type:"text",class:"form-control",placeholder:"Токен","aria-label":"Токен","onUpdate:modelValue":t[0]||(t[0]=f=>n.frontPadForm.token=f),"aria-describedby":"token"},null,512),[[_,n.frontPadForm.token]])]),e("div",LT,[e("label",KT,[b(h,null,{content:y(()=>[JT]),default:y(()=>[NT]),_:1}),m(" Канал продаж ")]),c(e("input",{type:"text",class:"form-control",placeholder:"channel","aria-label":"channel","onUpdate:modelValue":t[1]||(t[1]=f=>n.frontPadForm.channel=f),"aria-describedby":"channel"},null,512),[[_,n.frontPadForm.channel]])]),e("div",HT,[e("label",GT,[b(h,null,{content:y(()=>[WT]),default:y(()=>[YT]),_:1}),m(" Филиал ")]),c(e("input",{type:"text",class:"form-control",placeholder:"Филиал","aria-label":"Филиал","onUpdate:modelValue":t[2]||(t[2]=f=>n.frontPadForm.affiliate=f),"aria-describedby":"Филиал"},null,512),[[_,n.frontPadForm.affiliate]])]),e("div",ZT,[e("label",XT,[b(h,null,{content:y(()=>[eB]),default:y(()=>[xT]),_:1}),m(" Точка продаж ")]),c(e("input",{type:"text",class:"form-control",placeholder:"Точка продаж","aria-label":"Точка продаж","onUpdate:modelValue":t[3]||(t[3]=f=>n.frontPadForm.point=f),"aria-describedby":"Точка продаж"},null,512),[[_,n.frontPadForm.point]])]),e("div",tB,[sB,n.frontPadForm.statuses?(l(),i("div",oB,[lB,e("div",iB,[e("table",nB,[aB,e("tbody",null,[(l(!0),i(g,null,$(n.frontPadForm.statuses,(f,F)=>(l(),i("tr",null,[e("td",null,u(f.title||"-"),1),e("td",null,u(f.key||"-"),1),e("td",null,[c(e("input",{type:"text",class:"form-control",placeholder:"Статус","aria-label":"Статус","onUpdate:modelValue":w=>n.frontPadForm.statuses[F].value=w,"aria-describedby":"Статус"},null,8,dB),[[_,n.frontPadForm.statuses[F].value]])])]))),256))])])])])):r("",!0)]),e("div",rB,[cB,n.frontPadForm.pays?(l(),i("div",uB,[mB,e("div",hB,[e("table",_B,[pB,e("tbody",null,[(l(!0),i(g,null,$(n.frontPadForm.pays,(f,F)=>(l(),i("tr",null,[e("td",null,u(f.title||"-"),1),e("td",null,u(f.key||"-"),1),e("td",null,[c(e("input",{type:"text",class:"form-control",placeholder:"Статус","aria-label":"Статус","onUpdate:modelValue":w=>n.frontPadForm.pays[F].value=w,"aria-describedby":"Статус"},null,8,bB),[[_,n.frontPadForm.pays[F].value]])])]))),256))])])])])):r("",!0)]),fB],32)}const yB=A(TT,[["render",gB]]),vB={props:["bot","date"],data(){return{traffics:[],sort:{key:"created_at",direction:"asc"}}},mounted(){this.prepareStatistic()},methods:{changeSort(s){this.sort.key=s,this.sort.direction=this.sort.direction==="asc"?"desc":"asc"},prepareStatistic(){return this.loadedChart=!1,this.$store.dispatch("trafficLoad",{bot_id:this.bot.id,date:this.date,need_all:!this.need_date_range,sort:this.sort}).then(s=>{this.traffics=s.traffics})}}},$B={key:0,class:"table"},kB={scope:"col"},FB={key:0,class:"fa-solid fa-arrow-up-wide-short"},wB={key:1,class:"fa-solid fa-arrow-up-short-wide"},CB={scope:"col"},SB={key:0,class:"fa-solid fa-arrow-up-wide-short"},jB={key:1,class:"fa-solid fa-arrow-up-short-wide"},VB={scope:"col"},qB={key:0,class:"fa-solid fa-arrow-up-wide-short"},zB={key:1,class:"fa-solid fa-arrow-up-short-wide"},PB={scope:"row"},UB={key:1,class:"text-danger my-3"};function AB(s,t,o,a,n,d){return(n.traffics||[]).length>0?(l(),i("table",$B,[e("thead",null,[e("tr",null,[e("th",kB,[e("a",{href:"javascript:void(0)",onClick:t[0]||(t[0]=h=>d.changeSort("id"))},[n.sort.key==="id"?(l(),i(g,{key:0},[n.sort.direction==="asc"?(l(),i("i",FB)):(l(),i("i",wB))],64)):r("",!0),m(" # ")])]),e("th",CB,[e("a",{href:"javascript:void(0)",onClick:t[1]||(t[1]=h=>d.changeSort("source"))},[n.sort.key==="source"?(l(),i(g,{key:0},[n.sort.direction==="asc"?(l(),i("i",SB)):(l(),i("i",jB))],64)):r("",!0),m(" Источник ")])]),e("th",VB,[e("a",{href:"javascript:void(0)",onClick:t[2]||(t[2]=h=>d.changeSort("count"))},[n.sort.key==="count"?(l(),i(g,{key:0},[n.sort.direction==="asc"?(l(),i("i",qB)):(l(),i("i",zB))],64)):r("",!0),m(" Число переходов ")])])])]),e("tbody",null,[(l(!0),i(g,null,$(n.traffics,(h,f)=>(l(),i("tr",null,[e("th",PB,u(f+1),1),e("td",null,u(h.source),1),e("td",null,u(h.count),1)]))),256))])])):(l(),i("p",UB,"Нет данных по продажам за выбранный период:("))}const OB=A(vB,[["render",AB]]);const IB={class:"container"},QB={class:"row my-3"},TB={key:0,class:"col-md-4"},BB={class:"row"},MB={class:"col-12"},RB={class:"form-check form-switch"},DB=e("label",{class:"form-check-label",for:"flexSwitchCheckDefault"}," Использовать временной период ",-1),EB={class:"row"},LB={class:"col-6"},KB=e("h6",{class:"my-3 fw-bold"},"Основная статистика",-1),NB=e("p",{class:"fst-italic"}," Сводка всех показателей эффективности работы системы ",-1),JB={key:0,class:"table"},HB=e("thead",null,[e("tr",{class:"bg-light"},[e("th",{scope:"col",style:{width:"200px"}},"Ключ"),e("th",{scope:"col"},"Значение")])],-1),GB=e("th",{scope:"row"},"Всего пользователей в БД",-1),YB={class:"font-weight-bold"},WB=e("th",{scope:"row"},"Всего VIP",-1),ZB={class:"font-weight-bold"},XB=e("th",{scope:"row"},"Администраторы в БД",-1),xB={class:"font-weight-bold"},eM=e("th",{scope:"row"},"Администраторы за работой",-1),tM={class:"font-weight-bold"},sM=e("th",{scope:"row"},"Всего кэшбэка на счету у пользователей, руб",-1),oM={class:"font-weight-bold"},lM={key:0},iM=e("th",{scope:"row"},"Всего кэшбэка начислено пользователям, руб",-1),nM={class:"font-weight-bold"},aM={key:0},dM=e("th",{scope:"row"},"Всего кэшбэка списано у пользователей, руб",-1),rM={class:"font-weight-bold"},cM={key:0},uM=e("th",{scope:"row"},"Всего начислено кэшбэка первого уровня, руб",-1),mM={class:"font-weight-bold"},hM={key:0},_M=e("th",{scope:"row"},"Всего начислено кэшбэка второго уровня, руб",-1),pM={class:"font-weight-bold"},bM={key:0},fM=e("th",{scope:"row"},"Всего начислено кэшбэка третьего уровня, руб",-1),gM={class:"font-weight-bold"},yM={key:0},vM=e("i",{class:"fa-regular fa-file-excel mr-2"},null,-1),$M={class:"col-6"},kM={class:"form-check form-switch my-3"},FM=e("label",{class:"form-check-label",for:"flexSwitchCheckDefault"},"Отобразить графики",-1),wM={class:"row my-3 sticky-charts"},CM={class:"col-12"},SM={class:"nav nav-tabs"},jM={class:"nav-item"},VM={class:"nav-item"},qM={class:"nav-item"},zM={class:"nav-item"},PM={key:0,class:"col-12"},UM={key:0,class:"d-flex justify-content-center mb-3"},AM={key:1,class:"text-danger my-2"},OM={key:1,class:"w-100 overflow-x-scroll"},IM={class:"table"},QM=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"#"),e("th",{scope:"col"},"Год"),e("th",{scope:"col"},"Месяц"),e("th",{scope:"col"},"Число пользователей")])],-1),TM={scope:"row"},BM={key:1,class:"col-12"},MM=e("h6",{class:"my-2"},"Начисления",-1),RM={class:"d-flex justify-content-center mb-3"},DM={key:1,class:"text-danger my-3"},EM=e("h6",{class:"my-2"},"Списания",-1),LM={class:"d-flex justify-content-center mb-3"},KM={key:1,class:"text-danger my-3"},NM={key:1,class:"w-100 overflow-x-scroll"},JM={class:"table"},HM=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"#"),e("th",{scope:"col"},"Год"),e("th",{scope:"col"},"Месяц"),e("th",{scope:"col"},"Начислено"),e("th",{scope:"col"},"Списано")])],-1),GM={scope:"row"},YM={key:2,class:"col-12"},WM={key:0,class:"d-flex justify-content-center mb-3"},ZM={key:1,class:"text-danger my-3"},XM={key:2,class:"table"},xM=e("th",{scope:"col"},"#",-1),eR={scope:"col"},tR={key:0,class:"fa-solid fa-arrow-up-wide-short"},sR={key:1,class:"fa-solid fa-arrow-up-short-wide"},oR={scope:"col"},lR={key:0,class:"fa-solid fa-arrow-up-wide-short"},iR={key:1,class:"fa-solid fa-arrow-up-short-wide"},nR={scope:"col"},aR={key:0,class:"fa-solid fa-arrow-up-wide-short"},dR={key:1,class:"fa-solid fa-arrow-up-short-wide"},rR={scope:"col"},cR={key:0,class:"fa-solid fa-arrow-up-wide-short"},uR={key:1,class:"fa-solid fa-arrow-up-short-wide"},mR={scope:"col"},hR={key:0,class:"fa-solid fa-arrow-up-wide-short"},_R={key:1,class:"fa-solid fa-arrow-up-short-wide"},pR={scope:"row"},bR={key:3,class:"text-danger my-3"},fR={key:3,class:"col-12"},gR={props:["bot"],components:{Chart:R,Grid:K,Line:lt,Bar:N,Tooltip:M,Responsive:je,Pie:Ve,VueDatePicker:x},data(){return{sort:{key:"price",direction:"asc"},need_charts:!1,need_date_range:!1,date:null,tab:0,botUser:null,loadedChart:!1,statistic:null,loading:!1,tooltipConfig:{sump:{label:"Сумма продаж",color:"#5d1010"},m:{label:"Месяц",color:"#54a375"},y:{label:"Год",color:"#0ea9cb"}},products:[{title:"1",count:1,price:2020},{title:"2",count:2,price:2020},{title:"3",count:3,price:2020},{title:"4",count:4,price:2020},{title:"5",count:5,price:2020}],orders:[{sump:0,m:1,y:2020},{sump:111,m:2,y:2020},{sump:222,m:3,y:2020},{sump:333,m:4,y:2020},{sump:444,m:5,y:2020}],users:[{count:0,m:1,y:2020},{count:111,m:2,y:2020},{count:222,m:3,y:2020},{count:333,m:4,y:2020},{count:444,m:5,y:2020}],cashback_up:[{sum:0,m:1,y:2020},{sum:111,m:2,y:2020},{sum:222,m:3,y:2020},{sum:333,m:4,y:2020},{sum:444,m:5,y:2020}],cashback_down:[{sum:0,m:1,y:2020},{sum:111,m:2,y:2020},{sum:222,m:3,y:2020},{sum:333,m:4,y:2020},{sum:444,m:5,y:2020}],direction:"horizontal",margin:{left:0,top:20,right:20,bottom:0},axis:{primary:{type:"band"},secondary:{domain:["dataMin","dataMax + 100"],type:"linear",ticks:11}}}},computed:{preparedCashback(){if(this.cashback_up.length===0&&this.cashback_down.length===0)return[];let s=[];for(let t=0;t<this.cashback_up.length;t++){let o=null;for(let a=0;a<this.cashback_down.length;a++){let n=this.cashback_down[a],d=this.cashback_up[t];if(d.m===n.m&&d.y===n.y){o=this.cashback_down[a];break}}s.push({y:this.cashback_up[t].y||0,m:this.cashback_up[t].m||0,up:this.cashback_up[t].sum||0,down:o===null?0:o.sum})}return s}},watch:{sort:{handler:function(s){this.prepareStatistic()},deep:!0},need_date_range:function(){this.prepareStatistic()},date:function(){this.prepareStatistic()}},mounted(){const s=new Date,t=new Date(new Date().setDate(s.getDate()+7));this.date=[s,t],this.prepareStatistic()},methods:{changeSort(s){this.sort.key=s,this.sort.direction=this.sort.direction==="asc"?"desc":"asc"},prepareStatistic(){return this.loadedChart=!1,this.$store.dispatch("statisticLoad",{bot_id:this.bot.id,date:this.date,need_all:!this.need_date_range,sort:this.sort}).then(s=>{this.statistic=s.statistic,this.orders=this.statistic.orders.sum,this.products=this.statistic.orders.products,this.users=this.statistic.users.sum,this.cashback_up=this.statistic.cashback_up.sum,this.cashback_down=this.statistic.cashback_down.sum,this.loadedChart=!0})},downloadBotStatistic(){this.$notify({title:"Внимание!",text:"Начался формироваться документ статистики!"}),this.$store.dispatch("downloadBotStatistic").then(s=>{this.$notify({title:"Отлично!",text:"Документ успешно сформирован",type:"success"})}).catch(()=>{this.$notify({title:"Упс!",text:"Что-то пошло не так...",type:"error"})})}}},yR=Object.assign(gR,{__name:"Statistic",setup(s){return(t,o)=>{const a=P("Marker"),n=P("divs");return l(),i("div",IB,[e("div",QB,[t.need_date_range?(l(),i("div",TB,[b(j(x),{modelValue:t.date,"onUpdate:modelValue":o[0]||(o[0]=d=>t.date=d),locale:"ru",range:""},null,8,["modelValue"])])):r("",!0)]),e("div",BB,[e("div",MB,[e("div",RB,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[1]||(o[1]=d=>t.need_date_range=d),type:"checkbox",role:"switch",id:"flexSwitchCheckDefault"},null,512),[[k,t.need_date_range]]),DB])])]),e("div",EB,[e("div",LB,[KB,NB,t.statistic?(l(),i("table",JB,[HB,e("tbody",null,[e("tr",null,[GB,e("td",YB,u(t.statistic.users_in_bd||0),1)]),e("tr",null,[WB,e("td",ZB,u(t.statistic.vip_in_bd||0),1)]),e("tr",null,[XB,e("td",xB,u(t.statistic.admin_in_bd||0),1)]),e("tr",null,[eM,e("td",tM,u(t.statistic.work_admin_in_bd||0),1)]),e("tr",null,[sM,e("td",oM,[m(u((t.statistic.summary_cashback||0).toFixed(2))+" ",1),t.statistic.summary_cashback_people_count?(l(),i("strong",lM,"("+u(t.statistic.summary_cashback_people_count)+" чел)",1)):r("",!0)])]),e("tr",null,[iM,e("td",nM,[m(u((t.statistic.cashback_summary_up||0).toFixed(2))+" ",1),t.statistic.cashback_summary_up_people_count?(l(),i("strong",aM,"("+u(t.statistic.cashback_summary_up_people_count)+" чел)",1)):r("",!0)])]),e("tr",null,[dM,e("td",rM,[m(u((t.statistic.cashback_summary_down||0).toFixed(2))+" ",1),t.statistic.cashback_summary_down_people_count?(l(),i("strong",cM,"("+u(t.statistic.cashback_summary_down_people_count)+" чел)",1)):r("",!0)])]),e("tr",null,[uM,e("td",mM,[m(u((t.statistic.cashback_up_level_1||0).toFixed(2))+" ",1),t.statistic.cashback_up_level_1_people_count?(l(),i("strong",hM,"("+u(t.statistic.cashback_up_level_1_people_count)+" чел)",1)):r("",!0)])]),e("tr",null,[_M,e("td",pM,[m(u((t.statistic.cashback_up_level_2||0).toFixed(2))+" ",1),t.statistic.cashback_up_level_2_people_count?(l(),i("strong",bM,"("+u(t.statistic.cashback_up_level_2_people_count)+" чел)",1)):r("",!0)])]),e("tr",null,[fM,e("td",gM,[m(u((t.statistic.cashback_up_level_3||0).toFixed(2))+" ",1),t.statistic.cashback_up_level_3_people_count?(l(),i("strong",yM,"("+u(t.statistic.cashback_up_level_3_people_count)+" чел)",1)):r("",!0)])])])])):r("",!0),e("a",{href:"javascript:void(0)",onClick:o[2]||(o[2]=(...d)=>t.downloadBotStatistic&&t.downloadBotStatistic(...d)),class:"btn w-100 btn-outline-info p-3"},[vM,m(" Скачать статистику ")])]),e("div",$M,[e("div",kM,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[3]||(o[3]=d=>t.need_charts=d),type:"checkbox",role:"switch",id:"flexSwitchCheckDefault"},null,512),[[k,t.need_charts]]),FM]),e("div",wM,[e("div",CM,[e("ul",SM,[e("li",jM,[e("a",{class:p(["nav-link",{active:t.tab===0}]),onClick:o[4]||(o[4]=d=>t.tab=0),"aria-current":"page",href:"#"},"Пользователи",2)]),e("li",VM,[e("a",{class:p(["nav-link",{active:t.tab===1}]),onClick:o[5]||(o[5]=d=>t.tab=1),"aria-current":"page",href:"#"},"Бонусы",2)]),e("li",qM,[e("a",{class:p(["nav-link",{active:t.tab===2}]),onClick:o[6]||(o[6]=d=>t.tab=2),"aria-current":"page",href:"#"},"Продажи",2)]),e("li",zM,[e("a",{class:p(["nav-link",{active:t.tab===3}]),onClick:o[7]||(o[7]=d=>t.tab=3),"aria-current":"page",href:"#"},"Переходы",2)])])]),t.tab===0?(l(),i("div",PM,[t.need_charts?(l(),i("div",UM,[t.loadedChart&&(t.users||[]).length>0?(l(),v(j(R),{key:0,size:{width:500,height:320},data:t.users,margin:t.margin,direction:t.direction,axis:t.axis},{layers:y(()=>[b(j(K),{strokeDasharray:"2,2"}),b(j(N),{dataKeys:["m","count"],barStyle:{fill:"#ffe775"}}),b(a,{value:1e3,label:"Avg.",color:"#e76f51",strokeWidth:"2",strokeDasharray:"6 6"})]),widgets:y(()=>[b(j(M),{borderColor:"#48CAE4",config:t.tooltipConfig},null,8,["config"])]),_:1},8,["data","margin","direction","axis"])):(l(),i("p",AM,"Статистика еще не загружена или её нет"))])):r("",!0),(t.users||[]).length>0?(l(),i("div",OM,[e("table",IM,[QM,e("tbody",null,[(l(!0),i(g,null,$(t.users,(d,h)=>(l(),i("tr",null,[e("th",TM,u(h+1),1),e("td",null,u(d.y),1),e("td",null,u(d.m),1),e("td",null,u(d.count),1)]))),256))])])])):r("",!0)])):r("",!0),t.tab===1?(l(),i("div",BM,[t.need_charts?(l(),i(g,{key:0},[MM,e("div",RM,[t.loadedChart&&(t.cashback_up||[]).length>0?(l(),v(j(R),{key:0,size:{width:500,height:320},data:t.cashback_up,margin:t.margin,direction:t.direction,axis:t.axis},{layers:y(()=>[b(j(K),{strokeDasharray:"2,2"}),b(j(N),{dataKeys:["m","sum"],barStyle:{fill:"#ffe775"}}),b(a,{value:1e3,label:"Avg.",color:"#e76f51",strokeWidth:"2",strokeDasharray:"6 6"})]),widgets:y(()=>[b(j(M),{borderColor:"#48CAE4",config:t.tooltipConfig},null,8,["config"])]),_:1},8,["data","margin","direction","axis"])):(l(),i("p",DM,"Статистика еще не загружена или её нет"))]),EM,e("div",LM,[t.loadedChart&&(t.cashback_down||[]).length>0?(l(),v(j(R),{key:0,size:{width:500,height:320},data:t.cashback_down,margin:t.margin,direction:t.direction,axis:t.axis},{layers:y(()=>[b(j(K),{strokeDasharray:"2,2"}),b(j(N),{dataKeys:["m","sum"],barStyle:{fill:"#ffe775"}}),b(a,{value:1e3,label:"Avg.",color:"#e76f51",strokeWidth:"2",strokeDasharray:"6 6"})]),widgets:y(()=>[b(j(M),{borderColor:"#48CAE4",config:t.tooltipConfig},null,8,["config"])]),_:1},8,["data","margin","direction","axis"])):(l(),i("p",KM,"Статистика еще не загружена или её нет"))])],64)):r("",!0),(t.preparedCashback||[]).length>0?(l(),i("div",NM,[e("table",JM,[HM,e("tbody",null,[(l(!0),i(g,null,$(t.preparedCashback,(d,h)=>(l(),i("tr",null,[e("th",GM,u(h+1),1),e("td",null,u(d.y),1),e("td",null,u(d.m),1),e("td",null,u(d.up),1),e("td",null,u(d.down),1)]))),256))])])])):r("",!0)])):r("",!0),t.tab===2?(l(),i("div",YM,[t.need_charts?(l(),i("div",WM,[t.loadedChart&&(t.orders||[]).length>0?(l(),v(j(R),{key:0,size:{width:500,height:320},data:t.orders,margin:t.margin,direction:t.direction,axis:t.axis},{layers:y(()=>[b(j(K),{strokeDasharray:"2,2"}),b(j(N),{dataKeys:["m","sump"],barStyle:{fill:"#ffe775"}}),b(a,{value:1e3,label:"Avg.",color:"#e76f51",strokeWidth:"2",strokeDasharray:"6 6"})]),widgets:y(()=>[b(j(M),{borderColor:"#48CAE4",config:t.tooltipConfig},null,8,["config"])]),_:1},8,["data","margin","direction","axis"])):(l(),i("p",ZM,"Статистика еще не загружена или её нет"))])):r("",!0),t.need_charts?(l(),v(n,{key:1,class:"d-flex"},{default:y(()=>[b(j(je),{class:"w-full"},{main:y(({width:d})=>[b(j(R),{direction:"circular",size:{width:d,height:400},data:t.products,margin:{left:Math.round((d-360)/2),top:50,right:0,bottom:0},axis:t.axis,config:{controlHover:!1}},{layers:y(()=>[b(j(Ve),{dataKeys:["title","count","price"],"pie-style":{innerRadius:100,padAngle:.05}},null,8,["pie-style"])]),widgets:y(()=>[b(j(M),{config:{title:{label:"Название"},price:{label:"Выручено средств"},count:{label:"Кол-во"},volume_count_ratio:{hide:!0},volume_price_ratio:{hide:!0}},hideLine:""})]),_:2},1032,["size","data","margin","axis"])]),_:1})]),_:1})):r("",!0),(t.products||[]).length>0?(l(),i("table",XM,[e("thead",null,[e("tr",null,[xM,e("th",eR,[e("a",{href:"javascript:void(0)",onClick:o[8]||(o[8]=d=>t.changeSort("title"))},[t.sort.key==="title"?(l(),i(g,{key:0},[t.sort.direction==="asc"?(l(),i("i",tR)):(l(),i("i",sR))],64)):r("",!0),m(" Название ")])]),e("th",oR,[e("a",{href:"javascript:void(0)",onClick:o[9]||(o[9]=d=>t.changeSort("price"))},[t.sort.key==="price"?(l(),i(g,{key:0},[t.sort.direction==="asc"?(l(),i("i",lR)):(l(),i("i",iR))],64)):r("",!0),m(" Объем продаж ")])]),e("th",nR,[e("a",{href:"javascript:void(0)",onClick:o[10]||(o[10]=d=>t.changeSort("count"))},[t.sort.key==="count"?(l(),i(g,{key:0},[t.sort.direction==="asc"?(l(),i("i",aR)):(l(),i("i",dR))],64)):r("",!0),m(" Продано ед. ")])]),e("th",rR,[e("a",{href:"javascript:void(0)",onClick:o[11]||(o[11]=d=>t.changeSort("volume_count_ratio"))},[t.sort.key==="volume_count_ratio"?(l(),i(g,{key:0},[t.sort.direction==="asc"?(l(),i("i",cR)):(l(),i("i",uR))],64)):r("",!0),m(" % от объема ")])]),e("th",mR,[e("a",{href:"javascript:void(0)",onClick:o[12]||(o[12]=d=>t.changeSort("volume_price_ratio"))},[t.sort.key==="volume_price_ratio"?(l(),i(g,{key:0},[t.sort.direction==="asc"?(l(),i("i",hR)):(l(),i("i",_R))],64)):r("",!0),m(" % от числа ")])])])]),e("tbody",null,[(l(!0),i(g,null,$(t.products,(d,h)=>(l(),i("tr",null,[e("th",pR,u(h+1),1),e("td",null,u(d.title),1),e("td",null,u(d.price),1),e("td",null,u(d.count),1),e("td",null,u(d.volume_count_ratio),1),e("td",null,u(d.volume_price_ratio),1)]))),256))])])):(l(),i("p",bR,"Нет данных по продажам за выбранный период:("))])):r("",!0),t.tab===3?(l(),i("div",fR,[b(OB,{date:t.date,bot:s.bot},null,8,["date","bot"])])):r("",!0)])])])])}}});const vR={class:"d-flex custom-dropdown justify-content-between align-items-center"},$R={class:"btn-group"},kR=e("i",{class:"fa-solid fa-info mr-2"},null,-1),FR=e("i",{class:"fa-solid fa-file mr-2"},null,-1),wR=e("i",{class:"fa-solid fa-chart-column mr-2"},null,-1),CR={key:0,class:"btn btn-primary",type:"button","data-bs-toggle":"offcanvas","data-bs-target":"#bot-section-menu","aria-controls":"staticBackdrop"},SR=e("i",{class:"fa-solid fa-screwdriver-wrench p-2 text-primary"},null,-1),jR=[SR],VR={key:0,class:"pb-5 mb-5"},qR={key:1,class:"pb-5 mb-5"},zR={key:2,class:"pb-5 mb-5"},PR={key:3,class:"pb-5 mb-5"},UR={key:4,class:"pb-5 mb-5"},AR={key:5,class:"pb-5 mb-5"},OR={key:6,class:"pb-5 mb-5"},IR={key:7,class:"pb-5 mb-5"},QR={key:8,class:"pb-5 mb-5"},TR={key:9,class:"pb-5 pt-2 mb-5"},BR={key:10,class:"pb-5 mb-5"},MR={key:11,class:"pb-5 mb-5 pt-2"},RR={key:12,class:"pb-5 mb-5"},DR={key:13,class:"pb-5 mb-5 pt-2"},ER={key:14,class:"pb-5 mb-5 pt-2"},LR={key:15,class:"pb-5 mb-5 pt-2"},KR={key:16,class:"row pb-5 mb-5"},NR={key:0,class:"col-12 col-md-12"},JR={key:17,class:"pb-5 mb-5"},HR={class:"offcanvas offcanvas-end","data-bs-scroll":"true","data-bs-backdrop":"false",tabindex:"-1",id:"bot-section-menu","aria-labelledby":"staticBackdropLabel"},GR=e("div",{class:"offcanvas-header"},[e("h5",{class:"offcanvas-title",id:"staticBackdropLabel"},"Меню управления ботом"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"offcanvas","aria-label":"Close"})],-1),YR={class:"offcanvas-body"},WR={class:"list-group list-group-flush bot-section-menu-group"},ZR=e("i",{class:"fa-regular fa-newspaper mr-2"},null,-1),XR=e("i",{class:"fa-regular fa-calendar-days mr-2"},null,-1),xR=e("i",{class:"fa-solid fa-q mr-2"},null,-1),eD=e("i",{class:"fa-solid fa-q mr-2"},null,-1),tD=e("i",{class:"fa-solid fa-clipboard-list mr-2"},null,-1),sD=e("i",{class:"fa-solid fa-code mr-2"},null,-1),oD=e("i",{class:"fa-solid fa-keyboard mr-2"},null,-1),lD=e("i",{class:"fa-solid fa-scroll mr-2"},null,-1),iD=e("i",{class:"fa-solid fa-comment-dots mr-2"},null,-1),nD=e("i",{class:"fa-solid fa-users mr-2"},null,-1),aD=e("i",{class:"fa-solid fa-list-check mr-2"},null,-1),dD=e("i",{class:"fa-solid fa-list-check mr-2"},null,-1),rD=e("i",{class:"fa-solid fa-list-check mr-2"},null,-1),cD=e("i",{class:"fa-brands fa-shopify mr-2"},null,-1),uD=e("i",{class:"fa-brands fa-shopify mr-2"},null,-1),mD={props:["bot"],data(){return{page:null,step:0,load:!1,loadPage:!1}},mounted(){this.setStep(localStorage.getItem("cashman_set_botform_step_index")||0)},methods:{botCallbackUpdate(s){this.$store.dispatch("updateCurrentBot",{bot:s}).then(()=>{}),this.$emit("callback")},hasRole(s){return window.hasRole(s)||!1},setStep(s){this.step=parseInt(s),localStorage.setItem("cashman_set_botform_step_index",s)},pageListCallback(s){this.loadPage=!0,this.page=s,this.$nextTick(()=>{this.loadPage=!1})},botSettingsCallback(){this.step=0,document.documentElement.scrollTop=200,this.$nextTick(()=>{window.dispatchEvent(new CustomEvent("add-payment-system-event"))})},pageCallback(s){this.page=s,this.loadPageList=!0,this.$nextTick(()=>{this.loadPageList=!1})},loadCurrentCompany(s=null){this.$store.dispatch("updateCurrentCompany",{company:s}).then(()=>{this.company=this.getCurrentCompany})},companyListCallback(s){this.load=!0,this.loadCurrentCompany(s),this.$nextTick(()=>{this.load=!1})}}},cL=Object.assign(mD,{__name:"BotSection",setup(s){return(t,o)=>(l(),i(g,null,[e("div",vR,[e("div",$R,[e("button",{type:"button",class:p(["btn btn-primary text-primary",{"bg-primary text-white":t.step===0}]),onClick:o[0]||(o[0]=a=>t.setStep(0))},[kR,m("Информация о боте ")],2),e("button",{type:"button",class:p(["btn btn-primary text-primary",{"bg-primary text-white":t.step===4}]),onClick:o[1]||(o[1]=a=>t.setStep(4))},[FR,m("Страницы (кнопки бота) ")],2),e("button",{type:"button",class:p(["btn btn-primary text-primary",{"bg-primary text-white":t.step===18}]),onClick:o[2]||(o[2]=a=>t.setStep(18))},[wR,m("Статистика ")],2)]),t.hasRole("admin")?(l(),i("button",CR,jR)):r("",!0)]),t.step===18?(l(),i("div",VR,[t.load?r("",!0):(l(),v(yR,{key:0,bot:s.bot},null,8,["bot"]))])):r("",!0),t.step===14?(l(),i("div",qR,[t.load?r("",!0):(l(),v(TA,{key:0,bot:s.bot},null,8,["bot"]))])):r("",!0),t.step===16?(l(),i("div",zR,[t.load?r("",!0):(l(),v(QT,{key:0,bot:s.bot},null,8,["bot"]))])):r("",!0),t.step===13?(l(),i("div",PR,[t.load?r("",!0):(l(),v(kS,{key:0,bot:s.bot},null,8,["bot"]))])):r("",!0),t.step===0?(l(),i("div",UR,[t.load?r("",!0):(l(),v(it,{key:0,onCallback:t.botCallbackUpdate,bot:s.bot},null,8,["onCallback","bot"]))])):r("",!0),t.step===15?(l(),i("div",AR,[t.load?r("",!0):(l(),v(XI,{key:0,bot:s.bot},null,8,["bot"]))])):r("",!0),t.step===7?(l(),i("div",OR,[t.load?r("",!0):(l(),v(sw,{key:0,data:s.bot.amo},null,8,["data"]))])):r("",!0),t.step===17?(l(),i("div",IR,[t.load?r("",!0):(l(),v(yB,{key:0,data:s.bot.frontPad},null,8,["data"]))])):r("",!0),t.step===12?(l(),i("div",QR,[t.load?r("",!0):(l(),v(fw,{key:0,data:s.bot.y_clients},null,8,["data"]))])):r("",!0),t.step===11?(l(),i("div",TR,[t.load?r("",!0):(l(),v(GC,{key:0}))])):r("",!0),t.step===8?(l(),i("div",BR,[t.load?r("",!0):(l(),v(PF,{key:0}))])):r("",!0),t.step===10?(l(),i("div",MR,[t.load?r("",!0):(l(),v(bC,{key:0}))])):r("",!0),t.step===1?(l(),i("div",RR,[t.load?r("",!0):(l(),v(E,{key:0,"select-mode":!1}))])):r("",!0),t.step===6?(l(),i("div",DR,[t.load?r("",!0):(l(),v(ze,{key:0}))])):r("",!0),t.step===2?(l(),i("div",ER,[t.load?r("",!0):(l(),v(ma,{key:0}))])):r("",!0),t.step===3?(l(),i("div",LR,[t.load?r("",!0):(l(),v(X,{key:0}))])):r("",!0),t.step===4?(l(),i("div",KR,[t.load?r("",!0):(l(),i("div",NR,[t.loadPage?r("",!0):(l(),v(l0,{key:0,page:t.page,onBotSettings:t.botSettingsCallback,onCallback:t.pageCallback},null,8,["page","onBotSettings","onCallback"]))]))])):r("",!0),t.step===9?(l(),i("div",JR,[b(Vw,{bot:s.bot},null,8,["bot"])])):r("",!0),e("div",HR,[GR,e("div",YR,[e("ul",WR,[e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"#bot-news",onClick:o[3]||(o[3]=a=>t.setStep(9))},[ZR,m(" Рассылки")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"#bot-appointments",onClick:o[4]||(o[4]=a=>t.setStep(13))},[XR,m("Запись на событие (прием)")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"#bot-quizzes",onClick:o[5]||(o[5]=a=>t.setStep(14))},[xR,m("Квизы")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"#bot-promo-codes",onClick:o[6]||(o[6]=a=>t.setStep(16))},[eD,m("Промокоды")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"#bot-inline-queries",onClick:o[7]||(o[7]=a=>t.setStep(15))},[tD,m("Встраиваемые запросы")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"#bot-custom-fields",onClick:o[8]||(o[8]=a=>t.setStep(10))},[sD,m("Настраиваемые поля")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"#bot-menu-template",onClick:o[9]||(o[9]=a=>t.setStep(1))},[oD,m("Все клавиатуры в боте")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"#bot-slugs",onClick:o[10]||(o[10]=a=>t.setStep(2))},[lD,m("Все скрипты в боте")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"#bot-dialogs",onClick:o[11]||(o[11]=a=>t.setStep(6))},[iD,m("Все диалоги в боте")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"#bot-users",onClick:o[12]||(o[12]=a=>t.setStep(3))},[nD,m("Все пользователи в боте")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"#bot-amo",onClick:o[13]||(o[13]=a=>t.setStep(7))},[aD,m(" AMO CRM")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"#bot-front-pad",onClick:o[14]||(o[14]=a=>t.setStep(17))},[dD,m(" FrontPad")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"#bot-y-clients",onClick:o[15]||(o[15]=a=>t.setStep(12))},[rD,m(" YClients")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"#bot-shop",onClick:o[16]||(o[16]=a=>t.setStep(8))},[cD,m(" Магазин")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"#bot-media",onClick:o[17]||(o[17]=a=>t.setStep(11))},[uD,m(" Медиа файлы бота")])])])])])],64))}}),hD={key:0},_D={key:0,class:"row"},pD={class:"col-md-12"},bD=e("h4",null,"Боты в работе",-1),fD={class:"mb-0"},gD={class:"table mb-5"},yD=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"#"),e("th",{scope:"col"},"Домен"),e("th",{scope:"col"},"Название"),e("th",{scope:"col"},"Шаблон"),e("th",{scope:"col"},"Дата изменения"),e("th",{scope:"col"},"Действие")])],-1),vD={scope:"row"},$D=["onClick"],kD=["onClick"],FD={key:0,class:"badge bg-primary"},wD={key:1},CD={class:"d-flex"},SD=["onClick"],jD=e("i",{class:"fa-regular fa-star"},null,-1),VD=[jD],qD=["onClick"],zD=e("i",{class:"fa-solid fa-chevron-down"},null,-1),PD=[zD],UD=["onClick"],AD=e("i",{class:"fa-solid fa-chevron-up"},null,-1),OD=[AD],ID=e("hr",null,null,-1),QD={class:"row"},TD={class:"col-md-12 d-flex flex-column"},BD={class:"d-flex"},MD={class:"dropdown mr-2"},RD=e("button",{class:"btn btn-outline-primary dropdown-toggle",type:"button",id:"dropdownMenuButton1","data-bs-toggle":"dropdown","aria-expanded":"false"}," Фильтры ",-1),DD={class:"dropdown-menu","aria-labelledby":"dropdownMenuButton1"},ED=["onClick"],LD={class:"input-group mb-3"},KD={key:0,class:"mt-2"},ND={class:"badge bg-primary mr-1"},JD=["onClick"],HD=e("i",{class:"fa-solid fa-xmark"},null,-1),GD=[HD],YD={key:1,class:"row"},WD={class:"col-12"},ZD=e("h4",null,"Все боты",-1),XD={class:"mb-0"},xD={class:"mb-0"},eE={key:2,class:"row"},tE={class:"col-12 mb-3"},sE={key:0,class:"col-12 mb-3"},oE={class:"table"},lE=e("th",{scope:"col"},"Действие",-1),iE={scope:"row"},nE=["onClick"],aE=["onClick"],dE={key:0,class:"badge bg-primary"},rE={key:1},cE={class:"d-flex"},uE=["onClick"],mE=e("i",{class:"fa-regular fa-star"},null,-1),hE=[mE],_E=["onClick"],pE=e("i",{class:"fa-regular fa-copy"},null,-1),bE=[pE],fE=["onClick"],gE=e("i",{class:"fa-solid fa-boxes-packing"},null,-1),yE=[gE],vE=["onClick"],$E=e("i",{class:"fa-solid fa-box-open"},null,-1),kE=[$E],FE=["onClick"],wE=e("i",{class:"fa-solid fa-trash-can text-white"},null,-1),CE=[wE],SE={class:"col-lg-4 col-12 mb-3"},jE={class:"card-body"},VE=["onClick"],qE={key:0,class:"badge bg-info"},zE={class:"card-footer d-flex"},PE=["onClick"],UE=e("i",{class:"fa-regular fa-star"},null,-1),AE=[UE],OE=["onClick"],IE=e("i",{class:"fa-regular fa-copy"},null,-1),QE=[IE],TE=["onClick"],BE=e("i",{class:"fa-solid fa-boxes-packing"},null,-1),ME=[BE],RE=["onClick"],DE=e("i",{class:"fa-solid fa-box-open"},null,-1),EE=[DE],LE=["onClick"],KE=e("i",{class:"fa-solid fa-trash-can text-white"},null,-1),NE=[KE],JE={class:"col-12"},HE={key:3,class:"row"},GE=e("div",{class:"col-12"},[e("div",{class:"alert alert-warning",role:"alert"}," У выбранной компании нет созданных ботов! ")],-1),YE=[GE],WE={props:["companyId","editor"],data(){return{displayType:1,direction:"desc",order:"updated_at",filters:[{name:"Активные",icon:"fa-brands fa-telegram",slug:"active"},{name:"Архивные",icon:"fa-solid fa-box-archive",slug:"archive"}],selectedFilters:[],show:!0,loading:!0,bots:[],favorites:[],search:null,bots_paginate_object:null}},watch:{displayType:function(s,t){localStorage.setItem("cashman_set_botlist_display_type",this.displayType)},selectedFilters:{handler:function(s){this.loadBots()},deep:!0}},computed:{...C(["getBots","getBotsPaginateObject","getCurrentCompany","getBotFavorites","inBotFav"]),filteredBots(){if(!this.bots)return[];if(this.selectedFilters.length===0&&this.search==null)return this.bots;if(this.selectedFilters.length===0&&this.search!=null)return this.bots.filter(t=>(t.bot_domain||"").trim().toLowerCase().indexOf(this.search.trim().toLowerCase())!==-1);let s=[];return this.selectedFilters.forEach(t=>{switch(t.slug){case"active":this.bots.filter(o=>o.deleted_at==null).forEach(o=>{s.push(o)});break;case"archive":this.bots.filter(o=>o.deleted_at!=null).forEach(o=>{s.push(o)});break}}),this.search==null?s:s.filter(t=>(t.bot_domain||"").trim().toLowerCase().indexOf(this.search.trim().toLowerCase())!==-1)}},mounted(){this.selectFilter("active"),this.displayType=parseInt(localStorage.getItem("cashman_set_botlist_display_type")||0)},methods:{hasRole(s){return window.hasRole(s)||!1},loadBotsByIds(){if(this.getBotFavorites.length==0){this.favorites=[];return}this.loading=!0,this.$store.dispatch("loadBotsByIds",{ids:this.getBotFavorites}).then(s=>{this.loading=!1,this.favorites=s}).catch(()=>{this.loading=!1})},prepareFavorites(){this.$store.dispatch("loadBotFavs").then(s=>{this.loadBotsByIds()})},moveOrderFavBot(s,t){this.$store.dispatch("swapBotInFav",{id:s,direction:t}).then(o=>{this.loadBotsByIds()})},addToFavorite(s){if(this.inBotFav(s)){this.$store.dispatch("removeFromBotFavorites",s).then(t=>{this.$notify("Указанный бот успешно удален из избранного"),this.loadBotsByIds()});return}this.$store.dispatch("addBotToFavorites",s).then(t=>{this.$notify("Указанный бот успешно добавлен в избранное"),this.loadBotsByIds()})},duplicate(s){if(!this.getCurrentCompany){this.$notify("У Вас не выбран клиент!");return}this.$store.dispatch("duplicateBot",{dataObject:{bot_id:s,company_id:this.getCurrentCompany.id}}).then(t=>{let o=this.bots_paginate_object.meta.current_page||0;this.loadBots(o),this.$notify("Указанный бот успешно продублирован")})},addToArchive(s){this.$store.dispatch("removeBot",{botId:s}).then(t=>{let o=this.bots_paginate_object.meta.current_page||0;this.$store.dispatch("resetCurrentBot"),this.loadBots(o),this.$notify("Указанный бот успешно перемещен в архив")})},forceDelete(s){this.$store.dispatch("forceDeleteBot",{botId:s}).then(t=>{let o=this.bots_paginate_object.meta.current_page||0;this.$store.dispatch("resetCurrentBot"),this.loadBots(o),this.$notify("Указанный бот успешно перемещен из архива")})},extractFromArchive(s){this.$store.dispatch("restoreBot",{botId:s}).then(t=>{let o=this.bots_paginate_object.meta.current_page||0;this.loadBots(o),this.$notify("Указанный бот успешно перемещен из архива")})},selectFilter(s){let t=this.filters.find(o=>o.slug===s);t&&this.selectedFilters.filter(o=>o.slug===s).length===0&&this.selectedFilters.push(t)},removeSelectedFilter(s){let t=this.selectedFilters.findIndex(o=>o.slug===s);this.selectedFilters.splice(t,1)},selectBot(s){this.$emit("callback",s),this.show=!1,this.$notify("Вы выбрали бота из списка! Все остальные действия будут производится для этого бота.")},nextBots(s){this.loadBots(s)},loadAndOrder(s){this.order=s,this.direction=this.direction==="desc"?"asc":"desc",this.loadBots(0)},loadBots(s=0){this.loading=!0,this.$store.dispatch("loadBots",{dataObject:{companyId:this.companyId||null,search:this.search,order:this.order,direction:this.direction,filters:this.selectedFilters.map(t=>t.slug)},page:s,size:20}).then(t=>{this.loading=!1,this.bots=this.getBots,this.bots_paginate_object=this.getBotsPaginateObject,this.prepareFavorites()}).catch(()=>{this.loading=!1})}}},uL=Object.assign(WE,{__name:"BotList",setup(s){return(t,o)=>t.show?(l(),i("div",hD,[t.favorites.length>0?(l(),i("div",_D,[e("div",pD,[bD,e("p",fD,"Количество ботов в работе "+u(t.favorites.length||0),1),e("table",gD,[yD,e("tbody",null,[(l(!0),i(g,null,$(t.favorites,(a,n)=>(l(),i("tr",{class:p({"border-info":a.deleted_at==null,"border-danger":a.deleted_at!=null})},[e("th",vD,u(a.id),1),e("td",{onClick:d=>t.selectBot(a)},[e("i",{class:p([{"text-danger":a.deleted_at!=null},"fa-solid fa-robot mr-2"])},null,2),m(" "+u(a.bot_domain||"Не указано"),1)],8,$D),e("td",{onClick:d=>t.selectBot(a)},u(a.title||"Не указано"),9,kD),e("td",null,[a.is_template?(l(),i("span",FD,u(a.template_description||"Не указано"),1)):(l(),i("span",wD,"Не является шаблоном"))]),e("td",null,u(t.$filters.current(a.updated_at)),1),e("td",null,[e("div",CD,[e("button",{class:p(["btn btn-outline-danger mr-2",{"btn-danger text-white":t.inBotFav(a.id)}]),type:"button",onClick:d=>t.addToFavorite(a.id),title:"Добавить в избранное"},VD,10,SD),t.favorites.length>1?(l(),i("button",{key:0,class:"btn btn-outline-primary mr-2",type:"button",onClick:d=>t.moveOrderFavBot(a.id,1),title:"Переместить вниз"},PD,8,qD)):r("",!0),t.favorites.length>1?(l(),i("button",{key:1,class:"btn btn-outline-primary mr-2",type:"button",onClick:d=>t.moveOrderFavBot(a.id,0),title:"Переместить вверх"},OD,8,UD)):r("",!0)])])],2))),256))])]),ID])])):r("",!0),e("div",QD,[e("div",TD,[e("div",BD,[e("div",MD,[RD,e("ul",DD,[(l(!0),i(g,null,$(t.filters,a=>(l(),i("li",null,[e("a",{class:"dropdown-item",onClick:n=>t.selectFilter(a.slug),href:"#filter"},[e("i",{class:p([a.icon,"mr-2"])},null,2),m(" "+u(a.name||"Не указано"),1)],8,ED)]))),256))])]),e("div",LD,[c(e("input",{type:"search",class:"form-control",placeholder:"Поиск бота","aria-label":"Поиск бота","onUpdate:modelValue":o[0]||(o[0]=a=>t.search=a),onKeydown:o[1]||(o[1]=ot((...a)=>t.loadBots&&t.loadBots(...a),["enter"])),"aria-describedby":"button-addon2"},null,544),[[_,t.search]]),e("button",{class:"btn btn-outline-secondary",onClick:o[2]||(o[2]=(...a)=>t.loadBots&&t.loadBots(...a)),type:"button",id:"button-addon2"},"Найти ")])]),t.selectedFilters.length>0?(l(),i("p",KD,[(l(!0),i(g,null,$(t.selectedFilters,a=>(l(),i("span",ND,[m(u(a.name||"не указан")+" ",1),e("a",{onClick:n=>t.removeSelectedFilter(a.slug),class:"ml-1 text-white",href:"#filter"},GD,8,JD)]))),256))])):r("",!0)])]),t.bots_paginate_object?(l(),i("div",YD,[e("div",WD,[ZD,e("p",XD,"Количество найденных ботов "+u(t.bots_paginate_object.meta.total||0),1),e("p",xD,"Количество результатов на странице "+u(t.bots.length||0),1),e("p",null,[m(" Тип отображения списка: "),e("span",{onClick:o[3]||(o[3]=a=>t.displayType=0),class:p([{"bg-primary":t.displayType===0,"bg-secondary":t.displayType!==0},"badge cursor-pointer mr-2"])},"Карточки",2),e("span",{class:p([{"bg-primary":t.displayType===1,"bg-secondary":t.displayType!==1},"badge cursor-pointer mr-2"]),onClick:o[4]||(o[4]=a=>t.displayType=1)},"Таблица",2)])])])):r("",!0),t.bots.length>0?(l(),i("div",eE,[e("div",tE,[s.editor?r("",!0):(l(),i("button",{key:0,type:"button",class:"btn btn-outline-info",onClick:o[5]||(o[5]=a=>t.selectBot(null))},"Создать нового бота "))]),t.displayType===1?(l(),i("div",sE,[e("table",oE,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:o[6]||(o[6]=a=>t.loadAndOrder("id"))},"#"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[7]||(o[7]=a=>t.loadAndOrder("bot_domain"))},"Домен"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[8]||(o[8]=a=>t.loadAndOrder("title"))},"Название"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[9]||(o[9]=a=>t.loadAndOrder("template_description"))},"Шаблон"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[10]||(o[10]=a=>t.loadAndOrder("updated_at"))},"Дата изменения"),lE])]),e("tbody",null,[(l(!0),i(g,null,$(t.bots,(a,n)=>(l(),i("tr",{class:p({"border-info":a.deleted_at==null,"border-danger":a.deleted_at!=null})},[e("th",iE,u(a.id),1),e("td",{onClick:d=>t.selectBot(a)},[e("i",{class:p([{"text-danger":a.deleted_at!=null},"fa-solid fa-robot mr-2"])},null,2),m(" "+u(a.bot_domain||"Не указано"),1)],8,nE),e("td",{onClick:d=>t.selectBot(a)},u(a.title||"Не указано"),9,aE),e("td",null,[a.is_template?(l(),i("span",dE,u(a.template_description||"Не указано"),1)):(l(),i("span",rE,"Не является шаблоном"))]),e("td",null,u(t.$filters.current(a.updated_at)),1),e("td",null,[e("div",cE,[e("button",{class:p(["btn btn-outline-danger mr-2",{"btn-danger text-white":t.inBotFav(a.id)}]),type:"button",onClick:d=>t.addToFavorite(a.id),title:"Добавить в избранное"},hE,10,uE),e("button",{class:"btn btn-outline-info mr-2",type:"button",onClick:d=>t.duplicate(a.id),title:"Дублировать"},bE,8,_E),a.deleted_at==null&&t.hasRole("admin")?(l(),i("button",{key:0,class:"btn btn-outline-info",type:"button",onClick:d=>t.addToArchive(a.id),title:"В архив"},yE,8,fE)):r("",!0),a.deleted_at!=null&&t.hasRole("admin")?(l(),i("button",{key:1,class:"btn btn-outline-info mr-2",onClick:d=>t.extractFromArchive(a.id),title:"Из архива"},kE,8,vE)):r("",!0),a.deleted_at!=null&&t.hasRole("admin")?(l(),i("button",{key:2,class:"btn btn-danger mr-2",onClick:d=>t.forceDelete(a.id),title:"Удалить на совсем"},CE,8,FE)):r("",!0)])])],2))),256))])])])):r("",!0),t.displayType===0?(l(!0),i(g,{key:1},$(t.bots,(a,n)=>(l(),i("div",SE,[e("div",{class:p(["card w-100",{"border-info":a.deleted_at==null,"border-secondary":a.deleted_at!=null}])},[e("div",jE,[e("p",{class:"d-flex justify-content-between",onClick:d=>t.selectBot(a),style:{"word-wrap":"break-word"}},[e("span",null,[e("i",{class:p([{"text-danger":a.deleted_at!=null},"fa-solid fa-robot mr-2"])},null,2),m(" "+u(a.bot_domain||"Не указано"),1)]),a.is_template?(l(),i("span",qE,u(a.template_description||"Шаблон без названия"),1)):r("",!0)],8,VE)]),e("div",zE,[e("button",{class:p(["btn btn-outline-danger mr-2",{"btn-danger text-white":t.inBotFav(a.id)}]),type:"button",onClick:d=>t.addToFavorite(a.id),title:"Добавить в избранное"},AE,10,PE),e("button",{class:"btn btn-outline-info mr-2",type:"button",onClick:d=>t.duplicate(a.id),title:"Дублировать"},QE,8,OE),a.deleted_at==null&&t.hasRole("admin")?(l(),i("button",{key:0,class:"btn btn-outline-info",type:"button",onClick:d=>t.addToArchive(a.id),title:"В архив"},ME,8,TE)):r("",!0),a.deleted_at!=null&&t.hasRole("admin")?(l(),i("button",{key:1,class:"btn btn-outline-info mr-2",onClick:d=>t.extractFromArchive(a.id),title:"Из архива"},EE,8,RE)):r("",!0),a.deleted_at!=null&&t.hasRole("admin")?(l(),i("button",{key:2,class:"btn btn-danger mr-2",onClick:d=>t.forceDelete(a.id),title:"Удалить на совсем"},NE,8,LE)):r("",!0)])],2)]))),256)):r("",!0),e("div",JE,[t.bots_paginate_object?(l(),v(V,{key:0,onPagination_page:t.nextBots,pagination:t.bots_paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])])):(l(),i("div",HE,YE))])):r("",!0)}});export{uL as _,cL as a,l0 as b,ze as c};
