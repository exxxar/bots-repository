import"./AdminProductCard-df07a238.js";/* empty css                                                   */import{P as h}from"./PreloaderV1-97f38083.js";import{g as p,o as r,j as o,J as u,F as a,l as n,K as l,$ as g,n as _,L as f,G as m}from"./index.es-db843bab.js";const y=["id"],P={class:"list-group"},b=["onClick"],C={key:0,class:"col-12"},k=["onClick"],x={key:0},O={key:1,class:"d-inline-flex align-items-center"},w=n("span",{class:"spinner-border",role:"status"},[n("span",{class:"visually-hidden"},"Loading...")],-1),B={props:["selected"],data(){return{search:null,products:[],paginate:null,sort:{param:null,direction:"asc"}}},computed:{...p(["getProducts","getProductsPaginateObject"]),filteredCategories(){return this.products.length===0?[]:(this.search||"").length===0?this.products:this.products.filter(t=>t.products.filter(e=>e.title.toLowerCase().indexOf(this.search.toLowerCase())!=-1).length>0)},filteredProducts(){return this.categories.length===0?this.products:this.products.filter(t=>t.categories.findIndex(e=>this.categories.indexOf(e.id)!==-1)!==-1)}},mounted(){this.loadProducts()},methods:{loadMore(t,e){var c;return this.load_content=!0,this.$store.dispatch("loadMoreProductsByCategory",{partner_id:((c=this.selected_partner)==null?void 0:c.bot_partner_id)||null,category_id:t,offset:e}).then(s=>{let i=s.length||0;if(this.load_content=!1,i===0){this.products.find(d=>d.id===t).products_count=e;return}this.products.find(d=>d.id===t).products.push(...s)}).catch(()=>{this.load_content=!1})},changeDirection(t){this.sort.direction=t,this.loadOrders(0)},selectProduct(t){this.$emit("select",t)},nextProducts(t){this.loadProducts(t)},loadProducts(t=0){return this.$store.dispatch("loadProductsByCategory",{dataObject:{search:this.search,direction:this.sort.direction,order_by:this.sort.param},page:t,size:100}).then(e=>{this.products=e.data}).catch(()=>{})}}},N=Object.assign(B,{__name:"SimpleProductList",setup(t){return(e,c)=>e.filteredCategories.length>0?(r(!0),o(a,{key:0},u(e.filteredCategories,s=>(r(),o(a,null,[n("h5",{class:"my-4 divider",id:"cat-"+s.id},l(s.title||"-"),9,y),n("ul",P,[(r(!0),o(a,null,u(s.products,(i,d)=>(r(),o("li",{class:g(["list-group-item d-flex justify-content-between align-items-center",{"bg-success text-white fw-bold":(t.selected||[]).indexOf(i.id)!=-1}]),onClick:L=>e.selectProduct(i)},l(i.title),11,b))),256))]),s.products_count>s.products.length?(r(),o("div",C,[n("button",{onClick:i=>e.loadMore(s.id,s.products.length),class:"btn btn-outline-light text-primary p-3 my-3 w-100",type:"button"},[e.load_content?(r(),o("span",O,[_(" Загружаем.... "),w])):(r(),o("span",x,"Загрузить еще ("+l(s.products_count-s.products.length)+") ",1))],8,k)])):f("",!0)],64))),256)):(r(),m(h,{key:1}))}});export{N as _};
