import{o as l,k as n,l as e,C as v,p as c,t as _,F as b,j as F,B as P,w as u,N as I,v as g,n as p,q as y,L as V,u as k,A as f,O as w,s as L,g as x}from"./index.es-00b6813f.js";import{_ as U}from"./_plugin-vue_export-helper-c27b6911.js";const q={props:["pagination"],data(){return{currentPage:1}},computed:{hasPagination(){return!(this.pagination===null||!this.pagination||this.pagination.meta.links[0].active===!1&&this.pagination.meta.links[this.pagination.meta.links.length-1].active===!1)},filteredLinks(){return this.pagination?(parseInt(this.pagination.meta.current_page),this.pagination.meta.links):[]}},methods:{first(){this.$emit("pagination_page",1)},last(){this.$emit("pagination_page",this.pagination.meta.last_page)},nextPage(){this.currentPage=this.pagination.meta.current_page+1,this.$emit("pagination_page",this.pagination.meta.current_page+1)},page(o){this.currentPage=o,window.scrollTo({top:10,behavior:"smooth"}),this.$emit("pagination_page",o)},prevPage(){this.currentPage!==1&&(this.currentPage=this.pagination.meta.current_page-1,this.$emit("pagination_page",this.pagination.meta.current_page-1))}}},O={key:0,class:"mt-4"},M={class:"pagination pagination- justify-content-center mb-3"},S={class:"page-item"},B=["disabled"],z=e("i",{class:"fa-solid fa-angles-left"},null,-1),E=[z],N={class:"page-item"},A=["disabled"],D=e("i",{class:"fa fa-angle-left"},null,-1),T=[D],R={class:"page-item"},J=["disabled"],Z=e("i",{class:"fa fa-angle-right"},null,-1),G=[Z],H={class:"page-item"},K=["disabled"],Q=e("i",{class:"fa-solid fa-angles-right"},null,-1),W=[Q],X={key:1,class:"text-center mb-3"},Y={style:{"font-weight":"bold"}};function ee(o,t,s,d,r,m){return l(),n(b,null,[s.pagination.links?(l(),n("nav",O,[e("ul",M,[e("li",S,[e("button",{type:"button",onClick:t[0]||(t[0]=(...i)=>m.first&&m.first(...i)),disabled:s.pagination.links.first==null||s.pagination.meta.current_page===1,class:v([{"bg-gray2-dark":s.pagination.links.first===null||s.pagination.meta.current_page===1,"bg-black":s.pagination.links.first!=null},"page-link rounded-xs color-white shadow-xl border-0"]),tabindex:"-1","aria-disabled":"true"},E,10,B)]),e("li",N,[e("button",{type:"button",onClick:t[1]||(t[1]=(...i)=>m.prevPage&&m.prevPage(...i)),disabled:s.pagination.links.prev==null,class:v([{"bg-gray2-dark":s.pagination.links.prev==null,"bg-black":s.pagination.links.prev!=null},"page-link rounded-xs color-white shadow-xl border-0"]),tabindex:"-1","aria-disabled":"true"},T,10,A)]),e("li",R,[e("button",{onClick:t[2]||(t[2]=(...i)=>m.nextPage&&m.nextPage(...i)),disabled:s.pagination.links.next==null,class:v([{"bg-gray2-dark":s.pagination.links.next==null,"bg-black":s.pagination.links.next!=null},"page-link rounded-xs color-white shadow-xl border-0"]),type:"button"},G,10,J)]),e("li",H,[e("button",{onClick:t[3]||(t[3]=(...i)=>m.last&&m.last(...i)),disabled:s.pagination.links.last==null||s.pagination.meta.current_page===s.pagination.meta.last_page,class:v([{"bg-gray2-dark":s.pagination.links.last==null||s.pagination.meta.current_page===s.pagination.meta.last_page,"bg-black":s.pagination.links.last!=null},"page-link rounded-xs color-white shadow-xl border-0"]),type:"button"},W,10,K)])])])):c("",!0),s.pagination.links?(l(),n("p",X,[e("small",Y," Страница "+_(s.pagination.meta.current_page)+" из "+_(s.pagination.meta.last_page),1)])):c("",!0)],64)}const te=U(q,[["render",ee]]),se={props:["company"],data(){return{locations:[],deletedLocations:[],locationForm:{id:null,lat:null,lon:null,address:null,description:null,location_channel:null,can_booking:!1,photos:[],company_id:null}}},mounted(){this.loadLocationsByCompany()},methods:{loadLocationsByCompany(){this.$store.dispatch("loadLocationsByCompany",{companyId:this.company.id}).then(o=>{this.locations=o||[]}).catch(()=>{})},getPhoto(o){return{imageUrl:URL.createObjectURL(o)}},removePhoto(o){this.locationForm.photos.splice(o,1)},removeItem(o){this.locations[o].id!=null&&this.deletedLocations.push(this.locations[o].id),this.locations.splice(o,1)},submitLocations(){this.locations.forEach(o=>{let t=new FormData;if(Object.keys(o).forEach(s=>{const d=o[s]||"";typeof d=="object"?t.append(s,JSON.stringify(d)):t.append(s,d)}),o.photos){for(let s=0;s<o.photos.length;s++)t.append("files[]",o.photos[s]);t.delete("photos")}this.deletedLocations.length>0&&t.append("deleted_locations",JSON.stringify(this.deletedLocations)),this.$store.dispatch("createLocation",{locationForm:t}).then(s=>{this.$emit("callback"),this.$notify("Локация успешно созадана и сохранена")}).catch(s=>{})})},selectLocation(o){this.locationForm=o},submitLocation(){this.locationForm.company_id=this.company.id,this.locations.push(this.locationForm),this.$notify("Локация успешно добавлена в список. Не забудьте сохранить"),this.locationForm={id:null,lat:null,lon:null,address:null,description:null,location_channel:null,can_booking:!1,photos:[]}},onChangePhotos(o){const t=o.target.files;for(let s=0;s<t.length;s++)this.locationForm.photos.push(t[s])}}},oe={class:"card"},le={class:"card-body"},ne={class:"row"},ie={class:"col-md-8"},ae={class:"row"},de={class:"col-12"},ce={class:"form-check"},re=e("label",{class:"form-check-label",for:"flexCheckDefault"}," Можно бронировать столик ",-1),me={class:"col-12"},he={class:"mb-3"},ue=e("label",{class:"form-label",id:"location-address"},[p(" Адрес заведения "),e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно")],-1),pe={class:"row"},_e={class:"col-md-6 col-12"},be={class:"mb-3"},ge=e("label",{class:"form-label",id:"location-lat"},[p(" Широта "),e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно")],-1),ye={class:"col-md-6 col-12"},fe={class:"mb-3"},ve=e("label",{class:"form-label",id:"location-lon"},[p(" Долгота "),e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно")],-1),ke={class:"row"},Ce={class:"col-12"},Fe={class:"mb-3"},$e={class:"form-label",id:"location-description"},we=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Pe={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},Le={class:"row"},Ue={class:"col-12 mb-3"},je=e("h6",null,"Фотографии локаций",-1),Ie={class:"photo-preview d-flex justify-content-start flex-wrap w-100"},Ve={for:"location-photos",style:{"margin-right":"10px"},class:"photo-loader ml-2 text-primary"},xe=e("span",null,"+",-1),qe={class:"mb-2 img-preview",style:{"margin-right":"10px"}},Oe={class:"remove"},Me=["onClick"],Se={class:"row"},Be={class:"col-12"},ze={class:"btn btn-outline-success w-100",type:"submit"},Ee={key:0},Ne={key:1},Ae={class:"col-md-4 mt-3"},De=["onClick"],Te={class:"card-header d-flex justify-content-between"},Re={key:0,class:"badge bg-success"},Je=["onClick"],Ze={class:"card-body"},Ge={key:0},He={key:1},Ke={key:2,class:"w-100 d-flex"},Qe={class:"mb-2 img-preview",style:{"margin-right":"10px"}},We={key:3,class:"w-100 d-flex"},Xe={class:"mb-2 img-preview",style:{"margin-right":"10px"}},Ye={class:"row mt-2"},et={class:"col-12"},tt=["disabled"];function st(o,t,s,d,r,m){const i=F("mask"),h=F("lazy");return l(),n("div",oe,[e("div",le,[e("div",ne,[e("div",ie,[e("form",{onSubmit:t[6]||(t[6]=P((...a)=>m.submitLocation&&m.submitLocation(...a),["prevent"]))},[e("h6",null,"Локации к компании #"+_(s.company.title||"Не установлен"),1),e("div",ae,[e("div",de,[e("div",ce,[u(e("input",{class:"form-check-input","onUpdate:modelValue":t[0]||(t[0]=a=>r.locationForm.can_booking=a),type:"checkbox",value:"false",id:"flexCheckDefault"},null,512),[[I,r.locationForm.can_booking]]),re])]),e("div",me,[e("div",he,[ue,u(e("input",{type:"text",class:"form-control",placeholder:"Адрес","aria-label":"Адрес",maxlength:"255","onUpdate:modelValue":t[1]||(t[1]=a=>r.locationForm.address=a),"aria-describedby":"location-address",required:""},null,512),[[g,r.locationForm.address]])])])]),e("div",pe,[e("div",_e,[e("div",be,[ge,u(e("input",{type:"text",class:"form-control",placeholder:"##.######","aria-label":"Широта",maxlength:"255","onUpdate:modelValue":t[2]||(t[2]=a=>r.locationForm.lat=a),"aria-describedby":"location-lat",required:""},null,512),[[i,"##.######"],[g,r.locationForm.lat]])])]),e("div",ye,[e("div",fe,[ve,u(e("input",{type:"text",class:"form-control",placeholder:"##.######","aria-label":"Долгота",maxlength:"255","onUpdate:modelValue":t[3]||(t[3]=a=>r.locationForm.lon=a),"aria-describedby":"location-lon",required:""},null,512),[[i,"##.######"],[g,r.locationForm.lon]])])])]),e("div",ke,[e("div",Ce,[e("div",Fe,[e("label",$e,[p(" Описание локации "),we,r.locationForm.description?(l(),n("small",Pe," Длина текста "+_(r.locationForm.description.length),1)):c("",!0)]),u(e("textarea",{type:"text",class:"form-control",placeholder:"Описание локации","aria-label":"Описание локации",maxlength:"255","onUpdate:modelValue":t[4]||(t[4]=a=>r.locationForm.description=a),"aria-describedby":"location-description",required:""},`
                    `,512),[[g,r.locationForm.description]])])])]),e("div",Le,[e("div",Ue,[je,e("div",Ie,[e("label",Ve,[xe,e("input",{type:"file",id:"location-photos",multiple:"",accept:"image/*",onChange:t[5]||(t[5]=(...a)=>m.onChangePhotos&&m.onChangePhotos(...a)),style:{display:"none"}},null,32)]),r.locationForm.photos?(l(!0),n(b,{key:0},y(r.locationForm.photos,(a,$)=>(l(),n("div",qe,[u(e("img",null,null,512),[[h,m.getPhoto(a).imageUrl]]),e("div",Oe,[e("a",{onClick:C=>m.removePhoto($)},"Удалить",8,Me)])]))),256)):c("",!0)])])]),e("div",Se,[e("div",Be,[e("button",ze,[r.locationForm.id?(l(),n("span",Ee,"Обновить расположение")):(l(),n("span",Ne,"Добавить расположение"))])])])],32)]),r.locations?(l(!0),n(b,{key:0},y(r.locations,(a,$)=>(l(),n("div",Ae,[e("div",{class:"card",onClick:C=>m.selectLocation(a)},[e("div",Te,[e("h6",null,[p("Адрес локации "),e("strong",null,_(a.address||"Не указано"),1),p(" (ш:"+_(a.lat)+",д:"+_(a.lon)+") ",1),a.can_booking?(l(),n("span",Re,"Можно забронировать столик")):c("",!0)]),e("a",{class:"cursor-pointer",onClick:C=>m.removeItem($)},"Удалить",8,Je)]),e("div",Ze,[a.location_channel?(l(),n("p",Ge,[p("Канал заведения "),e("strong",null,_(a.location_channel),1)])):c("",!0),e("p",null,_(a.description||"Не указано"),1),a.photos?(l(),n("h6",He,"Фотографии локаций")):c("",!0),a.photos?(l(),n("div",Ke,[a.photos.length>0?(l(!0),n(b,{key:0},y(a.photos,(C,j)=>(l(),n("div",Qe,[u(e("img",null,null,512),[[h,m.getPhoto(C).imageUrl]])]))),256)):c("",!0)])):c("",!0),a.images?(l(),n("div",We,[a.images.length>0?(l(!0),n(b,{key:0},y(a.images,(C,j)=>(l(),n("div",Xe,[u(e("img",null,null,512),[[h,"/images-by-company-id/"+s.company.id+"/"+C]])]))),256)):c("",!0)])):c("",!0)])],8,De)]))),256)):c("",!0)]),e("div",Ye,[e("div",et,[e("button",{onClick:t[7]||(t[7]=(...a)=>m.submitLocations&&m.submitLocations(...a)),disabled:r.locations.length===0&&r.deletedLocations.length===0,class:"btn btn-success p-3 w-100"}," Сохранить локации клиента ",8,tt)])])])])}const ot=U(se,[["render",st]]);const lt={key:0,class:"row mb-2"},nt={class:"col-12"},it={key:1,class:"row mb-2"},at={class:"col-12"},dt={class:"btn-group w-100",role:"group","aria-label":"Basic outlined example"},ct={class:"row"},rt=e("div",{class:"col-12"},[e("h4",null,"Системное")],-1),mt={class:"col-12 mb-3"},ht={class:"form-label",id:"company-title"},ut=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),pt=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),_t={class:"col-12 mb-3"},bt={class:"form-label",id:"company-title"},gt=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),yt=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),ft=["value"],vt={class:"col-12 mb-3"},kt={class:"form-label",id:"company-title"},Ct=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Ft=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),$t=["value"],wt={class:"col-12"},Pt={class:"mb-3"},Lt={class:"form-label",id:"company-slug"},Ut=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),jt=e("div",null,[p("Название компании на АНГЛИЙСКОМ"),e("br"),p(" без пробелов! можно использовать _"),e("br"),p(" Должно быть уникальным! Не отображается пользователю. ")],-1),It=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Vt={class:"col-12"},xt={class:"mb-3"},qt={class:"form-label",id:"company-description"},Ot=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Mt=e("div",null,'Добавится в раздел "О Нас"',-1),St=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Bt={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},zt={class:"col-12"},Et={class:"mb-3"},Nt={class:"form-label",id:"company-address"},At=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Dt=e("div",null,[p("Где находится главное заведение компании!"),e("br"),p('Можно не указывать, т.к. есть еще "Локации" ')],-1),Tt={class:"col-12"},Rt={class:"mb-3"},Jt=e("label",{class:"form-label",id:"company-email"},"Основная почта компании",-1),Zt={class:"col-12"},Gt={class:"mb-3"},Ht=e("label",{class:"form-label",id:"company-manager"},"Менеджер компании",-1),Kt={class:"col-12"},Qt={class:"card mb-3"},Wt=e("div",{class:"card-header"},[e("h6",null,[p("Логотип компании "),e("span",{class:"badge rounded-pill text-bg-warning m-0"},"Желательно")])],-1),Xt={class:"card-body d-flex justify-content-start"},Yt={for:"photos",style:{"margin-right":"10px"},class:"photo-loader text-primary ml-2"},es={key:0,class:"mb-2 img-preview",style:{"margin-right":"10px"}},ts={class:"remove"},ss=e("i",{class:"fa-regular fa-trash-can"},null,-1),os=[ss],ls={key:1,class:"mb-2 img-preview",style:{"margin-right":"10px"}},ns={class:"remove"},is=e("i",{class:"fa-regular fa-trash-can"},null,-1),as=[is],ds={class:"col-12"},cs={class:"card mb-3"},rs=e("div",{class:"card-header"},[e("h6",null,"Телефонные номера")],-1),ms={class:"card-body"},hs=e("div",{class:"row"},[e("div",{class:"col-12"},[e("h6",null,"Телефонный номер")])],-1),us={class:"col-10"},ps={class:"mb-3"},_s=["onUpdate:modelValue","aria-describedby"],bs={class:"col-2"},gs=["onClick"],ys=e("i",{class:"fa-regular fa-trash-can"},null,-1),fs=[ys],vs={class:"row"},ks={class:"col-12"},Cs={class:"col-12"},Fs={class:"card mb-3"},$s=e("div",{class:"card-header"},[e("h6",null,"Ссылки на соц. сети")],-1),ws={class:"card-body"},Ps=e("div",{class:"row"},[e("div",{class:"col-12"},[e("h6",null,"Ссылка")])],-1),Ls={class:"col-10"},Us={class:"mb-3"},js=["onUpdate:modelValue","aria-describedby"],Is={class:"col-2"},Vs=["onClick"],xs=e("i",{class:"fa-regular fa-trash-can"},null,-1),qs=[xs],Os={class:"row"},Ms={class:"col-12"},Ss={class:"col-12"},Bs={class:"card mb-3"},zs=e("div",{class:"card-header"},[e("h6",null,"График работы")],-1),Es={class:"card-body"},Ns={class:"row"},As={class:"col-12 d-flex justify-content-between align-items-center"},Ds=e("h6",null,"День недели ",-1),Ts={class:"col-10"},Rs={class:"mb-3"},Js=["onUpdate:modelValue","aria-describedby"],Zs={class:"col-2"},Gs=["onClick"],Hs=e("i",{class:"fa-regular fa-trash-can"},null,-1),Ks=[Hs],Qs={class:"row"},Ws={class:"col-12"},Xs=["disabled"],Ys={class:"row"},eo={class:"col-12"},to={type:"submit",class:"btn btn-outline-success w-100 p-3"},so={key:0},oo={key:1},lo={key:3},no={props:["company","editor"],data(){return{step:0,load:!1,photo:null,removedImage:null,need_reset:!1,vat_codes:[{id:1,title:"Общая система налогообложения"},{id:2,title:"Упрощенная (УСН, доходы)"},{id:3,title:"Упрощенная (УСН, доходы минус расходы)"},{id:4,title:"Единый налог на вмененный доход (ЕНВД)"},{id:5,title:"Единый сельскохозяйственный налог (ЕСН)"},{id:6,title:"Патентная система налогообложения"}],business_form_categories:[{id:0,title:"Физическое-лицо"},{id:1,title:"Самозанятый"},{id:2,title:"Индивидуальный предприниматель (ИП)"},{id:3,title:"Общество с ограниченной ответственностью (ООО)"},{id:4,title:"Акционерное общество (АО)"},{id:5,title:"Полное товарищество (ПТ)"},{id:6,title:"Товарищество на вере (ТНВ)"},{id:7,title:"Производственный кооператив (ПК)"},{id:8,title:"Государственное унитарное предприятие (ГУП)"},{id:9,title:"Муниципальное унитарное предприятие (МУП)"}],companyForm:{id:null,title:null,slug:null,description:null,address:null,business_form:null,phones:[""],links:[""],law_params:{},email:null,vat_code:1,schedule:[],manager:null}}},watch:{companyForm:{handler(o){this.need_reset=!0},deep:!0}},mounted(){this.companyForm.law_params.bank_card="1234",this.companyForm.law_params.phisical_adress="1234",this.company&&this.$nextTick(()=>{this.companyForm={id:this.company.id||null,title:this.company.title||null,slug:this.company.slug||null,image:this.company.image||null,description:this.company.description||null,address:this.company.address||null,phones:this.company.phones||[""],links:this.company.links||[""],email:this.company.email||null,vat_code:this.company.vat_code||1,schedule:this.company.schedule||[],manager:this.company.manager||null}})},methods:{resetForm(){this.photo=null,this.removedImage=null,this.companyForm={id:null,title:null,slug:null,description:null,address:null,phones:[""],links:[""],email:null,schedule:[],manager:null,vat_code:1},this.$nextTick(()=>{this.need_reset=!1})},getPhoto(){return{imageUrl:URL.createObjectURL(this.photo)}},onChangePhotos(o){const t=o.target.files;this.photo=t[0],this.companyForm.image=null},schedulePlaceholder(){this.companyForm.schedule.length>0?this.companyForm.schedule=[]:this.companyForm.schedule=["Понедельник - с 8:00 до 20:00","Вторник - с 8:00 до 20:00","Среда - с 8:00 до 20:00","Четверг - с 8:00 до 20:00","Пятница - с 8:00 до 20:00","Суббота - с 8:00 до 20:00","Воскресенье - выходной"]},removeCompanyImage(){this.removedImage=this.companyForm.image,this.companyForm.image=null},addItem(o){this.companyForm[o].push("")},removeItem(o,t){this.companyForm[o].splice(t,1)},submitForm(){let o=new FormData;Object.keys(this.companyForm).forEach(t=>{const s=this.companyForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),o.append("company_logo",this.photo),this.removedImage!=null&&o.append("removed_image",this.removedImage),this.$store.dispatch(this.companyForm.id===null?"createCompany":"updateCompany",{companyForm:o}).then(t=>{this.$emit("callback",t.data),this.$notify("Компания успешно создана")}).catch(t=>{})}}},io=Object.assign(no,{__name:"CompanyForm",setup(o){return(t,s)=>{const d=V("Popper"),r=F("lazy"),m=F("mask");return l(),n(b,null,[t.need_reset&&!o.editor?(l(),n("div",lt,[e("div",nt,[e("button",{type:"button",onClick:s[0]||(s[0]=(...i)=>t.resetForm&&t.resetForm(...i)),class:"btn btn-outline-danger"},"Новый клиент \\ очистка формы ")])])):c("",!0),o.editor?(l(),n("div",it,[e("div",at,[e("div",dt,[e("button",{type:"button",class:v([{"btn-primary border-white text-white":t.step===0},"btn btn-outline-primary"]),onClick:s[1]||(s[1]=i=>t.step=0)},"Информация о компании ",2),e("button",{type:"button",class:v([{"btn-primary border-white text-white":t.step===1},"btn btn-outline-primary"]),onClick:s[2]||(s[2]=i=>t.step=1)},"Информация о расположении ",2)])])])):c("",!0),t.step===0?(l(),n("form",{key:2,onSubmit:s[18]||(s[18]=P((...i)=>t.submitForm&&t.submitForm(...i),["prevent"]))},[e("div",ct,[rt,e("div",mt,[e("label",ht,[k(d,{content:"Название вашей компании"},{default:f(()=>[ut]),_:1}),p(" Название компании "),pt]),u(e("input",{type:"text",class:"form-control",placeholder:"Название","aria-label":"Название","onUpdate:modelValue":s[3]||(s[3]=i=>t.companyForm.title=i),maxlength:"255","aria-describedby":"company-title",required:""},null,512),[[g,t.companyForm.title]])]),e("div",_t,[e("label",bt,[k(d,{content:"Тип налогообложения вашей компании"},{default:f(()=>[gt]),_:1}),p(" Тип налогообложения "),yt]),u(e("select",{type:"text",class:"form-control","aria-label":"Выберите налогообложения","onUpdate:modelValue":s[4]||(s[4]=i=>t.companyForm.vat_code=i),"aria-describedby":"company-vat-code",required:""},[(l(!0),n(b,null,y(t.vat_codes,(i,h)=>(l(),n("option",{value:i.id},_(i.title||"Не указано"),9,ft))),256))],512),[[w,t.companyForm.vat_code]])]),e("div",vt,[e("label",kt,[k(d,{content:"Тип налогообложения вашей компании"},{default:f(()=>[Ct]),_:1}),p(" Вид организационно-правовой формы предприятия "),Ft]),u(e("select",{type:"text",class:"form-control","aria-label":"Выберите тип организационно-правовой формы предприятия","onUpdate:modelValue":s[5]||(s[5]=i=>t.companyForm.business_form=i),"aria-describedby":"company-business-form-categories",required:""},[(l(!0),n(b,null,y(t.business_form_categories,(i,h)=>(l(),n("option",{value:i.id},_(i.title||"Не указано"),9,$t))),256))],512),[[w,t.companyForm.business_form]])]),e("div",wt,[e("div",Pt,[e("label",Lt,[k(d,null,{content:f(()=>[jt]),default:f(()=>[Ut]),_:1}),p(" Название компании латиницей (домен компании) "),It]),u(e("input",{type:"text",class:"form-control",placeholder:"Мнемоническое имя","aria-label":"Мнемоническое имя",pattern:"^[a-zA-Z][a-zA-Z0-9-_]{1,40}$","onUpdate:modelValue":s[6]||(s[6]=i=>t.companyForm.slug=i),maxlength:"255","aria-describedby":"company-slug",required:""},null,512),[[g,t.companyForm.slug]])])]),e("div",Vt,[e("div",xt,[e("label",qt,[k(d,null,{content:f(()=>[Mt]),default:f(()=>[Ot]),_:1}),p(" Описание компании "),St,t.companyForm.description?(l(),n("small",Bt," Длина текста "+_(t.companyForm.description.length),1)):c("",!0)]),u(e("textarea",{type:"text",class:"form-control",placeholder:"Описание компании","aria-label":"Описание компании","onUpdate:modelValue":s[7]||(s[7]=i=>t.companyForm.description=i),"aria-describedby":"company-description",required:""},`
                                    `,512),[[g,t.companyForm.description]])])]),e("div",zt,[e("div",Et,[e("label",Nt,[k(d,null,{content:f(()=>[Dt]),default:f(()=>[At]),_:1}),p(" Основной адрес компании")]),u(e("input",{type:"text",class:"form-control",placeholder:"Адрес","aria-label":"Адрес",maxlength:"255","onUpdate:modelValue":s[8]||(s[8]=i=>t.companyForm.address=i),"aria-describedby":"company-address"},null,512),[[g,t.companyForm.address]])])]),e("div",Tt,[e("div",Rt,[Jt,u(e("input",{type:"email",class:"form-control",placeholder:"Почтовый адрес","aria-label":"Почтовый адрес",maxlength:"255","onUpdate:modelValue":s[9]||(s[9]=i=>t.companyForm.email=i),"aria-describedby":"company-email"},null,512),[[g,t.companyForm.email]])])]),e("div",Zt,[e("div",Gt,[Ht,u(e("input",{type:"text",class:"form-control",placeholder:"Имя менеджера","aria-label":"Имя менеджера","onUpdate:modelValue":s[10]||(s[10]=i=>t.companyForm.manager=i),maxlength:"255","aria-describedby":"company-manager"},null,512),[[g,t.companyForm.manager]])])]),e("div",Kt,[e("div",Qt,[Wt,e("div",Xt,[e("label",Yt,[p(" + "),e("input",{type:"file",id:"photos",accept:"image/*",onChange:s[11]||(s[11]=(...i)=>t.onChangePhotos&&t.onChangePhotos(...i)),style:{display:"none"}},null,32)]),t.photo?(l(),n("div",es,[u(e("img",null,null,512),[[r,t.getPhoto().imageUrl]]),e("div",ts,[e("a",{onClick:s[12]||(s[12]=i=>t.photo=null)},os)])])):c("",!0),t.companyForm.image?(l(),n("div",ls,[u(e("img",null,null,512),[[r,"/images/"+t.companyForm.slug+"/"+t.companyForm.image]]),e("div",ns,[e("a",{onClick:s[13]||(s[13]=(...i)=>t.removeCompanyImage&&t.removeCompanyImage(...i))},as)])])):c("",!0)])])]),e("div",ds,[e("div",cs,[rs,e("div",ms,[hs,(l(!0),n(b,null,y(t.companyForm.phones,(i,h)=>(l(),n("div",{class:"row",key:"phone"+h},[e("div",us,[e("div",ps,[u(e("input",{type:"text",class:"form-control",placeholder:"+7(000)000-00-00","aria-label":"Номер телефона",maxlength:"255","onUpdate:modelValue":a=>t.companyForm.phones[h]=a,"aria-describedby":"company-phone-"+h},null,8,_s),[[m,"+7(###)###-##-##"],[g,t.companyForm.phones[h]]])])]),e("div",bs,[e("button",{type:"button",onClick:a=>t.removeItem("phones",h),class:"btn btn-outline-danger w-100"},fs,8,gs)])]))),128)),e("div",vs,[e("div",ks,[e("button",{type:"button",onClick:s[14]||(s[14]=i=>t.addItem("phones")),class:"btn btn-outline-success w-100"},"Добавить еще номер ")])])])])]),e("div",Cs,[e("div",Fs,[$s,e("div",ws,[Ps,(l(!0),n(b,null,y(t.companyForm.links,(i,h)=>(l(),n("div",{class:"row",key:"link"+h},[e("div",Ls,[e("div",Us,[u(e("input",{type:"text",class:"form-control",placeholder:"Ссылка на соц.сеть","aria-label":"Ссылка на соц.сеть",maxlength:"255","onUpdate:modelValue":a=>t.companyForm.links[h]=a,"aria-describedby":"company-link-"+h},null,8,js),[[g,t.companyForm.links[h]]])])]),e("div",Is,[e("button",{type:"button",onClick:a=>t.removeItem("links",h),class:"btn btn-outline-danger w-100"},qs,8,Vs)])]))),128)),e("div",Os,[e("div",Ms,[e("button",{type:"button",onClick:s[15]||(s[15]=i=>t.addItem("links")),class:"btn btn-outline-success w-100"},"Добавить еще ссылку ")])])])])]),e("div",Ss,[e("div",Bs,[zs,e("div",Es,[e("div",Ns,[e("div",As,[Ds,e("a",{class:"btn btn-link",onClick:s[16]||(s[16]=(...i)=>t.schedulePlaceholder&&t.schedulePlaceholder(...i))},"Заполнить\\очистить")])]),(l(!0),n(b,null,y(t.companyForm.schedule,(i,h)=>(l(),n("div",{class:"row",key:"link"+h},[e("div",Ts,[e("div",Rs,[u(e("input",{type:"text",class:"form-control",placeholder:"День недели и время работы","aria-label":"День недели и время работы",maxlength:"255","onUpdate:modelValue":a=>t.companyForm.schedule[h]=a,"aria-describedby":"company-schedule-"+h},null,8,Js),[[g,t.companyForm.schedule[h]]])])]),e("div",Zs,[e("button",{type:"button",onClick:a=>t.removeItem("schedule",h),class:"btn btn-outline-danger w-100"},Ks,8,Gs)])]))),128)),e("div",Qs,[e("div",Ws,[e("button",{type:"button",disabled:t.companyForm.schedule.length===7,onClick:s[17]||(s[17]=i=>t.addItem("schedule")),class:"btn btn-outline-success w-100"},"Добавить еще время работы ",8,Xs)])])])])])]),e("div",Ys,[e("div",eo,[e("button",to,[t.companyForm.id===null?(l(),n("span",so,"Создать компанию")):(l(),n("span",oo,"Обновить компанию"))])])])],32)):c("",!0),t.step===1?(l(),n("div",lo,[o.company&&!t.load?(l(),L(ot,{key:0,company:o.company},null,8,["company"])):c("",!0)])):c("",!0)],64)}}}),ao={class:"d-flex"},co={class:"dropdown mr-2"},ro=e("button",{class:"btn btn-outline-primary dropdown-toggle",type:"button",id:"dropdownMenuButton1","data-bs-toggle":"dropdown","aria-expanded":"false"}," Фильтры ",-1),mo={class:"dropdown-menu","aria-labelledby":"dropdownMenuButton1"},ho=["onClick"],uo={class:"input-group mb-3"},po={key:0,class:"mt-2"},_o={class:"badge bg-info mr-1"},bo=["onClick"],go=e("i",{class:"fa-solid fa-xmark"},null,-1),yo=[go],fo={class:"list-group w-100 p-0 m-0"},vo=["onClick"],ko={key:0},Co=["onClick"],Fo=e("i",{class:"fa-solid fa-pen-to-square"},null,-1),$o=[Fo],wo=["onClick"],Po=e("i",{class:"fa-solid fa-boxes-packing"},null,-1),Lo=[Po],Uo=["onClick"],jo=e("i",{class:"fa-solid fa-box-open"},null,-1),Io=[jo],Vo={class:"modal fade",id:"edit-company-modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},xo={class:"modal-dialog modal-lg"},qo={class:"modal-content"},Oo=e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"exampleModalLabel"},"Сохранение клиента"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Mo={class:"modal-body"},So={key:0,class:"row"},Bo={class:"col-12 mb-2"},zo=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Не сохранять")],-1),Eo={props:["selected","isSimple"],data(){return{show:!0,loading:!0,companies:[],search:null,editCompanyModal:null,filters:[{name:"Активные",icon:"fa-brands fa-telegram",slug:"active"},{name:"Архивные",icon:"fa-solid fa-box-archive",slug:"archive"}],selectedFilters:[],companies_paginate_object:null,selectedCompany:null}},computed:{...x(["getCompanies","getCompaniesPaginateObject"]),filteredCompanies(){if(!this.companies)return[];if(this.selectedFilters.length===0&&this.search==null)return this.companies;if(this.selectedFilters.length===0&&this.search!=null)return this.companies.filter(t=>(t.title||"").trim().toLowerCase().indexOf(this.search.trim().toLowerCase())!==-1);let o=[];return this.selectedFilters.forEach(t=>{switch(t.slug){case"active":this.companies.filter(s=>s.deleted_at==null).forEach(s=>{o.push(s)});break;case"archive":this.companies.filter(s=>s.deleted_at!=null).forEach(s=>{o.push(s)});break}}),this.search==null?o:o.filter(t=>(t.title||"").trim().toLowerCase().indexOf(this.search.trim().toLowerCase())!==-1)}},mounted(){this.loadCompanies(),this.selectFilter("active"),this.editCompanyModal=new bootstrap.Modal(document.getElementById("edit-company-modal"),{})},methods:{companyCallback(o){this.selectedCompany=null,this.editCompanyModal.hide()},editClient(o){this.selectedCompany=o,this.editCompanyModal.show()},addToArchive(o){this.$store.dispatch("removeCompany",{companyId:o}).then(t=>{let s=this.companies_paginate_object.meta.current_page||0;this.loadCompanies(s),this.$notify("Указанный клиент успешно перемещен в архив")})},extractFromArchive(o){this.$store.dispatch("restoreCompany",{companyId:o}).then(t=>{let s=this.companies_paginate_object.meta.current_page||0;this.loadCompanies(s),this.$notify("Указанный клиент успешно перемещен из архива")})},selectFilter(o){let t=this.filters.find(s=>s.slug===o);t&&this.selectedFilters.filter(s=>s.slug===o).length===0&&this.selectedFilters.push(t)},removeSelectedFilter(o){let t=this.selectedFilters.findIndex(s=>s.slug===o);this.selectedFilters.splice(t,1)},selectCompany(o){this.$store.dispatch("updateCurrentCompany",{company:o}),this.$emit("callback",o),this.show=!1,this.$notify("Вы выбрали клиента из списка! Все остальные действия будут производится для этой компании.")},nextCompanies(o){this.loadCompanies(o)},loadCompanies(o=0){this.loading=!0,this.$store.dispatch("loadCompanies",{dataObject:{search:this.search},page:o}).then(t=>{this.loading=!1,this.companies=this.getCompanies,this.companies_paginate_object=this.getCompaniesPaginateObject}).catch(()=>{this.loading=!1})}}},Do=Object.assign(Eo,{__name:"CompanyList",setup(o){return(t,s)=>(l(),n(b,null,[t.show?(l(),n(b,{key:0},[e("div",ao,[e("div",co,[ro,e("ul",mo,[(l(!0),n(b,null,y(t.filters,d=>(l(),n("li",null,[e("a",{class:"dropdown-item",onClick:r=>t.selectFilter(d.slug),href:"#filter"},[e("i",{class:v([d.icon,"mr-2"])},null,2),p(" "+_(d.name||"Не указано"),1)],8,ho)]))),256))])]),e("div",uo,[u(e("input",{type:"search",class:"form-control",placeholder:"Поиск компании","aria-label":"Поиск компании","onUpdate:modelValue":s[0]||(s[0]=d=>t.search=d),"aria-describedby":"button-addon2"},null,512),[[g,t.search]]),e("button",{class:"btn btn-outline-secondary",onClick:s[1]||(s[1]=(...d)=>t.loadCompanies&&t.loadCompanies(...d)),type:"button",id:"button-addon2"},"Найти ")])]),t.selectedFilters.length>0?(l(),n("p",po,[(l(!0),n(b,null,y(t.selectedFilters,d=>(l(),n("span",_o,[p(_(d.name||"не указан")+" ",1),e("a",{onClick:r=>t.removeSelectedFilter(d.slug),class:"ml-1 text-white",href:"#filter"},yo,8,bo)]))),256))])):c("",!0),t.companies.length>0?(l(),n(b,{key:1},[e("ul",fo,[(l(!0),n(b,null,y(t.filteredCompanies,(d,r)=>(l(),n("li",{class:v(["list-group-item cursor-pointer",{"btn-outline-info":d.deleted_at==null,"btn-outline-danger border-danger":d.deleted_at!=null,"bg-success":o.selected==d.id,"btn d-flex justify-between":!o.isSimple}])},[e("span",{onClick:m=>t.selectCompany(d),class:v({"text-danger":d.deleted_at!=null})}," #"+_(d.id||"-")+" "+_(d.title||"Не указано")+" ("+_(d.slug||"Не указано")+") ",11,vo),o.isSimple?c("",!0):(l(),n("div",ko,[e("button",{class:"btn btn-info mr-1",type:"button",onClick:m=>t.editClient(d),title:"В архив"},$o,8,Co),d.deleted_at==null?(l(),n("button",{key:0,class:"btn btn-outline-info",type:"button",onClick:m=>t.addToArchive(d.id),title:"В архив"},Lo,8,wo)):c("",!0),d.deleted_at!=null?(l(),n("button",{key:1,class:"btn btn-outline-info",type:"button",onClick:m=>t.extractFromArchive(d.id),title:"Из архива"},Io,8,Uo)):c("",!0)]))],2))),256))]),t.companies_paginate_object?(l(),L(te,{key:0,onPagination_page:t.nextCompanies,pagination:t.companies_paginate_object},null,8,["onPagination_page","pagination"])):c("",!0)],64)):c("",!0)],64)):c("",!0),e("div",Vo,[e("div",xo,[e("div",qo,[Oo,e("div",Mo,[t.selectedCompany?(l(),n("div",So,[e("div",Bo,[k(io,{company:t.selectedCompany,editor:!1,onCallback:t.companyCallback},null,8,["company","onCallback"])])])):c("",!0)]),zo])])])],64))}});export{ot as L,io as _,Do as a};
