import{o as l,k as r,n as t,p as i,L as d,M as n,N as p,Y as m,l as h,H as u,F as g,O as b}from"./index.es-c4852431.js";import{_}from"./BotDialogGroupListSimple-daf9db06.js";import"./vue3-json-editor.esm.prod-a2876a2f.js";/* empty css                                                            *//* empty css                                                            *//* empty css                                                     *//* empty css                                                              */import"./BotMediaList-9b4db56f.js";/* empty css                                                               */import{T as f}from"./TrafficStatistic-7de42901.js";import{g as y}from"./base64-ae67ffac.js";import"./Pagination-b758f7ed.js";/* empty css                                                   */import"./_plugin-vue_export-helper-c27b6911.js";/* empty css             */import"./vue3-charts.esm-31920dfb.js";const w={class:"container py-3"},k=t("div",{class:"alert alert-light"}," Данный раздел предназначен для быстрой генерации ссылок с UTM-метками, по которым в дальнейшем будут переходит новые пользователи. Результат - отображение статистики по наиболее популярным точкам восприятия рекламы пользователем. ",-1),v={class:"row"},x={class:"col-12"},L=t("p",null,"Для начала выберите страницу, для которой будет создана ссылка",-1),C={key:0,class:"text-center mt-3"},D={class:"fw-bold text-primary"},B={key:0,class:"col-12 p-3"},T={class:"text-center fw-bold"},M=t("div",{class:"alert alert-light mb-2"},[t("strong",{class:"fw-bold"},"Внимание!"),i(" Используйте метки "),t("strong",{class:"fw-bold text-primary"},"на английском языке"),i(" или "),t("strong",{class:"fw-bold text-primary"},"число"),i("! ")],-1),P={style:{position:"sticky",bottom:"81px"},class:"form-floating mb-2"},$=t("label",{for:"utm-source"},"Укажите метку для статистики",-1),F={class:"d-flex justify-content-center"},V={style:{width:"200px",height:"200px"}},q={key:1,class:"col-12"},N=t("h6",{class:"fw-bold text-center mt-5"},"Статистика по переходам",-1),z={class:"w-100 overflow-x-scroll"},j={class:"modal fade",id:"page-form-modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},A={class:"modal-dialog modal-fullscreen"},O={class:"modal-content"},S=t("div",{class:"modal-header"},[t("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"Редактор"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),U={class:"modal-body pb-5"},E={class:"navbar navbar-expand-sm fixed-bottom p-3 bg-transparent border-0",style:{"border-radius":"10px 10px 0px 0px"}},H=["disabled"],I={data(){return{date:null,page:null,utm_source:null,loadPage:!1,loadPageList:!1,pageFormModal:null}},watch:{utm_source:{handler:o=>{const e=o.replace(/[а-яА-Я\s]/g,"");globalThis.utm_source=e},deep:!0}},computed:{bot(){return window.currentBot},qr(){return"https://api.qrserver.com/v1/create-qr-code/?size=450x450&qzone=2&data="+this.pageLink},pageLink(){if(!this.page)return"https://t.me/next_service1_bot";let o="";for(let e=0;e<10-(""+this.page.id).length;e++)o+="0";return o+=this.page.id,"https://t.me/"+this.bot.bot_domain+"?start="+y.encode("004"+o+(this.utm_source!=null?"utm"+this.utm_source:""))}},mounted(){this.pageFormModal=new bootstrap.Modal("#page-form-modal",{}),this.loadBotAdminConfig();const o=new Date,e=new Date(new Date().setDate(o.getDate()-31)),s=new Date(new Date().setDate(o.getDate()+31));this.date=[e,s]},methods:{copyLink(){this.copyToClipBoard(this.pageLink)},copyToClipBoard(o){navigator.clipboard.writeText(o).then(()=>{this.$notify({title:"Копирование",text:"Ссылка скопирована в буфер"})}).catch(e=>{this.$notify({title:"Копирование",text:"Ошибка копирования",type:"error"})})},loadBotAdminConfig(){this.$store.dispatch("loadBotAdminConfig").then(o=>{this.bot=o.data})},openPageList(){this.pageFormModal.show()},pageListCallback(o){this.loadPage=!0,this.$nextTick(()=>{this.page=o,this.loadPage=!1,this.pageFormModal.hide()})},pageCallback(o){this.loadPageList=!0,this.$nextTick(()=>{this.loadPageList=!1})}}},rt=Object.assign(I,{__name:"Links",setup(o){return(e,s)=>{const c=b("lazy");return l(),r(g,null,[t("div",w,[k,t("div",v,[t("div",x,[L,t("button",{onClick:s[0]||(s[0]=(...a)=>e.openPageList&&e.openPageList(...a)),class:"btn btn-primary w-100"},"Выбрать страницу "),e.page?(l(),r("p",C,[i(' Вы выбрали страницу "'),t("span",D,d(e.page.slug.command),1),i('" (#'+d(e.page.id)+") ",1)])):n("",!0)]),e.page?(l(),r("div",B,[t("p",T,[i("Ссылка на текущую страницу: "),t("span",{style:{"word-wrap":"break-word"},class:"bg-secondary text-white font-bold cursor-pointer",onClick:s[1]||(s[1]=a=>e.copyToClipBoard(e.pageLink))},d(e.pageLink),1)]),M,t("div",P,[p(t("input",{type:"text",maxlength:"100","onUpdate:modelValue":s[2]||(s[2]=a=>e.utm_source=a),class:"form-control",id:"utm-source",placeholder:"name@example.com"},null,512),[[m,e.utm_source]]),$]),t("div",F,[p(t("img",V,null,512),[[c,e.qr]])])])):n("",!0),e.date?(l(),r("div",q,[N,t("div",z,[h(f,{date:e.date},null,8,["date"])])])):n("",!0)])]),t("div",j,[t("div",A,[t("div",O,[S,t("div",U,[e.loadPageList?n("",!0):(l(),u(_,{key:0,editor:!0,onCallback:e.pageListCallback},null,8,["onCallback"]))])])])]),t("nav",E,[t("button",{onClick:s[3]||(s[3]=(...a)=>e.copyLink&&e.copyLink(...a)),style:{"box-shadow":"1px 1px 6px 0px #0000004a"},disabled:!e.page,class:"btn btn-primary w-100 p-3 rounded-3 shadow-lg d-flex justify-content-center"}," Скопировать ссылку в буфер ",8,H)])],64)}}});export{rt as default};
