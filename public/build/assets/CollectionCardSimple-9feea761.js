import{g as h,N as m,o as a,j as r,l as i,M as p,n as l,K as n,p as b,L as c,$ as d}from"./index.es-db843bab.js";const y={key:0,class:"card border-0 mb-3"},f={class:"card-body p-0"},_={class:"d-flex"},C={class:"mr-auto",style:{"max-height":"100px"}},v={class:"rounded-2",width:"110",style:{"object-fit":"cover",height:"100%"},alt:""},P={class:"w-100 px-2 d-flex flex-column justify-content-between"},g={class:"pb-0 mb-0 fw-bold",style:{"font-size":"14px"}},w={class:"fw-bold"},k={class:"fst-italic mb-2",style:{"font-size":"10px"}},$={key:0,class:"fst-italic mb-0 text-danger fw-bold",style:{"font-size":"10px"}},A={class:"py-2 mb-0 d-flex justify-content-between",style:{"font-size":"12px"}},z={class:"d-flex w-100"},I=["disabled"],j=i("sup",{class:"font-10 opacity-50"},".00",-1),E={key:1,class:"btn-group w-100"},B=["disabled"],N=["disabled"],R={props:["item","params"],data(){return{sending:!1,is_online:!0}},computed:{...h(["inCollectionCart"]),canProductAction(){return this.is_online&&!this.sending},checkInCart(){var e;return this.inCollectionCart(this.item.id,((e=this.params)==null?void 0:e.variant_id)||null)},description(){let e="",t=this.params.ids||[];return this.item.products.forEach(s=>{e+=t.indexOf(s.id)!==-1?s.title+", ":""}),e},currentPrice(){let e=0,t=this.params.ids||[];return this.item.products.forEach(s=>{e+=t.indexOf(s.id)!==-1&&s.current_price||0}),e},oldPrice(){return 0},bot(){return window.currentBot}},mounted(){window.addEventListener("online",()=>{this.is_online=!0}),window.addEventListener("offline",()=>{this.is_online=!1})},methods:{incProductCart(){this.sending=!0,(this.checkInCart===0?this.$store.dispatch("addCollectionToCart",this.item):this.$store.dispatch("incCollectionQuantity",{product_collection_id:this.item.id,variant_id:this.params.variant_id})).then(()=>{this.sending=!1,this.$notify({title:"Добавление товара",text:"Товар успешно добавлен",type:"success"})}).catch(()=>{this.sending=!1,this.$notify({title:"Добавление товара",text:"Ошибка добавления товара!",type:"error"})})},decProductCart(){this.sending=!0,(this.checkInCart<=1?this.$store.dispatch("removeCollectionFromCart",{product_collection_id:this.item.id,variant_id:this.params.variant_id}):this.$store.dispatch("decCollectionQuantity",{product_collection_id:this.item.id,variant_id:this.params.variant_id})).then(()=>{this.sending=!1,this.$notify({title:"Удаление товара",text:"Товар успешно удален",type:"success"})}).catch(()=>{this.sending=!1,this.$notify({title:"Удаление товара",text:"Ошибка удаления товара!",type:"error"})})}}},D=Object.assign(R,{__name:"CollectionCardSimple",setup(e){return(t,s)=>{const u=m("lazy");return e.item?(a(),r("div",y,[i("div",f,[i("div",_,[i("div",C,[p(i("img",v,null,512),[[u,"/images-by-company-id/"+t.bot.company.id+"/"+e.item.image]])]),i("div",P,[i("h6",g,[l(n(e.item.title||"не указано")+" ",1),i("small",w," ("+n((e.item.products||[]).length)+" ед.)",1)]),b(t.$slots,"partner"),i("p",k,n(t.description),1),e.item.discount>0?(a(),r("p",$,"Скидка "+n(e.item.discount)+"%",1)):c("",!0),i("h6",A,[i("span",null,n(t.currentPrice||0)+"₽",1),i("span",null,"="+n(t.currentPrice*t.checkInCart)+"₽",1)]),i("div",z,[t.checkInCart===0?(a(),r("button",{key:0,type:"button",class:d([{"btn-secondary":!t.canProductAction},"btn btn-sm btn-primary w-100 rounded-3"]),disabled:e.item.in_stop_list_at!=null||!t.canProductAction,onClick:s[0]||(s[0]=(...o)=>t.incProductCart&&t.incProductCart(...o))},[l(n(t.currentPrice||0),1),j,l("₽ ")],10,I)):c("",!0),t.checkInCart>0?(a(),r("div",E,[i("button",{type:"button",class:d([{"btn-secondary":!t.canProductAction},"btn btn-sm btn-primary"]),disabled:e.item.in_stop_list_at!=null||!t.canProductAction,onClick:s[1]||(s[1]=(...o)=>t.decProductCart&&t.decProductCart(...o))},"- ",10,B),i("button",{type:"button",class:d([{"btn-secondary":!t.canProductAction},"btn btn-sm"])},n(t.checkInCart),3),i("button",{type:"button",class:d([{"btn-secondary":!t.canProductAction},"btn btn-sm btn-primary"]),disabled:e.item.in_stop_list_at!=null||!t.canProductAction,onClick:s[2]||(s[2]=(...o)=>t.incProductCart&&t.incProductCart(...o))},"+ ",10,N)])):c("",!0)])])])])])):c("",!0)}}});export{D as _};
