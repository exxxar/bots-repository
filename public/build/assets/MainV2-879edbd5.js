import{y as B,o as n,g as l,j as e,n as _,s as m,C as j,w as u,v as b,t as d,l as r,F as g,q as k,N as F,R as z,x as V,u as S,L as I,p as w,B as P,K as q,Y as R,A as E}from"./index.es-800d80e2.js";import{a as O}from"./vue3-simple-typeahead-28cb397a.js";import{S as W}from"./app-28edf01f.js";import{_ as U}from"./_plugin-vue_export-helper-c27b6911.js";import"./vue3-json-editor.esm.prod-c06c32c7.js";import"./TelegramChannelHelper-5e7b2f6c.js";import"./TelegramChannelHelper.vue_vue_type_style_index_0_lang-43a0cbfe.js";import"./base64-eecd59f1.js";import"./main-70bbffa1.js";import"./v4-4a60fe23.js";import"./carousel.es-2930499a.js";import"./GlobalSlugList-bdba5fe0.js";import"./vue3-perfect-scrollbar-0ff93477.js";import"./index-55688c75.js";const A={class:"row",style:{position:"sticky",top:"0px","z-index":"1000"}},H={class:"col-12"},D={class:"btn-group w-100 px-3 py-2",style:{"overflow-x":"auto"}},N=e("i",{class:"fa-solid fa-scroll mr-2"},null,-1),x=e("i",{class:"fa-solid fa-coins mr-2"},null,-1),J=e("i",{class:"fa-solid fa-users mr-2"},null,-1),Q=e("i",{class:"fa-solid fa-icons mr-2"},null,-1),Y=e("i",{class:"fa-solid fa-arrow-up-right-from-square mr-2"},null,-1),G=e("i",{class:"fa-solid fa-arrow-up-right-from-square mr-2"},null,-1),K={class:"form-floating mb-2"},X={for:"floatingInput"},Z={key:0,class:"ml-1",style:{"font-size":"10px"}},tt={class:"form-floating"},et={for:"floatingTextarea2"},st={key:0,class:"ml-1",style:{"font-size":"10px"}},ot=e("h6",{class:"opacity-75 my-2"},"Контактная информация",-1),it={class:"form-floating mb-2"},nt=e("label",{for:"floatingInput"},"Телефон",-1),lt={class:"form-floating mb-2"},at=e("label",{for:"floatingInput"},"Инста",-1),rt={class:"form-floating mb-2"},dt=e("label",{for:"floatingInput"},"Вконтакте",-1),ct={class:"form-floating mb-2"},mt=e("label",{for:"floatingInput"},"Почта",-1),ut={class:"form-floating mb-2"},ht=e("label",{for:"floatingInput"},"Сайт",-1),pt=e("h6",{class:"opacity-75 my-2"},"Расположение заведения",-1),_t={class:"form-floating mb-2"},ft={for:"floatingInput"},bt={key:0,class:"ml-1",style:{"font-size":"10px"}},gt={class:"form-floating mb-2"},yt=e("label",{for:"floatingInput"},"Виджет с Яндекс.Картой",-1),vt=e("h6",{class:"opacity-75 my-3"},"График работы",-1),kt=e("div",{class:"alert alert-light p-2",style:{"font-size":"12px"},role:"alert"},[m(" Укажите график работы вашего заведения. Если в какой-то день ваше заведение "),e("span",{class:"fw-bold"},"закрыто"),m(" - поставьте галочку сбоку от времени и укажите причину. ")],-1),wt={class:"mb-0",style:{"font-size":"12px"}},$t={class:"input-group mb-2"},Ct={class:"input-group-text"},Ft=["onUpdate:modelValue"],It={key:0,class:"form-floating"},Tt=["onUpdate:modelValue"],Vt=e("label",{for:"floatingInput"},"Начало",-1),Bt={key:1,class:"form-floating"},St=["onUpdate:modelValue"],Mt=e("label",{for:"floatingInput"},"Окончание",-1),jt={key:2,class:"form-floating"},Pt=["onUpdate:modelValue"],Ut=e("label",{for:"floatingInput"},"Причина закрытия",-1),Lt=e("button",{style:{"z-index":"100"},type:"submit",class:"btn btn-primary w-100 p-3 mb-3 position-sticky bottom-0"},"Сохранить изменения ",-1),zt=e("div",{class:"alert alert-light mb-2"}," Максимальное значение баллов, которое пользователь может списать во время покупки в магазине, в % от цены заказа. ",-1),qt={class:"form-floating mb-2"},Rt=e("label",{for:"floatingInput"},"CashBack",-1),Et=e("div",{class:"alert alert-light mb-2"}," Уровни автоматического начисления баллов по реферальной программе, в %. ",-1),Ot={class:"form-floating mb-2"},Wt=e("label",{for:"floatingInput"},"Уровень 1, %",-1),At={class:"form-floating mb-2"},Ht=e("label",{for:"floatingInput"},"Уровень 2, %",-1),Dt={class:"form-floating mb-2"},Nt=e("label",{for:"floatingInput"},"Уровень 3, %",-1),xt={class:"mb-2"},Jt={class:"form-check"},Qt=e("label",{class:"form-check-label",for:"need-cashback-config"}," Необходимо настроить баллы по категориям ",-1),Yt={key:0,class:"mb-2"},Gt=e("h6",{class:"opacity-75 my-2"},"Настройка категорий баллов",-1),Kt=e("div",{class:"alert alert-light",role:"alert"}," Категории баллов - это возможность разделить накопления и траты баллов пользователями бота на указанные цели, например, кофейня может создать категории: на кофе, на десерты - и начислять баллы за купленный кофе отдельно от баллов за купленный десерт ",-1),Xt={class:"input-group mb-2"},Zt={class:"form-floating"},te=["onUpdate:modelValue"],ee=e("label",{for:"floatingInput"},"Название категории",-1),se=["onClick"],oe=e("i",{class:"fa-regular fa-trash-can"},null,-1),ie=[oe],ne={class:"mb-2"},le={class:"form-check"},ae=e("label",{class:"form-check-label",for:"need-cashback-rules"}," Необходимо настроить оповещения под CashBack ",-1),re={key:1,class:"col-md-12 col-12 mb-2"},de={class:"form-floating mb-2"},ce=e("option",{value:null},"Не выбрано",-1),me=["value"],ue=e("label",{for:"floatingSelect"},[e("i",{class:"fa-solid fa-triangle-exclamation text-danger"}),m(" Правила критических оповещений ")],-1),he={class:"m-0 fst-italic"},pe={class:"input-group mb-2"},_e={class:"input-group-text"},fe={class:"form-check d-flex justify-content-center align-items-center"},be=["onUpdate:modelValue","id"],ge={class:"form-floating"},ye=["onUpdate:modelValue"],ve=e("label",{for:"floatingInput"},"Значение",-1),ke=["onClick"],we=e("i",{class:"fa-regular fa-trash-can"},null,-1),$e=[we],Ce=e("button",{style:{"z-index":"100"},type:"submit",class:"btn btn-primary w-100 p-3 mb-3 position-sticky bottom-0"},"Сохранить изменения ",-1),Fe=e("h6",{class:"fw-bold"},"Варианты скрипта",-1),Ie={key:0,class:"list-group mb-2"},Te=["onClick"],Ve={class:"fw-bold"},Be=e("h6",{class:"fw-bold"},"Редактор",-1),Se=e("div",{class:"divider w-100 my-3"},"Пункты меню",-1),Me={class:"row row-cols-1"},je={class:"col mb-2"},Pe=["onClick"],Ue=e("div",{class:"divider w-100 my-3"},"Редактор",-1),Le={class:"form-check form-switch"},ze={class:"form-check-label",for:"iconForm-is_visible"},qe={class:"form-floating mb-2"},Re=e("label",{for:"floatingInput"},"Название меню",-1),Ee={key:0},Oe={class:"img-thumbnail w-100",alt:"..."},We={key:1},Ae={class:"img-thumbnail w-100"},He={key:2,class:"mb-0 w-100 text-center bg-success text-white rounded-2 my-2 p-3"},De=["innerHTML"],Ne={class:"form-floating my-2"},xe=["id"],Je=e("label",{for:"floatingInput"},"Изображение",-1),Qe={data(){return{selected_menu_item_index:0,scripts:[],photos_for_upload:[],selected_script:null,load_script:!0,tab:0,need_cashback_config:!1,need_cashback_rules:!1,need_cashback_fired:!1,warnings:[{title:"Сумма чека больше чем",key:"bill_sum_more_then"},{title:"Сумма начисления кэшбэка больше чем",key:"cashback_up_sum_more_then"},{title:"Сумма списания кэшбэка больше чем",key:"cashback_down_sum_more_then"}],cashback_fire_periods:[{title:"Не сгорает",value:0},{title:"7 дней",value:7},{title:"15 дней",value:15},{title:"30 дней",value:30},{title:"60 дней",value:60},{title:"60 дней",value:90},{title:"120 дней",value:120},{title:"180 дней",value:180},{title:"360 дней",value:360}],selected_warning:null,botForm:{warnings:[],payment_provider_token:null,auto_cashback_on_payments:!1,level_1:0,level_2:0,level_3:0,max_cashback_use_percent:0,cashback_config:[]},iconConfig:{maxWidth:500,maxHeight:500,maxSizeMB:2,errorMessage:""},iconForm:{items:[]},companyForm:{id:null,title:null,description:null,address:null,phones:[],links:{vk:null,inst:null,map_link:null,site:null},email:null,schedule:[{day:"Понедельник",start_at:"08:00",end_at:"20:00",closed:!1,closed_comment:"Выходной"},{day:"Вторник",start_at:"08:00",end_at:"20:00",closed:!1,closed_comment:"Выходной"},{day:"Среда",start_at:"08:00",end_at:"20:00",closed:!1,closed_comment:"Выходной"},{day:"Четверг",start_at:"08:00",end_at:"20:00",closed:!1,closed_comment:"Выходной"},{day:"Пятница",start_at:"08:00",end_at:"20:00",closed:!1,closed_comment:"Выходной"},{day:"Суббота",start_at:"08:00",end_at:"20:00",closed:!1,closed_comment:"Выходной"},{day:"Воскресенье",start_at:"08:00",end_at:"20:00",closed:!1,closed_comment:"Выходной"}]}}},computed:{currentBot(){return window.currentBot},filteredWarnings(){return this.botForm.warnings.length===0?this.warnings:this.warnings.filter(i=>!(this.botForm.warnings.findIndex(t=>t.rule_key===i.key)>=0))}},watch:{tab(i,t){this.tab===2&&this.loadFriendsScriptVariants()},selected_menu_item_index:{handler:function(i){this.iconConfig.errorMessage=""},deep:!0},iconForm:{handler:function(i){this.iconConfig.errorMessage=""},deep:!0}},mounted(){this.currentBot.settings&&(this.currentBot.settings.icons||null)!=null&&(this.iconForm.items=this.currentBot.settings.icons);const i=this.currentBot.company;this.companyForm.id=i.id||null,this.companyForm.title=i.title||null,this.companyForm.description=i.description||null,this.companyForm.email=i.email||null,this.companyForm.address=i.address||null,this.companyForm.phones=i.phones||["+7"],this.botForm.payment_provider_token=this.currentBot.payment_provider_token||null,this.botForm.auto_cashback_on_payments=this.currentBot.auto_cashback_on_payments||!1,this.botForm.max_cashback_use_percent=this.currentBot.max_cashback_use_percent||0,this.botForm.level_1=this.currentBot.level_1||0,this.botForm.level_2=this.currentBot.level_2||0,this.botForm.level_3=this.currentBot.level_3||0,this.botForm.cashback_config=this.currentBot.cashback_config||[],this.botForm.warnings=this.currentBot.warnings||[];let t=h=>{if(!h)return!1;let a=["inst","vk","map_link","site"],o=!1,c=0;return Object.keys(h).forEach(p=>{a.indexOf(p)!==-1&&(o=!0,c++)}),o&&c===a.length};this.companyForm.links=t(i.links)?i.links:{vk:null,inst:null,map_link:null,site:null};let s=h=>{if((h||[]).length<7)return!1;let a=!0;return h.forEach(o=>{a=a&&typeof o=="object"}),a};this.companyForm.schedule=s(i.schedule)?i.schedule:this.companyForm.schedule},methods:{goToEditor(){this.$router.push({name:"MenuV2"}),setTimeout(()=>{const i=document.querySelector(".modal.show");if(i){const s=bootstrap.Modal.getInstance(i);s&&s.hide()}new bootstrap.Modal("#script-setting-editor",{}).show()},300)},goToIntegrations(){this.$preloader.show(),this.$router.push({name:"IntegrationsV2"})},getPhoto(i){return{imageUrl:URL.createObjectURL(i)}},selectMenuItem(i){this.selected_menu_item_index=i},onChangePhotos(i,t){const s=i.target.files[0];if(!s)return;if(s.size/(1024*1024)>this.iconConfig.maxSizeMB){this.iconConfig.errorMessage=`Файл слишком большой. Максимальный размер: ${this.iconConfig.maxSizeMB}MB`;return}const a=new Image;a.src=URL.createObjectURL(s),a.onload=()=>{if(a.width>this.iconConfig.maxWidth||a.height>this.iconConfig.maxHeight)this.iconConfig.errorMessage=`Изображение слишком большое. Макс: ${this.iconConfig.maxWidth}x${this.iconConfig.maxHeight}px`;else{this.iconConfig.errorMessage="";const o=this.iconForm.items[t].slug;this.photos_for_upload[o]=s}}},storeMenu(){let i=new FormData;Object.keys(this.iconForm).forEach(t=>{const s=this.iconForm[t]||"";typeof s=="object"?i.append(t,JSON.stringify(s)):i.append(t,s)}),Object.keys(this.photos_for_upload).forEach(t=>{i.append(t+"[]",this.photos_for_upload[t])}),this.$store.dispatch("updateBotMenuItems",{iconForm:i}).then(t=>{this.$notify({title:"Иконки",text:"Иконки меню успешно обновлены!",type:"success"}),this.$emit("callback",t.data)}).catch(t=>{this.$notify({title:"Иконки",text:"Ошибка обновления информации",type:"error"})})},submitBotForm(){let i=new FormData;Object.keys(this.botForm).forEach(t=>{const s=this.botForm[t]||"";typeof s=="object"?i.append(t,JSON.stringify(s)):i.append(t,s)}),this.$store.dispatch("updateBotParams",{botForm:i}).then(t=>{this.$notify({title:"Информация о боте",text:"Информация о боте успешно обновлена!",type:"success"}),this.$emit("callback",t.data),window.location.reload()}).catch(t=>{this.$notify({title:"Информация о боте",text:"Ошибка обновления информации о боте",type:"error"})})},callbackScriptChange(){this.loadFriendsScriptVariants()},loadFriendsScriptVariants(){this.selected_script=null,this.load_script=!1,this.$store.dispatch("friendsLoadScriptVariants").then(i=>{this.load_script=!0,this.scripts=i||[],this.scripts.length>0&&this.selectScript(this.scripts[0])}).catch(i=>{this.load_script=!0})},selectScript(i){this.selected_script=null,this.load_script=!1,this.$nextTick(()=>{this.selected_script=i,this.load_script=!0})},submitCompanyForm(){let i=new FormData;Object.keys(this.companyForm).forEach(t=>{const s=this.companyForm[t]||"";typeof s=="object"?i.append(t,JSON.stringify(s)):i.append(t,s)}),this.$store.dispatch("updateCompany",{companyForm:i}).then(t=>{this.$notify({title:"Информация о компании",text:"Информация о компании успешно обновлена!",type:"success"}),this.$emit("callback",t.data),window.location.reload()}).catch(t=>{this.$notify({title:"Информация о компании",text:"Ошибка обновления информации о компании",type:"error"})})},addWarning(){const i=this.selected_warning;this.botForm.warnings.push({rule_key:i.key,rule_value:0,is_active:!0}),this.selected_warning=null},addCashBackConfig(){this.botForm.cashback_config=this.botForm.cashback_config==null?[]:this.botForm.cashback_config,this.botForm.cashback_config.push({title:null})},getWarning(i){let t=this.warnings.find(s=>s.key===i);return t||{title:"Не найдено"}},removeWarning(i){this.botForm.warnings.splice(i,1)},removeCashBackConfig(i){this.botForm.cashback_config.splice(i,1)}}},Ye=Object.assign(Qe,{__name:"CompanyInfo",setup(i){return(t,s)=>{const h=B("mask"),a=B("lazy");return n(),l(g,null,[e("div",A,[e("div",H,[e("div",D,[e("button",{type:"button",class:_(["btn-info btn p-3",{active:t.tab===0}]),onClick:s[0]||(s[0]=o=>t.tab=0),style:{"white-space":"nowrap","line-height":"100%"},"aria-current":"page"},[N,m("Основное ")],2),e("button",{type:"button",class:_(["btn-info btn p-3",{active:t.tab===1}]),onClick:s[1]||(s[1]=o=>t.tab=1),style:{"white-space":"nowrap","line-height":"100%"},"aria-current":"page"},[x,m("Баллы ")],2),e("button",{type:"button",class:_(["btn-info btn p-3",{active:t.tab===2}]),onClick:s[2]||(s[2]=o=>t.tab=2),style:{"white-space":"nowrap","line-height":"100%"},"aria-current":"page"},[J,m("Друзья ")],2),e("button",{type:"button",class:_(["btn-info btn p-3",{active:t.tab===3}]),onClick:s[3]||(s[3]=o=>t.tab=3),style:{"white-space":"nowrap","line-height":"100%"},"aria-current":"page"},[Q,m("Иконки ")],2),e("button",{type:"button",onClick:s[4]||(s[4]=(...o)=>t.goToEditor&&t.goToEditor(...o)),style:{"white-space":"nowrap","line-height":"100%"},class:"btn-primary btn p-3"},[Y,m(" Настройки магазина")]),e("button",{type:"button","data-bs-dismiss":"modal",style:{"white-space":"nowrap","line-height":"100%"},onClick:s[5]||(s[5]=(...o)=>t.goToIntegrations&&t.goToIntegrations(...o)),class:"btn-primary btn p-3"},[G,m(" Интеграции")])])])]),t.tab===0?(n(),l("form",{key:0,onSubmit:s[15]||(s[15]=j((...o)=>t.submitCompanyForm&&t.submitCompanyForm(...o),["prevent"]))},[e("div",K,[u(e("input",{type:"text","onUpdate:modelValue":s[6]||(s[6]=o=>t.companyForm.title=o),maxlength:"255",class:"form-control",id:"floatingInput",placeholder:"name@example.com",required:""},null,512),[[b,t.companyForm.title]]),e("label",X,[m("Название "),(t.companyForm.title||"").length>0?(n(),l("span",Z,"("+d(t.companyForm.title.length)+"/255)",1)):r("",!0)])]),e("div",tt,[u(e("textarea",{"onUpdate:modelValue":s[7]||(s[7]=o=>t.companyForm.description=o),maxlength:"512",required:"",class:"form-control",placeholder:"Leave a comment here",id:"floatingTextarea2",style:{height:"200px"}},null,512),[[b,t.companyForm.description]]),e("label",et,[m("Описание "),(t.companyForm.description||"").length>0?(n(),l("span",st,"("+d(t.companyForm.description.length)+"/512)",1)):r("",!0)])]),ot,e("div",it,[u(e("input",{type:"text","onUpdate:modelValue":s[8]||(s[8]=o=>t.companyForm.phones[0]=o),class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,512),[[h,["+7(###)###-##-##"]],[b,t.companyForm.phones[0]]]),nt]),e("div",lt,[u(e("input",{type:"text","onUpdate:modelValue":s[9]||(s[9]=o=>t.companyForm.links.inst=o),class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,512),[[b,t.companyForm.links.inst]]),at]),e("div",rt,[u(e("input",{type:"text","onUpdate:modelValue":s[10]||(s[10]=o=>t.companyForm.links.vk=o),class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,512),[[b,t.companyForm.links.vk]]),dt]),e("div",ct,[u(e("input",{type:"email","onUpdate:modelValue":s[11]||(s[11]=o=>t.companyForm.email=o),class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,512),[[b,t.companyForm.email]]),mt]),e("div",ut,[u(e("input",{type:"url","onUpdate:modelValue":s[12]||(s[12]=o=>t.companyForm.links.site=o),class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,512),[[b,t.companyForm.links.site]]),ht]),pt,e("div",_t,[u(e("input",{type:"text","onUpdate:modelValue":s[13]||(s[13]=o=>t.companyForm.address=o),class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,512),[[b,t.companyForm.address]]),e("label",ft,[m("Адрес расположения "),(t.companyForm.address||"").length>0?(n(),l("span",bt,"("+d(t.companyForm.address.length)+"/255)",1)):r("",!0)])]),e("div",gt,[u(e("textarea",{"onUpdate:modelValue":s[14]||(s[14]=o=>t.companyForm.links.map_link=o),class:"form-control",placeholder:"Leave a comment here",id:"floatingTextarea2",style:{height:"200px"}},null,512),[[b,t.companyForm.links.map_link]]),yt]),vt,kt,(n(!0),l(g,null,k(t.companyForm.schedule,(o,c)=>(n(),l(g,null,[e("p",wt,d(t.companyForm.schedule[c].day),1),e("div",$t,[e("div",Ct,[u(e("input",{class:"form-check-input mt-0","onUpdate:modelValue":p=>t.companyForm.schedule[c].closed=p,type:"checkbox",value:"","aria-label":"Checkbox for following text input"},null,8,Ft),[[F,t.companyForm.schedule[c].closed]])]),t.companyForm.schedule[c].closed?r("",!0):(n(),l("div",It,[u(e("input",{type:"time","onUpdate:modelValue":p=>t.companyForm.schedule[c].start_at=p,class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,8,Tt),[[b,t.companyForm.schedule[c].start_at]]),Vt])),t.companyForm.schedule[c].closed?r("",!0):(n(),l("div",Bt,[u(e("input",{type:"time","onUpdate:modelValue":p=>t.companyForm.schedule[c].end_at=p,class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,8,St),[[b,t.companyForm.schedule[c].end_at]]),Mt])),t.companyForm.schedule[c].closed?(n(),l("div",jt,[u(e("input",{type:"text","onUpdate:modelValue":p=>t.companyForm.schedule[c].closed_comment=p,class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,8,Pt),[[b,t.companyForm.schedule[c].closed_comment]]),Ut])):r("",!0)])],64))),256)),Lt],32)):r("",!0),t.tab===1?(n(),l("form",{key:1,onSubmit:s[25]||(s[25]=j((...o)=>t.submitBotForm&&t.submitBotForm(...o),["prevent"]))},[zt,e("div",qt,[u(e("input",{type:"number","onUpdate:modelValue":s[16]||(s[16]=o=>t.botForm.max_cashback_use_percent=o),min:"0",max:"100",class:"form-control",id:"floatingInput",placeholder:"name@example.com",required:""},null,512),[[b,t.botForm.max_cashback_use_percent]]),Rt]),Et,e("div",Ot,[u(e("input",{type:"number","onUpdate:modelValue":s[17]||(s[17]=o=>t.botForm.level_1=o),min:"0",max:"100",class:"form-control",id:"floatingInput",placeholder:"name@example.com",required:""},null,512),[[b,t.botForm.level_1]]),Wt]),e("div",At,[u(e("input",{type:"number","onUpdate:modelValue":s[18]||(s[18]=o=>t.botForm.level_2=o),min:"0",max:"100",class:"form-control",id:"floatingInput",placeholder:"name@example.com",required:""},null,512),[[b,t.botForm.level_2]]),Ht]),e("div",Dt,[u(e("input",{type:"number","onUpdate:modelValue":s[19]||(s[19]=o=>t.botForm.level_3=o),min:"0",max:"100",class:"form-control",id:"floatingInput",placeholder:"name@example.com",required:""},null,512),[[b,t.botForm.level_3]]),Nt]),e("div",xt,[e("div",Jt,[u(e("input",{class:"form-check-input","onUpdate:modelValue":s[20]||(s[20]=o=>t.need_cashback_config=o),type:"checkbox",id:"need-cashback-config"},null,512),[[F,t.need_cashback_config]]),Qt])]),t.need_cashback_config?(n(),l("div",Yt,[Gt,Kt,(n(!0),l(g,null,k(t.botForm.cashback_config,(o,c)=>(n(),l("div",{class:"d-flex justify-content-between flex-wrap",key:"social-link"+c},[e("div",Xt,[e("div",Zt,[u(e("input",{type:"text",placeholder:"Название категории","aria-label":"Название категории",maxlength:"255","onUpdate:modelValue":p=>t.botForm.cashback_config[c].title=p,class:"form-control",id:"floatingInput"},null,8,te),[[b,t.botForm.cashback_config[c].title]]),ee]),e("button",{type:"button",onClick:p=>t.removeCashBackConfig(c),class:"btn btn-outline-light text-danger"},ie,8,se)])]))),128)),e("button",{type:"button",onClick:s[21]||(s[21]=o=>t.addCashBackConfig()),class:"btn mb-2 rounded-sm btn-outline-primary p-3 w-100"}," Добавить категорию ")])):r("",!0),e("div",ne,[e("div",le,[u(e("input",{class:"form-check-input","onUpdate:modelValue":s[22]||(s[22]=o=>t.need_cashback_rules=o),type:"checkbox",id:"need-cashback-rules"},null,512),[[F,t.need_cashback_rules]]),ae])]),t.need_cashback_rules?(n(),l("div",re,[e("div",de,[u(e("select",{class:"form-select","onUpdate:modelValue":s[23]||(s[23]=o=>t.selected_warning=o),onChange:s[24]||(s[24]=(...o)=>t.addWarning&&t.addWarning(...o)),id:"floatingSelect","aria-label":"Floating label select example"},[ce,(n(!0),l(g,null,k(t.filteredWarnings,o=>(n(),l("option",{value:o},d(o.title),9,me))),256))],544),[[z,t.selected_warning]]),ue]),(n(!0),l(g,null,k(t.botForm.warnings,(o,c)=>(n(),l(g,null,[e("p",he,d(t.getWarning(o.rule_key).title||"Не найдено"),1),e("div",pe,[e("div",_e,[e("div",fe,[u(e("input",{class:"form-check-input","onUpdate:modelValue":p=>t.botForm.warnings[c].is_active=p,type:"checkbox",id:"warning-is-active-"+c},null,8,be),[[F,t.botForm.warnings[c].is_active]])])]),e("div",ge,[u(e("input",{type:"number",placeholder:"Значение","aria-label":"Значение","onUpdate:modelValue":p=>t.botForm.warnings[c].rule_value=p,min:"0",class:"form-control",id:"floatingInput"},null,8,ye),[[b,t.botForm.warnings[c].rule_value]]),ve]),e("button",{type:"button",onClick:p=>t.removeWarning(c),class:"btn btn-outline-light text-danger"},$e,8,ke)])],64))),256))])):r("",!0),Ce],32)):r("",!0),t.tab===2?(n(),l(g,{key:2},[Fe,(t.scripts||[]).length>0?(n(),l("ul",Ie,[(n(!0),l(g,null,k(t.scripts,o=>(n(),l("li",{onClick:c=>t.selectScript(o),class:_([{"bg-primary text-white":(t.selected_script||{id:null}).id===o.id},"list-group-item d-flex justify-content-between"])},[m(d(o.command||"-")+" ",1),e("small",Ve,"#"+d(o.id),1)],10,Te))),256))])):r("",!0),Be,t.load_script?(n(),V(O,{key:1,item:t.selected_script,onCallback:t.callbackScriptChange},null,8,["item","onCallback"])):r("",!0)],64)):r("",!0),t.tab===3?(n(),l(g,{key:3},[Se,e("div",Me,[(n(!0),l(g,null,k(t.iconForm.items.length,(o,c)=>(n(),l("div",je,[e("button",{type:"button",class:_([{"btn-primary text-white":c===t.selected_menu_item_index,"btn-outline-primary":c!==t.selected_menu_item_index},"mb-0 btn w-100"]),onClick:p=>t.selectMenuItem(c)},d(t.iconForm.items[c].title),11,Pe)]))),256))]),Ue,e("div",Le,[u(e("input",{class:"form-check-input","onUpdate:modelValue":s[26]||(s[26]=o=>t.iconForm.items[t.selected_menu_item_index].is_visible=o),type:"checkbox",role:"switch",id:"iconForm-is_visible"},null,512),[[F,t.iconForm.items[t.selected_menu_item_index].is_visible]]),e("label",ze,[m(" Виден пользователям: "),e("span",{class:_({"fw-bold text-primary":t.iconForm.items[t.selected_menu_item_index].is_visible})},"виден",2),m(" / "),e("span",{class:_({"fw-bold text-primary":!t.iconForm.items[t.selected_menu_item_index].is_visible})},"не виден",2)])]),e("div",qe,[u(e("input",{type:"text","onUpdate:modelValue":s[27]||(s[27]=o=>t.iconForm.items[t.selected_menu_item_index].title=o),required:"",class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,512),[[b,t.iconForm.items[t.selected_menu_item_index].title]]),Re]),t.iconForm.items[t.selected_menu_item_index].has_icon?(n(),l(g,{key:0},[t.iconForm.items[t.selected_menu_item_index].image_url&&!t.photos_for_upload[t.iconForm.items[t.selected_menu_item_index].slug]?(n(),l("div",Ee,[u(e("img",Oe,null,512),[[a,"/images/shop-v2-2/"+t.iconForm.items[t.selected_menu_item_index].image_url]])])):(n(),l("div",We,[u(e("img",Ae,null,512),[[a,t.getPhoto(t.photos_for_upload[t.iconForm.items[t.selected_menu_item_index].slug]).imageUrl]])])),t.photos_for_upload[t.iconForm.items[t.selected_menu_item_index].slug]?(n(),l("p",He,[m("Фото добавлено в очередь, "),e("a",{class:"text-white",onClick:s[28]||(s[28]=o=>delete t.photos_for_upload[t.iconForm.items[t.selected_menu_item_index].slug]),href:"javascript:void(0)"},"отменить?")])):r("",!0),t.iconConfig.errorMessage?(n(),l("div",{key:3,class:"alert alert-danger my-2",innerHTML:t.iconConfig.errorMessage},null,8,De)):r("",!0),e("div",Ne,[e("input",{type:"file",id:"menu-photos-"+t.selected_menu_item_index,accept:"image/*",required:"",class:"form-control",onChange:s[29]||(s[29]=o=>t.onChangePhotos(o,t.selected_menu_item_index))},null,40,xe),Je])],64)):r("",!0),e("button",{onClick:s[30]||(s[30]=(...o)=>t.storeMenu&&t.storeMenu(...o)),style:{"z-index":"100"},type:"button",class:"btn btn-primary w-100 p-3 mb-3 position-sticky bottom-0"},"Сохранить изменения ")],64)):r("",!0)],64)}}}),Ge={data(){return{item:null,tab:0,modal:null,selected_image:null,loading_reviews:!1,reviews:[],paginate:null,sending:!1,is_online:!0}},computed:{...S(["inCart","getReviews","getReviewsPaginateObject"]),currentPrice(){return this.item.current_price/100},oldPrice(){return this.item.old_price/100},checkInCart(){return this.inCart(this.item.id)},discount(){return this.oldPrice>0?Math.round(this.currentPrice/this.oldPrice*100):0},canProductAction(){return this.is_online&&!this.sending},currentScriptId(){return window.currentScript},currentBot(){return window.currentBot},qr(){return"https://api.qrserver.com/v1/create-qr-code/?size=450x450&qzone=2&data="+this.productLink},productLink(){return"https://t.me/"+this.currentBot.bot_domain+"?start="+btoa("001slug"+this.currentScriptId+"product"+this.item.id)}},mounted(){this.modal=new bootstrap.Modal(document.getElementById("product-modal-info"),{}),window.addEventListener("online",()=>{this.is_online=!0}),window.addEventListener("offline",()=>{this.is_online=!1}),window.addEventListener("product-info-event",i=>{this.item=i.detail.product,this.selected_image=(this.item.images||[]).length>0?this.item.images[0]:null,this.showProductDetails()})},methods:{goToProduct(){this.$router.push({name:"ProductV2",params:{productId:this.item.id}})},nextReviews(i){this.loadReviews(i)},loadReviews(i=0){return this.tab=1,this.loading_reviews=!0,this.$store.dispatch("loadReviewsByProductId",{dataObject:{product_id:this.item.id},page:i,size:30}).then(t=>{this.reviews=this.getReviews,this.paginate=this.getReviewsPaginateObject,this.loading_reviews=!1}).catch(()=>{this.loading_reviews=!1})},showProductDetails(){this.modal.show()},incProductCart(){this.sending=!0,(this.checkInCart===0?this.$store.dispatch("addProductToCart",this.item):this.$store.dispatch("incQuantity",this.item.id)).then(()=>{this.sending=!1,this.$notify({title:"Добавление товара",text:'Товар "'+this.item.title+'" успешно добавлен',type:"success"})}).catch(()=>{this.sending=!1,this.$notify({title:"Добавление товара",text:"Ошибка добавления товара!",type:"error"})})},decProductCart(){this.sending=!0,(this.checkInCart<=1?this.$store.dispatch("removeProduct",this.item.id):this.$store.dispatch("decQuantity",this.item.id)).then(()=>{this.sending=!1,this.$notify({title:"Удаление товара",text:'Товар "'+this.item.title+'" успешно убран из корзины',type:"success"})}).catch(()=>{this.sending=!1,this.$notify({title:"Удаление товара",text:"Ошибка удаления товара!",type:"error"})})},selectInCollection(i){this.canSelect&&this.$emit("select-in-collection",i)},copyToClipBoard(){const i=this.productLink;navigator.clipboard.writeText(i).then(()=>{this.$notify({title:"Копирование",text:"Ссылка скопирована в буфер"})}).catch(t=>{this.$notify({title:"Копирование",text:"Ошибка копирования",type:"error"})})}}},Ke={class:"modal fade",id:"product-modal-info",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},Xe={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-fullscreen"},Ze={class:"modal-content"},ts=e("div",{class:"modal-header"},[e("h1",{class:"modal-title fs-5",id:"exampleModalLabel"}),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),es={class:"modal-body"},ss={class:"card border-0"},os={style:{"min-height":"350px","object-fit":"cover"},class:"card-img",alt:"..."},is={class:"card-img-overlay d-flex flex-column justify-content-between p-0"},ns={class:"shadow-bg",style:{"min-height":"70px"}},ls={class:"text-left text-white",style:{"font-weight":"700","line-height":"100%"}},as={class:"d-flex justify-content-between align-items-center"},rs={class:"text-left mb-0 text-white"},ds={class:"text-primary fw-bold"},cs={key:0,class:"badge bg-primary fw-bold"},ms={key:0,class:"row g-2 row-cols-5"},us={class:"col"},hs=["onClick"],ps=e("i",{class:"fa-solid fa-link"},null,-1),_s={class:"p-2"},fs=e("p",{class:"mb-0"},"Рейтинг товара",-1),bs={class:"d-flex justify-content-between mb-3"},gs={key:1,class:"p-2 alert alert-warning"},ys=e("p",{class:"mb-0 fw-bold"},"Особенности доставки",-1),vs={key:0,class:"d-flex justify-content-between mb-3"},ks={key:1,class:"mb-0"},ws={key:2,class:"p-2"},$s=e("p",{class:"mb-0"},"Параметры товара",-1),Cs={class:"table"},Fs=e("thead",null,[e("th",null,"Параметр"),e("th",null,"Значение")],-1),Is={key:0},Ts=e("td",null,"Ширина",-1),Vs={key:1},Bs=e("td",null,"Высота",-1),Ss={key:2},Ms=e("td",null,"Длина",-1),js={key:3},Ps=e("td",null,"Вес",-1),Us={class:"nav nav-tabs justify-content-center"},Ls={class:"nav-item"},zs={class:"nav-item"},qs={key:3},Rs=["innerHTML"],Es={key:1,class:"text-justify py-2 fst-italic"},Os={key:4},Ws={key:0},As={class:"list-group w-100 py-2 rounded-0"},Hs={class:"list-group-item"},Ds={key:1,class:"alert alert-light my-2 d-flex justify-content-center align-items-center",role:"alert"},Ns=e("div",{class:"d-flex justify-content-center align-items-center flex-column"},[e("div",{class:"spinner-grow text-primary my-3",role:"status"},[e("span",{class:"visually-hidden"},"Загружаем....")]),e("p",null,"Загружаем отзывы...")],-1),xs=[Ns],Js={key:2,class:"alert alert-light my-2",role:"alert"},Qs={key:0,class:"modal-footer p-2 m-0"},Ys={class:"d-flex justify-content-between align-items-center w-100 p-0"},Gs=["disabled"],Ks={key:0,class:"text-decoration-line-through",style:{"font-size":"10px"}},Xs={key:1,class:"btn-group w-100"},Zs=["disabled"],to=["disabled"],eo={key:1,class:"modal-footer p-0 m-0"},so=e("p",{class:"p-3 border-secondary border rounded-2 w-100 text-secondary fw-bold text-center"},"Товар недоступен для заказа",-1),oo=[so];function io(i,t,s,h,a,o){const c=I("Rating"),p=I("ReviewCard"),v=I("Pagination"),$=B("lazy");return n(),l("div",Ke,[e("div",Xe,[e("div",Ze,[a.item?(n(),l(g,{key:0},[ts,e("div",es,[e("div",ss,[u(e("img",os,null,512),[[$,a.selected_image]]),e("div",is,[e("div",ns,[e("h6",ls,d(a.item.title||"Не указан"),1),e("div",as,[e("p",rs,[m("Цена "),e("strong",ds,d(a.item.current_price||0)+"₽",1)]),o.discount>0?(n(),l("span",cs,"-"+d(o.discount||0)+"%",1)):r("",!0)])])])]),(a.item.images||[]).length>1?(n(),l("div",ms,[(n(!0),l(g,null,k(a.item.images,f=>(n(),l("div",us,[u(e("img",{style:{"min-height":"60px","object-fit":"contain"},onClick:C=>a.selected_image=f,class:_([{"border border-primary":a.selected_image===f},"img-thumbnail my-2"]),alt:"..."},null,10,hs),[[$,f]])]))),256))])):r("",!0),e("a",{href:"javascript:void(0)",onClick:t[0]||(t[0]=(...f)=>o.copyToClipBoard&&o.copyToClipBoard(...f)),class:"d-block w-100 text-center py-3"},[ps,m(" Скопировать ссылку на товар")]),e("div",_s,[fs,e("h6",bs,[w(c,{rating:a.item.rating},null,8,["rating"]),m(" "+d(Math.round(a.item.rating))+" из 5 ",1)])]),a.item.delivery_terms?(n(),l("div",gs,[ys,a.item.delivery_terms?(n(),l("h6",vs,d(a.item.delivery_terms),1)):(n(),l("p",ks,"Дополнительных условий доставки нет"))])):r("",!0),a.item.dimension?(n(),l("div",ws,[$s,e("table",Cs,[Fs,e("tbody",null,[a.item.dimension.width>0?(n(),l("tr",Is,[Ts,e("td",null,d(a.item.dimension.width||0)+" см",1)])):r("",!0),a.item.dimension.height>0?(n(),l("tr",Vs,[Bs,e("td",null,d(a.item.dimension.height||0)+" см",1)])):r("",!0),a.item.dimension.length>0?(n(),l("tr",Ss,[Ms,e("td",null,d(a.item.dimension.length||0)+" см",1)])):r("",!0),a.item.dimension.weight>0?(n(),l("tr",js,[Ps,e("td",null,d(a.item.dimension.weight||0)+" кг",1)])):r("",!0)])])])):r("",!0),e("ul",Us,[e("li",Ls,[e("a",{class:_(["nav-link",{active:a.tab===0}]),onClick:t[1]||(t[1]=f=>a.tab=0),"aria-current":"page",href:"javascript:void(0)"},"Описание",2)]),e("li",zs,[e("a",{class:_(["nav-link",{active:a.tab===1}]),onClick:t[2]||(t[2]=f=>o.loadReviews(0)),href:"javascript:void(0)"},"Отзывы",2)])]),a.tab===0?(n(),l("div",qs,[a.item.description?(n(),l("p",{key:0,innerHTML:a.item.description,class:"text-justify py-2 fst-italic"},null,8,Rs)):(n(),l("p",Es,"Нет описания"))])):r("",!0),a.tab===1?(n(),l("div",Os,[a.reviews.length>0?(n(),l("div",Ws,[e("ul",As,[(n(!0),l(g,null,k(a.reviews,(f,C)=>(n(),l("li",Hs,[w(p,{"need-product":!1,modelValue:a.reviews[C],"onUpdate:modelValue":T=>a.reviews[C]=T},null,8,["modelValue","onUpdate:modelValue"])]))),256))]),a.paginate?(n(),V(v,{key:0,simple:!0,onPagination_page:o.nextReviews,pagination:a.paginate},null,8,["onPagination_page","pagination"])):r("",!0)])):r("",!0),a.reviews.length===0&&a.loading_reviews?(n(),l("div",Ds,xs)):r("",!0),a.reviews.length===0&&!a.loading_reviews?(n(),l("div",Js," У данного товара еще нет отзывов! Для того чтобы оставить отзыв Вам необходимо заказать данный товар, после чего у вас появится возможность написать ваше впечатление от него;) ")):r("",!0)])):r("",!0)]),a.item.in_stop_list_at?(n(),l("div",eo,oo)):(n(),l("div",Qs,[e("div",Ys,[i.inCart(a.item.id)===0?(n(),l("button",{key:0,type:"button",class:_([{"btn-secondary":!o.canProductAction},"btn btn-md btn-primary w-100 rounded-3 p-2"]),disabled:a.item.in_stop_list_at!=null||!o.canProductAction,onClick:t[3]||(t[3]=(...f)=>o.incProductCart&&o.incProductCart(...f))},[m(d(a.item.current_price||0)+"₽ ",1),a.item.old_price>0?(n(),l("span",Ks,d(a.item.old_price||0)+"₽",1)):r("",!0)],10,Gs)):r("",!0),i.inCart(a.item.id)>0?(n(),l("div",Xs,[e("button",{type:"button",class:_([{"btn-secondary":!o.canProductAction},"btn btn-md btn-primary p-2"]),disabled:a.item.in_stop_list_at!=null||!o.canProductAction,onClick:t[4]||(t[4]=(...f)=>o.decProductCart&&o.decProductCart(...f))},"- ",10,Zs),e("button",{type:"button",class:_([{"btn-secondary":!o.canProductAction},"btn btn-md btn-primary"])},d(o.checkInCart),3),e("button",{type:"button",class:_([{"btn-secondary":!o.canProductAction},"btn btn-md btn-primary p-2"]),disabled:a.item.in_stop_list_at!=null||!o.canProductAction,onClick:t[5]||(t[5]=(...f)=>o.incProductCart&&o.incProductCart(...f))},"+ ",10,to)])):r("",!0)])]))],64)):r("",!0)])])])}const no=U(Ge,[["render",io]]);const lo={data(){return{is_active:!1,timer:null}},computed:{colorScheme(){return window.Telegram.WebApp.colorScheme||"dark"}},mounted(){window.addEventListener("preloader-show",i=>{this.is_active=!0,this.timer=setTimeout(()=>{this.is_active=!1},1100)})},methods:{}},ao=e("div",{class:"stack"},[e("div",{class:"stack__card"}),e("div",{class:"stack__card"}),e("div",{class:"stack__card"})],-1),ro=[ao];function co(i,t,s,h,a,o){return a.is_active?(n(),l("div",{key:0,class:_([{"preloader--light":o.colorScheme!=="dark"},"d-flex justify-content-center align-items-center flex-column preloader"]),role:"alert"},ro,2)):r("",!0)}const mo=U(lo,[["render",co]]),uo=e("title",null,"CashMan - система твоего бизнеса внутри",-1),ho=e("meta",{name:"description",content:"CashMan - система твоего бизнеса внутри"},null,-1),po={key:0,"data-bs-theme":"dark"},_o={class:"navbar shadow shadow-sm"},fo={class:"container flex-row-reverse p-2"},bo=e("i",{class:"fa-solid fa-ruble-sign"},null,-1),go={"data-bs-toggle":"modal","data-bs-target":"#bot-info-modal",class:"text-primary fw-bold cursor-pointer"},yo=e("button",{class:"btn btn-link rounded-0 border-0 p-1",type:"button","data-bs-toggle":"offcanvas","data-bs-target":"#sidebar-menu","aria-controls":"sidebar-menu"},[e("span",{class:"navbar-toggler-icon"})],-1),vo={class:"text-body-secondary",style:{padding:"0px 0px 90px 0px"}},ko={class:"container d-flex justify-content-center flex-column align-items-center"},wo={class:"text-center mb-3"},$o=["innerHTML"],Co=e("br",null,null,-1),Fo={key:0,"data-bs-toggle":"modal","data-bs-target":"#edit-shop-footer-description-modal",href:"javascript:void(0)",class:"text-primary ml-2",style:{"font-size":"12px"}},Io=e("i",{class:"fa-solid fa-pen-to-square"},null,-1),To={key:1,class:"mb-3 text-center"},Vo=e("i",{class:"fa-solid fa-map-location-dot mr-2"},null,-1),Bo={class:"mb-0"},So={class:"d-flex justify-content-center my-3"},Mo=e("i",{class:"fa-solid fa-arrow-up mr-2"},null,-1),jo={class:"offcanvas offcanvas-start custom-offcanvas",style:{width:"70%","border-radius":"0px 10px 10px 0px"},tabindex:"-1",id:"sidebar-menu","aria-labelledby":"offcanvasExampleLabel"},Po={class:"offcanvas-header"},Uo={class:"offcanvas-title",id:"offcanvasExampleLabel"},Lo=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"offcanvas","aria-label":"Close"},null,-1),zo={class:"offcanvas-body"},qo={class:"list-unstyled"},Ro={class:"p-1"},Eo={class:"p-1"},Oo={class:"p-1"},Wo={class:"p-1"},Ao={key:0,class:"fw-bold"},Ho={class:"p-1"},Do={class:"p-1"},No={class:"p-1"},xo=e("div",{class:"border-top my-3"},null,-1),Jo={key:0,class:"p-2"},Qo={class:"list-unstyled"},Yo={key:0},Go=e("p",{class:"mb-0"},"Телефон",-1),Ko=[Go],Xo={key:1,class:"mb-2"},Zo=["href"],ti={key:2},ei=e("p",{class:"mb-0"},"Ссылки",-1),si=[ei],oi={key:3},ii=["href"],ni=e("i",{class:"fa-brands fa-instagram mr-1"},null,-1),li={key:4},ai=["href"],ri=e("i",{class:"fa-brands fa-vk mr-1"},null,-1),di={key:5},ci=e("p",{class:"mb-0"},"Почта",-1),mi=[ci],ui=["href"],hi={key:6},pi=e("p",{class:"mb-0"},"Сайт",-1),_i=[pi],fi=["href"],bi=e("li",null,[e("p",{class:"mt-3 mb-0"},"Связаться с сотрудником")],-1),gi={style:{position:"sticky",bottom:"0px"}},yi=["href"],vi={key:1,class:"dropdown"},ki=e("button",{class:"btn btn-light w-100 dropdown-toggle",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"}," Тема оформления ",-1),wi={key:0,class:"dropdown-menu w-100 bg-light"},$i=["onClick"],Ci={class:"modal fade",id:"bot-info-modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},Fi={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable"},Ii={class:"modal-content"},Ti={class:"modal-body",style:{"max-height":"400px"}},Vi={key:0,class:"mb-0 fw-bold d-flex flex-column align-items-center",style:{"font-size":"12px"}},Bi={key:0,class:"text-primary"},Si=e("i",{class:"fa-solid fa-location-dot mr-1"},null,-1),Mi={key:1,class:"text-primary"},ji={key:2,class:"small d-flex justify-content-end"},Pi={href:"javascript:void(0)",class:"text-secondary fw-bold"},Ui={key:1,class:"mb-0 text-primary",style:{"font-size":"12px"}},Li={key:2,class:"my-3 alert alert-primary",role:"alert"},zi=e("span",{class:"text-primary fw-bold"},"не работаем",-1),qi=e("span",{"data-bs-toggle":"modal","data-bs-target":"#schedule-list-display",class:"text-primary fw-bold text-decoration-underline cursor-pointer"},"графиком работы",-1),Ri={class:"text-center mb-3"},Ei=["innerHTML"],Oi=e("br",null,null,-1),Wi={key:0,"data-bs-toggle":"modal","data-bs-target":"#edit-shop-footer-description-modal",href:"javascript:void(0)",class:"text-primary ml-2 my-3",style:{"font-size":"12px"}},Ai=e("i",{class:"fa-solid fa-pen-to-square"},null,-1),Hi={class:"modal fade",id:"schedule-list-display",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},Di={class:"modal-dialog modal-dialog-centered"},Ni={class:"modal-content"},xi=e("div",{class:"modal-header"},[e("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"График работы"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Ji={class:"modal-body"},Qi={key:1,class:"my-2 d-flex justify-content-center"},Yi=e("a",{"data-bs-toggle":"modal","data-bs-target":"#edit-shop-footer-description-modal",href:"javascript:void(0)",class:"text-primary ml-2",style:{"font-size":"12px"}},[e("i",{class:"fa-solid fa-pen-to-square"}),m(" редактировать")],-1),Gi=[Yi],Ki={class:"modal fade",id:"edit-shop-footer-description-modal",tabindex:"-1","aria-labelledby":"edit-shop-footer-description","aria-hidden":"true"},Xi={class:"modal-dialog modal-fullscreen"},Zi={class:"modal-content"},tn=e("div",{class:"modal-header"},[e("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"Редактор"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),en={class:"modal-body"},sn={data(){return{loaded_cashback:!1,cashback:0,install_modal:null,currentTheme:"",themes:[]}},watch:{$route(i){let t=localStorage.getItem("cashman_global_client_theme")||null;t&&this.$nextTick(()=>{this.currentTheme=t}),this.$preloader.show()}},computed:{...S(["getSelf","cartTotalCount"]),tg(){return window.Telegram.WebApp},bot(){return window.currentBot},self(){return window.self||null},isWork(){return window.isCorrectSchedule(this.bot.company.schedule)?(this.bot.company||{is_work:!0}).is_work:!0},preparedMenuItem(){if(!this.bot.settings)return[];let i=this.bot.settings.icons||[],t=[];return i.forEach(s=>{t[s.slug]=s}),t},needHideMenu(){return new URLSearchParams(window.location.search).has("hide_menu")||this.$route.meta.hide_menu},links(){return{inst:(this.bot.company.links||{inst:null}).inst||null,vk:(this.bot.company.links||{vk:null}).vk||null,map_link:(this.bot.company.links||{map_link:null}).map_link||null,site:(this.bot.company.links||{site:null}).site||null}}},mounted(){var t,s;if(this.loaded_cashback=!1,this.$store.dispatch("loadSelf").then(()=>{var h;window.self=this.getSelf,this.cashback=((h=this.getSelf.cashBack)==null?void 0:h.amount)||0,this.loaded_cashback=!0}),(t=this.bot.settings)!=null&&t.themes&&(this.themes=((s=this.bot.settings)==null?void 0:s.themes)||[]),console.log("theme",window.theme),window.theme){let h=document.querySelector("#theme");h.href=window.theme,localStorage.setItem("cashman_global_client_theme_"+(this.bot.bot_domain||"any_bot"),h.href)}let i=localStorage.getItem("cashman_global_client_theme_"+(this.bot.bot_domain||"any_bot"))||null;i&&this.$nextTick(()=>{this.currentTheme=i}),this.changeTheme(this.tg.colorScheme),this.tg.expand()},methods:{goToBookingTable(){this.goTo("TableBookingV2");const i=document.getElementById("bot-info-modal");bootstrap.Modal.getInstance(i).hide()},switchTheme(i){let t=document.querySelector("#theme");t.href=this.themes[i].href,localStorage.setItem("cashman_global_client_theme_"+(this.bot.bot_domain||"any_bot"),t.href),this.$nextTick(()=>{this.currentTheme=t.href}),this.$store.dispatch("updateBotTheme",{theme:t.href}).then(()=>{this.$notify({title:"Изменение темы",text:"Тема успешно обновлена",type:"success"})}).catch(()=>{this.$notify({title:"Изменение темы",text:"Ошибка изменения темы",type:"error"})})},goTo(i){this.$router.push({name:i})},changeTheme(i){document.querySelectorAll("[data-bs-theme]").forEach(s=>{s.setAttribute("data-bs-theme",i)})},scrollTop(){window.scrollTo(0,80)},openLink(i){this.tg.openLink(i,{try_instant_view:!0})},closeShop(){this.tg.close()}}},on=Object.assign(sn,{__name:"V2Layout",setup(i){return(t,s)=>{var h,a,o,c,p,v,$,f,C,T,M;return n(),l(g,null,[w(q(R),null,{default:P(()=>[uo,ho]),_:1}),w(mo),t.needHideMenu?r("",!0):(n(),l("header",po,[e("div",_o,[e("div",fo,[t.loaded_cashback?(n(),l("a",{key:0,onClick:s[0]||(s[0]=y=>t.goTo("ProfileV2")),class:"badge bg-primary btn",href:"javascript:void(0)"},[m(d(t.cashback||0)+" ",1),bo])):r("",!0),e("span",go,d(t.bot.title||"Магазин"),1),yo])])])),E(t.$slots,"default"),w(no),e("footer",vo,[e("div",ko,[t.$route.name!="FeedBackV2"?(n(),l("button",{key:0,onClick:s[1]||(s[1]=y=>t.goTo("FeedBackV2")),class:"btn btn-link mb-2 w-100 p-3 text-primary"},"Обратная связь ")):r("",!0),e("p",wo,[e("span",{innerHTML:t.bot.company.description},null,8,$o),Co,(t.getSelf||{is_admin:!1}).is_admin?(n(),l("a",Fo,[Io,m(" редактировать")])):r("",!0)]),t.bot.company.address?(n(),l("p",To,[Vo,m(d(t.bot.company.address),1)])):r("",!0),e("p",Bo,d(t.bot.company.title)+"©"+d(new Date().getFullYear()),1),e("p",So,[e("a",{href:"javascript:void(0)",onClick:s[2]||(s[2]=(...y)=>t.scrollTop&&t.scrollTop(...y))},[Mo,m("Вернуться наверх")])])])]),e("div",jo,[e("div",Po,[e("h6",Uo,d(t.bot.title||"Магазин"),1),Lo]),e("div",zo,[e("ul",qo,[e("li",Ro,[e("a",{"data-bs-dismiss":"offcanvas",class:_([{"fw-bold":t.$route.name==="MenuV2"},"text-decoration-none fw-normal"]),onClick:s[3]||(s[3]=y=>t.goTo("MenuV2")),href:"javascript:void(0)"}," Главное меню",2)]),e("li",Eo,[e("a",{"data-bs-dismiss":"offcanvas",class:_([{"fw-bold":t.$route.name==="ProfileV2"},"text-decoration-none fw-normal"]),onClick:s[4]||(s[4]=y=>t.goTo("ProfileV2")),href:"javascript:void(0)"},d(((h=t.preparedMenuItem.profile)==null?void 0:h.title)||"Профиль"),3)]),e("li",Oo,[e("a",{"data-bs-dismiss":"offcanvas",class:_([{"fw-bold":t.$route.name==="CatalogV2"},"text-decoration-none fw-normal"]),onClick:s[5]||(s[5]=y=>t.goTo("CatalogV2")),href:"javascript:void(0)"},d(((a=t.preparedMenuItem.shop)==null?void 0:a.title)||"Магазин"),3)]),e("li",Wo,[e("a",{"data-bs-dismiss":"offcanvas",class:_([{"fw-bold":t.$route.name==="ShopCartV2"},"text-decoration-none fw-normal"]),onClick:s[6]||(s[6]=y=>t.goTo("ShopCartV2")),href:"javascript:void(0)"},[m(d(((o=t.preparedMenuItem.basket)==null?void 0:o.title)||"Корзина")+" ",1),t.cartTotalCount>0?(n(),l("span",Ao,"("+d(t.cartTotalCount)+")",1)):r("",!0)],2)]),e("li",Ho,[e("a",{"data-bs-dismiss":"offcanvas",class:_([{"fw-bold":t.$route.name==="OrdersV2"},"text-decoration-none fw-normal"]),onClick:s[7]||(s[7]=y=>t.goTo("OrdersV2")),href:"javascript:void(0)"},d(((c=t.preparedMenuItem.history)==null?void 0:c.title)||"История заказов"),3)]),e("li",Do,[e("a",{"data-bs-dismiss":"offcanvas",class:_([{"fw-bold":t.$route.name==="CashBackV2"},"text-decoration-none fw-normal"]),onClick:s[8]||(s[8]=y=>t.goTo("CashBackV2")),href:"javascript:void(0)"}," CashBack",2)]),e("li",No,[e("a",{"data-bs-dismiss":"offcanvas",class:_([{"fw-bold":t.$route.name==="FeedBackV2"},"text-decoration-none fw-normal"]),onClick:s[9]||(s[9]=y=>t.goTo("FeedBackV2")),href:"javascript:void(0)"}," Оставить отзыв",2)])]),xo,t.bot.company?(n(),l("div",Jo,[e("ul",Qo,[(t.bot.company.phones||[]).length>0?(n(),l("li",Yo,Ko)):r("",!0),(t.bot.company.phones||[]).length>0?(n(),l("li",Xo,[e("a",{target:"_blank",href:"tel:"+t.bot.company.phones[0],class:"text-decoration-none fw-bold"},d(t.bot.company.phones[0]||"-"),9,Zo)])):r("",!0),t.links.inst||t.links.vk?(n(),l("li",ti,si)):r("",!0),t.links.inst?(n(),l("li",oi,[e("a",{target:"_blank",href:"http://instagram.com/"+t.links.inst,style:{"font-size":"12px"},class:"text-primary"},[ni,m(" "+d(t.links.inst||"ссылка"),1)],8,ii)])):r("",!0),t.links.vk?(n(),l("li",li,[e("a",{target:"_blank",href:"https://vk.com/"+t.links.vk,style:{"font-size":"12px"},class:"text-primary"},[ri,m(" "+d(t.links.vk||"ссылка"),1)],8,ai)])):r("",!0),t.bot.company.email?(n(),l("li",di,mi)):r("",!0),e("li",null,[t.bot.company.email?(n(),l("a",{key:0,href:"mailto:"+t.bot.company.email,target:"_blank",class:"text-decoration-none fw-bold"},d(t.bot.company.email),9,ui)):r("",!0)]),t.links.site?(n(),l("li",hi,_i)):r("",!0),e("li",null,[t.links.site?(n(),l("a",{key:0,href:t.links.site,target:"_blank",class:"text-decoration-none fw-bold"},d(t.links.site),9,fi)):r("",!0)]),(v=(p=t.bot.settings)==null?void 0:p.manager)!=null&&v.link?(n(),l(g,{key:7},[bi,e("li",gi,[e("a",{href:(f=($=t.bot.settings)==null?void 0:$.manager)==null?void 0:f.link,target:"_blank",class:"btn btn-primary p-3 w-100"},d(((T=(C=t.bot.settings)==null?void 0:C.manager)==null?void 0:T.title)||"Написать"),9,yi)])],64)):r("",!0)])])):r("",!0),(t.getSelf||{is_admin:!1}).is_admin?(n(),l("div",vi,[ki,t.themes.length>0?(n(),l("ul",wi,[(n(!0),l(g,null,k(t.themes,(y,L)=>(n(),l("li",null,[e("button",{type:"button",onClick:ln=>t.switchTheme(L),class:_([{active:t.currentTheme.indexOf(y.href)!=-1},"list-group-item list-group-item-action p-2 w-100 text-primary"]),"aria-current":"true"},d(y.title||"-"),11,$i)]))),256))])):r("",!0)])):r("",!0)])]),e("div",Ci,[e("div",Fi,[e("div",Ii,[e("div",Ti,[t.bot.company?(n(),l("p",Vi,[t.bot.company.address?(n(),l("span",Bi,[Si,m(" "+d(t.bot.company.address),1)])):(n(),l("span",Mi,d(t.bot.title||"Магазин"),1)),(t.bot.company.phones||[]).length>0?(n(),l("span",ji,[e("a",Pi,d(t.bot.company.phones[0]),1)])):r("",!0)])):(n(),l("p",Ui,d(t.bot.title||"Бот"),1)),t.isWork?r("",!0):(n(),l("div",Li,[m(" В данный момент мы "),zi,m(". Вы можете ознакомиться с нашим "),qi,m(". ")])),(M=t.bot.settings)!=null&&M.can_use_booking?(n(),l("button",{key:3,class:"btn btn-info w-100 p-3 mb-2",onClick:s[10]||(s[10]=(...y)=>t.goToBookingTable&&t.goToBookingTable(...y))},"Забронировать столик")):r("",!0),e("p",Ri,[e("span",{innerHTML:t.bot.company.description},null,8,Ei),Oi,(t.getSelf||{is_admin:!1}).is_admin?(n(),l("a",Wi,[Ai,m(" Редактировать")])):r("",!0)])])])])]),e("div",Hi,[e("div",Di,[e("div",Ni,[xi,e("div",Ji,[t.bot?(n(),V(W,{key:0,schedule:t.bot.company.schedule},null,8,["schedule"])):r("",!0),(t.getSelf||{is_admin:!1}).is_admin?(n(),l("p",Qi,Gi)):r("",!0)])])])]),e("div",Ki,[e("div",Xi,[e("div",Zi,[tn,e("div",en,[w(Ye)])])])])],64)}}}),nn={computed:{...S(["getSelf"]),logo(){return`/images-by-bot-id/${this.currentBot.id}/${this.currentBot.image}`},self(){return window.self||null},tg(){return window.Telegram.WebApp},tgUser(){const i=new URLSearchParams(this.tg.initData);return JSON.parse(i.get("user"))},currentBot(){return window.currentBot},qr(){return"https://api.qrserver.com/v1/create-qr-code/?size=450x450&qzone=2&data="+this.link},link(){return"https://t.me/"+this.currentBot.bot_domain+"?start="+btoa("001"+this.self.telegram_chat_id)}},created(){window.currentBot=this.bot.data,window.theme=this.theme;const i=window.currentBot.company.schedule||[];if(window.isCorrectSchedule=t=>{if((t||[]).length<7)return!1;let s=!0;return t.forEach(h=>{s=s&&typeof h=="object"}),s},window.isCorrectSchedule(i)&&((!i||(i||[]).length===0)&&(window.currentBot.company.is_work=!0),i&&(i||[]).length>0)){const t=new Date().getUTCDay(),s=new Date().getHours(),h=new Date().getMinutes();let a=i[t].start_at||"08:00",o=parseInt(a.split(":")[0]),c=parseInt(a.split(":")[1]),p=i[t].end_at||"20:00",v=parseInt(p.split(":")[0]),$=parseInt(p.split(":")[1]),f=!1;o===s&&(f=h>=c),v===s&&(f=h<$),s>o&&s<v&&o<=v&&(f=!0),(s>o||s<=v)&&o>=v&&(f=!0),window.currentBot.company.is_work=!i[t].closed&&f}window.currentScript=this.slug_id||null,this.$notify({title:"Главная",text:"Успешно!",type:"success"})},methods:{open(i){this.tg.openLink(i)}}},kn=Object.assign(nn,{__name:"MainV2",props:{bot:{type:Object},theme:{type:String},slug_id:{type:String}},setup(i){return(t,s)=>{const h=I("notifications"),a=I("router-view");return n(),V(on,null,{default:P(()=>[w(h,{position:"top right",ignoreDuplicates:"true",max:"3",width:"100%",speed:"10"}),w(a,{bot:i.bot},null,8,["bot"])]),_:1})}}});export{kn as default};
