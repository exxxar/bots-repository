import{s as j,N as U,o as n,j as a,l as e,M as r,K as p,n as m,a2 as k,L as u,k as c,w as i,W as b,F as v,J as x,a0 as V,g as C,$ as B,G as F}from"./index.es-db843bab.js";import{P as I}from"./Pagination-ccc8cfc8.js";import{_ as q}from"./_plugin-vue_export-helper-c27b6911.js";import{_ as P}from"./CompanyList-a6287423.js";const S={props:["botId"],data(){return{bot:null,load:!1,need_payments:!1,need_shop:!1,need_demo:!1,botForm:{id:null,is_template:!1,auto_cashback_on_payments:!1,template_description:null,bot_domain:null,bot_token:null,bot_token_dev:null,order_channel:null,main_channel:null,vk_shop_link:null,balance:null,tax_per_day:null,welcome_message:null,image:null,description:null,info_link:null,social_links:[],maintenance_message:null,payment_provider_token:null,level_1:10,level_2:0,level_3:0,photos:[],selected_bot_template_id:null,pages:[],amo:null,is_active:!1}}},watch:{need_payments:function(l,t){this.need_payments||(this.botForm.auto_cashback_on_payments=!1)}},mounted(){this.loadBotAdminConfig(),window.addEventListener("select-telegram-channel-id",l=>{this.botForm[l.detail.param]=l.detail.channel})},methods:{loadBotAdminConfig(){this.$store.dispatch("loadBotManagerConfig",{botId:this.botId}).then(l=>{this.bot=l.data,this.botForm={id:this.bot.id||null,is_template:this.bot.is_template||!1,auto_cashback_on_payments:this.bot.auto_cashback_on_payments||!1,template_description:this.bot.template_description||null,bot_domain:this.bot.bot_domain||null,bot_token:this.bot.bot_token||null,bot_token_dev:this.bot.bot_token_dev||null,order_channel:this.bot.order_channel||null,main_channel:this.bot.main_channel||null,balance:this.bot.balance||null,tax_per_day:this.bot.tax_per_day||null,vk_shop_link:this.bot.vk_shop_link||null,image:this.bot.image||null,description:this.bot.description||null,info_link:this.bot.info_link||null,social_links:this.bot.social_links||[],maintenance_message:this.bot.maintenance_message||null,welcome_message:this.bot.welcome_message||null,payment_provider_token:this.bot.payment_provider_token||null,level_1:this.bot.level_1||10,level_2:this.bot.level_2||0,level_3:this.bot.level_3||0,photos:this.bot.photos||[],amo:this.bot.amo||null,is_active:this.bot.is_active||!1},this.botForm.payment_provider_token&&(this.need_payments=!0),this.botForm.vk_shop_link&&(this.need_shop=!0)})},getPhoto(l){return{imageUrl:URL.createObjectURL(l)}},onChangePhotos(l){const t=l.target.files;this.botForm.image=null;for(let h=0;h<t.length;h++)this.botForm.photos.push(t[h])},addItem(l){this.botForm[l].push("")},addSocialLinks(){this.botForm.social_links.push({title:null,url:null})},removeItem(l,t){this.botForm[l].splice(t,1)},removePhoto(l){l?this.botForm.photos.splice(l,1):this.botForm.image=null},switchStatus(){this.$store.dispatch("switchBotStatusManager",{botId:this.bot.id}).then(()=>{this.$botNotification.success("Конструктор ботов","Статус бота успешно изменен!")})},removeBot(){this.$store.dispatch("removeBotByManager",{botId:this.bot.id}).then(l=>{this.$emit("remove"),this.$botNotification.success("Конструктор ботов","Бот успешно удален!")}).catch(l=>{this.$botNotification.warning("Конструктор ботов","Ошибка удаления бота!")})},addBot(){let l=new FormData;Object.keys(this.botForm).forEach(t=>{const h=this.botForm[t]||"";typeof h=="object"?l.append(t,JSON.stringify(h)):l.append(t,h)}),this.company&&l.append("company_id",this.company.id);for(let t=0;t<this.botForm.photos.length;t++)l.append("images[]",this.botForm.photos[t]);l.delete("photos"),this.$store.dispatch("updateBotByManager",{botForm:l}).then(t=>{this.$emit("callback",t.data),this.$botNotification.success("Конструктор ботов","Бот успешно обновлен!")}).catch(t=>{this.$botNotification.warning("Конструктор ботов","Ошибка обновления бота!")})},requestChannelId(l){this.$botPages.telegramChannelHelper(l)},openUrl(l){this.tg.openLink(l)}}},N={class:"card card-style bg-1",style:{height:"390px"}},L={key:0,class:"card-center"},M={class:"w-100 d-flex justify-content-center p-3"},O={class:"object-cover",style:{width:"100px","border-radius":"50%"},alt:""},z={class:"color-white font-700 text-center mb-2"},E={key:0},D={key:1},R={class:"color-white text-center opacity-60 mt-n1 my-1"},T={href:"#",class:"color-white"},A=e("i",{class:"fa-solid fa-sack-dollar"},null,-1),G={class:"color-white text-center opacity-60 mt-n1 my-1"},J=e("i",{class:"fa-solid fa-hand-holding-dollar"},null,-1),H={class:"color-white text-center opacity-60 mt-n1 my-1"},K=e("i",{class:"fa-regular fa-calendar-days"},null,-1),W={class:"w-100 d-flex justify-content-center py-4"},Q={class:"custom-control ios-switch"},X=e("label",{class:"custom-control-label",for:"toggle-id-1"},null,-1),Y={key:0,class:"ml-5 text-white"},Z={key:1,class:"ml-5 text-white"},$={key:1,class:"card-center"},ee=e("p",null,"Загружаем данные бота",-1),te=e("div",{class:"d-flex justify-content-center w-100"},[e("div",{class:"spinner-border color-orange-dark",role:"status"},[e("span",{class:"sr-only"},"Загрузка...")])],-1),oe=[ee,te],se=e("div",{class:"card-overlay bg-black opacity-70"},null,-1),le={key:0,class:"w-100 d-flex justify-content-center align-items-center flex-column"},ne=e("h2",null,"Демонстрация работы бота",-1),ie={href:"#"},ae={class:"mb-0"},re={class:"mobile mb-2 p-0"},de=["src"],ce={key:0,class:"alert alert-small rounded-s shadow-xl bg-red2-dark w-100",role:"alert"},_e=e("span",null,[e("i",{class:"fa-solid fa-triangle-exclamation"})],-1),me=e("strong",null,"Тоукен не указан!",-1),be=e("button",{type:"button",class:"close color-white opacity-60 font-16","data-dismiss":"alert","aria-label":"Close"},"× ",-1),he=[_e,me,be],ue={key:0},pe={key:0,class:"d-flex w-100"},fe={class:"pt-1"},ge={"data-activate":"toggle-id-2",class:"font-500 font-13"},ve={key:0},ye={key:1},ke={class:"ml-auto mr-4 pr-2"},we={class:"custom-control ios-switch ios-switch-icon"},xe=e("label",{class:"custom-control-label",for:"toggle-demo-bot"},null,-1),Fe=e("i",{class:"fa fa-check font-11 color-white"},null,-1),Be=e("i",{class:"fa fa-times font-11 color-white"},null,-1),Ce={class:"mb-2"},je={class:"form-label d-flex justify-content-between align-items-center mt-2",id:"bot-domain"},Ue=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Ve=e("div",null,'Строго взять из BotFather! ТО что при создании с окончанием на "bot"',-1),Ie=e("i",{class:"fa-solid font-10 fa-star color-red2-dark"},null,-1),qe=e("div",null,"Нужно ",-1),Pe={key:0},Se={class:"mb-2"},Ne={class:"form-label d-flex justify-content-between mt-2 d-flex align-items-center flex-wrap",id:"bot-token"},Le=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Me=e("div",null,"Взять из BotFater при создании бота! Длинная нечитаемая подсвеченная строка! ",-1),Oe=e("i",{class:"fa-solid font-10 fa-star color-red2-dark"},null,-1),ze=e("div",null,"Нужно ",-1),Ee={class:"mb-2"},De=e("label",{class:"form-label d-flex justify-content-between mt-2",id:"bot-token-dev"},"Токен бота (для тестирования)",-1),Re={class:"mb-2"},Te={class:"d-flex justify-content-between align-items-center flex-wrap"},Ae={class:"form-label d-flex justify-content-between mt-2 d-flex align-items-center w-100",id:"bot-order-channel"},Ge=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Je=e("div",null,"Ввести адрес ссылки на канал в форму после добавления тоукена ",-1),He=e("i",{class:"fa-brands fa-telegram ml-2 color-blue2-dark"},null,-1),Ke=[He],We=e("i",{class:"fa-solid font-10 fa-star color-red2-dark"},null,-1),Qe=e("div",null,"Нужно ",-1),Xe={class:"mb-2"},Ye={class:"d-flex justify-content-between"},Ze={class:"form-label d-flex justify-content-between mt-2",id:"bot-main-channel"},$e=e("i",{class:"fa-brands fa-telegram ml-2 color-blue2-dark"},null,-1),et=[$e],tt={key:1,class:"mb-0"},ot={class:"mb-2"},st={class:"d-flex justify-content-between flex-wrap"},lt={class:"form-label d-flex justify-content-between align-items-center mb-0 flex-wrap w-100",id:"bot-description"},nt=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),it=e("div",null,"Отобразится пользователю при первом запуске",-1),at=e("i",{class:"fa-solid font-10 fa-star color-red2-dark"},null,-1),rt=e("div",null,"Нужно ",-1),dt={key:0,class:"text-gray-400 w-100",style:{"font-size":"10px"}},ct={class:"mb-2"},_t={class:"d-flex justify-content-between flex-wrap"},mt={class:"form-label d-flex justify-content-between align-items-center w-100 mb-0",id:"bot-description"},bt=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),ht=e("div",null,'Для меню "О Боте"',-1),ut=e("i",{class:"fa-solid font-10 fa-star color-red2-dark"},null,-1),pt=e("div",null,"Нужно ",-1),ft={key:0,class:"text-gray-400 w-100",style:{"font-size":"10px"}},gt={class:"mb-2"},vt={class:"d-flex justify-content-between flex-wrap"},yt={class:"form-label d-flex justify-content-between align-items-center w-100 mb-0",id:"bot-maintenance-message"},kt=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),wt=e("div",null,'Для меню "О Боте"',-1),xt=e("i",{class:"fa-solid font-10 fa-star color-red2-dark"},null,-1),Ft=e("div",null,"Нужно ",-1),Bt={key:0,class:"text-gray-400 w-100",style:{"font-size":"10px"}},Ct={class:"mb-2"},jt={class:"form-label d-flex justify-content-between align-items-center mt-2",id:"bot-level-1"},Ut=e("i",{class:"fa-solid font-10 fa-star color-red2-dark"},null,-1),Vt=e("div",null,"Нужно ",-1),It={class:"mb-2"},qt=e("label",{class:"form-label d-flex justify-content-between mt-2",id:"bot-level-2"},"Уровень 2 CashBack, %",-1),Pt={class:"mb-2"},St=e("label",{class:"form-label d-flex justify-content-between mt-2",id:"bot-level-3"},"Уровень 3 CashBack, %",-1),Nt={class:"mb-2"},Lt={class:"form-check"},Mt=e("label",{class:"form-check-label",for:"need-payments"}," Необходимо подключить платежную систему ",-1),Ot={key:0,class:"mb-2"},zt={class:"form-check"},Et=["value"],Dt=e("label",{class:"form-check-label",for:"bot-auto-cashback-on-payments"}," Начислять CashBack автоматически после успешной оплаты ",-1),Rt={class:"mb-2"},Tt={class:"form-label d-flex justify-content-between mt-2",id:"bot-level-3"},At=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Gt=e("div",null,"Если в боте планируется оплата, то необходимо через BotFather привязать нужную платежную систему и указать в данном поле полученный токен ",-1),Jt=e("a",{href:"https://t.me/botfather",target:"_blank"},"Подключить",-1),Ht={class:"mb-2"},Kt={class:"form-check"},Wt=e("label",{class:"form-check-label",for:"need-shop"}," Необходимо интегрировать магазин в бота ",-1),Qt={key:1,class:"mb-2"},Xt={class:"form-label d-flex justify-content-between mt-2",id:"bot-level-3"},Yt=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Zt=e("div",null,"Ссылка на страницу ВК с товарами для вашего магазина в боте ",-1),$t=e("a",{href:"https://vk.com/groups?w=groups_create",target:"_blank"},"Создать",-1),eo=e("div",{class:"divider divider-small my-3 bg-highlight"},null,-1),to={class:"mb-2"},oo={class:"form-label d-flex justify-content-between mt-2",id:"bot-level-3"},so=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),lo=e("div",null,"Ссылка на страницу ВК с товарами для вашего магазина в боте ",-1),no=e("a",{target:"_blank",href:"https://telegra.ph"},"Создать",-1),io=e("div",{class:"divider divider-small my-3 bg-highlight"},null,-1),ao=e("h6",null,"Ссылки на соц. сети",-1),ro={class:"d-flex justify-content-between align-items-center w-100"},co=e("small",null,"Ссылка",-1),_o=["onClick"],mo=e("i",{class:"fa-regular fa-trash-can"},null,-1),bo=[mo],ho=["onUpdate:modelValue","aria-describedby"],uo=["onUpdate:modelValue"],po=e("div",{class:"divider divider-small my-3 bg-highlight"},null,-1),fo={class:"d-flex justify-content-between align-items-center"},go=e("i",{class:"fa-solid font-10 fa-star color-red2-dark"},null,-1),vo=e("div",null,"Нужно ",-1),yo={class:"photo-preview d-flex justify-content-center flex-wrap w-100"},ko={for:"bot-photos",style:{"margin-right":"10px"},class:"photo-loader ml-2"},wo=e("span",null,"+",-1),xo={class:"mb-2 img-preview",style:{"margin-right":"10px"}},Fo={class:"remove"},Bo=["onClick"],Co=e("i",{class:"fa-regular fa-trash-can"},null,-1),jo=[Co],Uo={key:1,class:"mb-2 img-preview",style:{"margin-right":"10px"}},Vo={class:"remove"},Io=e("i",{class:"fa-regular fa-trash-can"},null,-1),qo=[Io],Po=["disabled"],So={key:1,class:"content"},No=e("p",null,"Загружаем данные бота",-1),Lo=e("div",{class:"d-flex justify-content-center w-100"},[e("div",{class:"spinner-border color-orange-dark",role:"status"},[e("span",{class:"sr-only"},"Загрузка...")])],-1),Mo=[No,Lo];function Oo(l,t,h,f,o,d){const _=j("Popper"),w=U("lazy");return n(),a(v,null,[e("div",N,[o.bot?(n(),a("div",L,[e("div",M,[r(e("img",O,null,512),[[w,"/images-by-company-id/"+o.bot.company_id+"/"+o.bot.image]])]),e("h2",z,[o.bot.bot_domain?(n(),a("span",E,p(o.bot.bot_domain.length>20?o.bot.bot_domain.substring(0,20)+"...":o.bot.bot_domain),1)):(n(),a("span",D,"Нет домена"))]),e("p",R,[e("a",T,[A,m(" Баланс "+p(o.bot.balance||"0")+" ₽",1)])]),e("p",G,[J,m(" Тариф "+p(o.bot.tax_per_day||"0")+" ₽/день ",1)]),e("p",H,[K,m(" Дней "+p(Math.round(o.bot.balance/o.bot.tax_per_day))+" осталось ",1)]),e("div",W,[e("div",Q,[r(e("input",{type:"checkbox",onChange:t[0]||(t[0]=(...s)=>d.switchStatus&&d.switchStatus(...s)),"onUpdate:modelValue":t[1]||(t[1]=s=>o.botForm.is_active=s),class:"ios-input",id:"toggle-id-1"},null,544),[[k,o.botForm.is_active]]),X]),o.botForm.is_active?(n(),a("span",Y,"Вкл")):(n(),a("span",Z,"Выкл"))]),e("a",{href:"javascript:void(0)",onClick:t[2]||(t[2]=(...s)=>d.removeBot&&d.removeBot(...s)),class:"btn btn-m btn-full mb-3 rounded-xl text-uppercase font-900 shadow-s color-red2-light"},"Удалить бота")])):(n(),a("div",$,oe)),se]),o.need_demo?(n(),a("div",le,[ne,e("h6",null,[e("a",ie,p(o.botForm.bot_domain),1)]),e("p",ae,[e("small",null,p(o.botForm.name||"Не указано имя"),1)]),e("div",re,[e("iframe",{style:{border:"none"},src:"/web/"+o.botForm.bot_domain},null,8,de)]),o.botForm.token?u("",!0):(n(),a("div",ce,he))])):u("",!0),e("form",{onSubmit:t[28]||(t[28]=V((...s)=>d.addBot&&d.addBot(...s),["prevent"]))},[o.bot?(n(),a("div",ue,[o.botForm.bot_domain?(n(),a("div",pe,[e("div",fe,[e("h5",ge,[o.need_demo?(n(),a("strong",ve,"Отобразить демо бота")):u("",!0),o.need_demo?u("",!0):(n(),a("strong",ye,"Не отображать демо бота"))])]),e("div",ke,[e("div",we,[r(e("input",{type:"checkbox","onUpdate:modelValue":t[3]||(t[3]=s=>o.need_demo=s),class:"ios-input",id:"toggle-demo-bot"},null,512),[[k,o.need_demo]]),xe,Fe,Be])])])):u("",!0),e("div",Ce,[e("label",je,[e("div",null,[c(_,null,{content:i(()=>[Ve]),default:i(()=>[Ue]),_:1}),m(" Доменное имя бота из BotFather ")]),c(_,null,{content:i(()=>[qe]),default:i(()=>[Ie]),_:1})]),r(e("input",{type:"text",class:"form-control",placeholder:"Имя бота","aria-label":"Имя бота","onUpdate:modelValue":t[4]||(t[4]=s=>o.botForm.bot_domain=s),maxlength:"255","aria-describedby":"bot-domain",required:""},null,512),[[b,o.botForm.bot_domain]]),o.botForm.bot_domain?(n(),a("p",Pe,[m("Проверить работу бота "),e("a",{href:"javascript:void(0)",onClick:t[5]||(t[5]=s=>d.openUrl("https://t.me/"+o.botForm.bot_domain))},"@"+p(o.botForm.bot_domain),1)])):u("",!0)]),e("div",Se,[e("label",Ne,[e("div",null,[c(_,null,{content:i(()=>[Me]),default:i(()=>[Le]),_:1}),m(" Токен бота ")]),c(_,null,{content:i(()=>[ze]),default:i(()=>[Oe]),_:1}),e("a",{href:"javascript:void(0)",onClick:t[6]||(t[6]=s=>d.openUrl("https://t.me/botfather")),class:"w-100",target:"_blank"},"Создать нового бота в ТГ")]),r(e("input",{type:"text",class:"form-control",placeholder:"Токен","aria-label":"Токен","onUpdate:modelValue":t[7]||(t[7]=s=>o.botForm.bot_token=s),maxlength:"255","aria-describedby":"bot-token",required:""},null,512),[[b,o.botForm.bot_token]])]),e("div",Ee,[De,r(e("input",{type:"text",class:"form-control",placeholder:"Токен","aria-label":"Токен","onUpdate:modelValue":t[8]||(t[8]=s=>o.botForm.bot_token_dev=s),maxlength:"255","aria-describedby":"bot-token-dev"},null,512),[[b,o.botForm.bot_token_dev]])]),e("div",Re,[e("div",Te,[e("label",Ae,[e("div",null,[c(_,null,{content:i(()=>[Je]),default:i(()=>[Ge]),_:1}),m(" Канал для заказов (id) "),e("span",{onClick:t[9]||(t[9]=s=>d.requestChannelId("order_channel"))},Ke)]),c(_,null,{content:i(()=>[Qe]),default:i(()=>[We]),_:1})])]),r(e("input",{type:"text",class:"form-control",placeholder:"id канала","aria-label":"id канала","onUpdate:modelValue":t[10]||(t[10]=s=>o.botForm.order_channel=s),maxlength:"255","aria-describedby":"bot-order-channel"},null,512),[[b,o.botForm.order_channel]])]),e("div",Xe,[e("div",Ye,[e("label",Ze,[m("Канал для постов (id,рекламный) "),e("span",{onClick:t[11]||(t[11]=s=>d.requestChannelId("main_channel"))},et)])]),r(e("input",{type:"text",class:"form-control",placeholder:"id канала","aria-label":"id канала","onUpdate:modelValue":t[12]||(t[12]=s=>o.botForm.main_channel=s),maxlength:"255","aria-describedby":"bot-main-channel"},null,512),[[b,o.botForm.main_channel]])]),o.botForm.bot_token?(n(),a("div",tt,[e("div",ot,[e("div",st,[e("label",lt,[e("div",null,[c(_,null,{content:i(()=>[it]),default:i(()=>[nt]),_:1}),m(" Приветственное сообщение ")]),c(_,null,{content:i(()=>[rt]),default:i(()=>[at]),_:1})]),o.botForm.welcome_message?(n(),a("small",dt," Длина текста "+p(o.botForm.welcome_message.length),1)):u("",!0)]),r(e("textarea",{class:"form-control font-12",placeholder:"Текстовое приветствие при запуске бота","aria-label":"Текстовое приветствие при запуске бота","onUpdate:modelValue":t[13]||(t[13]=s=>o.botForm.welcome_message=s),style:{"min-height":"200px"},"aria-describedby":"bot-description",required:""},`
                    `,512),[[b,o.botForm.welcome_message]])]),e("div",ct,[e("div",_t,[e("label",mt,[e("div",null,[c(_,null,{content:i(()=>[ht]),default:i(()=>[bt]),_:1}),m(" Описание бота ")]),c(_,null,{content:i(()=>[pt]),default:i(()=>[ut]),_:1})]),o.botForm.description?(n(),a("small",ft," Длина текста "+p(o.botForm.description.length)+" / 255",1)):u("",!0)]),r(e("textarea",{class:"form-control font-12",placeholder:"Текстовое описание бота","aria-label":"Текстовое описание бота","onUpdate:modelValue":t[14]||(t[14]=s=>o.botForm.description=s),style:{"min-height":"200px"},"aria-describedby":"bot-description",required:""},`
                    `,512),[[b,o.botForm.description]])]),e("div",gt,[e("div",vt,[e("label",yt,[e("div",null,[c(_,null,{content:i(()=>[wt]),default:i(()=>[kt]),_:1}),m(" Режим тех. работ ")]),c(_,null,{content:i(()=>[Ft]),default:i(()=>[xt]),_:1})]),o.botForm.maintenance_message?(n(),a("small",Bt," Длина текста "+p(o.botForm.maintenance_message.length)+" / 255 ",1)):u("",!0)]),r(e("textarea",{class:"form-control font-12",placeholder:"Текстовое сообщение","aria-label":"Текстовое сообщение","onUpdate:modelValue":t[15]||(t[15]=s=>o.botForm.maintenance_message=s),maxlength:"255",style:{"min-height":"200px"},"aria-describedby":"bot-maintenance-message",required:""},`
                    `,512),[[b,o.botForm.maintenance_message]])]),e("div",Ct,[e("label",jt,[m(" Уровень 1 CashBack, % "),c(_,null,{content:i(()=>[Vt]),default:i(()=>[Ut]),_:1})]),r(e("input",{type:"number",class:"form-control",placeholder:"%","aria-label":"уровень CashBack","onUpdate:modelValue":t[16]||(t[16]=s=>o.botForm.level_1=s),max:"50",min:"0","aria-describedby":"bot-level-1",required:""},null,512),[[b,o.botForm.level_1]])]),e("div",It,[qt,r(e("input",{type:"number",class:"form-control",placeholder:"%","aria-label":"уровень CashBack","onUpdate:modelValue":t[17]||(t[17]=s=>o.botForm.level_2=s),max:"50",min:"0","aria-describedby":"bot-level-2"},null,512),[[b,o.botForm.level_2]])]),e("div",Pt,[St,r(e("input",{type:"number",class:"form-control",placeholder:"%","aria-label":"уровень CashBack","onUpdate:modelValue":t[18]||(t[18]=s=>o.botForm.level_3=s),max:"50",min:"0","aria-describedby":"bot-level-3"},null,512),[[b,o.botForm.level_3]])]),e("div",Nt,[e("div",Lt,[r(e("input",{class:"form-check-input","onUpdate:modelValue":t[19]||(t[19]=s=>o.need_payments=s),type:"checkbox",id:"need-payments"},null,512),[[k,o.need_payments]]),Mt])]),o.need_payments?(n(),a("div",Ot,[e("div",zt,[r(e("input",{class:"form-check-input",type:"checkbox",value:o.botForm.auto_cashback_on_payments,"onUpdate:modelValue":t[20]||(t[20]=s=>o.botForm.auto_cashback_on_payments=s),id:"bot-auto-cashback-on-payments"},null,8,Et),[[k,o.botForm.auto_cashback_on_payments]]),Dt]),e("div",Rt,[e("label",Tt,[e("div",null,[c(_,null,{content:i(()=>[Gt]),default:i(()=>[At]),_:1}),m(" Токен платежной системы ")]),Jt]),r(e("input",{type:"text",class:"form-control",placeholder:"Токен","aria-label":"уровень CashBack","onUpdate:modelValue":t[21]||(t[21]=s=>o.botForm.payment_provider_token=s),"aria-describedby":"bot-level-3"},null,512),[[b,o.botForm.payment_provider_token]])])])):u("",!0),e("div",Ht,[e("div",Kt,[r(e("input",{class:"form-check-input","onUpdate:modelValue":t[22]||(t[22]=s=>o.need_shop=s),type:"checkbox",id:"need-shop"},null,512),[[k,o.need_shop]]),Wt])]),o.need_shop?(n(),a("div",Qt,[e("label",Xt,[e("div",null,[c(_,null,{content:i(()=>[Zt]),default:i(()=>[Yt]),_:1}),m(" ВК-группа ")]),$t]),r(e("input",{type:"url",class:"form-control",placeholder:"Ссылка на группу ВК","aria-label":"ссылка на группу ВК","onUpdate:modelValue":t[23]||(t[23]=s=>o.botForm.vk_shop_link=s),"aria-describedby":"vk_shop_link"},null,512),[[b,o.botForm.vk_shop_link]])])):u("",!0),eo,e("div",to,[e("label",oo,[e("div",null,[c(_,null,{content:i(()=>[lo]),default:i(()=>[so]),_:1}),m(" Информационная ссылка ")]),no]),r(e("input",{type:"text",class:"form-control",placeholder:"Ссылка ресурс telegraph","aria-label":"Ссылка ресурс telegraph",maxlength:"255","onUpdate:modelValue":t[24]||(t[24]=s=>o.botForm.info_link=s),"aria-describedby":"bot-info-link"},null,512),[[b,o.botForm.info_link]])]),io,ao,(n(!0),a(v,null,x(o.botForm.social_links,(s,g)=>(n(),a("div",{class:"d-flex justify-content-between mb-2 flex-wrap",key:"social-link"+g},[e("div",ro,[co,e("button",{type:"button",onClick:y=>d.removeItem("social_links",g),class:"btn btn-link text-danger"},bo,8,_o)]),r(e("input",{type:"text",class:"form-control mb-2 w-100",placeholder:"Название ссылки","aria-label":"Название ссылки",maxlength:"255","onUpdate:modelValue":y=>o.botForm.social_links[g].title=y,"aria-describedby":"bot-social-link-"+g,required:""},null,8,ho),[[b,o.botForm.social_links[g].title]]),r(e("input",{type:"text",class:"form-control mb-2",placeholder:"Ссылка на соц.сеть","aria-label":"Ссылка на соц.сеть",maxlength:"255","onUpdate:modelValue":y=>o.botForm.social_links[g].url=y},null,8,uo),[[b,o.botForm.social_links[g].url]])]))),128)),e("button",{type:"button",onClick:t[25]||(t[25]=s=>d.addSocialLinks()),class:"btn btn-border btn-m btn-full mb-2 rounded-sm text-uppercase font-900 border-green1-dark color-green1-dark bg-theme w-100"}," Добавить еще ссылку "),po,e("h6",fo,[m("Аватар для бота "),c(_,null,{content:i(()=>[vo]),default:i(()=>[go]),_:1})]),e("div",yo,[e("label",ko,[wo,e("input",{type:"file",id:"bot-photos",multiple:"",accept:"image/*",onChange:t[26]||(t[26]=(...s)=>d.onChangePhotos&&d.onChangePhotos(...s)),style:{display:"none"}},null,32)]),o.botForm.photos?(n(!0),a(v,{key:0},x(o.botForm.photos,(s,g)=>(n(),a("div",xo,[r(e("img",null,null,512),[[w,d.getPhoto(s).imageUrl]]),e("div",Fo,[e("a",{onClick:y=>d.removePhoto(g)},jo,8,Bo)])]))),256)):(n(),a("div",Uo,[r(e("img",null,null,512),[[w,"/images-by-bot-id/"+o.bot.id+"/"+o.botForm.image]]),e("div",Vo,[e("a",{onClick:t[27]||(t[27]=s=>d.removePhoto())},qo)])]))]),e("button",{disabled:!o.botForm.bot_token,type:"submit",class:"btn btn-m btn-full mb-3 rounded-s text-uppercase font-900 shadow-s bg-red1-light w-100"}," Сохранить настройки ",8,Po)])):u("",!0)])):(n(),a("div",So,Mo))],32)],64)}const zo=q(S,[["render",Oo]]),Eo={key:0},Do={class:"d-flex flex-column mt-2"},Ro={key:0},To=e("div",{class:"divider divider-small my-3 bg-highlight"},null,-1),Ao=["onClick"],Go=e("a",{href:"#",class:"btn btn-m btn-full rounded-xl text-uppercase font-900 shadow-s bg-red1-light"},[e("i",{class:"fa-solid fa-arrow-right"})],-1),Jo={key:1},Ho=e("div",{class:"alert alert-warning mt-2",role:"alert"}," К сожалению мы не нашли нужных ботов... ",-1),Ko=[Ho],Wo={props:{companyId:null,selectedBot:null},data(){return{selectedBotId:null,need_self_bots:!1,filters:[{name:"Активные",icon:"fa-brands fa-telegram",slug:"active"},{name:"Архивные",icon:"fa-solid fa-box-archive",slug:"archive"}],selectedFilters:[],show:!0,loading:!0,bots:[],search:null,bots_paginate_object:null}},watch:{need_self_bots:function(){this.loadBots()}},computed:{...C(["getBots","getBotsPaginateObject","getCurrentCompany"]),filteredBots(){return this.bots?this.bots.filter(l=>l.deleted_at==null):[]}},mounted(){this.loadBots()},methods:{removeBotCallback(){this.loadBots(),this.selectedBotId=null},duplicate(l){if(!this.getCurrentCompany){this.$notify("У Вас не выбран клиент!");return}this.$store.dispatch("duplicateBot",{dataObject:{bot_id:l,company_id:this.getCurrentCompany.id}}).then(t=>{let h=this.bots_paginate_object.meta.current_page||0;this.loadBots(h),this.$notify("Указанный бот успешно продублирован")})},selectBot(l){this.loading=!0,this.selectedBotId=l.id,this.$nextTick(()=>{this.loading=!1}),this.$notify("Вы выбрали бота из списка! Все остальные действия будут производится для этого бота.")},nextBots(l){this.loadBots(l)},loadBots(l=0){this.loading=!0,this.$store.dispatch("loadSimpleBots",{dataObject:{companyId:this.companyId||null,needSelfBots:!0,search:this.search},size:5,page:l}).then(t=>{this.loading=!1,this.bots=this.getBots,this.bots_paginate_object=this.getBotsPaginateObject}).catch(()=>{this.loading=!1})}}},Qo=Object.assign(Wo,{__name:"BotListSelf",setup(l){return(t,h)=>(n(),a(v,null,[t.show?(n(),a("div",Eo,[e("div",Do,[r(e("input",{type:"search",class:"form-control mb-2",placeholder:"Поиск бота","aria-label":"Поиск бота","onUpdate:modelValue":h[0]||(h[0]=f=>t.search=f),"aria-describedby":"button-addon2"},null,512),[[b,t.search]]),e("button",{class:"btn btn-m btn-full mb-0 rounded-xs text-uppercase font-900 shadow-s bg-blue2-dark",onClick:h[1]||(h[1]=f=>t.loadBots(0)),type:"button",id:"button-addon2"},"Найти ")]),t.bots.length>0?(n(),a("div",Ro,[To,(n(!0),a(v,null,x(t.filteredBots,(f,o)=>(n(),a("a",{href:"javascript:void(0)",class:B(["d-flex justify-content-between align-items-center btn btn-border px-2 py-1 btn-full mb-2 rounded-xl text-uppercase font-900 bg-theme",{" border-blue2-dark color-blue2-dark":t.selectedBotId!=f.id," border-green2-dark color-green2-dark":t.selectedBotId===f.id}])},[e("strong",{onClick:d=>t.selectBot(f),class:"font-12 w-100 text-center",style:{"word-wrap":"break-word"}},[e("i",{class:B([{"text-danger":f.deleted_at!=null},"fa-solid fa-robot mr-2"])},null,2),m(p(f.bot_domain||"Не указано"),1)],8,Ao),Go],2))),256)),t.bots_paginate_object?(n(),F(I,{key:0,onPagination_page:t.nextBots,pagination:t.bots_paginate_object},null,8,["onPagination_page","pagination"])):u("",!0)])):(n(),a("div",Jo,Ko))])):u("",!0),t.selectedBotId&&!t.loading?(n(),F(zo,{key:1,onRemove:t.removeBotCallback,"bot-id":t.selectedBotId},null,8,["onRemove","bot-id"])):u("",!0)],64))}}),Xo=e("div",{class:"divider divider-small my-3 bg-highlight"},null,-1),Yo={data(){return{selectedCompanyId:!1,botUser:null,loading:!1}},computed:{...C(["getSelf"]),currentBot(){return window.currentBot}},watch:{getSelf:function(){this.botUser=this.getSelf}},mounted(){this.getSelf&&(this.botUser=this.getSelf)},methods:{selectCompany(l){this.loading=!0,this.selectedCompanyId=l.id,this.$nextTick(()=>{this.loading=!1}),this.$botNotification.notification("Информация","Вы успешно выбрали за основу данного клиента!")},selectBot(l){this.form.selected_bot_id=l.id,this.$botNotification.notification("Информация","Вы успешно выбрали за основу данного бота!")}}},os=Object.assign(Yo,{__name:"Clients",setup(l){return(t,h)=>(n(),a(v,null,[c(P,{"visual-mode":"true",onCallback:t.selectCompany},null,8,["onCallback"]),Xo,t.selectedCompanyId!=null&&!t.loading?(n(),F(Qo,{key:0,"company-id":t.selectedCompanyId},null,8,["company-id"])):u("",!0)],64))}});export{os as _};
