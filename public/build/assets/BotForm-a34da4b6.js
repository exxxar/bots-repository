import{G as F,q as a,t as n,v as e,H as c,J as _,T as g,F as p,C as f,x as b,y as m,A as d,K as y,D as r,z as S,a4 as C,L as B,B as j,S as k,u as U,Y as w,P as I,M as T}from"./index.es-560b785d.js";import{a as O}from"./CompanyList-8faea17f.js";import{P as $,V}from"./TelegramChannelHelper.vue_vue_type_style_index_0_lang-6ebd6e3a.js";import{_ as M}from"./_plugin-vue_export-helper-c27b6911.js";const P={key:0,class:"row"},L={class:"col-12"},A={class:"form-floating mb-3"},E=e("label",{for:"floatingInput"},"Быстрый поиск команды",-1),z={class:"col-12 mb-2"},q={class:"form-check"},R={class:"form-check-label",for:"need_global"},W={key:0},D={key:1},J={class:"form-check"},N=e("label",{class:"form-check-label",for:"need_show_deleted"}," Удаленные ",-1),H={key:0,class:"mb-3 col-12 col-sm-12"},K={class:"table"},G=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"#"),e("th",{scope:"col"},"Команда"),e("th",{scope:"col"},"Пояснение")])],-1),Y=["onClick"],Z={key:2,class:"mb-3 col-md-12"},Q=e("div",{class:"alert alert-danger",role:"alert"}," У Вас еще нет добавленных скриптов! ",-1),X=[Q],x={props:["command","canSelect"],data(){return{bot:null,load:!1,need_global:!0,need_show_deleted:!0,slugs:[],ownSearch:null,paginate:[]}},watch:{ownSearch:function(o,t){this.loadSlugs()},need_global:function(o,t){this.loadSlugs()},need_show_deleted:function(o,t){this.loadSlugs()}},computed:{...F(["getCurrentBot","getSlugs","getSlugsPaginateObject"])},mounted(){this.loadCurrentBot().then(()=>{this.loadSlugs()})},methods:{nextSlugs(o){this.loadSlugs(o)},loadSlugs(o=0){if(this.bot)return this.$store.dispatch("loadSlugs",{dataObject:{botId:this.bot.id,needGlobal:this.need_global,needDeleted:this.need_show_deleted,search:this.ownSearch},page:o}).then(t=>{this.slugs=this.getSlugs,this.paginate=this.getSlugsPaginateObject})},loadCurrentBot(o=null){return this.$store.dispatch("updateCurrentBot",{bot:o}).then(()=>{this.bot=this.getCurrentBot})},callbackSlugs(){this.loadSlugs()},selectSlug(o){this.$emit("select",o)}}},ee=Object.assign(x,{__name:"BotSlugSimpleTableList",setup(o){return(t,s)=>t.bot?(a(),n("div",P,[e("div",L,[e("div",A,[c(e("input",{type:"search","onUpdate:modelValue":s[0]||(s[0]=i=>t.ownSearch=i),class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,512),[[_,t.ownSearch]]),E])]),e("div",z,[e("div",q,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[1]||(s[1]=i=>t.need_global=i),type:"checkbox",id:"need_global"},null,512),[[g,t.need_global]]),e("label",R,[t.need_global?(a(),n("span",W,"Глобальные")):(a(),n("span",D,"Локальные"))])]),e("div",J,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[2]||(s[2]=i=>t.need_show_deleted=i),type:"checkbox",id:"need_show_deleted"},null,512),[[g,t.need_show_deleted]]),N])]),t.slugs?(a(),n("div",H,[e("table",K,[G,e("tbody",null,[(a(!0),n(p,null,f(t.slugs,(i,v)=>(a(),n("tr",{class:b({"border-info":i.deleted_at==null,"border-danger":i.deleted_at!=null})},[e("th",{scope:"row",class:b({"text-danger":i.deleted_at!=null})},m(i.id||"Нет идентификатора"),3),e("td",{onClick:l=>t.selectSlug(i),class:b({"text-danger":i.deleted_at!=null})},m(i.command||"Нет команды"),11,Y),e("td",{class:b({"text-danger":i.deleted_at!=null})},m(i.comment||"Пояснение не указано"),3)],2))),256))])])])):d("",!0),t.paginate?(a(),y($,{key:1,onPagination_page:t.nextSlugs,pagination:t.paginate},null,8,["onPagination_page","pagination"])):d("",!0),t.slugs.length===0?(a(),n("div",Z,X)):d("",!0)])):d("",!0)}}),te={props:["botsCount"],computed:{profile(){return window.profile||null},maxSlotsCount(){var o,t;return((t=(o=this.profile)==null?void 0:o.manager)==null?void 0:t.max_bot_slot_count)||0},slotsPercent(){return this.botsCount/this.maxSlotsCount*100}}},se={class:"progress",role:"progressbar","aria-label":"Success striped example","aria-valuenow":"25","aria-valuemin":"0","aria-valuemax":"100"};function oe(o,t,s,i,v,l){return a(),n(p,null,[e("h6",null,[r("Ваши доступные слоты "),e("p",null,[r("Число слотов "),e("strong",null,m(s.botsCount+l.maxSlotsCount),1),r(". Отображается ботов "),e("strong",null,m(s.botsCount),1),r(" шт. под вашим управлением")])]),e("div",se,[e("div",{class:"progress-bar progress-bar-striped bg-success",style:S({width:l.slotsPercent+"%"})},null,4)])],64)}const le=M(te,[["render",oe]]),ae={key:0},ne={key:0,class:"row"},ie={class:"col-md-12"},de=e("h4",null,"Боты в работе",-1),re={class:"mb-0"},ce={class:"table mb-5"},he=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"#"),e("th",{scope:"col"},"Домен"),e("th",{scope:"col"},"Название"),e("th",{scope:"col"},"Шаблон"),e("th",{scope:"col"},"Дата изменения"),e("th",{scope:"col"},"Действие")])],-1),me={scope:"row"},ue=["onClick"],be=["onClick"],_e={key:0,class:"badge bg-primary"},pe={key:1},fe={class:"d-flex"},ge=["onClick"],ve=e("i",{class:"fa-regular fa-star"},null,-1),ye=[ve],ke=["onClick"],$e=e("i",{class:"fa-solid fa-chevron-down"},null,-1),Fe=[$e],we=["onClick"],Ce=e("i",{class:"fa-solid fa-chevron-up"},null,-1),Be=[Ce],Ve=e("hr",null,null,-1),Se={class:"row"},je={class:"col-md-12 d-flex flex-column"},Ue={class:"d-flex"},Ie={class:"dropdown mr-2"},Te=e("button",{class:"btn btn-outline-primary dropdown-toggle",type:"button",id:"dropdownMenuButton1","data-bs-toggle":"dropdown","aria-expanded":"false"}," Фильтры ",-1),Oe={class:"dropdown-menu","aria-labelledby":"dropdownMenuButton1"},Me=["onClick"],Pe={class:"input-group mb-3"},Le={key:0,class:"mt-2"},Ae={class:"badge bg-primary mr-1"},Ee=["onClick"],ze=e("i",{class:"fa-solid fa-xmark"},null,-1),qe=[ze],Re={key:1,class:"row"},We={class:"col-12"},De=e("h4",null,"Все боты",-1),Je={class:"mb-0"},Ne={class:"mb-0"},He={key:2,class:"row"},Ke={class:"col-12 mb-3"},Ge={key:0,class:"col-12 mb-3"},Ye={class:"table"},Ze=e("th",{scope:"col"},"Действие",-1),Qe={scope:"row"},Xe=["onClick"],xe=["onClick"],et={key:0,class:"badge bg-primary"},tt={key:1},st={class:"d-flex"},ot=["onClick"],lt=e("i",{class:"fa-regular fa-star"},null,-1),at=[lt],nt=["onClick"],it=e("i",{class:"fa-regular fa-copy"},null,-1),dt=[it],rt=["onClick"],ct=e("i",{class:"fa-solid fa-boxes-packing"},null,-1),ht=[ct],mt=["onClick"],ut=e("i",{class:"fa-solid fa-box-open"},null,-1),bt=[ut],_t=["onClick"],pt=e("i",{class:"fa-solid fa-trash-can text-white"},null,-1),ft=[pt],gt={class:"col-lg-4 col-12 mb-3"},vt={class:"card-body"},yt=["onClick"],kt={key:0,class:"badge bg-info"},$t={class:"card-footer d-flex"},Ft=["onClick"],wt=e("i",{class:"fa-regular fa-star"},null,-1),Ct=[wt],Bt=["onClick"],Vt=e("i",{class:"fa-regular fa-copy"},null,-1),St=[Vt],jt=["onClick"],Ut=e("i",{class:"fa-solid fa-boxes-packing"},null,-1),It=[Ut],Tt=["onClick"],Ot=e("i",{class:"fa-solid fa-box-open"},null,-1),Mt=[Ot],Pt=["onClick"],Lt=e("i",{class:"fa-solid fa-trash-can text-white"},null,-1),At=[Lt],Et={class:"col-12"},zt={key:3,class:"row"},qt=e("div",{class:"col-12"},[e("div",{class:"alert alert-warning",role:"alert"}," У выбранной компании нет созданных ботов! ")],-1),Rt=[qt],Wt={props:["companyId","editor"],data(){return{displayType:1,direction:"desc",order:"updated_at",filters:[{name:"Активные",icon:"fa-brands fa-telegram",slug:"active"},{name:"Архивные",icon:"fa-solid fa-box-archive",slug:"archive"}],selectedFilters:[],show:!0,loading:!0,bots:[],favorites:[],search:null,bots_paginate_object:null}},watch:{displayType:function(o,t){localStorage.setItem("cashman_set_botlist_display_type",this.displayType)},selectedFilters:{handler:function(o){this.loadBots()},deep:!0}},computed:{...F(["getBots","getBotsPaginateObject","getCurrentCompany","getBotFavorites","inBotFav"]),filteredBots(){if(!this.bots)return[];if(this.selectedFilters.length===0&&this.search==null)return this.bots;if(this.selectedFilters.length===0&&this.search!=null)return this.bots.filter(t=>(t.bot_domain||"").trim().toLowerCase().indexOf(this.search.trim().toLowerCase())!==-1);let o=[];return this.selectedFilters.forEach(t=>{switch(t.slug){case"active":this.bots.filter(s=>s.deleted_at==null).forEach(s=>{o.push(s)});break;case"archive":this.bots.filter(s=>s.deleted_at!=null).forEach(s=>{o.push(s)});break}}),this.search==null?o:o.filter(t=>(t.bot_domain||"").trim().toLowerCase().indexOf(this.search.trim().toLowerCase())!==-1)}},mounted(){this.selectFilter("active"),this.displayType=parseInt(localStorage.getItem("cashman_set_botlist_display_type")||0)},methods:{hasRole(o){return window.hasRole(o)||!1},loadBotsByIds(){if(this.getBotFavorites.length==0){this.favorites=[];return}this.loading=!0,this.$store.dispatch("loadBotsByIds",{ids:this.getBotFavorites}).then(o=>{this.loading=!1,this.favorites=o}).catch(()=>{this.loading=!1})},prepareFavorites(){this.$store.dispatch("loadBotFavs").then(o=>{this.loadBotsByIds()})},moveOrderFavBot(o,t){this.$store.dispatch("swapBotInFav",{id:o,direction:t}).then(s=>{this.loadBotsByIds()})},addToFavorite(o){if(this.inBotFav(o)){this.$store.dispatch("removeFromBotFavorites",o).then(t=>{this.$notify("Указанный бот успешно удален из избранного"),this.loadBotsByIds()});return}this.$store.dispatch("addBotToFavorites",o).then(t=>{this.$notify("Указанный бот успешно добавлен в избранное"),this.loadBotsByIds()})},duplicate(o){if(!this.getCurrentCompany){this.$notify("У Вас не выбран клиент!");return}this.$store.dispatch("duplicateBot",{dataObject:{bot_id:o,company_id:this.getCurrentCompany.id}}).then(t=>{let s=this.bots_paginate_object.meta.current_page||0;this.loadBots(s),this.$notify("Указанный бот успешно продублирован")})},addToArchive(o){this.$store.dispatch("removeBot",{botId:o}).then(t=>{let s=this.bots_paginate_object.meta.current_page||0;this.$store.dispatch("resetCurrentBot"),this.loadBots(s),this.$notify("Указанный бот успешно перемещен в архив")})},forceDelete(o){this.$store.dispatch("forceDeleteBot",{botId:o}).then(t=>{let s=this.bots_paginate_object.meta.current_page||0;this.$store.dispatch("resetCurrentBot"),this.loadBots(s),this.$notify("Указанный бот успешно перемещен из архива")})},extractFromArchive(o){this.$store.dispatch("restoreBot",{botId:o}).then(t=>{let s=this.bots_paginate_object.meta.current_page||0;this.loadBots(s),this.$notify("Указанный бот успешно перемещен из архива")})},selectFilter(o){let t=this.filters.find(s=>s.slug===o);t&&this.selectedFilters.filter(s=>s.slug===o).length===0&&this.selectedFilters.push(t)},removeSelectedFilter(o){let t=this.selectedFilters.findIndex(s=>s.slug===o);this.selectedFilters.splice(t,1)},selectBot(o){this.$emit("callback",o),this.show=!1,this.$notify("Вы выбрали бота из списка! Все остальные действия будут производится для этого бота.")},nextBots(o){this.loadBots(o)},loadAndOrder(o){this.order=o,this.direction=this.direction==="desc"?"asc":"desc",this.loadBots(0)},loadBots(o=0){this.loading=!0,this.$store.dispatch("loadBots",{dataObject:{companyId:this.companyId||null,search:this.search,order:this.order,direction:this.direction,filters:this.selectedFilters.map(t=>t.slug)},page:o,size:20}).then(t=>{this.loading=!1,this.bots=this.getBots,this.bots_paginate_object=this.getBotsPaginateObject,this.prepareFavorites()}).catch(()=>{this.loading=!1})}}},Dt=Object.assign(Wt,{__name:"BotList",setup(o){return(t,s)=>t.show?(a(),n("div",ae,[t.favorites.length>0?(a(),n("div",ne,[e("div",ie,[de,e("p",re,"Количество ботов в работе "+m(t.favorites.length||0),1),e("table",ce,[he,e("tbody",null,[(a(!0),n(p,null,f(t.favorites,(i,v)=>(a(),n("tr",{class:b({"border-info":i.deleted_at==null,"border-danger":i.deleted_at!=null})},[e("th",me,m(i.id),1),e("td",{onClick:l=>t.selectBot(i)},[e("i",{class:b([{"text-danger":i.deleted_at!=null},"fa-solid fa-robot mr-2"])},null,2),r(" "+m(i.bot_domain||"Не указано"),1)],8,ue),e("td",{onClick:l=>t.selectBot(i)},m(i.title||"Не указано"),9,be),e("td",null,[i.is_template?(a(),n("span",_e,m(i.template_description||"Не указано"),1)):(a(),n("span",pe,"Не является шаблоном"))]),e("td",null,m(t.$filters.current(i.updated_at)),1),e("td",null,[e("div",fe,[e("button",{class:b(["btn btn-outline-danger mr-2",{"btn-danger text-white":t.inBotFav(i.id)}]),type:"button",onClick:l=>t.addToFavorite(i.id),title:"Добавить в избранное"},ye,10,ge),t.favorites.length>1?(a(),n("button",{key:0,class:"btn btn-outline-primary mr-2",type:"button",onClick:l=>t.moveOrderFavBot(i.id,1),title:"Переместить вниз"},Fe,8,ke)):d("",!0),t.favorites.length>1?(a(),n("button",{key:1,class:"btn btn-outline-primary mr-2",type:"button",onClick:l=>t.moveOrderFavBot(i.id,0),title:"Переместить вверх"},Be,8,we)):d("",!0)])])],2))),256))])]),Ve])])):d("",!0),e("div",Se,[e("div",je,[e("div",Ue,[e("div",Ie,[Te,e("ul",Oe,[(a(!0),n(p,null,f(t.filters,i=>(a(),n("li",null,[e("a",{class:"dropdown-item",onClick:v=>t.selectFilter(i.slug),href:"#filter"},[e("i",{class:b([i.icon,"mr-2"])},null,2),r(" "+m(i.name||"Не указано"),1)],8,Me)]))),256))])]),e("div",Pe,[c(e("input",{type:"search",class:"form-control",placeholder:"Поиск бота","aria-label":"Поиск бота","onUpdate:modelValue":s[0]||(s[0]=i=>t.search=i),onKeydown:s[1]||(s[1]=C((...i)=>t.loadBots&&t.loadBots(...i),["enter"])),"aria-describedby":"button-addon2"},null,544),[[_,t.search]]),e("button",{class:"btn btn-outline-secondary",onClick:s[2]||(s[2]=(...i)=>t.loadBots&&t.loadBots(...i)),type:"button",id:"button-addon2"},"Найти ")])]),t.selectedFilters.length>0?(a(),n("p",Le,[(a(!0),n(p,null,f(t.selectedFilters,i=>(a(),n("span",Ae,[r(m(i.name||"не указан")+" ",1),e("a",{onClick:v=>t.removeSelectedFilter(i.slug),class:"ml-1 text-white",href:"#filter"},qe,8,Ee)]))),256))])):d("",!0)])]),t.bots_paginate_object?(a(),n("div",Re,[e("div",We,[De,e("p",Je,"Количество найденных ботов "+m(t.bots_paginate_object.meta.total||0),1),e("p",Ne,"Количество результатов на странице "+m(t.bots.length||0),1),e("p",null,[r(" Тип отображения списка: "),e("span",{onClick:s[3]||(s[3]=i=>t.displayType=0),class:b([{"bg-primary":t.displayType===0,"bg-secondary":t.displayType!==0},"badge cursor-pointer mr-2"])},"Карточки",2),e("span",{class:b([{"bg-primary":t.displayType===1,"bg-secondary":t.displayType!==1},"badge cursor-pointer mr-2"]),onClick:s[4]||(s[4]=i=>t.displayType=1)},"Таблица",2)])])])):d("",!0),t.bots.length>0?(a(),n("div",He,[e("div",Ke,[o.editor?d("",!0):(a(),n("button",{key:0,type:"button",class:"btn btn-outline-info",onClick:s[5]||(s[5]=i=>t.selectBot(null))},"Создать нового бота "))]),t.displayType===1?(a(),n("div",Ge,[e("table",Ye,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:s[6]||(s[6]=i=>t.loadAndOrder("id"))},"#"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[7]||(s[7]=i=>t.loadAndOrder("bot_domain"))},"Домен"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[8]||(s[8]=i=>t.loadAndOrder("title"))},"Название"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[9]||(s[9]=i=>t.loadAndOrder("template_description"))},"Шаблон"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[10]||(s[10]=i=>t.loadAndOrder("updated_at"))},"Дата изменения"),Ze])]),e("tbody",null,[(a(!0),n(p,null,f(t.bots,(i,v)=>(a(),n("tr",{class:b({"border-info":i.deleted_at==null,"border-danger":i.deleted_at!=null})},[e("th",Qe,m(i.id),1),e("td",{onClick:l=>t.selectBot(i)},[e("i",{class:b([{"text-danger":i.deleted_at!=null},"fa-solid fa-robot mr-2"])},null,2),r(" "+m(i.bot_domain||"Не указано"),1)],8,Xe),e("td",{onClick:l=>t.selectBot(i)},m(i.title||"Не указано"),9,xe),e("td",null,[i.is_template?(a(),n("span",et,m(i.template_description||"Не указано"),1)):(a(),n("span",tt,"Не является шаблоном"))]),e("td",null,m(t.$filters.current(i.updated_at)),1),e("td",null,[e("div",st,[e("button",{class:b(["btn btn-outline-danger mr-2",{"btn-danger text-white":t.inBotFav(i.id)}]),type:"button",onClick:l=>t.addToFavorite(i.id),title:"Добавить в избранное"},at,10,ot),e("button",{class:"btn btn-outline-info mr-2",type:"button",onClick:l=>t.duplicate(i.id),title:"Дублировать"},dt,8,nt),i.deleted_at==null&&t.hasRole("admin")?(a(),n("button",{key:0,class:"btn btn-outline-info",type:"button",onClick:l=>t.addToArchive(i.id),title:"В архив"},ht,8,rt)):d("",!0),i.deleted_at!=null&&t.hasRole("admin")?(a(),n("button",{key:1,class:"btn btn-outline-info mr-2",onClick:l=>t.extractFromArchive(i.id),title:"Из архива"},bt,8,mt)):d("",!0),i.deleted_at!=null&&t.hasRole("admin")?(a(),n("button",{key:2,class:"btn btn-danger mr-2",onClick:l=>t.forceDelete(i.id),title:"Удалить на совсем"},ft,8,_t)):d("",!0)])])],2))),256))])])])):d("",!0),t.displayType===0?(a(!0),n(p,{key:1},f(t.bots,(i,v)=>(a(),n("div",gt,[e("div",{class:b(["card w-100",{"border-info":i.deleted_at==null,"border-secondary":i.deleted_at!=null}])},[e("div",vt,[e("p",{class:"d-flex justify-content-between",onClick:l=>t.selectBot(i),style:{"word-wrap":"break-word"}},[e("span",null,[e("i",{class:b([{"text-danger":i.deleted_at!=null},"fa-solid fa-robot mr-2"])},null,2),r(" "+m(i.bot_domain||"Не указано"),1)]),i.is_template?(a(),n("span",kt,m(i.template_description||"Шаблон без названия"),1)):d("",!0)],8,yt)]),e("div",$t,[e("button",{class:b(["btn btn-outline-danger mr-2",{"btn-danger text-white":t.inBotFav(i.id)}]),type:"button",onClick:l=>t.addToFavorite(i.id),title:"Добавить в избранное"},Ct,10,Ft),e("button",{class:"btn btn-outline-info mr-2",type:"button",onClick:l=>t.duplicate(i.id),title:"Дублировать"},St,8,Bt),i.deleted_at==null&&t.hasRole("admin")?(a(),n("button",{key:0,class:"btn btn-outline-info",type:"button",onClick:l=>t.addToArchive(i.id),title:"В архив"},It,8,jt)):d("",!0),i.deleted_at!=null&&t.hasRole("admin")?(a(),n("button",{key:1,class:"btn btn-outline-info mr-2",onClick:l=>t.extractFromArchive(i.id),title:"Из архива"},Mt,8,Tt)):d("",!0),i.deleted_at!=null&&t.hasRole("admin")?(a(),n("button",{key:2,class:"btn btn-danger mr-2",onClick:l=>t.forceDelete(i.id),title:"Удалить на совсем"},At,8,Pt)):d("",!0)])],2)]))),256)):d("",!0),e("div",Et,[t.bots_paginate_object?(a(),y($,{key:0,onPagination_page:t.nextBots,pagination:t.bots_paginate_object},null,8,["onPagination_page","pagination"])):d("",!0)])])):(a(),n("div",zt,Rt))])):d("",!0)}}),Jt={class:"d-flex align-items-center"},Nt={key:0,style:{width:"40px",height:"40px","border-radius":"50%"},class:"object-fit-cover mr-2",alt:""},Ht={class:"dropdown w-100"},Kt={class:"dropdown-menu"},Gt=e("i",{class:"fa-regular fa-hand-pointer mr-2"},null,-1),Yt=["href"],Zt=e("i",{class:"fa-solid fa-arrow-right-to-bracket mr-2"},null,-1),Qt=e("i",{class:"fa-solid fa-gears mr-2"},null,-1),Xt=e("i",{class:"fa-solid fa-power-off mr-2"},null,-1),xt=["id"],es={class:"modal-dialog modal-xl"},ts={class:"modal-content"},ss=e("div",{class:"modal-header"},[e("h5",{class:"modal-title"},"Поиск ваших ботов"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),os={class:"modal-body"},ls={key:0,class:"nav nav-tabs"},as={class:"nav-item"},ns={class:"nav-item"},is={key:1,class:"px-2 py-3"},ds={class:"container"},rs={class:"row d-flex justify-content-center"},cs={class:"col-md-6 col-12"},hs={class:"input-group my-3"},ms={class:"w-100 d-flex justify-content-center flex-wrap"},us=e("p",{class:"mb-0 text-primary font-bold"},[e("small",null,"Тип сортировки")],-1),bs={class:"list-group d-flex flex-row w-100 justify-content-center"},_s={key:0},ps=e("i",{class:"fa-solid fa-caret-down"},null,-1),fs=[ps],gs={key:1},vs=e("i",{class:"fa-solid fa-caret-up"},null,-1),ys=[vs],ks={key:0},$s=e("i",{class:"fa-solid fa-caret-down"},null,-1),Fs=[$s],ws={key:1},Cs=e("i",{class:"fa-solid fa-caret-up"},null,-1),Bs=[Cs],Vs={key:0},Ss=e("i",{class:"fa-solid fa-caret-down"},null,-1),js=[Ss],Us={key:1},Is=e("i",{class:"fa-solid fa-caret-up"},null,-1),Ts=[Is],Os={key:0},Ms=e("i",{class:"fa-solid fa-caret-down"},null,-1),Ps=[Ms],Ls={key:1},As=e("i",{class:"fa-solid fa-caret-up"},null,-1),Es=[As],zs={key:1,class:"row my-2"},qs={class:"col-12"},Rs={key:0,class:"container pb-5"},Ws={class:"row row-cols-1 row-cols-lg-4 row-cols-md-1 g-4"},Ds={class:"col"},Js={class:"card h-100"},Ns={class:"card-img-top w-100 object-fit-cover",style:{"max-height":"150px"}},Hs={class:"card-body"},Ks={class:"card-title text-center"},Gs={class:"card-title text-center",style:{"font-size":"14px"}},Ys={class:"card-text text-center mb-2"},Zs={class:"card-text text-center mb-2"},Qs={class:"text-center mb-2"},Xs=["onClick"],xs={class:"row my-5"},eo={class:"col-12"},to={key:1,class:"container"},so=e("div",{class:"alert alert-info",role:"alert"},[e("p",null,"У вас еще нет созданных ботов, попробуйте с чего-то простого;)")],-1),oo={class:"d-flex justify-content-center"},lo={key:2,class:"px-2 py-3"},ao={props:["customClass","bot","id"],data(){return{search_modal_tab:0,direction:"desc",order:"updated_at",searchModal:null,filters:[{name:"Активные",icon:"fa-brands fa-telegram",slug:"active"},{name:"Архивные",icon:"fa-solid fa-box-archive",slug:"archive"}],selectedFilters:[],loading:!0,bots:[],search:null,bots_paginate_object:null}},watch:{},computed:{...F(["getBots","getBotsPaginateObject","getCurrentCompany","getCurrentBot"]),profile(){return window.profile||null},filteredBots(){if(!this.bots)return[];if(this.selectedFilters.length===0&&this.search==null)return this.bots;if(this.selectedFilters.length===0&&this.search!=null)return this.bots.filter(t=>(t.bot_domain||"").trim().toLowerCase().indexOf(this.search.trim().toLowerCase())!==-1);let o=[];return this.selectedFilters.forEach(t=>{switch(t.slug){case"active":this.bots.filter(s=>s.deleted_at==null).forEach(s=>{o.push(s)});break;case"archive":this.bots.filter(s=>s.deleted_at!=null).forEach(s=>{o.push(s)});break}}),this.search==null?o:o.filter(t=>(t.bot_domain||"").trim().toLowerCase().indexOf(this.search.trim().toLowerCase())!==-1)}},mounted(){this.searchModal=new bootstrap.Modal(document.getElementById("bot-search-modal-"+(this.id||"local")),{backdrop:!1}),this.selectFilter("active")},methods:{openBotParams(){window.dispatchEvent(new CustomEvent("open-base-bot-params-event"))},gotoBot(o){this.selectBot(o)},openModal(){this.loadBots(),this.searchModal.show()},resetBot(){window.dispatchEvent(new CustomEvent("reset-current_bot-from-navbar-event")),this.$store.dispatch("resetCurrentBot").then(()=>{}),this.searchModal.hide()},hasRole(o){return window.hasRole(o)||!1},loadBotsByIds(){this.loading=!0,this.$store.dispatch("loadBotsByIds",{ids:[]}).then(o=>{this.loading=!1}).catch(()=>{this.loading=!1})},selectFilter(o){let t=this.filters.find(s=>s.slug===o);t&&this.selectedFilters.filter(s=>s.slug===o).length===0&&this.selectedFilters.push(t)},removeSelectedFilter(o){let t=this.selectedFilters.findIndex(s=>s.slug===o);this.selectedFilters.splice(t,1)},selectBot(o){this.searchModal.hide(),this.$store.dispatch("updateCurrentBot",{bot:o}).then(()=>{}),this.$emit("select-bot",o),this.$notify("Вы выбрали бота из списка! Все остальные действия будут производится для этого бота.")},nextBots(o){this.loadBots(o)},loadAndOrder(o){this.order=o,this.direction=this.direction==="desc"?"asc":"desc",this.loadBots(0)},loadBots(o=0){this.loading=!0,this.$store.dispatch("loadBots",{dataObject:{companyId:this.companyId||null,search:this.search,order:this.order,direction:this.direction,filters:this.selectedFilters.map(t=>t.slug)},page:o,size:20}).then(t=>{this.loading=!1,this.bots=this.getBots,this.bots_paginate_object=this.getBotsPaginateObject}).catch(()=>{this.loading=!1})}}},no=Object.assign(ao,{__name:"BotSearchModal",setup(o){return(t,s)=>{var v,l,u;const i=B("lazy");return a(),n(p,null,[e("div",Jt,[o.bot?c((a(),n("img",Nt,null,512)),[[i,"/images/companies/"+o.bot.bot_domain+"/logo.jpg"]]):d("",!0),e("div",Ht,[e("button",{class:b(o.customClass),type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[o.bot?(a(),n(p,{key:1},[r(m(o.bot.bot_domain||"Без имени"),1)],64)):(a(),n(p,{key:0},[r(" Бот не выбран ")],64))],2),e("ul",Kt,[e("li",null,[e("a",{class:"dropdown-item",href:"javascript:void(0)",onClick:s[0]||(s[0]=(...h)=>t.openModal&&t.openModal(...h))},[Gt,r(" Выбрать бота")])]),o.bot?(a(),n(p,{key:0},[e("li",null,[e("a",{href:"https://t.me/"+(o.bot.bot_domain||"botfather"),class:"dropdown-item",target:"_blank"},[Zt,r(" Перейти в бот")],8,Yt)]),e("li",null,[e("a",{href:"javascript:void(0)",onClick:s[1]||(s[1]=(...h)=>t.openBotParams&&t.openBotParams(...h)),class:"dropdown-item"},[Qt,r(" Базовые параметры бота")])]),e("li",null,[e("a",{class:"dropdown-item",href:"javascript:void(0)",onClick:s[2]||(s[2]=(...h)=>t.resetBot&&t.resetBot(...h))},[Xt,r(" Завершить работу с ботом")])])],64)):d("",!0)])])]),e("div",{class:"modal fade",id:"bot-search-modal-"+(o.id||"local"),tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},[e("div",es,[e("div",ts,[ss,e("div",os,[(v=t.profile)!=null&&v.is_admin?(a(),n("ul",ls,[e("li",as,[e("a",{onClick:s[3]||(s[3]=h=>t.search_modal_tab=0),class:b([{active:t.search_modal_tab===0},"nav-link"]),"aria-current":"page",href:"javascript:void(0)"},"Базовый поиск",2)]),e("li",ns,[e("a",{onClick:s[4]||(s[4]=h=>t.search_modal_tab=1),class:b([{active:t.search_modal_tab===1},"nav-link"]),href:"javascript:void(0)"},"Административный поиск",2)])])):d("",!0),t.search_modal_tab===0?(a(),n("div",is,[e("div",ds,[t.bots.length>0?(a(),y(le,{key:0,"bots-count":((u=(l=t.bots_paginate_object)==null?void 0:l.meta)==null?void 0:u.total)||0},null,8,["bots-count"])):d("",!0),e("div",rs,[e("div",cs,[e("div",hs,[c(e("input",{type:"search",class:"form-control",placeholder:"Поиск бота","aria-label":"Поиск бота","onUpdate:modelValue":s[5]||(s[5]=h=>t.search=h),onKeydown:s[6]||(s[6]=C(h=>t.loadBots(0),["enter"])),"aria-describedby":"button-addon2"},null,544),[[_,t.search]]),e("button",{class:"btn btn-outline-secondary",onClick:s[7]||(s[7]=h=>t.loadBots(0)),type:"button",id:"button-addon2"},"Найти ")]),e("div",ms,[us,e("ul",bs,[e("li",{class:"list-inline-item mr-2 cursor-pointer",onClick:s[8]||(s[8]=h=>t.loadAndOrder("id"))},[t.direction==="desc"&&t.order==="id"?(a(),n("span",_s,fs)):d("",!0),t.direction==="asc"&&t.order==="id"?(a(),n("span",gs,ys)):d("",!0),r(" Id ")]),e("li",{class:"list-inline-item mr-2 cursor-pointer",onClick:s[9]||(s[9]=h=>t.loadAndOrder("title"))},[t.direction==="desc"&&t.order==="title"?(a(),n("span",ks,Fs)):d("",!0),t.direction==="asc"&&t.order==="title"?(a(),n("span",ws,Bs)):d("",!0),r(" Название бота ")]),e("li",{class:"list-inline-item mr-2 cursor-pointer",onClick:s[10]||(s[10]=h=>t.loadAndOrder("bot_domain"))},[t.direction==="desc"&&t.order==="bot_domain"?(a(),n("span",Vs,js)):d("",!0),t.direction==="asc"&&t.order==="bot_domain"?(a(),n("span",Us,Ts)):d("",!0),r(" Домен бота ")]),e("li",{class:"list-inline-item mr-2 cursor-pointer",onClick:s[11]||(s[11]=h=>t.loadAndOrder("updated_at"))},[t.direction==="desc"&&t.order==="updated_at"?(a(),n("span",Os,Ps)):d("",!0),t.direction==="asc"&&t.order==="updated_at"?(a(),n("span",Ls,Es)):d("",!0),r(" Дата обновления ")])])])])]),t.bots.length>0?(a(),n("div",zs,[e("div",qs,[t.bots_paginate_object?(a(),y($,{key:0,onPagination_page:t.nextBots,pagination:t.bots_paginate_object},null,8,["onPagination_page","pagination"])):d("",!0)])])):d("",!0)]),t.bots.length>0?(a(),n("div",Rs,[e("div",Ws,[(a(!0),n(p,null,f(t.bots,h=>(a(),n("div",Ds,[e("div",Js,[c(e("img",Ns,null,512),[[i,"/images/companies/"+h.bot_domain+"/logo.jpg"]]),e("div",Hs,[e("h6",Ks,"#"+m(h.id),1),e("h5",Gs,m(h.title||h.id),1),e("p",Ys," Баланс "+m(h.balance||"0")+" руб ",1),e("p",Zs," Тариф "+m(h.tax_per_day||"0")+" руб\\день ",1),e("p",Qs,[e("small",null,m(t.$filters.currentFull(h.updated_at)),1)])]),e("div",{class:b(["card-footer",{"bg-danger":(h.bot_token||"").length<40,"bg-success":(h.bot_token||"").length>=40}])},[e("button",{type:"button",onClick:hd=>t.gotoBot(h),class:"btn btn-link text-white w-100"},"Редактировать ",8,Xs)],2)])]))),256))]),e("div",xs,[e("div",eo,[t.bots_paginate_object?(a(),y($,{key:0,onPagination_page:t.nextBots,pagination:t.bots_paginate_object},null,8,["onPagination_page","pagination"])):d("",!0)])])])):(a(),n("div",to,[so,e("div",oo,[e("button",{class:"btn btn-primary",onClick:s[12]||(s[12]=(...h)=>t.resetBot&&t.resetBot(...h))},"Поехали создавать")])]))])):d("",!0),t.search_modal_tab===1?(a(),n("div",lo,[j(Dt,{onCallback:t.gotoBot},null,8,["onCallback"])])):d("",!0)])])])],8,xt)],64)}}});const io={key:0,class:"h-100 gradient-form"},ro={class:"container py-5 h-100"},co={class:"row d-flex justify-content-center align-items-center h-100"},ho={class:"col-xl-10"},mo={class:"card rounded-3 text-black"},uo={class:"row g-0"},bo={class:"col-lg-6 d-flex align-items-center bg-primary"},_o={class:"text-white px-3 py-4 p-md-5 mx-md-4"},po={class:"d-flex justify-content-center mb-3"},fo={alt:"",width:"100",height:"100"},go=T('<h4 class="mb-4">Добро пожаловать в раздел создания бота!</h4><p class="small mb-2"> Здесь вы можете легко управлять своими Telegram-ботами: создавать новых, настраивать команды, анализировать статистику и многое другое. Войдите в систему, чтобы получить доступ ко всем возможностям платформы. Если у вас ещё нет аккаунта, зарегистрируйтесь — это займёт всего несколько минут. </p><p class="small mb-2 fw-bold"> Для начала рекомендуем ознакомится с обучением! </p><a href="https://telegra.ph/Sozdanie-telegram-bota-02-02" target="_blank" class="btn w-100 btn-outline-light text-center p-3 mb-2"><i class="fas fa-graduation-cap"></i> Обучение </a><p class="small mb-2"> Начните прямо сейчас и сделайте своих ботов ещё умнее и полезнее! 🚀 </p><a href="https://t.me/botfather" target="_blank" class="btn w-100 btn-outline-light text-center p-3 mb-2"><i class="fab fa-telegram"></i> Создать бота в Телеграм </a>',6),vo={class:"col-lg-6"},yo={class:"card-body p-md-5 mx-md-4"},ko=e("div",{class:"text-center"},[e("h1",{class:"text-primary"},"NextIT"),e("h4",{class:"mt-1 mb-2 pb-1"},"Современные решения для бизнеса")],-1),$o={key:0,class:"alert alert-warning"},Fo=e("p",{class:"mb-2"},[r("Перед добавлением токена выберите "),e("span",{class:"fw-bold text-primary"},"тип бота")],-1),wo={class:"row"},Co={class:"col-md-6 mb-2"},Bo=e("i",{class:"fas fa-robot mb-3",style:{"font-size":"20px"}},null,-1),Vo=e("h6",{style:{"font-size":"14px","text-align":"center"}},[r("Чистый бот"),e("br"),r("(без шаблона)")],-1),So=[Bo,Vo],jo={class:"col-md-6 mb-2"},Uo=e("i",{class:"fas fa-utensils mb-2",style:{"font-size":"20px"}},null,-1),Io=e("h6",{style:{"font-size":"14px","text-align":"center"}},[r("Бот для кафетериев"),e("br"),r("и ресторанного дела")],-1),To=[Uo,Io],Oo={class:"col-md-6 mb-2"},Mo=e("i",{class:"fas fa-spa mb-2",style:{"font-size":"20px"}},null,-1),Po=e("h6",{style:{"font-size":"14px","text-align":"center"}},"Бот для салонов красоты",-1),Lo=[Mo,Po],Ao={class:"col-md-6 mb-2"},Eo=e("i",{class:"fas fa-comments mb-2",style:{"font-size":"20px"}},null,-1),zo=e("h6",{style:{"font-size":"14px","text-align":"center"}},"Диалоговый бот",-1),qo=[Eo,zo],Ro=e("p",{class:"mb-2"},[e("em",null,[e("small",null,"Для начала создания бота добавьте токен телеграм бота")])],-1),Wo={class:"form-floating mb-3"},Do=e("label",{class:"form-label",id:"bot-token"}," Токен бота ",-1),Jo=e("p",{class:"mb-2"},[e("em",null,[e("small",null,"Или выберите существующего бота для редактирования")])],-1),No={class:"row"},Ho={class:"col-md-8 order-2 mb-2 order-md-1 col-12"},Ko={class:"row"},Go={class:"col-12"},Yo={class:"nav nav-tabs justify-content-center"},Zo={key:1,class:"nav-item"},Qo=e("a",{class:"nav-link text-secondary",href:"javascript:void(0)"},[e("i",{class:"fa-solid fa-triangle-exclamation mr-1"}),r(" Обратная связь")],-1),Xo=[Qo],xo={class:"row py-3"},el={class:"col-md-12 col-12"},tl={class:"input-group mb-3"},sl={class:"form-floating"},ol=e("label",{class:"form-label",id:"bot-domain"},[e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно"),r(" Доменное имя бота (загружается автоматически) ")],-1),ll={class:"input-group-text"},al={key:0,style:{width:"40px"},class:"object-fit-cover",alt:""},nl={key:1,style:{width:"40px"},class:"object-fit-cover",alt:""},il={key:0,class:"col-md-12 col-12"},dl={class:"form-check mb-3"},rl=["value"],cl=e("label",{class:"form-check-label",for:"bot-is-template"}," Сделать шаблоном ",-1),hl={key:1,class:"col-md-12 col-12"},ml={class:"form-floating mb-3"},ul=e("label",{class:"form-label",id:"bot-template-description"},[e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно"),r(" Название шаблона бота ")],-1),bl={class:"col-md-12 col-12"},_l={class:"card"},pl={class:"card-body"},fl=e("h6",null,"Настройка параметров бота в BotFather",-1),gl={class:"form-floating mb-3"},vl={class:"form-label d-flex justify-content-between align-items-center",id:"bot-title"},yl={key:0},kl={key:0,class:"text-secondary"},$l=e("div",{class:"alert alert-info",role:"alert"}," Данное описание видно в момент, когда пользователь делится ссылкой на бота, а также при нажатии на иконку бота. ",-1),Fl={class:"form-floating mb-3"},wl={class:"form-label",id:"bot-short-description"},Cl={key:0,class:"text-secondary"},Bl=e("div",{class:"alert alert-info",role:"alert"},[r(" Данное описание видно при первом запуске бота, оно должно содержать информацию о возможностях бота: "),e("ul",{class:"m-0 pl-2"},[e("li",null,"- система лояльности"),e("li",null,"- колесо фортуны"),e("li",null,"- интернет-магазин"),e("li",null,"- реферальная система")]),r(" и т.д. ")],-1),Vl={class:"mb-3 form-floating"},Sl={class:"form-label",id:"bot-long-description"},jl={key:0,class:"text-secondary"},Ul={class:"row"},Il={class:"col-6"},Tl={class:"form-check"},Ol=e("label",{class:"form-check-label",for:"needMenuBtn"}," Нужна кнопка меню ",-1),Ml={key:0,class:"col-12"},Pl={class:"input-group mb-3"},Ll={class:"form-floating"},Al=e("label",{for:""},"Текст кнопки меню",-1),El={class:"form-floating"},zl=e("label",{for:""},"URL-адрес перехода",-1),ql=e("i",{class:"fa-solid fa-link"},null,-1),Rl=[ql],Wl=e("h6",{class:"fw-bold mb-2"},"Пользовательские команды ",-1),Dl={key:0,class:"col-12"},Jl=e("div",{class:"alert alert-primary",role:"alert"},[e("strong",null,"Внимание!"),r(" Отображать пользователю команду "),e("strong",{class:"text-danger"},"/adminmenu"),r(" плохая идея. Команда доступна только администраторам системы, а обычный пользователь будет видеть ошибку. Это создаст негативное восприятие от работы сервиса. ")],-1),Nl=[Jl],Hl={class:"col-12"},Kl={class:"input-group mb-3"},Gl={class:"form-floating"},Yl=["onUpdate:modelValue","aria-describedby"],Zl=e("label",{for:""},"Команда",-1),Ql={class:"form-floating"},Xl=["onUpdate:modelValue","aria-describedby"],xl=e("label",{for:""},"Описание команды",-1),ea=["onClick"],ta=e("i",{class:"fa-regular fa-trash-can"},null,-1),sa=[ta],oa={class:"row"},la={class:"col-6"},aa=e("i",{class:"fa-regular fa-square-plus"},null,-1),na={class:"col-6 d-flex justify-content-end"},ia={class:"form-check"},da=e("label",{class:"form-check-label",for:"showCode"}," Отобразить код ",-1),ra={class:"row"},ca={key:0,class:"col-12 mb-3"},ha=e("label",{class:"form-label",id:"bot-domain"},"JSON-код клавиатуры",-1),ma={class:"row py-3"},ua={class:"col-md-4 col-12"},ba={class:"form-floating mb-3"},_a=e("label",{class:"form-label",id:"bot-level-1"},[e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно"),r(" Уровень 1 CashBack, % ")],-1),pa={class:"col-md-4 col-12"},fa={class:"form-floating mb-3"},ga=e("label",{class:"form-label",id:"bot-level-2"},"Уровень 2 CashBack, %",-1),va={class:"col-md-4 col-12"},ya={class:"form-floating mb-3"},ka=e("label",{class:"form-label",id:"bot-level-3"},"Уровень 3 CashBack, %",-1),$a={class:"mb-2"},Fa={class:"form-check"},wa=e("label",{class:"form-check-label",for:"need-cashback-fired"}," Необходимо настроить период сгорания CashBack ",-1),Ca={key:0,class:"col-md-12 col-12"},Ba={class:"form-floating mb-3"},Va=["value"],Sa=e("label",{class:"form-label",id:"cashback-fired-period"},"Период сгорания CashBack",-1),ja={key:0,class:"mb-3"},Ua=e("label",{class:"form-label",id:"cashback-fired-level"},"Уровень сгорания CashBack, %",-1),Ia={class:"col-md-12 col-12"},Ta={class:"form-floating mb-3"},Oa=e("label",{class:"form-label",id:"cashback-max_cashback_use_percent"}," Автоматическое списание CashBack при покупке, % от цены товара",-1),Ma={class:"col-12 mb-2"},Pa={class:"form-check"},La=e("label",{class:"form-check-label",for:"need-payments"}," Необходимо подключить платежную систему ",-1),Aa={key:1,class:"col-md-12 col-12"},Ea={class:"form-check mb-3 ml-3"},za=["value"],qa=e("label",{class:"form-check-label",for:"bot-auto-cashback-on-payments"}," Начислять CashBack автоматически после успешной оплаты ",-1),Ra={class:"input-group mb-3"},Wa={class:"form-floating"},Da=e("label",{class:"form-label",id:"payment_provider_token"},"Токен платежной системы",-1),Ja=e("a",{class:"input-group-text",href:"https://t.me/botfather",target:"_blank"},"Подключить",-1),Na={class:"col-12 mb-2"},Ha={class:"form-check"},Ka=e("label",{class:"form-check-label",for:"need-shop"}," Необходимо интегрировать магазин в бота ",-1),Ga={key:2,class:"col-md-12 col-12"},Ya={class:"input-group mb-3"},Za={class:"form-floating"},Qa=e("label",{class:"form-label",id:"bot-vk_shop_link"},"Ссылка на группу ВК с товарами",-1),Xa=e("a",{class:"input-group-text",href:"https://vk.com/groups?w=groups_create",target:"_blank"},"Создать",-1),xa={class:"mb-2"},en={class:"form-check"},tn=e("label",{class:"form-check-label",for:"need-cashback-config"}," Необходимо настроить CashBack по категориям ",-1),sn={key:3,class:"mb-2"},on=e("h6",null,"Настройка категорий CashBack-а",-1),ln=e("div",{class:"alert alert-light",role:"alert"}," Категории CashBack - это возможность разделить накопления и траты CashBack пользователями бота на указанные цели, например, кофейня может создать категории: на кофе, на десерты - и начислять баллы за купленный кофе отдельно от баллов за купленный десерт ",-1),an={class:"input-group mb-2 w-100"},nn={class:"form-floating"},dn=["onUpdate:modelValue","aria-describedby"],rn=e("label",{for:""},"Название категории",-1),cn=["onClick"],hn=e("i",{class:"fa-regular fa-trash-can"},null,-1),mn=[hn],un=e("div",{class:"divider divider-small my-3 bg-highlight"},null,-1),bn={class:"mb-2"},_n={class:"form-check"},pn=e("label",{class:"form-check-label",for:"need-cashback-rules"}," Необходимо настроить оповещения под CashBack ",-1),fn={key:4,class:"col-md-12 col-12 mb-2"},gn={class:"form-floating mb-2"},vn=e("option",{value:null},"Не выбрано",-1),yn=["value"],kn=e("label",{class:"form-check-label",for:"warning-rules"},[e("i",{class:"fa-solid fa-triangle-exclamation text-danger"}),r(" Правила критических оповещений ")],-1),$n={class:"input-group mb-2"},Fn={class:"input-group-text"},wn={class:"form-check"},Cn=["onUpdate:modelValue","id"],Bn=["for"],Vn={key:0},Sn={key:1},jn={class:"form-floating"},Un=["onUpdate:modelValue"],In={for:""},Tn=["onClick"],On=e("i",{class:"fa-solid fa-trash-can"},null,-1),Mn=[On],Pn={class:"row py-3"},Ln=e("div",{class:"col-12"},[e("div",{class:"alert alert-light",role:"alert"},[e("strong",null,"Внимание!"),r(' Пропишите сообщение "Мой id" в группе и выполните указания бота ')])],-1),An={class:"col-md-6 col-12"},En={class:"form-floating mb-3"},zn=e("label",{class:"form-label",id:"bot-order-channel"},[e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно"),r(" Канал для заказов (id) ")],-1),qn={class:"col-md-6 col-12"},Rn={class:"form-floating mb-3"},Wn=e("label",{class:"form-label",id:"bot-main-channel"},"Канал для постов (id,рекламный)",-1),Dn={key:0,class:"col-12 mb-2"},Jn={class:"form-check"},Nn=e("label",{class:"form-check-label",for:"need-topics-mailing"}," Необходимо добавить рассылку по топикам для канала заказов (он же системный канал) ",-1),Hn={key:1,class:"col-12 mb-2"},Kn=e("div",{class:"alert alert-light"},[r(" Для автоматического создания топиков и заполнения информации по ним выполните следующие действий: "),e("ul",{class:"m-0 p-0"},[e("li",null,"1.Создайте группу"),e("li",null,"2.Добавьте в группу вашего бота"),e("li",null,"3.Выдайте все административные права боту"),e("li",null,[r("4.Переведите группу в режим работы с темами в настройках группы ("),e("strong",{class:"fw-bold text-primary"},'переключатель "Темы"'),r(") ")]),e("li",null,[r("5.Пропишите сообщение "),e("strong",{class:"fw-bold text-primary"},'"Мой id"'),r(" в группе и выполните указания бота ")])])],-1),Gn={class:"row row-cols-3"},Yn={class:"col"},Zn={class:"form-floating mb-2"},Qn=["onUpdate:modelValue"],Xn={for:""},xn=e("h6",{class:"mb-2 mt-3"},"Сообщения",-1),ei={class:"mb-3 form-floating"},ti={class:"form-label",id:"bot-maintenance-message"},si=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),oi={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},li={class:"row py-3"},ai=e("div",{class:"col-12"},[e("div",{class:"alert alert-primary",role:"alert"},' Внешний сервис находится в эксперементальном режиме. Он нужен для связывания команд (страниц) бота с программой Клиента (если есть такая необходимость). Если на странице бота выбрано "внешнее управление", то все запросы будут переадесрованы на указанную ниже ссылку. ')],-1),ni={class:"col-md-12 col-12"},ii={class:"form-floating mb-3"},di=e("label",{class:"form-label",id:"callback_link"},"Ссылка на внешний сервис обработки данных ",-1),ri={class:"col-md-4 order-1 mb-2 order-md-2 col-12"},ci={class:"card mb-2 border-light"},hi={class:"card-body"},mi={class:"form-floating mb-2"},ui=e("label",{class:"form-label",id:"bot-token"}," Токен бота ",-1),bi=["disabled"],_i={key:0},pi={key:1},fi=e("i",{class:"fa-regular fa-floppy-disk"},null,-1),gi={key:0,class:"input-group mb-2"},vi={class:"form-floating"},yi=["disabled"],ki=["disabled","value"],$i=e("label",{for:"floatingSelect"},[e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно"),r(" Выбор сервера размещения")],-1),Fi=["disabled"],wi=e("i",{class:"fa-solid fa-right-left"},null,-1),Ci=[wi],Bi={class:"card border-light mb-2"},Vi={class:"card-body"},Si={key:0},ji=["href"],Ui=e("i",{class:"fa-solid fa-arrow-up-right-from-square"},null,-1),Ii={key:1,type:"button",class:"btn btn-primary p-3 w-100 mb-3"},Ti=e("div",{class:"col-12"},[e("div",{class:"alert alert-primary",role:"alert"},[e("strong",null,"Внимание!"),r(" Внесите сумму, которую вам дал Клиент! Эта сумма будет балансом Клиента для работы бота! Укажите тариф бота - это сумма, которую система будет списывать с клиента каждый день пока баланс бота не будет равен 0. "),e("br"),e("strong",null,"Внимание!"),r(" Вы можете начислить какую-то небольшую сумму для того чтобы клиент протестировал работу бота. При достижении нулевого баланса клиент будет оповещен об этом и должен будет пополнить счёт бота! ")])],-1),Oi={class:"col-md-12 col-12"},Mi={class:"mb-3 form-floating"},Pi=e("label",{class:"form-label",id:"bot-balance"},[e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно"),r(" Баланс бота, руб ")],-1),Li={class:"col-md-12 col-12"},Ai={class:"mb-3 form-floating"},Ei=e("label",{class:"form-label",id:"bot-tax-per-day"},[e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно"),r(" Списание за сутки, руб ")],-1),zi={class:"card border-light"},qi={class:"card-body"},Ri={class:"col-md-12 col-12"},Wi={class:"form-check mb-3"},Di=["value"],Ji=e("label",{class:"form-check-label",for:"bot-select-company"}," Выбрать клиента из списка ",-1),Ni={key:0,class:"font-bold"},Hi={key:0,class:"col-md-12 col-12"},Ki={class:"w-100 p-2",style:{"overflow-y":"scroll","max-height":"300px"}},Gi={class:"row"},Yi={class:"col-12"},Zi={class:"alert alert-danger alert-dismissible fade show",role:"alert"},Qi=e("strong",null,"Внимание!",-1),Xi=["onClick"],xi={class:"modal fade",id:"select-script-for-menu",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},ed={class:"modal-dialog modal-lg"},td={class:"modal-content"},sd=e("div",{class:"modal-header"},[e("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"Выбор скрипта"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),od={class:"modal-body"},ld=e("div",{class:"alert alert-light"}," Внимание! Необходимо выбрать тип скрипта в меню ",-1),ad={class:"row row-cols-3"},nd={class:"col mb-2"},id=["onClick"],dd={class:"card-body text-center cursor-pointer text-primary fw-bold"},rd=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),cd={components:{Vue3JsonEditor:V},props:["bot"],data(){return{load_photo:!0,loadCommandEditor:!0,select_script_modal:null,select_script_step:0,script_types:[{title:"Магазин",uri:"/menu"},{title:"Отзывы",uri:"/feedback"},{title:"Колесо фортуны",uri:"/wheel"},{title:"Профиль",uri:"/profile"},{title:"Заказы",uri:"/orders"},{title:"Ввод промокода",uri:"/new-promo-code"},{title:"Контакты",uri:"/contacts"},{title:"Корзина",uri:"/cart"}],showCode:!1,tab:0,spent_time_counter:0,can_create:!0,can_create_topics:!0,messages:[],servers:[],need_company_select:!1,selected_warning:null,page:null,step:0,templates:[],load:!1,loadPage:!1,needPageListUpdate:!1,need_threads:!1,need_company:!1,need_cashback_config:!1,need_cashback_rules:!1,need_cashback_fired:!1,need_payments:!1,need_shop:!1,command:null,company:null,warnings:[{title:"Сумма чека больше чем",key:"bill_sum_more_then"},{title:"Сумма начисления кэшбэка больше чем",key:"cashback_up_sum_more_then"},{title:"Сумма списания кэшбэка больше чем",key:"cashback_down_sum_more_then"}],cashback_fire_periods:[{title:"Не сгорает",value:0},{title:"7 дней",value:7},{title:"15 дней",value:15},{title:"30 дней",value:30},{title:"60 дней",value:60},{title:"60 дней",value:90},{title:"120 дней",value:120},{title:"180 дней",value:180},{title:"360 дней",value:360}],needMenuBtn:!1,botForm:{title:"Название бота",short_description:"Описание в шапке бота",long_description:"Описание при первом запуске бота",bot_type:0,is_template:!1,auto_cashback_on_payments:!1,template_description:null,bot_domain:null,bot_token:null,company_id:null,creator_id:null,bot_token_dev:null,order_channel:null,message_threads:null,cashback_config:null,server:"main",main_channel:null,vk_shop_link:null,callback_link:null,balance:70,tax_per_day:10,welcome_message:"Приветствую!",image:null,cashback_fire_percent:0,cashback_fire_period:0,max_cashback_use_percent:0,description:"Это ваш бот! Вот такое вот описание у него.",info_link:null,social_links:[],maintenance_message:"Технические работы",payment_provider_token:null,level_1:10,level_2:0,level_3:0,commands:null,menu:{text:"Меню",url:null},selected_bot_template_id:null,pages:[],amo:null,warnings:[]}}},watch:{isValidTelegramToken:{handler(o){this.profile.is_admin&&(this.servers||[]).length===0&&this.loadCurrentServers()},deep:!0},"botForm.bot_token":{handler(o){this.isValidTelegramToken&&this.getMe()},deep:!0},need_threads:function(o,t){let s=[{title:"Отзывы",key:"reviews",value:null},{title:"Начисление cashback",key:"cashback",value:null},{title:"Вопросы",key:"questions",value:null},{title:"Конкурсы",key:"actions",value:null},{title:"Заказы",key:"orders",value:null},{title:"Вывод средств",key:"ask-money",value:null},{title:"Доставка",key:"delivery",value:null},{title:"Ответы",key:"response",value:null},{title:"Обратная связь",key:"callback",value:null}];this.need_threads&&!this.botForm.message_threads&&(this.botForm.message_threads=s),this.need_threads&&this.botForm.message_threads&&s.forEach(i=>{this.botForm.message_threads.findIndex(l=>l.key===i.key)===-1&&this.botForm.message_threads.push(i)})},need_payments:function(o,t){this.need_payments||(this.botForm.auto_cashback_on_payments=!1)}},computed:{...F(["getSlugs","getCurrentCompany"]),profile(){return window.profile},isValidTelegramToken(){return this.botForm.bot_token?/^[0-9]{8,10}:[a-zA-Z0-9_-]{35}$/.test(this.botForm.bot_token):!1},filteredWarnings(){return this.botForm.warnings.length===0?this.warnings:this.warnings.filter(o=>!(this.botForm.warnings.findIndex(t=>t.rule_key===o.key)>=0))}},mounted(){if(this.select_script_modal=new bootstrap.Modal("#select-script-for-menu",{}),localStorage.getItem("cashman_admin_bot_creator_counter")!=null){let o=localStorage.getItem("cashman_admin_bot_creator_counter");this.startTimer(o==="null"||o==null?0:o)}window.addEventListener("store_current_company-change-event",o=>{this.company=this.getCurrentCompany}),window.addEventListener("add-payment-system-event",o=>{this.tab=1,this.need_payments=!0,this.$nextTick(()=>{let t=document.querySelector("#payment_provider_token-input");t.classList="form-control border-danger",t.focus(),setTimeout(()=>{let s=document.querySelector("#payment_provider_token-input");s.classList="form-control"},5e3)})}),this.bot?this.$nextTick(()=>{this.botForm={id:this.bot.id||null,title:this.bot.title||"",short_description:this.bot.short_description||"",long_description:this.bot.long_description||"",is_template:this.bot.is_template||!1,auto_cashback_on_payments:this.bot.auto_cashback_on_payments||!1,template_description:this.bot.template_description||null,bot_domain:this.bot.bot_domain||null,bot_token:this.bot.bot_token||null,bot_token_dev:this.bot.bot_token_dev||null,order_channel:this.bot.order_channel||null,message_threads:this.bot.message_threads||null,cashback_config:this.bot.cashback_config||null,main_channel:this.bot.main_channel||null,balance:this.bot.balance||null,server:this.bot.server||"main",tax_per_day:this.bot.tax_per_day||null,vk_shop_link:this.bot.vk_shop_link||null,callback_link:this.bot.callback_link||null,cashback_fire_percent:this.bot.cashback_fire_percent||0,cashback_fire_period:this.bot.cashback_fire_period||0,max_cashback_use_percent:this.bot.max_cashback_use_percent||0,image:this.bot.image||null,description:this.bot.description||null,creator_id:this.bot.creator_id||null,info_link:this.bot.info_link||null,social_links:this.bot.social_links||[],maintenance_message:this.bot.maintenance_message||null,welcome_message:this.bot.welcome_message||null,payment_provider_token:this.bot.payment_provider_token||null,level_1:this.bot.level_1,level_2:this.bot.level_2,level_3:this.bot.level_3,company_id:this.bot.company_id,commands:this.bot.commands||null,warnings:this.bot.warnings||[],amo:this.bot.amo||null,menu:{text:"Меню",url:null}},Array.isArray(this.botForm.commands)||(this.botForm.commands=[]),this.botForm.menu=this.bot.menu||{text:"Меню",url:null},this.botForm.menu.url!==null&&(this.needMenuBtn=!0),this.botForm.commands==null&&this.autoAddCommands(),this.botForm.message_threads&&(this.need_threads=!0),this.botForm.payment_provider_token&&(this.need_payments=!0),(this.botForm.cashback_config||[]).length>0&&(this.need_cashback_config=!0),this.botForm.warnings.length>0&&(this.need_cashback_rules=!0),this.botForm.cashback_fire_period>0&&(this.need_cashback_fired=!0),this.bot.company&&(this.company=this.bot.company)}):this.botForm.commands==null&&this.autoAddCommands()},methods:{openSelectScriptModal(){this.select_script_step=0,this.select_script_modal.show()},selectBot(o){this.$emit("callback")},autoAddCommands(){this.botForm.commands=[{command:"/start",description:"начни с этой команды"},{command:"/admins",description:"доступные администраторы в системе"},{command:"/help",description:"как использовать систему"},{command:"/about",description:"о CashMan"}]},startTimer(o){this.spent_time_counter=o!=null?Math.min(o,10):10;let t=setInterval(()=>{this.spent_time_counter>0?this.spent_time_counter--:(clearInterval(t),this.spent_time_counter=null),localStorage.setItem("cashman_admin_bot_creator_counter",this.spent_time_counter)},1e3)},alert(o,t=null){t!=null&&(this.tab=t),this.messages.push(o)},removeMessage(o){this.messages.splice(o,1)},createBotTopics(){this.can_create_topics=!1,this.$store.dispatch("createBotTopics",{dataObject:{topics:this.botForm.message_threads,bot_id:this.bot.id}}).then(o=>{this.botForm.message_threads=o.data,this.$notify({title:"Конструктор ботов",text:"Топики успешно созданы!",type:"success"})}).catch(()=>{this.can_create_topics=!0,this.$notify({title:"Конструктор ботов",text:"Ошибка создания топиков",type:"error"})})},getMe(){let o=this.botForm.bot_token||"";o.length<40||this.$store.dispatch("getMe",{bot_token:o}).then(t=>{let s=t.username||null,i=t.first_name||null;s&&(this.botForm.bot_domain=s),i&&(this.botForm.title=i),this.load_photo=!1,this.$nextTick(()=>{this.load_photo=!0})})},getChatLink(o){this.$store.dispatch("loadChatInfo",{dataObject:{chat_id:o,bot_id:this.bot.id}}).then(t=>{console.log("chat info",t)})},addTextTo(o={param:null,text:null}){this.botForm[o.param]=o.text},removeCommands(o){this.botForm.commands.splice(o,1),this.loadCommandEditor=!1,this.$nextTick(()=>{this.loadCommandEditor=!0})},addCommands(){this.botForm.commands||(this.botForm.commands=[]),this.botForm.commands.push({command:null,description:null}),this.loadCommandEditor=!1,this.$nextTick(()=>{this.loadCommandEditor=!0})},loadCurrentServers(){this.$store.dispatch("loadCurrentServers").then(o=>{this.servers=o})},addItem(o){this.botForm[o].push("")},addSocialLinks(){this.botForm.social_links.push({title:null,url:null})},removeItem(o,t){this.botForm[o].splice(t,1)},updateWebHook(){this.$store.dispatch("updateBotWebhook",{dataObject:{bot_id:this.bot.id,bot_server:this.botForm.server||null}}).catch(o=>{this.alert(o.response.data.message)})},addBot(){this.startTimer();let o=new FormData;Object.keys(this.botForm).forEach(t=>{const s=this.botForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),this.company&&o.append("company_id",this.company.id),this.$store.dispatch(this.bot==null?"createBot":"updateBot",{botForm:o}).then(t=>{let s=t.data;this.$emit("callback",s),this.$notify({title:"Конструктор ботов",text:this.bot==null?"Бот успешно создан!":"Бот успешно обновлен!",type:"success"}),this.$store.dispatch("updateBotWebhook",{dataObject:{bot_id:s.id}}).catch(i=>{this.alert(i.response.data.message)}),this.bot==null&&(this.botForm={title:"",server:"main",short_description:"",long_description:"",is_template:!1,auto_cashback_on_payments:!1,template_description:null,bot_domain:null,bot_token:null,bot_token_dev:null,order_channel:null,message_threads:null,main_channel:null,balance:null,tax_per_day:null,callback_link:null,cashback_fire_percent:0,cashback_fire_period:0,max_cashback_use_percent:0,image:null,description:null,info_link:null,social_links:[],maintenance_message:null,payment_provider_token:null,level_1:10,level_2:0,level_3:0,warnings:[],selected_bot_template_id:null,pages:[]})}).catch(t=>{this.$notify({title:"Конструктор ботов",text:t.response.data.message,type:"error"})})},onJsonChange(o){this.botForm.commands=o},removeCashBackConfig(o){this.botForm.cashback_config.splice(o,1)},addCashBackConfig(){this.botForm.cashback_config=this.botForm.cashback_config==null?[]:this.botForm.cashback_config,this.botForm.cashback_config.push({title:null})},getWarning(o){let t=this.warnings.find(s=>s.key===o);return t||{title:"Не найдено"}},removeWarning(o){this.botForm.warnings.splice(o,1)},companyListCallback(o){this.load=!0,this.company=o,this.botForm.company_id=o.id,this.need_company_select=!1,this.$nextTick(()=>{this.load=!1})},selectVariant(o){this.select_script_step++,this.botForm.menu.text=o.title||"Меню",this.botForm.menu.url="https://test.next-bots.ru/bot-client/simple/"+this.bot.bot_domain+"?slug="+o.id+"#/s"},selectVariantStep2(o){this.botForm.menu.url+=o.uri,this.select_script_modal.hide(),this.select_script_step=0,this.$notify({title:"Конструктор ботов",text:"Скрипт успешно выбран",type:"success"})},addWarning(){const o=this.selected_warning;this.botForm.warnings.push({rule_key:o.key,rule_value:0,is_active:!0}),this.selected_warning=null}}},pd=Object.assign(cd,{__name:"BotForm",setup(o){return(t,s)=>{var v;const i=B("lazy");return a(),n(p,null,[e("form",{class:"mb-5",ref:"botForm",onSubmit:s[65]||(s[65]=I((...l)=>t.addBot&&t.addBot(...l),["prevent"]))},[t.isValidTelegramToken?d("",!0):(a(),n("section",io,[e("div",ro,[e("div",co,[e("div",ho,[e("div",mo,[e("div",uo,[e("div",bo,[e("div",_o,[e("div",po,[c(e("img",fo,null,512),[[i,"../images/icon.png"]])]),go])]),e("div",vo,[e("div",yo,[ko,!t.isValidTelegramToken&&((v=t.botForm.bot_token)==null?void 0:v.length)>0?(a(),n("div",$o," Токен не действительный! ")):d("",!0),Fo,e("div",wo,[e("div",Co,[e("div",{onClick:s[0]||(s[0]=l=>t.botForm.bot_type=0),class:b([{"border-primary":t.botForm.bot_type===0},"card cursor-pointer"]),style:{height:"120px"}},[e("div",{class:b([{"text-primary":t.botForm.bot_type===0},"card-body d-flex flex-column justify-content-center align-items-center p-3"])},So,2)],2)]),e("div",jo,[e("div",{class:b(["card cursor-pointer",{"border-primary":t.botForm.bot_type===1}]),onClick:s[1]||(s[1]=l=>t.botForm.bot_type=1),style:{height:"120px"}},[e("div",{class:b([{"text-primary":t.botForm.bot_type===1},"card-body d-flex flex-column justify-content-center align-items-center p-3"])},To,2)],2)]),e("div",Oo,[e("div",{class:b(["card cursor-pointer",{"border-primary":t.botForm.bot_type===2}]),onClick:s[2]||(s[2]=l=>t.botForm.bot_type=2),style:{height:"120px"}},[e("div",{class:b([{"text-primary":t.botForm.bot_type===2},"card-body d-flex flex-column justify-content-center align-items-center p-3"])},Lo,2)],2)]),e("div",Ao,[e("div",{class:b(["card cursor-pointer",{"border-primary":t.botForm.bot_type===3}]),onClick:s[3]||(s[3]=l=>t.botForm.bot_type=3),style:{height:"120px"}},[e("div",{class:b([{"text-primary":t.botForm.bot_type===3},"card-body d-flex flex-column justify-content-center align-items-center p-3"])},qo,2)],2)])]),Ro,e("div",Wo,[c(e("input",{type:"text",class:"form-control",placeholder:"Токен","aria-label":"Токен","onUpdate:modelValue":s[4]||(s[4]=l=>t.botForm.bot_token=l),maxlength:"255",minlength:"40",onInvalid:s[5]||(s[5]=l=>t.alert("Вы не ввели токен бота!")),"aria-describedby":"bot-token",required:""},null,544),[[_,t.botForm.bot_token]]),Do]),Jo,t.load?d("",!0):(a(),y(no,{key:1,"custom-class":"btn btn-primary p-3 w-100 dropdown-toggle",onSelectBot:t.selectBot,bot:o.bot},null,8,["onSelectBot","bot"]))])])])])])])])])),t.isValidTelegramToken?(a(),n(p,{key:1},[e("div",No,[e("div",Ho,[e("div",Ko,[e("div",Go,[e("ul",Yo,[e("li",{class:"nav-item",onClick:s[6]||(s[6]=l=>t.tab=0)},[e("a",{class:b(["nav-link",{active:t.tab===0}]),href:"javascript:void(0)"},"Базовые настройки",2)]),e("li",{class:"nav-item",onClick:s[7]||(s[7]=l=>t.tab=1)},[e("a",{class:b(["nav-link",{active:t.tab===1}]),href:"javascript:void(0)"},"Кэшбэк&Финансы",2)]),t.botForm.id!=null?(a(),n("li",{key:0,class:"nav-item",onClick:s[8]||(s[8]=l=>t.tab=2)},[e("a",{class:b(["nav-link",{active:t.tab===2}]),href:"javascript:void(0)"},"Обратная связь",2)])):d("",!0),t.botForm.id==null?(a(),n("li",Zo,Xo)):d("",!0)])])]),c(e("div",xo,[e("div",el,[e("div",tl,[e("div",sl,[c(e("input",{type:"text",class:"form-control",placeholder:"Имя бота","aria-label":"Имя бота",disabled:!0,name:"bot_domain",onInvalid:s[9]||(s[9]=l=>t.alert("Вы не ввели доменное имя бота!",0)),"onUpdate:modelValue":s[10]||(s[10]=l=>t.botForm.bot_domain=l),maxlength:"255","aria-describedby":"bot-domain",required:""},null,544),[[_,t.botForm.bot_domain]]),ol]),e("span",ll,[t.load_photo?c((a(),n("img",al,null,512)),[[i,"/images/companies/"+t.botForm.bot_domain+"/logo.jpg"]]):c((a(),n("img",nl,null,512)),[[i,"/images/icon.png"]])])])]),t.profile.is_admin?(a(),n("div",il,[e("div",dl,[c(e("input",{class:"form-check-input",type:"checkbox",value:t.botForm.is_template||!1,"onUpdate:modelValue":s[11]||(s[11]=l=>t.botForm.is_template=l),id:"bot-is-template"},null,8,rl),[[g,t.botForm.is_template]]),cl])])):d("",!0),t.botForm.is_template?(a(),n("div",hl,[e("div",ml,[c(e("input",{type:"text",class:"form-control",placeholder:"Название \\ описание шаблона","aria-label":"Описание шаблона","onUpdate:modelValue":s[12]||(s[12]=l=>t.botForm.template_description=l),maxlength:"255",onInvalid:s[13]||(s[13]=l=>t.alert("Вы не ввели название шаблона!")),"aria-describedby":"bot-template-description",required:""},null,544),[[_,t.botForm.template_description]]),ul])])):d("",!0),e("div",bl,[e("div",_l,[e("div",pl,[fl,e("div",gl,[c(e("input",{type:"text",class:"form-control",placeholder:"Текст названия","aria-label":"Текст названия","onUpdate:modelValue":s[14]||(s[14]=l=>t.botForm.title=l),maxlength:"64","aria-describedby":"bot-title"},null,512),[[_,t.botForm.title]]),e("label",vl,[t.botForm.title?(a(),n("span",yl,[r(" Название бота "),t.botForm.title.length>0?(a(),n("small",kl,"Длина текста "+m(t.botForm.title.length)+"/64",1)):d("",!0)])):d("",!0)])]),$l,e("div",Fl,[c(e("textarea",{class:"form-control",placeholder:"Описание в шапке бота","aria-label":"Описание в шапке бота","onUpdate:modelValue":s[15]||(s[15]=l=>t.botForm.short_description=l),maxlength:"105",style:{"min-height":"100px"},"aria-describedby":"bot-short-description"},`
                                        `,512),[[_,t.botForm.short_description]]),e("label",wl,[e("span",null,[r(" Описание в шапке бота "),t.botForm.short_description.length>0?(a(),n("small",Cl,"Длина текста "+m(t.botForm.short_description.length)+"/105",1)):d("",!0)])])]),Bl,e("div",Vl,[c(e("textarea",{class:"form-control",placeholder:"Описание возможностей бота","aria-label":"Описание возможностей бота","onUpdate:modelValue":s[16]||(s[16]=l=>t.botForm.long_description=l),maxlength:"505",style:{"min-height":"200px"},"aria-describedby":"bot-long-description"},null,512),[[_,t.botForm.long_description]]),e("label",Sl,[e("span",null,[r(" Описание возможностей бота "),t.botForm.long_description.length>0?(a(),n("small",jl,"Длина текста "+m(t.botForm.long_description.length)+"/505",1)):d("",!0)])])]),e("div",Ul,[e("div",Il,[e("div",Tl,[c(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":s[17]||(s[17]=l=>t.needMenuBtn=l),id:"needMenuBtn"},null,512),[[g,t.needMenuBtn]]),Ol])]),t.needMenuBtn?(a(),n("div",Ml,[e("div",Pl,[e("div",Ll,[c(e("input",{type:"text",class:"form-control",placeholder:"Текст кнопки меню","aria-label":"Текст кнопки меню",maxlength:"255",onInvalid:s[18]||(s[18]=l=>t.alert("Текст кнопки меню!",0)),"onUpdate:modelValue":s[19]||(s[19]=l=>t.botForm.menu.text=l),required:""},null,544),[[_,t.botForm.menu.text]]),Al]),e("div",El,[c(e("input",{type:"url",class:"form-control",placeholder:"Адрес перехода URL","aria-label":"Адрес перехода URL",maxlength:"255",onInvalid:s[20]||(s[20]=l=>t.alert("Вы не ввели адрес меню!",0)),"onUpdate:modelValue":s[21]||(s[21]=l=>t.botForm.menu.url=l),required:""},null,544),[[_,t.botForm.menu.url]]),zl]),e("button",{type:"button",onClick:s[22]||(s[22]=(...l)=>t.openSelectScriptModal&&t.openSelectScriptModal(...l)),class:"input-group-text px-2 text-primary",id:"basic-addon1"},Rl)])])):d("",!0)]),Wl,(a(!0),n(p,null,f(t.botForm.commands,(l,u)=>(a(),n("div",{class:"row",key:"commands-"+u},[t.botForm.commands[u].command==="/adminmenu"?(a(),n("div",Dl,Nl)):d("",!0),e("div",Hl,[e("div",Kl,[e("div",Gl,[c(e("input",{type:"text",class:"form-control",placeholder:"Название команды","aria-label":"Название команды",maxlength:"255",onInvalid:s[23]||(s[23]=h=>t.alert("Вы не ввели название команды",0)),"onUpdate:modelValue":h=>t.botForm.commands[u].command=h,"aria-describedby":"bot-command-"+u,required:""},null,40,Yl),[[_,t.botForm.commands[u].command]]),Zl]),e("div",Ql,[c(e("input",{type:"text",class:"form-control",placeholder:"Описание команды","aria-label":"Описание команды",maxlength:"255",onInvalid:s[24]||(s[24]=h=>t.alert("Вы не ввели описание команды!",0)),"onUpdate:modelValue":h=>t.botForm.commands[u].description=h,"aria-describedby":"bot-command-description-"+u,required:""},null,40,Xl),[[_,t.botForm.commands[u].description]]),xl]),e("button",{class:"input-group-text text-danger",onClick:h=>t.removeCommands(u)},sa,8,ea)])])]))),128)),e("div",oa,[e("div",la,[e("button",{type:"button",onClick:s[25]||(s[25]=l=>t.addCommands()),class:"btn btn-link text-primary text-decoration-none p-0"},[aa,r(" Добавить еще команду ")])]),e("div",na,[e("div",ia,[c(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":s[26]||(s[26]=l=>t.showCode=l),id:"showCode"},null,512),[[g,t.showCode]]),da])])]),e("div",ra,[t.showCode?(a(),n("div",ca,[ha,t.loadCommandEditor?(a(),y(U(V),{key:0,mode:"code",modelValue:t.botForm.commands,"onUpdate:modelValue":s[27]||(s[27]=l=>t.botForm.commands=l),"show-btns":!1,expandedOnStart:!0,onJsonChange:t.onJsonChange},null,8,["modelValue","onJsonChange"])):d("",!0)])):d("",!0)])])])])],512),[[k,t.tab===0]]),c(e("div",ma,[e("div",ua,[e("div",ba,[c(e("input",{type:"number",class:"form-control",placeholder:"%","aria-label":"уровень CashBack","onUpdate:modelValue":s[28]||(s[28]=l=>t.botForm.level_1=l),min:"0",onInvalid:s[29]||(s[29]=l=>t.alert("Вы не ввели значение кэшбэка 1 уровня бота!",1)),"aria-describedby":"bot-level-1",required:""},null,544),[[_,t.botForm.level_1]]),_a])]),e("div",pa,[e("div",fa,[c(e("input",{type:"number",class:"form-control",placeholder:"%","aria-label":"уровень CashBack","onUpdate:modelValue":s[30]||(s[30]=l=>t.botForm.level_2=l),min:"0","aria-describedby":"bot-level-2"},null,512),[[_,t.botForm.level_2]]),ga])]),e("div",va,[e("div",ya,[c(e("input",{type:"number",class:"form-control",placeholder:"%","aria-label":"уровень CashBack","onUpdate:modelValue":s[31]||(s[31]=l=>t.botForm.level_3=l),min:"0","aria-describedby":"bot-level-3"},null,512),[[_,t.botForm.level_3]]),ka])]),e("div",$a,[e("div",Fa,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[32]||(s[32]=l=>t.need_cashback_fired=l),type:"checkbox",id:"need-cashback-fired"},null,512),[[g,t.need_cashback_fired]]),wa])]),t.need_cashback_fired?(a(),n("div",Ca,[e("div",Ba,[c(e("select",{class:"form-control","onUpdate:modelValue":s[33]||(s[33]=l=>t.botForm.cashback_fire_period=l),id:"cashback-fired-period"},[(a(!0),n(p,null,f(t.cashback_fire_periods,l=>(a(),n("option",{value:l.value},m(l.title||"Не указано"),9,Va))),256))],512),[[w,t.botForm.cashback_fire_period]]),Sa]),t.botForm.cashback_fire_period>0?(a(),n("div",ja,[Ua,c(e("input",{type:"number",class:"form-control",placeholder:"%","aria-label":"уровень сгорания CashBack","onUpdate:modelValue":s[34]||(s[34]=l=>t.botForm.cashback_fire_percent=l),min:"0",max:"100","aria-describedby":"cashback-fired-level"},null,512),[[_,t.botForm.cashback_fire_percent]])])):d("",!0)])):d("",!0),e("div",Ia,[e("div",Ta,[c(e("input",{type:"number",class:"form-control",placeholder:"%","aria-label":"процент для списания CashBack при покупке","onUpdate:modelValue":s[35]||(s[35]=l=>t.botForm.max_cashback_use_percent=l),min:"0",max:"100","aria-describedby":"cashback-max_cashback_use_percent"},null,512),[[_,t.botForm.max_cashback_use_percent]]),Oa])]),e("div",Ma,[e("div",Pa,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[36]||(s[36]=l=>t.need_payments=l),type:"checkbox",id:"need-payments"},null,512),[[g,t.need_payments]]),La])]),t.need_payments?(a(),n("div",Aa,[e("div",Ea,[c(e("input",{class:"form-check-input",type:"checkbox",value:t.botForm.auto_cashback_on_payments,"onUpdate:modelValue":s[37]||(s[37]=l=>t.botForm.auto_cashback_on_payments=l),id:"bot-auto-cashback-on-payments"},null,8,za),[[g,t.botForm.auto_cashback_on_payments]]),qa]),e("div",Ra,[e("div",Wa,[c(e("input",{type:"text",class:"form-control",id:"payment_provider_token-input",placeholder:"Токен","aria-label":"Токен","onUpdate:modelValue":s[38]||(s[38]=l=>t.botForm.payment_provider_token=l),"aria-describedby":"payment_provider_token"},null,512),[[_,t.botForm.payment_provider_token]]),Da]),Ja])])):d("",!0),e("div",Na,[e("div",Ha,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[39]||(s[39]=l=>t.need_shop=l),type:"checkbox",id:"need-shop"},null,512),[[g,t.need_shop]]),Ka])]),t.need_shop?(a(),n("div",Ga,[e("div",Ya,[e("div",Za,[c(e("input",{type:"url",class:"form-control",placeholder:"Ссылка на группу ВК","aria-label":"ссылка на группу ВК","onUpdate:modelValue":s[40]||(s[40]=l=>t.botForm.vk_shop_link=l),"aria-describedby":"vk_shop_link"},null,512),[[_,t.botForm.vk_shop_link]]),Qa]),Xa])])):d("",!0),e("div",xa,[e("div",en,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[41]||(s[41]=l=>t.need_cashback_config=l),type:"checkbox",id:"need-cashback-config"},null,512),[[g,t.need_cashback_config]]),tn])]),t.need_cashback_config?(a(),n("div",sn,[on,ln,(a(!0),n(p,null,f(t.botForm.cashback_config,(l,u)=>(a(),n("div",{class:"d-flex justify-content-between mb-2 flex-wrap",key:"social-link"+u},[e("div",an,[e("div",nn,[c(e("input",{type:"text",class:"form-control",placeholder:"Название категории","aria-label":"Название категории",maxlength:"255",onInvalid:s[42]||(s[42]=h=>t.alert("Вы не ввели название категории!",1)),"onUpdate:modelValue":h=>t.botForm.cashback_config[u].title=h,"aria-describedby":"bot-cashback-config-"+u,required:""},null,40,dn),[[_,t.botForm.cashback_config[u].title]]),rn]),e("button",{type:"button",onClick:h=>t.removeCashBackConfig(u),class:"input-group-text text-danger"},mn,8,cn)])]))),128)),e("button",{type:"button",onClick:s[43]||(s[43]=l=>t.addCashBackConfig()),class:"btn mb-2 rounded-sm btn-outline-primary p-3 w-100"}," Добавить категорию "),un])):d("",!0),e("div",bn,[e("div",_n,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[44]||(s[44]=l=>t.need_cashback_rules=l),type:"checkbox",id:"need-cashback-rules"},null,512),[[g,t.need_cashback_rules]]),pn])]),t.need_cashback_rules?(a(),n("div",fn,[e("div",gn,[c(e("select",{class:"form-control","onUpdate:modelValue":s[45]||(s[45]=l=>t.selected_warning=l),onChange:s[46]||(s[46]=(...l)=>t.addWarning&&t.addWarning(...l)),id:"warning-rules"},[vn,(a(!0),n(p,null,f(t.filteredWarnings,l=>(a(),n("option",{value:l},m(l.title),9,yn))),256))],544),[[w,t.selected_warning]]),kn]),(a(!0),n(p,null,f(t.botForm.warnings,(l,u)=>(a(),n("div",$n,[e("div",Fn,[e("div",wn,[c(e("input",{class:"form-check-input","onUpdate:modelValue":h=>t.botForm.warnings[u].is_active=h,type:"checkbox",id:"warning-is-active-"+u},null,8,Cn),[[g,t.botForm.warnings[u].is_active]]),e("label",{class:"form-check-label",style:{"font-size":"12px"},for:"warning-is-active-"+u},[t.botForm.warnings[u].is_active?(a(),n("span",Vn,"Включено")):(a(),n("span",Sn,"Выключено"))],8,Bn)])]),e("div",jn,[c(e("input",{type:"number",class:"form-control",placeholder:"Значение","onUpdate:modelValue":h=>t.botForm.warnings[u].rule_value=h,min:"0","aria-describedby":"bot-level-3"},null,8,Un),[[_,t.botForm.warnings[u].rule_value]]),e("label",In,m(t.getWarning(l.rule_key).title||"Не найдено"),1)]),e("button",{onClick:h=>t.removeWarning(u),type:"button",class:"input-group-text text-danger"},Mn,8,Tn)]))),256))])):d("",!0)],512),[[k,t.tab===1]]),c(e("div",Pn,[Ln,e("div",An,[e("div",En,[c(e("input",{type:"text",class:"form-control",placeholder:"id канала","aria-label":"id канала",disabled:"true","onUpdate:modelValue":s[47]||(s[47]=l=>t.botForm.order_channel=l),maxlength:"255","aria-describedby":"bot-order-channel"},null,512),[[_,t.botForm.order_channel]]),zn])]),e("div",qn,[e("div",Rn,[c(e("input",{type:"text",class:"form-control",placeholder:"id канала","aria-label":"id канала","onUpdate:modelValue":s[48]||(s[48]=l=>t.botForm.main_channel=l),maxlength:"255",disabled:"true","aria-describedby":"bot-main-channel"},null,512),[[_,t.botForm.main_channel]]),Wn])]),t.botForm.order_channel?(a(),n("div",Dn,[e("div",Jn,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[49]||(s[49]=l=>t.need_threads=l),type:"checkbox",id:"need-topics-mailing"},null,512),[[g,t.need_threads]]),Nn])])):d("",!0),t.need_threads&&t.botForm.order_channel?(a(),n("div",Hn,[Kn,e("div",Gn,[(a(!0),n(p,null,f(t.botForm.message_threads,(l,u)=>(a(),n("div",Yn,[e("div",Zn,[c(e("input",{type:"number",class:"form-control",min:"0",max:"10000",placeholder:"Идентификатор топика","onUpdate:modelValue":h=>t.botForm.message_threads[u].value=h},null,8,Qn),[[_,t.botForm.message_threads[u].value]]),e("label",Xn,m(l.title)+" ("+m(l.key)+")",1)])]))),256))]),xn,e("div",ei,[c(e("textarea",{type:"text",class:"form-control",placeholder:"Текстовое сообщение","aria-label":"Текстовое сообщение","onUpdate:modelValue":s[50]||(s[50]=l=>t.botForm.maintenance_message=l),maxlength:"255",style:{"min-height":"200px"},onInvalid:s[51]||(s[51]=l=>t.alert("Вы не ввели сообщение для технических работ бота!",3)),"aria-describedby":"bot-maintenance-message",required:""},null,544),[[_,t.botForm.maintenance_message]]),e("label",ti,[si,r(" Сообщение для режима тех.работ "),t.botForm.maintenance_message?(a(),n("small",oi," Длина текста "+m(t.botForm.maintenance_message.length),1)):d("",!0)])])])):d("",!0)],512),[[k,t.tab===2]]),c(e("div",li,[ai,e("div",ni,[e("div",ii,[c(e("input",{type:"url",class:"form-control",placeholder:"Ссылка на внешний сервис","aria-label":"ссылка на внешний сервис","onUpdate:modelValue":s[52]||(s[52]=l=>t.botForm.callback_link=l),"aria-describedby":"callback_link"},null,512),[[_,t.botForm.callback_link]]),di])])],512),[[k,t.tab===4]])]),e("div",ri,[e("div",ci,[e("div",hi,[e("div",mi,[c(e("input",{type:"text",class:"form-control",placeholder:"Токен","aria-label":"Токен","onUpdate:modelValue":s[53]||(s[53]=l=>t.botForm.bot_token=l),maxlength:"255",minlength:"40",onInvalid:s[54]||(s[54]=l=>t.alert("Вы не ввели токен бота!")),"aria-describedby":"bot-token",required:""},null,544),[[_,t.botForm.bot_token]]),ui]),e("button",{type:"submit",id:"save-bot-btn",onClick:s[55]||(s[55]=l=>t.messages=[]),disabled:!t.botForm.bot_token||t.spent_time_counter>0,title:"Сохранение бота",class:"btn btn-primary min-menu-btn w-100"},[t.spent_time_counter>0?(a(),n(p,{key:0},[r(" Осталось подождать "+m(t.spent_time_counter)+" сек. ",1)],64)):(a(),n(p,{key:1},[o.bot?(a(),n("span",pi,[fi,r(" Сохранить изменения")])):(a(),n("span",_i,"Добавить бота"))],64))],8,bi)])]),t.profile.is_admin?(a(),n("div",gi,[e("div",vi,[c(e("select",{class:"form-select",required:"",disabled:t.servers.length===0,"onUpdate:modelValue":s[56]||(s[56]=l=>t.botForm.server=l),id:"floatingSelect","aria-label":"Floating label select example"},[(a(!0),n(p,null,f(t.servers,l=>(a(),n("option",{disabled:l.disabled,value:l.key},m(l.title||"без названия")+" ("+m(l.current_count||0)+" из "+m(l.max_bot_limit||0)+") ",9,ki))),256))],8,yi),[[w,t.botForm.server]]),$i]),e("button",{onClick:s[57]||(s[57]=(...l)=>t.updateWebHook&&t.updateWebHook(...l)),disabled:o.bot==null,class:"input-group-text text-danger"},Ci,8,Fi)])):d("",!0),e("div",Bi,[e("div",Vi,[t.botForm.bot_domain?(a(),n("p",Si,"Проверить работу бота")):d("",!0),e("a",{class:"btn btn-success w-100 p-3 mb-3",href:"https://t.me/"+t.botForm.bot_domain,target:"_blank"},[Ui,r(" "+m(t.botForm.bot_domain),1)],8,ji),t.profile.is_manager?(a(),n("button",Ii,"Пополнить баланс бота ")):d("",!0),t.profile.is_admin?(a(),n(p,{key:2},[Ti,e("div",Oi,[e("div",Mi,[c(e("input",{type:"number",class:"form-control",placeholder:"Баланс","aria-label":"Баланс","onUpdate:modelValue":s[58]||(s[58]=l=>t.botForm.balance=l),min:"0",onInvalid:s[59]||(s[59]=l=>t.alert("Вы не ввели сумму баланса бота!",1)),"aria-describedby":"bot-balance",required:""},null,544),[[_,t.botForm.balance]]),Pi])]),e("div",Li,[e("div",Ai,[c(e("input",{type:"number",class:"form-control",placeholder:"Списание","aria-label":"Списание","onUpdate:modelValue":s[60]||(s[60]=l=>t.botForm.tax_per_day=l),min:"0",onInvalid:s[61]||(s[61]=l=>t.alert("Вы не ввели сумму списания бота!",1)),"aria-describedby":"bot-tax-per-day",required:""},null,544),[[_,t.botForm.tax_per_day]]),Ei])])],64)):d("",!0)])]),e("div",zi,[e("div",qi,[e("div",Ri,[e("div",Wi,[c(e("input",{class:"form-check-input",type:"checkbox",value:t.need_company_select,"onUpdate:modelValue":s[62]||(s[62]=l=>t.need_company_select=l),id:"bot-select-company"},null,8,Di),[[g,t.need_company_select]]),Ji]),t.botForm.company_id==null?(a(),n("p",{key:0,class:"alert alert-danger",onClick:s[63]||(s[63]=l=>t.need_company_select=!0)},"Внимание! Вы не выбрали клиента!")):(a(),n("p",{key:1,class:"card alert alert-success cursor-pointer",onClick:s[64]||(s[64]=l=>t.need_company_select=!0)},[r(" Выбран клиент "),t.company?(a(),n("span",Ni,"#"+m(t.company.id)+" "+m(t.company.title),1)):d("",!0)]))]),t.need_company_select?(a(),n("div",Hi,[r("s "),e("div",Ki,[t.load?d("",!0):(a(),y(O,{key:0,"is-simple":!0,selected:t.botForm.company_id,onCallback:t.companyListCallback},null,8,["selected","onCallback"]))])])):d("",!0)])])])]),e("div",Gi,[e("div",Yi,[t.messages.length>0?(a(!0),n(p,{key:0},f(t.messages,(l,u)=>(a(),n("div",Zi,[Qi,r(" "+m(l||"Ошибка")+" ",1),e("button",{type:"button",class:"btn-close",onClick:h=>t.removeMessage(u)},null,8,Xi)]))),256)):d("",!0)])])],64)):d("",!0)],32),e("div",xi,[e("div",ed,[e("div",td,[sd,e("div",od,[t.select_script_step===0?(a(),y(ee,{key:0,onSelect:s[66]||(s[66]=l=>t.selectVariant(l))})):d("",!0),t.select_script_step===1?(a(),n(p,{key:1},[ld,e("div",ad,[(a(!0),n(p,null,f(t.script_types,l=>(a(),n("div",nd,[e("div",{class:"card",onClick:u=>t.selectVariantStep2(l)},[e("div",dd,m(l.title),1)],8,id)]))),256))])],64)):d("",!0)]),rd])])])],64)}}});export{pd as _,Dt as a,no as b,ee as c};
