import{R as d}from"./ReturnToBot-97343ef5.js";import{P as u}from"./PlayerForm-869e8d18.js";import{o as a,k as i,n as e,L as r,p as c,M as l,N as m,l as p,H as f,w as g,F as b,O as y}from"./index.es-c4852431.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./custom-4bdc3e34.js";const _={key:0,class:"card card-style"},v={class:"content"},P=e("h4",null,"Правила данного задания",-1),k={key:0},D={key:1,class:"card card-style"},w={class:"content"},F={class:"card mb-0"},C={class:"card-body"},N={for:"photos",class:"photo-loader mb-2 d-flex justify-content-center align-items-center flex-column text-center w-100"},U=e("i",{class:"fa-brands fa-instagram font-36"},null,-1),j=e("p",{class:"mt-3 font-16"}," Нажмите для выбора фотографии",-1),$={key:0,class:"img-preview w-100"},B={class:"w-100 object-fit-cover"},O={class:"remove"},R=e("i",{class:"fa-regular fa-trash-can"},null,-1),L=e("div",{class:"card card-style my-3"},[e("div",{class:"content"},[e("h3",null,"Анкета участника акции"),e("p",null," Для участия в конкурсе и дальнейшего получения приза необходимо заполнить данную анкету! Укажите своё имя и номер телефона чтоб менеджер мог выдать Вам приз по итогу. ")])],-1),Q={name:"App",data(){return{rules:null,sending:!1,action:null,photo:null,hasProfileData:!1,instaForm:{comment:null,name:null,phone:null}}},computed:{canPlay(){return this.action?this.action.current_attempts<this.action.max_attempts:!1}},mounted(){this.loadServiceData().then(()=>{this.prepareUserData()})},methods:{lose(){this.$botNotification.warning("Упс!","Вы израсходовали все попытки!")},prepareUserData(){return this.$store.dispatch("instagramQuestPrepare").then(s=>{this.action=s.action,this.canPlay||this.$botNotification.warning("Упс!","Вы израсходовали все попытки!")})},loadServiceData(){return this.$store.dispatch("instagramQuestLoadData").then(s=>{this.rules=s.rules})},removePhoto(){this.photo=null},getPhoto(){return{imageUrl:URL.createObjectURL(this.photo)}},onChangePhotos(s){const t=s.target.files;this.photo=t[0]},callbackPlayerForm(s){this.instaForm={...this.instaForm,...s},this.hasProfileData=!0},submit(){let s=new FormData;Object.keys(this.instaForm).forEach(t=>{const o=this.instaForm[t]||"";typeof o=="object"?s.append(t,JSON.stringify(o)):s.append(t,o)}),s.append("photo",this.photo),this.$store.dispatch("instagramQuestResult",{instaForm:s}).then(t=>{this.sending=!1,this.instaForm={comment:null,name:null,phone:null},this.photo=null,this.hasProfileData=!1,this.$botNotification.success("Вы выиграли!","Наш менеджер свяжется с вами для дальнейших инструкций."),setTimeout(()=>{this.prepareUserData()},5e3)}).catch(t=>{})}}},A=Object.assign(Q,{setup(s){return(t,o)=>{const h=y("lazy");return a(),i(b,null,[t.rules?(a(),i("div",_,[e("div",v,[P,e("p",null,r(t.rules),1),t.canPlay?(a(),i("p",k,[c("Ваши попытки: "),e("strong",null,r(t.action.current_attempts||0),1),c(" из "),e("strong",null,r(t.action.max_attempts||1),1)])):(a(),i("p",{key:1,onClick:o[0]||(o[0]=(...n)=>t.lose&&t.lose(...n)),style:{"font-weight":"900",color:"red"}},"Вы израсходовали все ваши попытки"))])])):l("",!0),t.canPlay&&t.hasProfileData?(a(),i("div",D,[e("div",w,[e("div",F,[e("div",C,[e("label",N,[U,e("input",{type:"file",id:"photos",accept:"image/*",onChange:o[1]||(o[1]=(...n)=>t.onChangePhotos&&t.onChangePhotos(...n)),style:{display:"none"}},null,32),j]),t.photo?(a(),i("div",$,[m(e("img",B,null,512),[[h,t.getPhoto().imageUrl]]),e("div",O,[e("a",{onClick:o[2]||(o[2]=(...n)=>t.removePhoto&&t.removePhoto(...n)),class:"btn btn-m btn-full rounded-xs text-uppercase font-900 shadow-s border-danger text-danger"},[R,c(" Удалить фото")])])])):l("",!0)])]),t.photo?(a(),i("button",{key:0,onClick:o[3]||(o[3]=(...n)=>t.submit&&t.submit(...n)),type:"button",class:"btn btn-m btn-full rounded-s text-uppercase font-900 shadow-s bg-green1-light w-100 mt-2 mb-2"}," Получить приз ")):l("",!0),p(d,{class:"mb-0"})])])):l("",!0),t.canPlay&&!t.hasProfileData?(a(),f(u,{key:2,onCallback:t.callbackPlayerForm},{head:g(()=>[L]),_:1},8,["onCallback"])):l("",!0)],64)}}});export{A as default};
