import{G as $,R as B,L as j,q as l,t as n,v as e,H as i,B as p,O as h,D as d,J as m,x as g,A as c,S as y,F as f,C as k,y as _,Y as w,T as v,K as C,u as q,P as I,M as S}from"./index.es-600867a1.js";import{a as T}from"./CompanyList-a21f8da8.js";import{V as U,T as V}from"./TelegramChannelHelper-a33471ce.js";const M={class:"row"},L={key:0,class:"col-12"},O=e("p",null,[d("Для создания бота в Телеграм воспользуйтесь "),e("a",{href:"https://telegra.ph/Sozdanie-telegram-bota-02-02",class:"text-success font-bold",target:"_blank"},[e("i",{class:"fa-solid fa-triangle-exclamation mr-1"}),d("инструкцией")])],-1),E=[O],P={key:1,class:"col-12 mb-2"},W={class:"position-relative p-4 text-center text-muted bg-body border border-dashed rounded-2"},z={class:"d-flex justify-content-center mb-3"},J={alt:"",width:"100",height:"100"},N=S('<h1 class="text-body-emphasis">Создание бота</h1><p class="col-lg-8 mx-auto fs-5 text-muted"> Воспользуйся данным разделом просмотрев обучение или предложенной инструкцией. </p><div class="d-md-inline-flex d-flex flex-column flex-md-row gap-2"><a href="https://t.me/botfather" target="_blank" class="btn btn-primary text-center p-3 rounded-pill mb-0"> Создать бота в Телеграм </a><a href="https://telegra.ph/Sozdanie-telegram-bota-02-02" target="_blank" class="btn btn-outline-secondary text-center p-3 rounded-pill"> Инструкция </a></div>',3),A={class:"row d-flex justify-content-center"},D={class:"col-md-12 col-12"},R={class:"card mb-3"},G={class:"card-body"},H={class:"form-label d-flex justify-content-between",id:"bot-token"},K=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Y=e("div",null,"Взять из BotFather при создании бота! Длинная нечитаемая подсвеченная строка! ",-1),Q=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),X=e("p",null,[e("em",null,[e("small",null,"Для начала создания бота добавьте токен телеграм бота")])],-1),Z={key:0,class:"row"},x={class:"col-12"},ee={class:"nav nav-tabs justify-content-center"},te={key:1,class:"nav-item"},oe=e("a",{class:"nav-link text-secondary",href:"javascript:void(0)"},[e("i",{class:"fa-solid fa-triangle-exclamation mr-1"}),d(" Обратная связь")],-1),se=[oe],le=e("i",{class:"fa-solid fa-skull-crossbones mr-1"},null,-1),ae={class:"row py-3"},ne={class:"col-md-12 col-12"},ie={class:"form-floating mb-2"},re=["disabled","value"],de=e("label",{for:"floatingSelect"},"Выбор сервера размещения",-1),ce={class:"col-md-12 col-12"},me={class:"form-check mb-3"},be=["value"],he=e("label",{class:"form-check-label",for:"bot-select-company"}," Выбрать клиента из списка ",-1),ue={key:0,class:"font-bold"},_e={key:0,class:"col-md-12 col-12"},pe={class:"col-md-12 col-12"},ve={class:"form-check mb-3"},fe=["value"],ke=e("label",{class:"form-check-label",for:"bot-is-template"}," Сделать шаблоном ",-1),ge={key:1,class:"col-md-12 col-12"},ye={class:"mb-3"},Fe={class:"form-label",id:"bot-template-description"},we=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Ce=e("div",null,"Если Вы создаете шаблон, а не реального бота ",-1),Ve=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Ue={class:"col-md-12 col-12"},$e={class:"mb-3"},Be={class:"form-label",id:"bot-domain"},je=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),qe=e("div",null,'Строго взять из BotFather! ТО что при создании с окончанием на "bot"',-1),Ie={key:0},Se=["href"],Te={class:"col-md-12 col-12"},Me={class:"card"},Le={class:"card-body"},Oe=e("h6",null,"Настройка параметров бота в BotFather",-1),Ee={class:"mb-3"},Pe={class:"form-label d-flex justify-content-between align-items-center",id:"bot-title"},We={key:0},ze={key:0,class:"text-secondary"},Je={class:"mb-3"},Ne={class:"form-label d-flex justify-content-between align-items-center",id:"bot-short-description"},Ae={key:0,class:"text-secondary"},De=e("div",{class:"alert alert-info",role:"alert"}," Данное описание видно в момент, когда пользователь делится ссылкой на бота, а также при нажатии на иконку бота. ",-1),Re={class:"mb-3"},Ge={class:"form-label d-flex justify-content-between align-items-center",id:"bot-long-description"},He={key:0,class:"text-secondary"},Ke=e("div",{class:"alert alert-info",role:"alert"},[d(" Данное описание видно при первом запуске бота, оно должно содержать информацию о возможностях бота: "),e("ul",{class:"m-0 pl-2"},[e("li",null,"- система лояльности"),e("li",null,"- колесо фортуны"),e("li",null,"- интернет-магазин"),e("li",null,"- реферальная система")]),d(" и т.д. ")],-1),Ye={key:0,class:"col-12"},Qe=e("div",{class:"alert alert-primary",role:"alert"},[e("strong",null,"Внимание!"),d(" Отображать пользователю команду "),e("strong",{class:"text-danger"},"/adminmenu"),d(" плохая идея. Команда доступна только администраторам системы, а обычный пользователь будет видеть ошибку. Это создаст негативное восприятие от работы сервиса. ")],-1),Xe=[Qe],Ze={class:"col-5"},xe={class:"mb-3"},et=["onUpdate:modelValue","aria-describedby"],tt={class:"col-5"},ot={class:"mb-3"},st=["onUpdate:modelValue","aria-describedby"],lt={class:"col-2"},at=["onClick"],nt=e("i",{class:"fa-regular fa-trash-can"},null,-1),it=[nt],rt={class:"row"},dt={class:"col-12"},ct={key:0},mt={key:1},bt={class:"row"},ht={class:"col-12 my-2"},ut={class:"form-check"},_t=e("label",{class:"form-check-label",for:"showCode"}," Отобразить код ",-1),pt={key:0,class:"col-12 mb-3"},vt=e("label",{class:"form-label",id:"bot-domain"},"JSON-код клавиатуры",-1),ft={class:"row"},kt={class:"col-12"},gt=e("p",{class:"mb-2"},"Кнопка меню",-1),yt={class:"form-check"},Ft=e("label",{class:"form-check-label",for:"needMenuBtn"}," Нужна кнопка меню ",-1),wt={key:0,class:"col-12"},Ct=["onClick"],Vt={key:1,class:"col-6"},Ut={key:2,class:"col-6"},$t=e("div",{class:"col-12 mt-2"},[e("div",{class:"alert alert-primary",role:"alert"},[e("strong",null,"Внимание!"),d(" Внесите сумму, которую вам дал Клиент! Эта сумма будет балансом Клиента для работы бота! Укажите тариф бота - это сумма, которую система будет списывать с клиента каждый день пока баланс бота не будет равен 0. "),e("br"),e("strong",null,"Внимание!"),d(" Вы можете начислить какую-то небольшую сумму для того чтобы клиент протестировал работу бота. При достижении нулевого баланса клиент будет оповещен об этом и должен будет пополнить счёт бота! ")])],-1),Bt={class:"col-md-6 col-12"},jt={class:"mb-3"},qt={class:"form-label",id:"bot-balance"},It=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),St=e("div",null,"Начальная сумма денег на счету у конкретного бота",-1),Tt=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Mt={class:"col-md-6 col-12"},Lt={class:"mb-3"},Ot={class:"form-label",id:"bot-tax-per-day"},Et=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Pt=e("div",null,"Сумма списания денег за сутки работы бота (тариф)",-1),Wt=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),zt={class:"row py-3"},Jt={class:"col-md-6 col-12"},Nt={class:"mb-3"},At=e("label",{class:"form-label",id:"bot-level-1"},[d(" Уровень 1 CashBack, % "),e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно")],-1),Dt={class:"col-md-6 col-12"},Rt={class:"mb-3"},Gt=e("label",{class:"form-label",id:"bot-level-2"},"Уровень 2 CashBack, %",-1),Ht={class:"col-md-6 col-12"},Kt={class:"mb-3"},Yt=e("label",{class:"form-label",id:"bot-level-3"},"Уровень 3 CashBack, %",-1),Qt={class:"mb-2"},Xt={class:"form-check"},Zt=e("label",{class:"form-check-label",for:"need-cashback-fired"}," Необходимо настроить период сгорания CashBack ",-1),xt={key:0,class:"col-md-12 col-12"},eo={class:"mb-3"},to=e("label",{class:"form-label",id:"cashback-fired-period"},"Период сгорания CashBack",-1),oo=["value"],so={key:0,class:"mb-3"},lo=e("label",{class:"form-label",id:"cashback-fired-level"},"Уровень сгорания CashBack, %",-1),ao={class:"col-md-12 col-12"},no={class:"mb-3"},io=e("label",{class:"form-label",id:"cashback-max_cashback_use_percent"}," Автоматическое списание CashBack при покупке, % от цены товара",-1),ro={class:"col-12 mb-2"},co={class:"form-check"},mo=e("label",{class:"form-check-label",for:"need-payments"}," Необходимо подключить платежную систему ",-1),bo={key:1,class:"col-md-12 col-12"},ho={class:"form-check mb-3 ml-3"},uo=["value"],_o=e("label",{class:"form-check-label",for:"bot-auto-cashback-on-payments"}," Начислять CashBack автоматически после успешной оплаты ",-1),po={class:"mb-3"},vo=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),fo=e("div",null,"Если в боте планируется оплата, то необходимо через BotFather привязать нужную платежную систему и указать в данном поле полученный токен ",-1),ko=e("label",{class:"form-label",id:"payment_provider_token"},[d("Токен платежной системы "),e("a",{href:"https://t.me/botfather",target:"_blank"},"Подключить")],-1),go={class:"col-12 mb-2"},yo={class:"form-check"},Fo=e("label",{class:"form-check-label",for:"need-shop"}," Необходимо интегрировать магазин в бота ",-1),wo={key:2,class:"col-md-12 col-12"},Co={class:"mb-3"},Vo=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Uo=e("div",null,"Ссылка на страницу ВК с товарами для вашего магазина в боте ",-1),$o=e("label",{class:"form-label",id:"bot-vk_shop_link"},[d("Ссылка на группу ВК с товарами "),e("a",{href:"https://vk.com/groups?w=groups_create",target:"_blank"},"Создать")],-1),Bo={class:"mb-2"},jo={class:"form-check"},qo=e("label",{class:"form-check-label",for:"need-cashback-config"}," Необходимо настроить CashBack по категориям ",-1),Io={key:3,class:"mb-2"},So=e("h6",null,"Настройка категорий CashBack-а",-1),To={class:"d-flex justify-content-between align-items-center w-100"},Mo=e("small",null,"Название категории",-1),Lo=["onClick"],Oo=e("i",{class:"fa-regular fa-trash-can"},null,-1),Eo=[Oo],Po=["onUpdate:modelValue","aria-describedby"],Wo=e("div",{class:"alert alert-primary",role:"alert"}," Категории CashBack - это возможность разделить накопления и траты CashBack пользователями бота на указанные цели, например, кофейня может создать категории: на кофе, на десерты - и начислять баллы за купленный кофе отдельно от баллов за купленный десерт ",-1),zo=e("div",{class:"divider divider-small my-3 bg-highlight"},null,-1),Jo={class:"mb-2"},No={class:"form-check"},Ao=e("label",{class:"form-check-label",for:"need-cashback-rules"}," Необходимо настроить оповещения под CashBack ",-1),Do={key:4,class:"col-md-12 col-12 mb-2"},Ro={class:"card border-warning"},Go={class:"card-body"},Ho={class:"form-group"},Ko=e("label",{class:"form-check-label",for:"warning-rules"},[e("i",{class:"fa-solid fa-triangle-exclamation text-danger"}),d(" Правила критических оповещений ")],-1),Yo=e("option",{value:null},"Не выбрано",-1),Qo=["value"],Xo={class:"card my-2 p-2"},Zo={class:"row"},xo={class:"col-md-4 d-flex align-items-center"},es={class:"m-0"},ts={class:"col-md-2"},os={class:"form-check"},ss=["onUpdate:modelValue","id"],ls=["for"],as={key:0},ns={key:1},is={class:"col-md-5"},rs=["onUpdate:modelValue"],ds={class:"col-md-1 d-flex justify-content-center"},cs=["onClick"],ms=e("i",{class:"fa-solid fa-trash-can"},null,-1),bs=[ms],hs={class:"row py-3"},us=e("div",{class:"col-12"},[e("div",{class:"alert alert-primary",role:"alert"},[e("strong",null,"Внимание!"),d(" Для того чтобы узнать ID канала сперва создайте Канал или Группу в телеграм, добавьте в него вашего "),e("strong",null,"сохраненного бота"),d(', назначьте бота администратором Канала или Группы, а только после этого впишите команду "Мой id" в бота. ')])],-1),_s={class:"col-md-6 col-12"},ps={class:"mb-3"},vs={class:"d-flex justify-content-between align-items-center"},fs={class:"form-label d-flex justify-content-between",id:"bot-order-channel"},ks=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),gs=e("div",null,"Ввести адрес ссылки на канал в форму после добавления тоукена ",-1),ys=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Fs={class:"col-md-6 col-12"},ws={class:"mb-3"},Cs={class:"d-flex justify-content-between"},Vs=e("label",{class:"form-label",id:"bot-main-channel"},"Канал для постов (id,рекламный)",-1),Us={key:0,class:"col-12"},$s=e("div",{class:"alert alert-primary",role:"alert"},[e("strong",null,"Внимание!"),d(' Топики работают только в Группах телеграм с включенным режимом "Топики" в настройках Группы! В каналах топиков нет. ')],-1),Bs=[$s],js={key:1,class:"col-12 mb-2"},qs={class:"form-check"},Is=e("label",{class:"form-check-label",for:"need-topics-mailing"}," Необходимо добавить рассылку по топикам для канала заказов (он же системный канал) ",-1),Ss={key:2,class:"col-12 mb-2"},Ts={class:"d-flex justify-content-between align-items-center mb-2"},Ms=e("p",null,'Для того, чтоб узнать идентификатор топика в группе впишите в чат "Мой id"',-1),Ls=["disabled"],Os=e("i",{class:"fa-solid fa-paperclip mr-2"},null,-1),Es={class:"list-group"},Ps={class:"list-group-item"},Ws={class:"mb-0"},zs=["onUpdate:modelValue"],Js={class:"row py-3"},Ns={class:"col-12"},As={class:"mb-3"},Ds={class:"d-flex justify-content-between"},Rs={class:"form-label",id:"bot-maintenance-message"},Gs=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Hs={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},Ks={class:"row py-3"},Ys=e("div",{class:"col-12"},[e("div",{class:"alert alert-primary",role:"alert"}," Системная иконка нужна только для красивого отображения и узнаваемости бота на Landing-е системы. ")],-1),Qs={class:"col-12 mb-3"},Xs=e("h6",null,[d("Системная иконка бота "),e("span",{class:"badge rounded-pill text-bg-warning m-0"},"желательно")],-1),Zs={class:"photo-preview d-flex justify-content-center flex-wrap w-100"},xs={key:0,for:"bot-photos",style:{"margin-right":"10px"},class:"photo-loader ml-2 bg-primary text-white shadow-md"},el=e("span",null,"+",-1),tl={class:"mb-2 img-preview",style:{"margin-right":"10px"}},ol={class:"remove"},sl=e("i",{class:"fa-regular fa-trash-can"},null,-1),ll=[sl],al={key:2,class:"mb-2 img-preview",style:{"margin-right":"10px"}},nl={class:"remove"},il=e("i",{class:"fa-regular fa-trash-can"},null,-1),rl=[il],dl=e("div",{class:"col-12"},[e("div",{class:"alert alert-primary",role:"alert"},' Внешний сервис находится в эксперементальном режиме. Он нужен для связывания команд (страниц) бота с программой Клиента (если есть такая необходимость). Если на странице бота выбрано "внешнее управление", то все запросы будут переадесрованы на указанную ниже ссылку. ')],-1),cl={class:"col-md-12 col-12"},ml={class:"mb-3"},bl=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),hl=e("div",null,"Ссылка на внешний сервис обработки данных ",-1),ul=e("label",{class:"form-label",id:"callback_link"},"Ссылка на внешний сервис обработки данных ",-1),_l={class:"row py-3"},pl=e("div",{class:"col-12"},[e("div",{class:"alert alert-danger",role:"alert"}," Внимание! Данный блок настроек больше не поддерживается и со временем эти настройки будут удалены из системы. ")],-1),vl={class:"col-12"},fl={class:"mb-3"},kl={class:"d-flex justify-content-between"},gl={class:"form-label",id:"bot-description"},yl=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Fl=e("div",null,"Отобразится пользователю при первом запуске",-1),wl=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Cl={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},Vl={class:"col-12"},Ul={class:"mb-3"},$l={class:"d-flex justify-content-between"},Bl={class:"form-label",id:"bot-description"},jl=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),ql=e("div",null,'Для меню "О Боте"',-1),Il=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Sl={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},Tl={class:"col-12"},Ml={class:"card mb-3"},Ll=e("div",{class:"card-header"},[e("h6",null,[d("Информационная ссылка: создайте контент в "),e("a",{target:"_blank",href:"https://telegra.ph"},"https://telegra.ph")])],-1),Ol={class:"card-body"},El=e("div",{class:"row"},[e("div",{class:"col-12"},[e("h6",null,"Ссылка")])],-1),Pl={class:"row"},Wl={class:"col-12"},zl={class:"mb-3"},Jl={class:"col-12"},Nl={class:"card mb-3"},Al=e("div",{class:"card-header"},[e("h6",null,"Ссылки на соц. сети")],-1),Dl={class:"card-body"},Rl=e("div",{class:"row"},[e("div",{class:"col-12"},[e("h6",null,"Ссылка")])],-1),Gl={class:"col-5"},Hl={class:"mb-3"},Kl=["onUpdate:modelValue","aria-describedby"],Yl={class:"col-5"},Ql={class:"mb-3"},Xl=["onUpdate:modelValue","aria-describedby"],Zl={class:"col-2"},xl=["onClick"],ea=e("i",{class:"fa-regular fa-trash-can"},null,-1),ta=[ea],oa={class:"row"},sa={class:"col-12"},la={key:1,class:"row"},aa={class:"col-12"},na={class:"alert alert-danger alert-dismissible fade show",role:"alert"},ia=e("strong",null,"Внимание!",-1),ra=["onClick"],da={class:"col-12 col-md-12"},ca=["disabled"],ma={key:0},ba={key:1},ha={key:2,class:"ml-2"},ua={components:{Vue3JsonEditor:U},props:["bot"],data(){return{loadCommandEditor:!0,menu_variants:[{title:"Открыть меню",url:"/bot-client/simple/{0}?slug={скрипт_id}#/s/menu"}],showCode:!1,tab:0,spent_time_counter:0,can_create:!0,can_create_topics:!0,messages:[],servers:[],need_company_select:!1,selected_warning:null,page:null,step:0,templates:[],load:!1,loadPage:!1,needPageListUpdate:!1,need_threads:!1,need_company:!1,need_cashback_config:!1,need_cashback_rules:!1,need_cashback_fired:!1,need_payments:!1,need_shop:!1,command:null,company:null,warnings:[{title:"Сумма чека больше чем",key:"bill_sum_more_then"},{title:"Сумма начисления кэшбэка больше чем",key:"cashback_up_sum_more_then"},{title:"Сумма списания кэшбэка больше чем",key:"cashback_down_sum_more_then"}],cashback_fire_periods:[{title:"Не сгорает",value:0},{title:"7 дней",value:7},{title:"15 дней",value:15},{title:"30 дней",value:30},{title:"60 дней",value:60},{title:"60 дней",value:90},{title:"120 дней",value:120},{title:"180 дней",value:180},{title:"360 дней",value:360}],needMenuBtn:!1,botForm:{title:"Название бота",short_description:"Описание в шапке бота",long_description:"Описание при первом запуске бота",is_template:!1,auto_cashback_on_payments:!1,template_description:null,bot_domain:null,bot_token:null,company_id:null,creator_id:null,bot_token_dev:null,order_channel:null,message_threads:null,cashback_config:null,server:"main",main_channel:null,vk_shop_link:null,callback_link:null,balance:70,tax_per_day:10,welcome_message:"Приветствую!",image:null,cashback_fire_percent:0,cashback_fire_period:0,max_cashback_use_percent:0,description:"Это ваш бот! Вот такое вот описание у него.",info_link:null,social_links:[],maintenance_message:"Технические работы",payment_provider_token:null,level_1:10,level_2:0,level_3:0,photos:[],commands:null,menu:{text:null,url:null},selected_bot_template_id:null,pages:[],amo:null,warnings:[]}}},watch:{"botForm.bot_token":{handler(a){this.botForm.bot_token&&this.getMe()},deep:!0},need_threads:function(a,t){let o=[{title:"Отзывы",key:"reviews",value:null},{title:"Начисление cashback",key:"cashback",value:null},{title:"Вопросы",key:"questions",value:null},{title:"Конкурсы",key:"actions",value:null},{title:"Заказы",key:"orders",value:null},{title:"Вывод средств",key:"ask-money",value:null},{title:"Доставка",key:"delivery",value:null},{title:"Ответы",key:"response",value:null},{title:"Обратная связь",key:"callback",value:null}];this.need_threads&&!this.botForm.message_threads&&(this.botForm.message_threads=o),this.need_threads&&this.botForm.message_threads&&o.forEach(u=>{this.botForm.message_threads.findIndex(s=>s.key===u.key)===-1&&this.botForm.message_threads.push(u)})},need_payments:function(a,t){this.need_payments||(this.botForm.auto_cashback_on_payments=!1)}},computed:{...$(["getSlugs","getCurrentCompany"]),canOpenForm(){return!(!this.botForm.bot_token||this.botForm.bot_token.length<40)},filteredWarnings(){return this.botForm.warnings.length===0?this.warnings:this.warnings.filter(a=>!(this.botForm.warnings.findIndex(t=>t.rule_key===a.key)>=0))}},mounted(){if(this.loadCurrentServers(),localStorage.getItem("cashman_admin_bot_creator_counter")!=null){this.can_create=!1;let a=localStorage.getItem("cashman_admin_bot_creator_counter");this.startTimer(a==="null"||a==null?0:a)}window.addEventListener("store_current_company-change-event",a=>{this.company=this.getCurrentCompany}),window.addEventListener("add-payment-system-event",a=>{this.tab=1,this.need_payments=!0,this.$nextTick(()=>{let t=document.querySelector("#payment_provider_token-input");t.classList="form-control border-danger",t.focus(),setTimeout(()=>{let o=document.querySelector("#payment_provider_token-input");o.classList="form-control"},5e3)})}),this.bot?this.$nextTick(()=>{this.botForm={id:this.bot.id||null,title:this.bot.title||"",short_description:this.bot.short_description||"",long_description:this.bot.long_description||"",is_template:this.bot.is_template||!1,auto_cashback_on_payments:this.bot.auto_cashback_on_payments||!1,template_description:this.bot.template_description||null,bot_domain:this.bot.bot_domain||null,bot_token:this.bot.bot_token||null,bot_token_dev:this.bot.bot_token_dev||null,order_channel:this.bot.order_channel||null,message_threads:this.bot.message_threads||null,cashback_config:this.bot.cashback_config||null,main_channel:this.bot.main_channel||null,balance:this.bot.balance||null,server:this.bot.server||"main",tax_per_day:this.bot.tax_per_day||null,vk_shop_link:this.bot.vk_shop_link||null,callback_link:this.bot.callback_link||null,cashback_fire_percent:this.bot.cashback_fire_percent||0,cashback_fire_period:this.bot.cashback_fire_period||0,max_cashback_use_percent:this.bot.max_cashback_use_percent||0,image:this.bot.image||null,description:this.bot.description||null,creator_id:this.bot.creator_id||null,info_link:this.bot.info_link||null,social_links:this.bot.social_links||[],maintenance_message:this.bot.maintenance_message||null,welcome_message:this.bot.welcome_message||null,payment_provider_token:this.bot.payment_provider_token||null,level_1:this.bot.level_1,level_2:this.bot.level_2,level_3:this.bot.level_3,company_id:this.bot.company_id,commands:this.bot.commands||null,photos:this.bot.photos||[],warnings:this.bot.warnings||[],amo:this.bot.amo||null,menu:{text:null,url:null}},Array.isArray(this.botForm.commands)||(this.botForm.commands=[]),this.botForm.menu=this.bot.menu||{text:null,url:null},this.botForm.menu.url!==null&&(this.needMenuBtn=!0),this.botForm.commands==null&&this.autoAddCommands(),this.botForm.message_threads&&(this.need_threads=!0),this.botForm.payment_provider_token&&(this.need_payments=!0),(this.botForm.cashback_config||[]).length>0&&(this.need_cashback_config=!0),this.botForm.warnings.length>0&&(this.need_cashback_rules=!0),this.botForm.cashback_fire_period>0&&(this.need_cashback_fired=!0),this.bot.company&&(this.company=this.bot.company)}):this.botForm.commands==null&&this.autoAddCommands()},methods:{autoAddCommands(){this.botForm.commands=[{command:"/start",description:"начни с этой команды"},{command:"/admins",description:"доступные администраторы в системе"},{command:"/help",description:"как использовать систему"},{command:"/about",description:"о CashMan"}]},startTimer(a){this.spent_time_counter=a!=null?Math.min(a,10):10;let t=setInterval(()=>{this.spent_time_counter>0?this.spent_time_counter--:(clearInterval(t),this.can_create=!0,this.spent_time_counter=null),localStorage.setItem("cashman_admin_bot_creator_counter",this.spent_time_counter)},1e3)},alert(a,t=null){t!=null&&(this.tab=t),this.messages.push(a)},removeMessage(a){this.messages.splice(a,1)},createBotTopics(){this.can_create_topics=!1,this.$store.dispatch("createBotTopics",{dataObject:{topics:this.botForm.message_threads,bot_id:this.bot.id}}).then(a=>{this.botForm.message_threads=a.data,this.$notify({title:"Конструктор ботов",text:"Топики успешно созданы!",type:"success"})}).catch(()=>{this.can_create_topics=!0,this.$notify({title:"Конструктор ботов",text:"Ошибка создания топиков",type:"error"})})},getMe(){let a=this.botForm.bot_token||"";a.length<40||this.$store.dispatch("getMe",{bot_token:a}).then(t=>{let o=t.username||null,u=t.first_name||null;o&&(this.botForm.bot_domain=o),u&&(this.botForm.title=u)})},getChatLink(a){this.$store.dispatch("loadChatInfo",{dataObject:{chat_id:a,bot_id:this.bot.id}}).then(t=>{console.log("chat info",t)})},addTextTo(a={param:null,text:null}){this.botForm[a.param]=a.text},removeCommands(a){this.botForm.commands.splice(a,1),this.loadCommandEditor=!1,this.$nextTick(()=>{this.loadCommandEditor=!0})},addCommands(){this.botForm.commands||(this.botForm.commands=[]),this.botForm.commands.push({command:null,description:null}),this.loadCommandEditor=!1,this.$nextTick(()=>{this.loadCommandEditor=!0})},loadCurrentServers(){this.$store.dispatch("loadCurrentServers").then(a=>{this.servers=a})},getPhoto(a){return{imageUrl:URL.createObjectURL(a)}},onChangePhotos(a){const t=a.target.files;this.botForm.image=null;for(let o=0;o<t.length;o++)this.botForm.photos=[t[o]]},addItem(a){this.botForm[a].push("")},addSocialLinks(){this.botForm.social_links.push({title:null,url:null})},removeItem(a,t){this.botForm[a].splice(t,1)},removePhoto(){this.botForm.photos=[],this.botForm.image=null},addBot(){let a=new FormData;Object.keys(this.botForm).forEach(t=>{const o=this.botForm[t]||"";typeof o=="object"?a.append(t,JSON.stringify(o)):a.append(t,o)}),this.company&&a.append("company_id",this.company.id);for(let t=0;t<this.botForm.photos.length;t++)a.append("images[]",this.botForm.photos[t]);a.delete("photos"),this.$store.dispatch(this.bot==null?"createBot":"updateBot",{botForm:a}).then(t=>{let o=t.data;this.$emit("callback",o),this.$notify({title:"Конструктор ботов",text:this.bot==null?"Бот успешно создан!":"Бот успешно обновлен!",type:"success"}),this.startTimer(),this.can_create=!1,this.$store.dispatch("updateBotWebhook",{dataObject:{bot_id:o.id}}).catch(u=>{this.alert(u.response.data.message)}),this.bot==null&&(this.botForm={title:"",server:"main",short_description:"",long_description:"",is_template:!1,auto_cashback_on_payments:!1,template_description:null,bot_domain:null,bot_token:null,bot_token_dev:null,order_channel:null,message_threads:null,main_channel:null,balance:null,tax_per_day:null,callback_link:null,cashback_fire_percent:0,cashback_fire_period:0,max_cashback_use_percent:0,image:null,description:null,info_link:null,social_links:[],maintenance_message:null,payment_provider_token:null,level_1:10,level_2:0,level_3:0,photos:[],warnings:[],selected_bot_template_id:null,pages:[]})}).catch(t=>{this.alert(t.response.data.message),this.$notify({title:"Конструктор ботов",text:"Ошибочка...",type:"error"})})},onJsonChange(a){this.botForm.commands=a},removeCashBackConfig(a){this.botForm.cashback_config.splice(a,1)},addCashBackConfig(){this.botForm.cashback_config=this.botForm.cashback_config==null?[]:this.botForm.cashback_config,this.botForm.cashback_config.push({title:null})},getWarning(a){let t=this.warnings.find(o=>o.key===a);return t||{title:"Не найдено"}},removeWarning(a){this.botForm.warnings.splice(a,1)},companyListCallback(a){this.load=!0,this.company=a,this.botForm.company_id=a.id,this.need_company_select=!1,this.$nextTick(()=>{this.load=!1})},selectVariant(a){String.format=function(){let t=arguments[0];for(let o=0;o<arguments.length-1;o++){let u=new RegExp("\\{"+o+"\\}","gm");t=t.replace(u,arguments[o+1])}return t},this.botForm.menu.text=a.title||"Меню",this.botForm.menu.url="https://rep2u.ru"+String.format(a.url,this.bot.bot_domain||"домен_бота")},addWarning(){const a=this.selected_warning;this.botForm.warnings.push({rule_key:a.key,rule_value:0,is_active:!0}),this.selected_warning=null}}},fa=Object.assign(ua,{__name:"BotForm",setup(a){return(t,o)=>{const u=B("Popper"),F=j("lazy");return l(),n("form",{class:"mb-5",onSubmit:o[74]||(o[74]=I((...s)=>t.addBot&&t.addBot(...s),["prevent"]))},[e("div",M,[(t.botForm.id||null)!=null?(l(),n("div",L,E)):(l(),n("div",P,[e("div",W,[e("div",z,[i(e("img",J,null,512),[[F,"../images/icon.png"]])]),N])]))]),e("div",A,[e("div",D,[e("div",R,[e("div",G,[e("label",H,[e("div",null,[p(u,null,{content:h(()=>[Y]),default:h(()=>[K]),_:1}),d(" Токен бота "),Q])]),i(e("input",{type:"text",class:"form-control",placeholder:"Токен","aria-label":"Токен","onUpdate:modelValue":o[0]||(o[0]=s=>t.botForm.bot_token=s),maxlength:"255",minlength:"40",onInvalid:o[1]||(o[1]=s=>t.alert("Вы не ввели токен бота!")),"aria-describedby":"bot-token",required:""},null,544),[[m,t.botForm.bot_token]]),X])])])]),t.canOpenForm?(l(),n("div",Z,[e("div",x,[e("ul",ee,[e("li",{class:"nav-item",onClick:o[2]||(o[2]=s=>t.tab=0)},[e("a",{class:g(["nav-link",{active:t.tab===0}]),href:"javascript:void(0)"},"Базовые настройки",2)]),e("li",{class:"nav-item",onClick:o[3]||(o[3]=s=>t.tab=1)},[e("a",{class:g(["nav-link",{active:t.tab===1}]),href:"javascript:void(0)"},"Кэшбэк&Финансы",2)]),t.botForm.id!=null?(l(),n("li",{key:0,class:"nav-item",onClick:o[4]||(o[4]=s=>t.tab=2)},[e("a",{class:g(["nav-link",{active:t.tab===2}]),href:"javascript:void(0)"},"Обратная связь",2)])):c("",!0),t.botForm.id==null?(l(),n("li",te,se)):c("",!0),e("li",{class:"nav-item",onClick:o[5]||(o[5]=s=>t.tab=3)},[e("a",{class:g(["nav-link",{active:t.tab===3}]),href:"javascript:void(0)"},"Сообщения",2)]),e("li",{class:"nav-item",onClick:o[6]||(o[6]=s=>t.tab=4)},[e("a",{class:g(["nav-link",{active:t.tab===4}]),href:"javascript:void(0)"},"Другие настройки",2)]),e("li",{class:"nav-item",onClick:o[7]||(o[7]=s=>t.tab=5)},[e("a",{class:g(["nav-link text-danger",{active:t.tab===5}]),href:"javascript:void(0)"},[le,d(" Устаревшие настройки")],2)])])])])):c("",!0),i(e("div",ae,[e("div",ne,[e("div",ie,[i(e("select",{class:"form-select",required:"","onUpdate:modelValue":o[8]||(o[8]=s=>t.botForm.server=s),id:"floatingSelect","aria-label":"Floating label select example"},[(l(!0),n(f,null,k(t.servers,s=>(l(),n("option",{disabled:s.disabled,value:s.key},_(s.title||"без названия")+" ("+_(s.current_count||0)+" из "+_(s.max_bot_limit||0)+") ",9,re))),256))],512),[[w,t.botForm.server]]),de])]),e("div",ce,[e("div",me,[i(e("input",{class:"form-check-input",type:"checkbox",value:t.need_company_select,"onUpdate:modelValue":o[9]||(o[9]=s=>t.need_company_select=s),id:"bot-select-company"},null,8,be),[[v,t.need_company_select]]),he]),t.botForm.company_id==null?(l(),n("p",{key:0,class:"alert alert-danger",onClick:o[10]||(o[10]=s=>t.need_company_select=!0)},"Внимание! Вы не выбрали клиента!")):(l(),n("p",{key:1,class:"card alert alert-success cursor-pointer",onClick:o[11]||(o[11]=s=>t.need_company_select=!0)},[d(" Выбран клиент "),t.company?(l(),n("span",ue,"#"+_(t.company.id)+" "+_(t.company.title),1)):c("",!0)]))]),t.need_company_select?(l(),n("div",_e,[t.load?c("",!0):(l(),C(T,{key:0,selected:t.botForm.company_id,onCallback:t.companyListCallback},null,8,["selected","onCallback"]))])):c("",!0),e("div",pe,[e("div",ve,[i(e("input",{class:"form-check-input",type:"checkbox",value:t.botForm.is_template||!1,"onUpdate:modelValue":o[12]||(o[12]=s=>t.botForm.is_template=s),id:"bot-is-template"},null,8,fe),[[v,t.botForm.is_template]]),ke])]),t.botForm.is_template?(l(),n("div",ge,[e("div",ye,[e("label",Fe,[p(u,null,{content:h(()=>[Ce]),default:h(()=>[we]),_:1}),d(" Название шаблона бота "),Ve]),i(e("input",{type:"text",class:"form-control",placeholder:"Название \\ описание шаблона","aria-label":"Описание шаблона","onUpdate:modelValue":o[13]||(o[13]=s=>t.botForm.template_description=s),maxlength:"255",onInvalid:o[14]||(o[14]=s=>t.alert("Вы не ввели название шаблона!")),"aria-describedby":"bot-template-description",required:""},null,544),[[m,t.botForm.template_description]])])])):c("",!0),e("div",Ue,[e("div",$e,[e("label",Be,[p(u,null,{content:h(()=>[qe]),default:h(()=>[je]),_:1}),d(" Доменное имя бота (загружается автоматически) ")]),i(e("input",{type:"text",class:"form-control",placeholder:"Имя бота","aria-label":"Имя бота",disabled:!0,name:"bot_domain",onInvalid:o[15]||(o[15]=s=>t.alert("Вы не ввели доменное имя бота!",0)),"onUpdate:modelValue":o[16]||(o[16]=s=>t.botForm.bot_domain=s),maxlength:"255","aria-describedby":"bot-domain",required:""},null,544),[[m,t.botForm.bot_domain]]),t.botForm.bot_domain?(l(),n("p",Ie,[d("Проверить работу бота "),e("a",{href:"https://t.me/"+t.botForm.bot_domain,target:"_blank"},"@"+_(t.botForm.bot_domain),9,Se)])):c("",!0)])]),e("div",Te,[e("div",Me,[e("div",Le,[Oe,e("div",Ee,[e("label",Pe,[t.botForm.title?(l(),n("span",We,[d(" Название бота "),t.botForm.title.length>0?(l(),n("small",ze,"Длина текста "+_(t.botForm.title.length)+"/64",1)):c("",!0)])):c("",!0)]),i(e("input",{type:"text",class:"form-control",placeholder:"Текст названия","aria-label":"Текст названия","onUpdate:modelValue":o[17]||(o[17]=s=>t.botForm.title=s),maxlength:"64","aria-describedby":"bot-title"},null,512),[[m,t.botForm.title]])]),e("div",Je,[e("label",Ne,[e("span",null,[d(" Описание в шапке бота "),t.botForm.short_description.length>0?(l(),n("small",Ae,"Длина текста "+_(t.botForm.short_description.length)+"/105",1)):c("",!0)])]),De,i(e("textarea",{class:"form-control",placeholder:"Описание в шапке бота","aria-label":"Описание в шапке бота","onUpdate:modelValue":o[18]||(o[18]=s=>t.botForm.short_description=s),maxlength:"105","aria-describedby":"bot-short-description"},`
                                `,512),[[m,t.botForm.short_description]])]),e("div",Re,[e("label",Ge,[e("span",null,[d(" Описание возможностей бота "),t.botForm.long_description.length>0?(l(),n("small",He,"Длина текста "+_(t.botForm.long_description.length)+"/505",1)):c("",!0)])]),Ke,i(e("textarea",{class:"form-control",placeholder:"Описание возможностей бота","aria-label":"Описание возможностей бота","onUpdate:modelValue":o[19]||(o[19]=s=>t.botForm.long_description=s),maxlength:"505","aria-describedby":"bot-long-description"},`
                                `,512),[[m,t.botForm.long_description]])]),(l(!0),n(f,null,k(t.botForm.commands,(s,r)=>(l(),n("div",{class:"row",key:"commands-"+r},[t.botForm.commands[r].command==="/adminmenu"?(l(),n("div",Ye,Xe)):c("",!0),e("div",Ze,[e("div",xe,[i(e("input",{type:"text",class:"form-control",placeholder:"Название команды","aria-label":"Название команды",maxlength:"255",onInvalid:o[20]||(o[20]=b=>t.alert("Вы не ввели название команды",0)),"onUpdate:modelValue":b=>t.botForm.commands[r].command=b,"aria-describedby":"bot-command-"+r,required:""},null,40,et),[[m,t.botForm.commands[r].command]])])]),e("div",tt,[e("div",ot,[i(e("input",{type:"text",class:"form-control",placeholder:"Описание команды","aria-label":"Описание команды",maxlength:"255",onInvalid:o[21]||(o[21]=b=>t.alert("Вы не ввели описание команды!",0)),"onUpdate:modelValue":b=>t.botForm.commands[r].description=b,"aria-describedby":"bot-command-description-"+r,required:""},null,40,st),[[m,t.botForm.commands[r].description]])])]),e("div",lt,[e("button",{type:"button",onClick:b=>t.removeCommands(r),class:"btn btn-outline-danger w-100"},it,8,at)])]))),128)),e("div",rt,[e("div",dt,[e("button",{type:"button",onClick:o[22]||(o[22]=s=>t.addCommands()),class:"btn btn-outline-success w-100"},[(t.botForm.commands||[]).length>0?(l(),n("span",ct," Добавить еще команду")):(l(),n("span",mt," Добавить системное меню"))])])]),e("div",bt,[e("div",ht,[e("div",ut,[i(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":o[23]||(o[23]=s=>t.showCode=s),id:"showCode"},null,512),[[v,t.showCode]]),_t])]),t.showCode?(l(),n("div",pt,[vt,t.loadCommandEditor?(l(),C(q(U),{key:0,mode:"code",modelValue:t.botForm.commands,"onUpdate:modelValue":o[24]||(o[24]=s=>t.botForm.commands=s),"show-btns":!1,expandedOnStart:!0,onJsonChange:t.onJsonChange},null,8,["modelValue","onJsonChange"])):c("",!0)])):c("",!0)]),e("div",ft,[e("div",kt,[gt,e("div",yt,[i(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":o[25]||(o[25]=s=>t.needMenuBtn=s),id:"needMenuBtn"},null,512),[[v,t.needMenuBtn]]),Ft])]),t.needMenuBtn?(l(),n("div",wt,[(l(!0),n(f,null,k(t.menu_variants,s=>(l(),n("span",{onClick:r=>t.selectVariant(s),class:"badge bg-primary mb-2 btn"},_(s.title||"Выбрать"),9,Ct))),256))])):c("",!0),t.needMenuBtn?(l(),n("div",Vt,[i(e("input",{type:"text",class:"form-control",placeholder:"Текст кнопки меню","aria-label":"Текст кнопки меню",maxlength:"255",onInvalid:o[26]||(o[26]=s=>t.alert("Текст кнопки меню!",0)),"onUpdate:modelValue":o[27]||(o[27]=s=>t.botForm.menu.text=s),required:""},null,544),[[m,t.botForm.menu.text]])])):c("",!0),t.needMenuBtn?(l(),n("div",Ut,[i(e("input",{type:"url",class:"form-control",placeholder:"Адрес перехода URL","aria-label":"Адрес перехода URL",maxlength:"255",onInvalid:o[28]||(o[28]=s=>t.alert("Вы не ввели адрес меню!",0)),"onUpdate:modelValue":o[29]||(o[29]=s=>t.botForm.menu.url=s),required:""},null,544),[[m,t.botForm.menu.url]])])):c("",!0)])])])]),$t,e("div",Bt,[e("div",jt,[e("label",qt,[p(u,null,{content:h(()=>[St]),default:h(()=>[It]),_:1}),d(" Баланс бота, руб "),Tt]),i(e("input",{type:"number",class:"form-control",placeholder:"Баланс","aria-label":"Баланс","onUpdate:modelValue":o[30]||(o[30]=s=>t.botForm.balance=s),min:"0",onInvalid:o[31]||(o[31]=s=>t.alert("Вы не ввели сумму баланса бота!",1)),"aria-describedby":"bot-balance",required:""},null,544),[[m,t.botForm.balance]])])]),e("div",Mt,[e("div",Lt,[e("label",Ot,[p(u,null,{content:h(()=>[Pt]),default:h(()=>[Et]),_:1}),d(" Списание за сутки, руб "),Wt]),i(e("input",{type:"number",class:"form-control",placeholder:"Списание","aria-label":"Списание","onUpdate:modelValue":o[32]||(o[32]=s=>t.botForm.tax_per_day=s),min:"0",onInvalid:o[33]||(o[33]=s=>t.alert("Вы не ввели сумму списания бота!",1)),"aria-describedby":"bot-tax-per-day",required:""},null,544),[[m,t.botForm.tax_per_day]])])])],512),[[y,t.tab===0&&t.canOpenForm]]),i(e("div",zt,[e("div",Jt,[e("div",Nt,[At,i(e("input",{type:"number",class:"form-control",placeholder:"%","aria-label":"уровень CashBack","onUpdate:modelValue":o[34]||(o[34]=s=>t.botForm.level_1=s),min:"0",onInvalid:o[35]||(o[35]=s=>t.alert("Вы не ввели значение кэшбэка 1 уровня бота!",1)),"aria-describedby":"bot-level-1",required:""},null,544),[[m,t.botForm.level_1]])])]),e("div",Dt,[e("div",Rt,[Gt,i(e("input",{type:"number",class:"form-control",placeholder:"%","aria-label":"уровень CashBack","onUpdate:modelValue":o[36]||(o[36]=s=>t.botForm.level_2=s),min:"0","aria-describedby":"bot-level-2"},null,512),[[m,t.botForm.level_2]])])]),e("div",Ht,[e("div",Kt,[Yt,i(e("input",{type:"number",class:"form-control",placeholder:"%","aria-label":"уровень CashBack","onUpdate:modelValue":o[37]||(o[37]=s=>t.botForm.level_3=s),min:"0","aria-describedby":"bot-level-3"},null,512),[[m,t.botForm.level_3]])])]),e("div",Qt,[e("div",Xt,[i(e("input",{class:"form-check-input","onUpdate:modelValue":o[38]||(o[38]=s=>t.need_cashback_fired=s),type:"checkbox",id:"need-cashback-fired"},null,512),[[v,t.need_cashback_fired]]),Zt])]),t.need_cashback_fired?(l(),n("div",xt,[e("div",eo,[to,i(e("select",{class:"form-control","onUpdate:modelValue":o[39]||(o[39]=s=>t.botForm.cashback_fire_period=s),id:"cashback-fired-period"},[(l(!0),n(f,null,k(t.cashback_fire_periods,s=>(l(),n("option",{value:s.value},_(s.title||"Не указано"),9,oo))),256))],512),[[w,t.botForm.cashback_fire_period]])]),t.botForm.cashback_fire_period>0?(l(),n("div",so,[lo,i(e("input",{type:"number",class:"form-control",placeholder:"%","aria-label":"уровень сгорания CashBack","onUpdate:modelValue":o[40]||(o[40]=s=>t.botForm.cashback_fire_percent=s),min:"0",max:"100","aria-describedby":"cashback-fired-level"},null,512),[[m,t.botForm.cashback_fire_percent]])])):c("",!0)])):c("",!0),e("div",ao,[e("div",no,[io,i(e("input",{type:"number",class:"form-control",placeholder:"%","aria-label":"процент для списания CashBack при покупке","onUpdate:modelValue":o[41]||(o[41]=s=>t.botForm.max_cashback_use_percent=s),min:"0",max:"100","aria-describedby":"cashback-max_cashback_use_percent"},null,512),[[m,t.botForm.max_cashback_use_percent]])])]),e("div",ro,[e("div",co,[i(e("input",{class:"form-check-input","onUpdate:modelValue":o[42]||(o[42]=s=>t.need_payments=s),type:"checkbox",id:"need-payments"},null,512),[[v,t.need_payments]]),mo])]),t.need_payments?(l(),n("div",bo,[e("div",ho,[i(e("input",{class:"form-check-input",type:"checkbox",value:t.botForm.auto_cashback_on_payments,"onUpdate:modelValue":o[43]||(o[43]=s=>t.botForm.auto_cashback_on_payments=s),id:"bot-auto-cashback-on-payments"},null,8,uo),[[v,t.botForm.auto_cashback_on_payments]]),_o]),e("div",po,[p(u,null,{content:h(()=>[fo]),default:h(()=>[vo]),_:1}),ko,i(e("input",{type:"text",class:"form-control",id:"payment_provider_token-input",placeholder:"Токен","aria-label":"Токен","onUpdate:modelValue":o[44]||(o[44]=s=>t.botForm.payment_provider_token=s),"aria-describedby":"payment_provider_token"},null,512),[[m,t.botForm.payment_provider_token]])])])):c("",!0),e("div",go,[e("div",yo,[i(e("input",{class:"form-check-input","onUpdate:modelValue":o[45]||(o[45]=s=>t.need_shop=s),type:"checkbox",id:"need-shop"},null,512),[[v,t.need_shop]]),Fo])]),t.need_shop?(l(),n("div",wo,[e("div",Co,[p(u,null,{content:h(()=>[Uo]),default:h(()=>[Vo]),_:1}),$o,i(e("input",{type:"url",class:"form-control",placeholder:"Ссылка на группу ВК","aria-label":"ссылка на группу ВК","onUpdate:modelValue":o[46]||(o[46]=s=>t.botForm.vk_shop_link=s),"aria-describedby":"vk_shop_link"},null,512),[[m,t.botForm.vk_shop_link]])])])):c("",!0),e("div",Bo,[e("div",jo,[i(e("input",{class:"form-check-input","onUpdate:modelValue":o[47]||(o[47]=s=>t.need_cashback_config=s),type:"checkbox",id:"need-cashback-config"},null,512),[[v,t.need_cashback_config]]),qo])]),t.need_cashback_config?(l(),n("div",Io,[So,(l(!0),n(f,null,k(t.botForm.cashback_config,(s,r)=>(l(),n("div",{class:"d-flex justify-content-between mb-2 flex-wrap",key:"social-link"+r},[e("div",To,[Mo,e("button",{type:"button",onClick:b=>t.removeCashBackConfig(r),class:"btn btn-link text-danger"},Eo,8,Lo)]),i(e("input",{type:"text",class:"form-control mb-2 w-100",placeholder:"Название категории","aria-label":"Название категории",maxlength:"255",onInvalid:o[48]||(o[48]=b=>t.alert("Вы не ввели название категории!",1)),"onUpdate:modelValue":b=>t.botForm.cashback_config[r].title=b,"aria-describedby":"bot-cashback-config-"+r,required:""},null,40,Po),[[m,t.botForm.cashback_config[r].title]])]))),128)),Wo,e("button",{type:"button",onClick:o[49]||(o[49]=s=>t.addCashBackConfig()),class:"btn mb-2 rounded-sm btn-outline-info w-100"}," Добавить категорию "),zo])):c("",!0),e("div",Jo,[e("div",No,[i(e("input",{class:"form-check-input","onUpdate:modelValue":o[50]||(o[50]=s=>t.need_cashback_rules=s),type:"checkbox",id:"need-cashback-rules"},null,512),[[v,t.need_cashback_rules]]),Ao])]),t.need_cashback_rules?(l(),n("div",Do,[e("div",Ro,[e("div",Go,[e("div",Ho,[Ko,i(e("select",{class:"form-control","onUpdate:modelValue":o[51]||(o[51]=s=>t.selected_warning=s),onChange:o[52]||(o[52]=(...s)=>t.addWarning&&t.addWarning(...s)),id:"warning-rules"},[Yo,(l(!0),n(f,null,k(t.filteredWarnings,s=>(l(),n("option",{value:s},_(s.title),9,Qo))),256))],544),[[w,t.selected_warning]])]),(l(!0),n(f,null,k(t.botForm.warnings,(s,r)=>(l(),n("div",Xo,[e("div",Zo,[e("div",xo,[e("p",es,_(t.getWarning(s.rule_key).title||"Не найдено"),1)]),e("div",ts,[e("div",os,[i(e("input",{class:"form-check-input","onUpdate:modelValue":b=>t.botForm.warnings[r].is_active=b,type:"checkbox",id:"warning-is-active-"+r},null,8,ss),[[v,t.botForm.warnings[r].is_active]]),e("label",{class:"form-check-label",for:"warning-is-active-"+r},[t.botForm.warnings[r].is_active?(l(),n("span",as,"Вкл")):(l(),n("span",ns,"Выкл"))],8,ls)])]),e("div",is,[i(e("input",{type:"number",class:"form-control",placeholder:"Значение","onUpdate:modelValue":b=>t.botForm.warnings[r].rule_value=b,min:"0","aria-describedby":"bot-level-3"},null,8,rs),[[m,t.botForm.warnings[r].rule_value]])]),e("div",ds,[e("button",{onClick:b=>t.removeWarning(r),type:"button",class:"btn btn-outline-danger"},bs,8,cs)])])]))),256))])])])):c("",!0)],512),[[y,t.tab===1&&t.canOpenForm]]),i(e("div",hs,[us,e("div",_s,[e("div",ps,[e("div",vs,[e("label",fs,[e("div",null,[p(u,null,{content:h(()=>[gs]),default:h(()=>[ks]),_:1}),d(" Канал для заказов (id) "),ys])]),p(V,{token:t.botForm.bot_token,param:"order_channel",onCallback:t.addTextTo},null,8,["token","onCallback"])]),i(e("input",{type:"text",class:"form-control",placeholder:"id канала","aria-label":"id канала","onUpdate:modelValue":o[53]||(o[53]=s=>t.botForm.order_channel=s),maxlength:"255","aria-describedby":"bot-order-channel"},null,512),[[m,t.botForm.order_channel]]),e("small",null,[e("a",{onClick:o[54]||(o[54]=s=>t.getChatLink(t.botForm.order_channel)),href:"javascript:void(0)"},"Узнать ссылку"),d("(будет отправлена в бота)")])])]),e("div",Fs,[e("div",ws,[e("div",Cs,[Vs,p(V,{token:t.botForm.bot_token,param:"main_channel",onCallback:t.addTextTo},null,8,["token","onCallback"])]),i(e("input",{type:"text",class:"form-control",placeholder:"id канала","aria-label":"id канала","onUpdate:modelValue":o[55]||(o[55]=s=>t.botForm.main_channel=s),maxlength:"255","aria-describedby":"bot-main-channel"},null,512),[[m,t.botForm.main_channel]]),e("small",null,[e("a",{onClick:o[56]||(o[56]=s=>t.getChatLink(t.botForm.main_channel)),href:"javascript:void(0)"},"Узнать ссылку"),d("(будет отправлена в бота)")])])]),t.botForm.order_channel?(l(),n("div",Us,Bs)):c("",!0),t.botForm.order_channel?(l(),n("div",js,[e("div",qs,[i(e("input",{class:"form-check-input","onUpdate:modelValue":o[57]||(o[57]=s=>t.need_threads=s),type:"checkbox",id:"need-topics-mailing"},null,512),[[v,t.need_threads]]),Is])])):c("",!0),t.need_threads&&t.botForm.order_channel?(l(),n("div",Ss,[e("div",Ts,[Ms,e("button",{class:"btn btn-outline-info",onClick:o[58]||(o[58]=(...s)=>t.createBotTopics&&t.createBotTopics(...s)),disabled:!t.can_create_topics,type:"button"},[Os,d("Создать топики автоматически ")],8,Ls)]),e("ul",Es,[(l(!0),n(f,null,k(t.botForm.message_threads,(s,r)=>(l(),n("li",Ps,[e("p",Ws,_(s.title)+" ("+_(s.key)+")",1),i(e("input",{type:"number",class:"form-control",min:"0",max:"10000",placeholder:"Идентификатор топика","onUpdate:modelValue":b=>t.botForm.message_threads[r].value=b},null,8,zs),[[m,t.botForm.message_threads[r].value]])]))),256))])])):c("",!0)],512),[[y,t.tab===2&&t.canOpenForm]]),i(e("div",Js,[e("div",Ns,[e("div",As,[e("div",Ds,[e("label",Rs,[d("Сообщение для режима тех. работ "),Gs,t.botForm.maintenance_message?(l(),n("small",Hs," Длина текста "+_(t.botForm.maintenance_message.length),1)):c("",!0)])]),i(e("textarea",{type:"text",class:"form-control",placeholder:"Текстовое сообщение","aria-label":"Текстовое сообщение","onUpdate:modelValue":o[59]||(o[59]=s=>t.botForm.maintenance_message=s),maxlength:"255",onInvalid:o[60]||(o[60]=s=>t.alert("Вы не ввели сообщение для технических работ бота!",3)),"aria-describedby":"bot-maintenance-message",required:""},`
                    `,544),[[m,t.botForm.maintenance_message]])])])],512),[[y,t.tab===3&&t.canOpenForm]]),i(e("div",Ks,[Ys,e("div",Qs,[Xs,e("div",Zs,[t.botForm.photos?(l(),n("label",xs,[el,e("input",{type:"file",id:"bot-photos",accept:"image/*",onChange:o[61]||(o[61]=(...s)=>t.onChangePhotos&&t.onChangePhotos(...s)),style:{display:"none"}},null,32)])):c("",!0),t.botForm.photos?(l(!0),n(f,{key:1},k(t.botForm.photos,(s,r)=>(l(),n("div",tl,[i(e("img",null,null,512),[[F,t.getPhoto(s).imageUrl]]),e("div",ol,[e("a",{onClick:o[62]||(o[62]=b=>t.removePhoto())},ll)])]))),256)):(l(),n("div",al,[i(e("img",null,null,512),[[F,"/images-by-bot-id/"+a.bot.id+"/"+t.botForm.image]]),e("div",nl,[e("a",{onClick:o[63]||(o[63]=s=>t.removePhoto())},rl)])]))])]),dl,e("div",cl,[e("div",ml,[p(u,null,{content:h(()=>[hl]),default:h(()=>[bl]),_:1}),ul,i(e("input",{type:"url",class:"form-control",placeholder:"Ссылка на внешний сервис","aria-label":"ссылка на внешний сервис","onUpdate:modelValue":o[64]||(o[64]=s=>t.botForm.callback_link=s),"aria-describedby":"callback_link"},null,512),[[m,t.botForm.callback_link]])])])],512),[[y,t.tab===4&&t.canOpenForm]]),i(e("div",_l,[pl,e("div",vl,[e("div",fl,[e("div",kl,[e("label",gl,[p(u,null,{content:h(()=>[Fl]),default:h(()=>[yl]),_:1}),d(" Приветственное сообщение "),wl,t.botForm.welcome_message?(l(),n("small",Cl," Длина текста "+_(t.botForm.welcome_message.length),1)):c("",!0)])]),i(e("textarea",{type:"text",class:"form-control",style:{"min-height":"400px"},placeholder:"Текстовое приветствие при запуске бота","aria-label":"Текстовое приветствие при запуске бота","onUpdate:modelValue":o[65]||(o[65]=s=>t.botForm.welcome_message=s),onInvalid:o[66]||(o[66]=s=>t.alert("Вы не ввели приветственное сообщение!",3)),"aria-describedby":"bot-description",required:""},`
                    `,544),[[m,t.botForm.welcome_message]])])]),e("div",Vl,[e("div",Ul,[e("div",$l,[e("label",Bl,[p(u,null,{content:h(()=>[ql]),default:h(()=>[jl]),_:1}),d(" Описание бота "),Il,t.botForm.description?(l(),n("small",Sl," Длина текста "+_(t.botForm.description.length),1)):c("",!0)])]),i(e("textarea",{type:"text",class:"form-control",placeholder:"Текстовое описание бота","aria-label":"Текстовое описание бота","onUpdate:modelValue":o[67]||(o[67]=s=>t.botForm.description=s),onInvalid:o[68]||(o[68]=s=>t.alert("Вы не ввели описание бота!",3)),"aria-describedby":"bot-description",required:""},`
                    `,544),[[m,t.botForm.description]])])]),e("div",Tl,[e("div",Ml,[Ll,e("div",Ol,[El,e("div",Pl,[e("div",Wl,[e("div",zl,[i(e("input",{type:"text",class:"form-control",placeholder:"Ссылка ресурс telegraph","aria-label":"Ссылка ресурс telegraph",maxlength:"255","onUpdate:modelValue":o[69]||(o[69]=s=>t.botForm.info_link=s),"aria-describedby":"bot-info-link"},null,512),[[m,t.botForm.info_link]])])])])])])]),e("div",Jl,[e("div",Nl,[Al,e("div",Dl,[Rl,(l(!0),n(f,null,k(t.botForm.social_links,(s,r)=>(l(),n("div",{class:"row",key:"social-link"+r},[e("div",Gl,[e("div",Hl,[i(e("input",{type:"text",class:"form-control",placeholder:"Название ссылки","aria-label":"Название ссылки",maxlength:"255",onInvalid:o[70]||(o[70]=b=>t.alert("Вы не ввели название ссылки на соц. сеть!",4)),"onUpdate:modelValue":b=>t.botForm.social_links[r].title=b,"aria-describedby":"bot-social-link-"+r,required:""},null,40,Kl),[[m,t.botForm.social_links[r].title]])])]),e("div",Yl,[e("div",Ql,[i(e("input",{type:"text",class:"form-control",placeholder:"Ссылка на соц.сеть","aria-label":"Ссылка на соц.сеть",maxlength:"255",onInvalid:o[71]||(o[71]=b=>t.alert("Вы не ввели ссылку на соц. сеть!",4)),"onUpdate:modelValue":b=>t.botForm.social_links[r].url=b,"aria-describedby":"bot-social-link-"+r,required:""},null,40,Xl),[[m,t.botForm.social_links[r].url]])])]),e("div",Zl,[e("button",{type:"button",onClick:b=>t.removeItem("social_links",r),class:"btn btn-outline-danger w-100"},ta,8,xl)])]))),128)),e("div",oa,[e("div",sa,[e("button",{type:"button",onClick:o[72]||(o[72]=s=>t.addSocialLinks()),class:"btn btn-outline-success w-100"},"Добавить еще ссылку ")])])])])])],512),[[y,t.tab===5&&t.canOpenForm]]),t.canOpenForm?(l(),n("div",la,[e("div",aa,[t.messages.length>0?(l(!0),n(f,{key:0},k(t.messages,(s,r)=>(l(),n("div",na,[ia,d(" "+_(s||"Ошибка")+" ",1),e("button",{type:"button",class:"btn-close",onClick:b=>t.removeMessage(r)},null,8,ra)]))),256)):c("",!0)]),e("div",da,[e("button",{type:"submit",onClick:o[73]||(o[73]=s=>t.messages=[]),disabled:!t.botForm.bot_token||!t.can_create,title:"Сохранение бота",class:"btn btn-primary min-menu-btn w-100"},[a.bot?(l(),n("span",ba,"Обновить бота")):(l(),n("span",ma,"Добавить бота")),t.can_create?c("",!0):(l(),n("span",ha,_(t.spent_time_counter)+" сек.",1))],8,ca)])])):c("",!0)],32)}}});export{fa as _};
