import{_ as C}from"./MainAdminLayout-28e1a6fc.js";import{_ as g}from"./BotSection-c5beafd5.js";import"./CompanyList-6f3c5f92.js";import{_ as k,a as v}from"./BotForm-a4bdbbd7.js";import{j as y,o as a,H as r,w as l,n as s,a0 as p,k as d,M as n,l as c,u,F as S,K as B,L as m,U as w,W as $}from"./index.es-c4852431.js";import{C as h,S as b,P as T,N as _}from"./carousel.es-39a2ec14.js";import{_ as I}from"./_plugin-vue_export-helper-c27b6911.js";import"./ManagerProfile-d7e8e099.js";/* empty css                                                 */import"./MailingTable-cb829bc7.js";import"./TelegramChannelHelper-ff1b321d.js";/* empty css                                                              */import"./Pagination-02b5940a.js";import"./vue3-json-editor.esm.prod-a2876a2f.js";import"./v4-4a60fe23.js";import"./BotMediaList-30a5f8d8.js";import"./vue-datepicker-ff2ff697.js";/* empty css             */import"./SlugForm-bfc274b3.js";import"./GlobalSlugList-1bba8449.js";import"./AppointmentScheduleList-fd2d6334.js";/* empty css                                                               */import"./base64-ae67ffac.js";import"./vue3-charts.esm-31920dfb.js";const F=e=>(w("data-v-ce553b86"),e=e(),$(),e),E={class:"container"},L={class:"row mb-2"},N={class:"col-12"},P={class:"btn-group",role:"group","aria-label":"Basic outlined example"},U=["disabled"],V={key:0,class:"row mt-3"},j={class:"col-12"},A={key:1,class:"row"},M={class:"col-12"},O=F(()=>s("h5",null,"Создать бота из шаблона",-1)),z={class:"carousel__item p-2 w-100"},D={class:"card w-100"},G={class:"card-body w-100"},H={class:"card-title"},K={class:"card-text"},W=["disabled","onClick"],q={key:2},J={components:{Carousel:h,Slide:b,Pagination:T,Navigation:_},data(){return{templates:[],load:!1,step:0,bot:null,botUser:null}},computed:{...y(["getCurrentBot","getCurrentCompany","getBotFavorites","inBotFav"]),getSelf(){return window.profile},isManagerVerified(){return!(!this.botUser||!this.botUser.manager)}},mounted(){this.loadTemplates(),this.loadCurrentBot(),this.botUser=this.getSelf,this.setStep(localStorage.getItem("cashman_set_botpage_step_index")||0),window.addEventListener("store_current_bot-change-event",e=>{this.bot=this.getCurrentBot,this.step=this.bot?2:1})},methods:{openForEdit(){},duplicateAndEdit(e,t){this.templates[e].in_use=!0,this.$store.dispatch("duplicateBot",{dataObject:{bot_id:t,company_id:this.getCurrentCompany?this.getCurrentCompany.id:null}}).then(i=>{this.bot=i.data,this.load=!0,this.templates[e].in_use=!1,this.loadCurrentBot(this.bot),localStorage.setItem("cashman_set_botform_step_index",0),this.inBotFav(this.bot.id)||this.$store.dispatch("addBotToFavorites",this.bot.id),this.setStep(2),this.$nextTick(()=>{this.load=!1}),this.$notify("Указанный бот успешно продублирован")})},loadTemplates(){this.$store.dispatch("loadTemplates").then(e=>{this.templates=e.data,console.log(e.data)})},setStep(e){this.step=parseInt(e),localStorage.setItem("cashman_set_botpage_step_index",e)},loadCurrentBot(e=null){this.$store.dispatch("updateCurrentBot",{bot:e}).then(()=>{this.bot=this.getCurrentBot})},botSectionCallback(){this.load=!0,this.setStep(2),this.$nextTick(()=>{this.load=!1})},botListCallback(e){this.load=!0,this.setStep(2),this.loadCurrentBot(e),this.$nextTick(()=>{this.load=!1})}}},Q=Object.assign(J,{__name:"BotPage",setup(e){return(t,i)=>(a(),r(C,{active:2,"need-menu":!0},{default:l(()=>[s("div",E,[s("div",L,[s("div",N,[s("div",P,[s("button",{type:"button",onClick:i[0]||(i[0]=o=>t.setStep(0)),class:p([{"btn-primary":t.step===0,"btn-outline-primary":t.step!==0},"btn"])},"Создание бота ",2),s("button",{type:"button",onClick:i[1]||(i[1]=o=>t.setStep(1)),class:p([{"btn-primary":t.step===1,"btn-outline-primary":t.step!==1},"btn"])},"Поиск бота ",2),s("button",{type:"button",disabled:!t.bot,onClick:i[2]||(i[2]=o=>t.setStep(2)),class:p([{"btn-primary":t.step===2,"btn-outline-primary":t.step!==2},"btn"])},"Редактирование бота ",10,U)])])]),t.step===0?(a(),d("div",V,[s("div",j,[t.load?n("",!0):(a(),r(k,{key:0,onCallback:t.loadCurrentBot},null,8,["onCallback"]))])])):n("",!0),t.step===1?(a(),d("div",A,[s("div",M,[O,c(u(h),{itemsToShow:3.95,wrapAround:!0,transition:500},{addons:l(()=>[c(u(_))]),default:l(()=>[(a(!0),d(S,null,B(t.templates,(o,f)=>(a(),r(u(b),{key:o.id},{default:l(()=>[s("div",z,[s("div",D,[s("div",G,[s("h5",H,m(o.title||o.bot_domain||"Без названия"),1),s("p",K,m(o.template_description||"-"),1),s("button",{disabled:o.in_use||!1,type:"button",onClick:R=>t.duplicateAndEdit(f,o.id),class:"btn btn-primary"},"Создать из шаблона",8,W)])])])]),_:2},1024))),128))]),_:1},8,["itemsToShow"])]),t.load?n("",!0):(a(),r(v,{key:0,editor:!0,onCallback:t.botListCallback},null,8,["onCallback"]))])):n("",!0),t.step===2?(a(),d("div",q,[t.bot&&!t.load?(a(),r(g,{key:0,onCallback:t.botSectionCallback,bot:t.bot},null,8,["onCallback","bot"])):n("",!0)])):n("",!0)])]),_:1}))}}),kt=I(Q,[["__scopeId","data-v-ce553b86"]]);export{kt as default};
